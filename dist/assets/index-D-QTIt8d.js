var vN=Object.defineProperty;var Eb=r=>{throw TypeError(r)};var _N=(r,t,e)=>t in r?vN(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var Xe=(r,t,e)=>_N(r,typeof t!="symbol"?t+"":t,e),z_=(r,t,e)=>t.has(r)||Eb("Cannot "+e);var p=(r,t,e)=>(z_(r,t,"read from private field"),e?e.call(r):t.get(r)),O=(r,t,e)=>t.has(r)?Eb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),w=(r,t,e,a)=>(z_(r,t,"write to private field"),a?a.call(r,e):t.set(r,e),e),D=(r,t,e)=>(z_(r,t,"access private method"),e);var ka=(r,t,e,a)=>({set _(i){w(r,t,i,e)},get _(){return p(r,t,a)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(i){if(i.ep)return;i.ep=!0;const l=e(i);fetch(i.href,l)}})();function fR(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var G_={exports:{}},z0={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ab;function EN(){if(Ab)return z0;Ab=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(a,i,l){var o=null;if(l!==void 0&&(o=""+l),i.key!==void 0&&(o=""+i.key),"key"in i){l={};for(var c in i)c!=="key"&&(l[c]=i[c])}else l=i;return i=l.ref,{$$typeof:r,type:a,key:o,ref:i!==void 0?i:null,props:l}}return z0.Fragment=t,z0.jsx=e,z0.jsxs=e,z0}var yb;function AN(){return yb||(yb=1,G_.exports=EN()),G_.exports}var Ee=AN(),V_={exports:{}},$e={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tb;function yN(){if(Tb)return $e;Tb=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),v=Symbol.iterator;function _(Y){return Y===null||typeof Y!="object"?null:(Y=v&&Y[v]||Y["@@iterator"],typeof Y=="function"?Y:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,T={};function S(Y,N,q){this.props=Y,this.context=N,this.refs=T,this.updater=q||A}S.prototype.isReactComponent={},S.prototype.setState=function(Y,N){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,N,"setState")},S.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function R(){}R.prototype=S.prototype;function C(Y,N,q){this.props=Y,this.context=N,this.refs=T,this.updater=q||A}var F=C.prototype=new R;F.constructor=C,y(F,S.prototype),F.isPureReactComponent=!0;var U=Array.isArray;function B(){}var k={H:null,A:null,T:null,S:null},J=Object.prototype.hasOwnProperty;function j(Y,N,q){var X=q.ref;return{$$typeof:r,type:Y,key:N,ref:X!==void 0?X:null,props:q}}function ie(Y,N){return j(Y.type,N,Y.props)}function Q(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===r}function ee(Y){var N={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(q){return N[q]})}var ge=/\/+/g;function ye(Y,N){return typeof Y=="object"&&Y!==null&&Y.key!=null?ee(""+Y.key):N.toString(36)}function me(Y){switch(Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason;default:switch(typeof Y.status=="string"?Y.then(B,B):(Y.status="pending",Y.then(function(N){Y.status==="pending"&&(Y.status="fulfilled",Y.value=N)},function(N){Y.status==="pending"&&(Y.status="rejected",Y.reason=N)})),Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason}}throw Y}function G(Y,N,q,X,K){var se=typeof Y;(se==="undefined"||se==="boolean")&&(Y=null);var xe=!1;if(Y===null)xe=!0;else switch(se){case"bigint":case"string":case"number":xe=!0;break;case"object":switch(Y.$$typeof){case r:case t:xe=!0;break;case g:return xe=Y._init,G(xe(Y._payload),N,q,X,K)}}if(xe)return K=K(Y),xe=X===""?"."+ye(Y,0):X,U(K)?(q="",xe!=null&&(q=xe.replace(ge,"$&/")+"/"),G(K,N,q,"",function(be){return be})):K!=null&&(Q(K)&&(K=ie(K,q+(K.key==null||Y&&Y.key===K.key?"":(""+K.key).replace(ge,"$&/")+"/")+xe)),N.push(K)),1;xe=0;var ke=X===""?".":X+":";if(U(Y))for(var Se=0;Se<Y.length;Se++)X=Y[Se],se=ke+ye(X,Se),xe+=G(X,N,q,se,K);else if(Se=_(Y),typeof Se=="function")for(Y=Se.call(Y),Se=0;!(X=Y.next()).done;)X=X.value,se=ke+ye(X,Se++),xe+=G(X,N,q,se,K);else if(se==="object"){if(typeof Y.then=="function")return G(me(Y),N,q,X,K);throw N=String(Y),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.")}return xe}function te(Y,N,q){if(Y==null)return Y;var X=[],K=0;return G(Y,X,"","",function(se){return N.call(q,se,K++)}),X}function we(Y){if(Y._status===-1){var N=Y._result;N=N(),N.then(function(q){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=q)},function(q){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=q)}),Y._status===-1&&(Y._status=0,Y._result=N)}if(Y._status===1)return Y._result.default;throw Y._result}var ae=typeof reportError=="function"?reportError:function(Y){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var N=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Y=="object"&&Y!==null&&typeof Y.message=="string"?String(Y.message):String(Y),error:Y});if(!window.dispatchEvent(N))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Y);return}console.error(Y)},Oe={map:te,forEach:function(Y,N,q){te(Y,function(){N.apply(this,arguments)},q)},count:function(Y){var N=0;return te(Y,function(){N++}),N},toArray:function(Y){return te(Y,function(N){return N})||[]},only:function(Y){if(!Q(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}};return $e.Activity=m,$e.Children=Oe,$e.Component=S,$e.Fragment=e,$e.Profiler=i,$e.PureComponent=C,$e.StrictMode=a,$e.Suspense=f,$e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,$e.__COMPILER_RUNTIME={__proto__:null,c:function(Y){return k.H.useMemoCache(Y)}},$e.cache=function(Y){return function(){return Y.apply(null,arguments)}},$e.cacheSignal=function(){return null},$e.cloneElement=function(Y,N,q){if(Y==null)throw Error("The argument must be a React element, but you passed "+Y+".");var X=y({},Y.props),K=Y.key;if(N!=null)for(se in N.key!==void 0&&(K=""+N.key),N)!J.call(N,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&N.ref===void 0||(X[se]=N[se]);var se=arguments.length-2;if(se===1)X.children=q;else if(1<se){for(var xe=Array(se),ke=0;ke<se;ke++)xe[ke]=arguments[ke+2];X.children=xe}return j(Y.type,K,X)},$e.createContext=function(Y){return Y={$$typeof:o,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null},Y.Provider=Y,Y.Consumer={$$typeof:l,_context:Y},Y},$e.createElement=function(Y,N,q){var X,K={},se=null;if(N!=null)for(X in N.key!==void 0&&(se=""+N.key),N)J.call(N,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(K[X]=N[X]);var xe=arguments.length-2;if(xe===1)K.children=q;else if(1<xe){for(var ke=Array(xe),Se=0;Se<xe;Se++)ke[Se]=arguments[Se+2];K.children=ke}if(Y&&Y.defaultProps)for(X in xe=Y.defaultProps,xe)K[X]===void 0&&(K[X]=xe[X]);return j(Y,se,K)},$e.createRef=function(){return{current:null}},$e.forwardRef=function(Y){return{$$typeof:c,render:Y}},$e.isValidElement=Q,$e.lazy=function(Y){return{$$typeof:g,_payload:{_status:-1,_result:Y},_init:we}},$e.memo=function(Y,N){return{$$typeof:d,type:Y,compare:N===void 0?null:N}},$e.startTransition=function(Y){var N=k.T,q={};k.T=q;try{var X=Y(),K=k.S;K!==null&&K(q,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(B,ae)}catch(se){ae(se)}finally{N!==null&&q.types!==null&&(N.types=q.types),k.T=N}},$e.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},$e.use=function(Y){return k.H.use(Y)},$e.useActionState=function(Y,N,q){return k.H.useActionState(Y,N,q)},$e.useCallback=function(Y,N){return k.H.useCallback(Y,N)},$e.useContext=function(Y){return k.H.useContext(Y)},$e.useDebugValue=function(){},$e.useDeferredValue=function(Y,N){return k.H.useDeferredValue(Y,N)},$e.useEffect=function(Y,N){return k.H.useEffect(Y,N)},$e.useEffectEvent=function(Y){return k.H.useEffectEvent(Y)},$e.useId=function(){return k.H.useId()},$e.useImperativeHandle=function(Y,N,q){return k.H.useImperativeHandle(Y,N,q)},$e.useInsertionEffect=function(Y,N){return k.H.useInsertionEffect(Y,N)},$e.useLayoutEffect=function(Y,N){return k.H.useLayoutEffect(Y,N)},$e.useMemo=function(Y,N){return k.H.useMemo(Y,N)},$e.useOptimistic=function(Y,N){return k.H.useOptimistic(Y,N)},$e.useReducer=function(Y,N,q){return k.H.useReducer(Y,N,q)},$e.useRef=function(Y){return k.H.useRef(Y)},$e.useState=function(Y){return k.H.useState(Y)},$e.useSyncExternalStore=function(Y,N,q){return k.H.useSyncExternalStore(Y,N,q)},$e.useTransition=function(){return k.H.useTransition()},$e.version="19.2.3",$e}var Sb;function VA(){return Sb||(Sb=1,V_.exports=yN()),V_.exports}var Fr=VA();const TN=fR(Fr);var j_={exports:{}},G0={},Y_={exports:{}},X_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bb;function SN(){return bb||(bb=1,(function(r){function t(G,te){var we=G.length;G.push(te);e:for(;0<we;){var ae=we-1>>>1,Oe=G[ae];if(0<i(Oe,te))G[ae]=te,G[we]=Oe,we=ae;else break e}}function e(G){return G.length===0?null:G[0]}function a(G){if(G.length===0)return null;var te=G[0],we=G.pop();if(we!==te){G[0]=we;e:for(var ae=0,Oe=G.length,Y=Oe>>>1;ae<Y;){var N=2*(ae+1)-1,q=G[N],X=N+1,K=G[X];if(0>i(q,we))X<Oe&&0>i(K,q)?(G[ae]=K,G[X]=we,ae=X):(G[ae]=q,G[N]=we,ae=N);else if(X<Oe&&0>i(K,we))G[ae]=K,G[X]=we,ae=X;else break e}}return te}function i(G,te){var we=G.sortIndex-te.sortIndex;return we!==0?we:G.id-te.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;r.unstable_now=function(){return l.now()}}else{var o=Date,c=o.now();r.unstable_now=function(){return o.now()-c}}var f=[],d=[],g=1,m=null,v=3,_=!1,A=!1,y=!1,T=!1,S=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function F(G){for(var te=e(d);te!==null;){if(te.callback===null)a(d);else if(te.startTime<=G)a(d),te.sortIndex=te.expirationTime,t(f,te);else break;te=e(d)}}function U(G){if(y=!1,F(G),!A)if(e(f)!==null)A=!0,B||(B=!0,ee());else{var te=e(d);te!==null&&me(U,te.startTime-G)}}var B=!1,k=-1,J=5,j=-1;function ie(){return T?!0:!(r.unstable_now()-j<J)}function Q(){if(T=!1,B){var G=r.unstable_now();j=G;var te=!0;try{e:{A=!1,y&&(y=!1,R(k),k=-1),_=!0;var we=v;try{t:{for(F(G),m=e(f);m!==null&&!(m.expirationTime>G&&ie());){var ae=m.callback;if(typeof ae=="function"){m.callback=null,v=m.priorityLevel;var Oe=ae(m.expirationTime<=G);if(G=r.unstable_now(),typeof Oe=="function"){m.callback=Oe,F(G),te=!0;break t}m===e(f)&&a(f),F(G)}else a(f);m=e(f)}if(m!==null)te=!0;else{var Y=e(d);Y!==null&&me(U,Y.startTime-G),te=!1}}break e}finally{m=null,v=we,_=!1}te=void 0}}finally{te?ee():B=!1}}}var ee;if(typeof C=="function")ee=function(){C(Q)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,ye=ge.port2;ge.port1.onmessage=Q,ee=function(){ye.postMessage(null)}}else ee=function(){S(Q,0)};function me(G,te){k=S(function(){G(r.unstable_now())},te)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(G){G.callback=null},r.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<G?Math.floor(1e3/G):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_next=function(G){switch(v){case 1:case 2:case 3:var te=3;break;default:te=v}var we=v;v=te;try{return G()}finally{v=we}},r.unstable_requestPaint=function(){T=!0},r.unstable_runWithPriority=function(G,te){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var we=v;v=G;try{return te()}finally{v=we}},r.unstable_scheduleCallback=function(G,te,we){var ae=r.unstable_now();switch(typeof we=="object"&&we!==null?(we=we.delay,we=typeof we=="number"&&0<we?ae+we:ae):we=ae,G){case 1:var Oe=-1;break;case 2:Oe=250;break;case 5:Oe=1073741823;break;case 4:Oe=1e4;break;default:Oe=5e3}return Oe=we+Oe,G={id:g++,callback:te,priorityLevel:G,startTime:we,expirationTime:Oe,sortIndex:-1},we>ae?(G.sortIndex=we,t(d,G),e(f)===null&&G===e(d)&&(y?(R(k),k=-1):y=!0,me(U,we-ae))):(G.sortIndex=Oe,t(f,G),A||_||(A=!0,B||(B=!0,ee()))),G},r.unstable_shouldYield=ie,r.unstable_wrapCallback=function(G){var te=v;return function(){var we=v;v=te;try{return G.apply(this,arguments)}finally{v=we}}}})(X_)),X_}var wb;function bN(){return wb||(wb=1,Y_.exports=SN()),Y_.exports}var q_={exports:{}},ua={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cb;function wN(){if(Cb)return ua;Cb=1;var r=VA();function t(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var a={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},i=Symbol.for("react.portal");function l(f,d,g){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:m==null?null:""+m,children:f,containerInfo:d,implementation:g}}var o=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return ua.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,ua.createPortal=function(f,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return l(f,d,null,g)},ua.flushSync=function(f){var d=o.T,g=a.p;try{if(o.T=null,a.p=2,f)return f()}finally{o.T=d,a.p=g,a.d.f()}},ua.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,a.d.C(f,d))},ua.prefetchDNS=function(f){typeof f=="string"&&a.d.D(f)},ua.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var g=d.as,m=c(g,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,_=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?a.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:m,integrity:v,fetchPriority:_}):g==="script"&&a.d.X(f,{crossOrigin:m,integrity:v,fetchPriority:_,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},ua.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=c(d.as,d.crossOrigin);a.d.M(f,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&a.d.M(f)},ua.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,m=c(g,d.crossOrigin);a.d.L(f,g,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},ua.preloadModule=function(f,d){if(typeof f=="string")if(d){var g=c(d.as,d.crossOrigin);a.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else a.d.m(f)},ua.requestFormReset=function(f){a.d.r(f)},ua.unstable_batchedUpdates=function(f,d){return f(d)},ua.useFormState=function(f,d,g){return o.H.useFormState(f,d,g)},ua.useFormStatus=function(){return o.H.useHostTransitionStatus()},ua.version="19.2.3",ua}var Rb;function CN(){if(Rb)return q_.exports;Rb=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),q_.exports=wN(),q_.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kb;function RN(){if(kb)return G0;kb=1;var r=bN(),t=VA(),e=CN();function a(n){var s="https://react.dev/errors/"+n;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)s+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+n+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var s=n,u=n;if(n.alternate)for(;s.return;)s=s.return;else{n=s;do s=n,(s.flags&4098)!==0&&(u=s.return),n=s.return;while(n)}return s.tag===3?u:null}function o(n){if(n.tag===13){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function c(n){if(n.tag===31){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function f(n){if(l(n)!==n)throw Error(a(188))}function d(n){var s=n.alternate;if(!s){if(s=l(n),s===null)throw Error(a(188));return s!==n?null:n}for(var u=n,h=s;;){var x=u.return;if(x===null)break;var E=x.alternate;if(E===null){if(h=x.return,h!==null){u=h;continue}break}if(x.child===E.child){for(E=x.child;E;){if(E===u)return f(x),n;if(E===h)return f(x),s;E=E.sibling}throw Error(a(188))}if(u.return!==h.return)u=x,h=E;else{for(var b=!1,I=x.child;I;){if(I===u){b=!0,u=x,h=E;break}if(I===h){b=!0,h=x,u=E;break}I=I.sibling}if(!b){for(I=E.child;I;){if(I===u){b=!0,u=E,h=x;break}if(I===h){b=!0,h=E,u=x;break}I=I.sibling}if(!b)throw Error(a(189))}}if(u.alternate!==h)throw Error(a(190))}if(u.tag!==3)throw Error(a(188));return u.stateNode.current===u?n:s}function g(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n;for(n=n.child;n!==null;){if(s=g(n),s!==null)return s;n=n.sibling}return null}var m=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),C=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),ie=Symbol.for("react.memo_cache_sentinel"),Q=Symbol.iterator;function ee(n){return n===null||typeof n!="object"?null:(n=Q&&n[Q]||n["@@iterator"],typeof n=="function"?n:null)}var ge=Symbol.for("react.client.reference");function ye(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===ge?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case y:return"Fragment";case S:return"Profiler";case T:return"StrictMode";case U:return"Suspense";case B:return"SuspenseList";case j:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case A:return"Portal";case C:return n.displayName||"Context";case R:return(n._context.displayName||"Context")+".Consumer";case F:var s=n.render;return n=n.displayName,n||(n=s.displayName||s.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case k:return s=n.displayName||null,s!==null?s:ye(n.type)||"Memo";case J:s=n._payload,n=n._init;try{return ye(n(s))}catch{}}return null}var me=Array.isArray,G=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,we={pending:!1,data:null,method:null,action:null},ae=[],Oe=-1;function Y(n){return{current:n}}function N(n){0>Oe||(n.current=ae[Oe],ae[Oe]=null,Oe--)}function q(n,s){Oe++,ae[Oe]=n.current,n.current=s}var X=Y(null),K=Y(null),se=Y(null),xe=Y(null);function ke(n,s){switch(q(se,s),q(K,n),q(X,null),s.nodeType){case 9:case 11:n=(n=s.documentElement)&&(n=n.namespaceURI)?VS(n):0;break;default:if(n=s.tagName,s=s.namespaceURI)s=VS(s),n=jS(s,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}N(X),q(X,n)}function Se(){N(X),N(K),N(se)}function be(n){n.memoizedState!==null&&q(xe,n);var s=X.current,u=jS(s,n.type);s!==u&&(q(K,n),q(X,u))}function ot(n){K.current===n&&(N(X),N(K)),xe.current===n&&(N(xe),P0._currentValue=we)}var W,Wt;function st(n){if(W===void 0)try{throw Error()}catch(u){var s=u.stack.trim().match(/\n( *(at )?)/);W=s&&s[1]||"",Wt=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+W+n+Wt}var bt=!1;function tt(n,s){if(!n||bt)return"";bt=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(s){var Te=function(){throw Error()};if(Object.defineProperty(Te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Te,[])}catch(pe){var he=pe}Reflect.construct(n,[],Te)}else{try{Te.call()}catch(pe){he=pe}n.call(Te.prototype)}}else{try{throw Error()}catch(pe){he=pe}(Te=n())&&typeof Te.catch=="function"&&Te.catch(function(){})}}catch(pe){if(pe&&he&&typeof pe.stack=="string")return[pe.stack,he.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=h.DetermineComponentFrameRoot(),b=E[0],I=E[1];if(b&&I){var Z=b.split(`
`),oe=I.split(`
`);for(x=h=0;h<Z.length&&!Z[h].includes("DetermineComponentFrameRoot");)h++;for(;x<oe.length&&!oe[x].includes("DetermineComponentFrameRoot");)x++;if(h===Z.length||x===oe.length)for(h=Z.length-1,x=oe.length-1;1<=h&&0<=x&&Z[h]!==oe[x];)x--;for(;1<=h&&0<=x;h--,x--)if(Z[h]!==oe[x]){if(h!==1||x!==1)do if(h--,x--,0>x||Z[h]!==oe[x]){var ve=`
`+Z[h].replace(" at new "," at ");return n.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",n.displayName)),ve}while(1<=h&&0<=x);break}}}finally{bt=!1,Error.prepareStackTrace=u}return(u=n?n.displayName||n.name:"")?st(u):""}function Ie(n,s){switch(n.tag){case 26:case 27:case 5:return st(n.type);case 16:return st("Lazy");case 13:return n.child!==s&&s!==null?st("Suspense Fallback"):st("Suspense");case 19:return st("SuspenseList");case 0:case 15:return tt(n.type,!1);case 11:return tt(n.type.render,!1);case 1:return tt(n.type,!0);case 31:return st("Activity");default:return""}}function Kt(n){try{var s="",u=null;do s+=Ie(n,u),u=n,n=n.return;while(n);return s}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var ca=Object.prototype.hasOwnProperty,Ya=r.unstable_scheduleCallback,cn=r.unstable_cancelCallback,zo=r.unstable_shouldYield,zi=r.unstable_requestPaint,Pt=r.unstable_now,hi=r.unstable_getCurrentPriorityLevel,di=r.unstable_ImmediatePriority,Sl=r.unstable_UserBlockingPriority,_r=r.unstable_NormalPriority,Ln=r.unstable_LowPriority,rt=r.unstable_IdlePriority,rr=r.log,Xa=r.unstable_setDisableYieldValue,jt=null,hr=null;function pi(n){if(typeof rr=="function"&&Xa(n),hr&&typeof hr.setStrictMode=="function")try{hr.setStrictMode(jt,n)}catch{}}var Ca=Math.clz32?Math.clz32:Eg,Dx=Math.log,_g=Math.LN2;function Eg(n){return n>>>=0,n===0?32:31-(Dx(n)/_g|0)|0}var Go=256,Lu=262144,Pu=4194304;function Pn(n){var s=n&42;if(s!==0)return s;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Bu(n,s,u){var h=n.pendingLanes;if(h===0)return 0;var x=0,E=n.suspendedLanes,b=n.pingedLanes;n=n.warmLanes;var I=h&134217727;return I!==0?(h=I&~E,h!==0?x=Pn(h):(b&=I,b!==0?x=Pn(b):u||(u=I&~n,u!==0&&(x=Pn(u))))):(I=h&~E,I!==0?x=Pn(I):b!==0?x=Pn(b):u||(u=h&~n,u!==0&&(x=Pn(u)))),x===0?0:s!==0&&s!==x&&(s&E)===0&&(E=x&-x,u=s&-s,E>=u||E===32&&(u&4194048)!==0)?s:x}function Vo(n,s){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&s)===0}function Nx(n,s){switch(n){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ag(){var n=Pu;return Pu<<=1,(Pu&62914560)===0&&(Pu=4194304),n}function $h(n){for(var s=[],u=0;31>u;u++)s.push(n);return s}function jo(n,s){n.pendingLanes|=s,s!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Mx(n,s,u,h,x,E){var b=n.pendingLanes;n.pendingLanes=u,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=u,n.entangledLanes&=u,n.errorRecoveryDisabledLanes&=u,n.shellSuspendCounter=0;var I=n.entanglements,Z=n.expirationTimes,oe=n.hiddenUpdates;for(u=b&~u;0<u;){var ve=31-Ca(u),Te=1<<ve;I[ve]=0,Z[ve]=-1;var he=oe[ve];if(he!==null)for(oe[ve]=null,ve=0;ve<he.length;ve++){var pe=he[ve];pe!==null&&(pe.lane&=-536870913)}u&=~Te}h!==0&&yg(n,h,0),E!==0&&x===0&&n.tag!==0&&(n.suspendedLanes|=E&~(b&~s))}function yg(n,s,u){n.pendingLanes|=s,n.suspendedLanes&=~s;var h=31-Ca(s);n.entangledLanes|=s,n.entanglements[h]=n.entanglements[h]|1073741824|u&261930}function Uu(n,s){var u=n.entangledLanes|=s;for(n=n.entanglements;u;){var h=31-Ca(u),x=1<<h;x&s|n[h]&s&&(n[h]|=s),u&=~x}}function Tg(n,s){var u=s&-s;return u=(u&42)!==0?1:Qh(u),(u&(n.suspendedLanes|s))!==0?0:u}function Qh(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Zh(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function M(){var n=te.p;return n!==0?n:(n=window.event,n===void 0?32:db(n.type))}function z(n,s){var u=te.p;try{return te.p=n,s()}finally{te.p=u}}var L=Math.random().toString(36).slice(2),P="__reactFiber$"+L,H="__reactProps$"+L,V="__reactContainer$"+L,ce="__reactEvents$"+L,_e="__reactListeners$"+L,ue="__reactHandles$"+L,fe="__reactResources$"+L,de="__reactMarker$"+L;function Ce(n){delete n[P],delete n[H],delete n[ce],delete n[_e],delete n[ue]}function De(n){var s=n[P];if(s)return s;for(var u=n.parentNode;u;){if(s=u[V]||u[P]){if(u=s.alternate,s.child!==null||u!==null&&u.child!==null)for(n=QS(n);n!==null;){if(u=n[P])return u;n=QS(n)}return s}n=u,u=n.parentNode}return null}function Fe(n){if(n=n[P]||n[V]){var s=n.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return n}return null}function Re(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n.stateNode;throw Error(a(33))}function Ne(n){var s=n[fe];return s||(s=n[fe]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function He(n){n[de]=!0}var Ht=new Set,zt={};function $t(n,s){Bn(n,s),Bn(n+"Capture",s)}function Bn(n,s){for(zt[n]=s,n=0;n<s.length;n++)Ht.add(s[n])}var Yo=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),bl={},Gi={};function Jh(n){return ca.call(Gi,n)?!0:ca.call(bl,n)?!1:Yo.test(n)?Gi[n]=!0:(bl[n]=!0,!1)}function qa(n,s,u){if(Jh(s))if(u===null)n.removeAttribute(s);else{switch(typeof u){case"undefined":case"function":case"symbol":n.removeAttribute(s);return;case"boolean":var h=s.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){n.removeAttribute(s);return}}n.setAttribute(s,""+u)}}function Sg(n,s,u){if(u===null)n.removeAttribute(s);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(s);return}n.setAttribute(s,""+u)}}function Es(n,s,u,h){if(h===null)n.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(u);return}n.setAttributeNS(s,u,""+h)}}function Un(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Fy(n){var s=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function fD(n,s,u){var h=Object.getOwnPropertyDescriptor(n.constructor.prototype,s);if(!n.hasOwnProperty(s)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var x=h.get,E=h.set;return Object.defineProperty(n,s,{configurable:!0,get:function(){return x.call(this)},set:function(b){u=""+b,E.call(this,b)}}),Object.defineProperty(n,s,{enumerable:h.enumerable}),{getValue:function(){return u},setValue:function(b){u=""+b},stopTracking:function(){n._valueTracker=null,delete n[s]}}}}function Ix(n){if(!n._valueTracker){var s=Fy(n)?"checked":"value";n._valueTracker=fD(n,s,""+n[s])}}function Ly(n){if(!n)return!1;var s=n._valueTracker;if(!s)return!0;var u=s.getValue(),h="";return n&&(h=Fy(n)?n.checked?"true":"false":n.value),n=h,n!==u?(s.setValue(n),!0):!1}function bg(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var hD=/[\n"\\]/g;function Hn(n){return n.replace(hD,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Fx(n,s,u,h,x,E,b,I){n.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?n.type=b:n.removeAttribute("type"),s!=null?b==="number"?(s===0&&n.value===""||n.value!=s)&&(n.value=""+Un(s)):n.value!==""+Un(s)&&(n.value=""+Un(s)):b!=="submit"&&b!=="reset"||n.removeAttribute("value"),s!=null?Lx(n,b,Un(s)):u!=null?Lx(n,b,Un(u)):h!=null&&n.removeAttribute("value"),x==null&&E!=null&&(n.defaultChecked=!!E),x!=null&&(n.checked=x&&typeof x!="function"&&typeof x!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?n.name=""+Un(I):n.removeAttribute("name")}function Py(n,s,u,h,x,E,b,I){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(n.type=E),s!=null||u!=null){if(!(E!=="submit"&&E!=="reset"||s!=null)){Ix(n);return}u=u!=null?""+Un(u):"",s=s!=null?""+Un(s):u,I||s===n.value||(n.value=s),n.defaultValue=s}h=h??x,h=typeof h!="function"&&typeof h!="symbol"&&!!h,n.checked=I?n.checked:!!h,n.defaultChecked=!!h,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(n.name=b),Ix(n)}function Lx(n,s,u){s==="number"&&bg(n.ownerDocument)===n||n.defaultValue===""+u||(n.defaultValue=""+u)}function Hu(n,s,u,h){if(n=n.options,s){s={};for(var x=0;x<u.length;x++)s["$"+u[x]]=!0;for(u=0;u<n.length;u++)x=s.hasOwnProperty("$"+n[u].value),n[u].selected!==x&&(n[u].selected=x),x&&h&&(n[u].defaultSelected=!0)}else{for(u=""+Un(u),s=null,x=0;x<n.length;x++){if(n[x].value===u){n[x].selected=!0,h&&(n[x].defaultSelected=!0);return}s!==null||n[x].disabled||(s=n[x])}s!==null&&(s.selected=!0)}}function By(n,s,u){if(s!=null&&(s=""+Un(s),s!==n.value&&(n.value=s),u==null)){n.defaultValue!==s&&(n.defaultValue=s);return}n.defaultValue=u!=null?""+Un(u):""}function Uy(n,s,u,h){if(s==null){if(h!=null){if(u!=null)throw Error(a(92));if(me(h)){if(1<h.length)throw Error(a(93));h=h[0]}u=h}u==null&&(u=""),s=u}u=Un(s),n.defaultValue=u,h=n.textContent,h===u&&h!==""&&h!==null&&(n.value=h),Ix(n)}function zu(n,s){if(s){var u=n.firstChild;if(u&&u===n.lastChild&&u.nodeType===3){u.nodeValue=s;return}}n.textContent=s}var dD=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Hy(n,s,u){var h=s.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?h?n.setProperty(s,""):s==="float"?n.cssFloat="":n[s]="":h?n.setProperty(s,u):typeof u!="number"||u===0||dD.has(s)?s==="float"?n.cssFloat=u:n[s]=(""+u).trim():n[s]=u+"px"}function zy(n,s,u){if(s!=null&&typeof s!="object")throw Error(a(62));if(n=n.style,u!=null){for(var h in u)!u.hasOwnProperty(h)||s!=null&&s.hasOwnProperty(h)||(h.indexOf("--")===0?n.setProperty(h,""):h==="float"?n.cssFloat="":n[h]="");for(var x in s)h=s[x],s.hasOwnProperty(x)&&u[x]!==h&&Hy(n,x,h)}else for(var E in s)s.hasOwnProperty(E)&&Hy(n,E,s[E])}function Px(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pD=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),gD=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function wg(n){return gD.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function As(){}var Bx=null;function Ux(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Gu=null,Vu=null;function Gy(n){var s=Fe(n);if(s&&(n=s.stateNode)){var u=n[H]||null;e:switch(n=s.stateNode,s.type){case"input":if(Fx(n,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),s=u.name,u.type==="radio"&&s!=null){for(u=n;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Hn(""+s)+'"][type="radio"]'),s=0;s<u.length;s++){var h=u[s];if(h!==n&&h.form===n.form){var x=h[H]||null;if(!x)throw Error(a(90));Fx(h,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(s=0;s<u.length;s++)h=u[s],h.form===n.form&&Ly(h)}break e;case"textarea":By(n,u.value,u.defaultValue);break e;case"select":s=u.value,s!=null&&Hu(n,!!u.multiple,s,!1)}}}var Hx=!1;function Vy(n,s,u){if(Hx)return n(s,u);Hx=!0;try{var h=n(s);return h}finally{if(Hx=!1,(Gu!==null||Vu!==null)&&(d1(),Gu&&(s=Gu,n=Vu,Vu=Gu=null,Gy(s),n)))for(s=0;s<n.length;s++)Gy(n[s])}}function e0(n,s){var u=n.stateNode;if(u===null)return null;var h=u[H]||null;if(h===null)return null;u=h[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(n=n.type,h=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!h;break e;default:n=!1}if(n)return null;if(u&&typeof u!="function")throw Error(a(231,s,typeof u));return u}var ys=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zx=!1;if(ys)try{var t0={};Object.defineProperty(t0,"passive",{get:function(){zx=!0}}),window.addEventListener("test",t0,t0),window.removeEventListener("test",t0,t0)}catch{zx=!1}var wl=null,Gx=null,Cg=null;function jy(){if(Cg)return Cg;var n,s=Gx,u=s.length,h,x="value"in wl?wl.value:wl.textContent,E=x.length;for(n=0;n<u&&s[n]===x[n];n++);var b=u-n;for(h=1;h<=b&&s[u-h]===x[E-h];h++);return Cg=x.slice(n,1<h?1-h:void 0)}function Rg(n){var s=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&s===13&&(n=13)):n=s,n===10&&(n=13),32<=n||n===13?n:0}function kg(){return!0}function Yy(){return!1}function Wa(n){function s(u,h,x,E,b){this._reactName=u,this._targetInst=x,this.type=h,this.nativeEvent=E,this.target=b,this.currentTarget=null;for(var I in n)n.hasOwnProperty(I)&&(u=n[I],this[I]=u?u(E):E[I]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?kg:Yy,this.isPropagationStopped=Yy,this}return m(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=kg)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=kg)},persist:function(){},isPersistent:kg}),s}var Xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Og=Wa(Xo),r0=m({},Xo,{view:0,detail:0}),mD=Wa(r0),Vx,jx,a0,Dg=m({},r0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xx,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==a0&&(a0&&n.type==="mousemove"?(Vx=n.screenX-a0.screenX,jx=n.screenY-a0.screenY):jx=Vx=0,a0=n),Vx)},movementY:function(n){return"movementY"in n?n.movementY:jx}}),Xy=Wa(Dg),xD=m({},Dg,{dataTransfer:0}),vD=Wa(xD),_D=m({},r0,{relatedTarget:0}),Yx=Wa(_D),ED=m({},Xo,{animationName:0,elapsedTime:0,pseudoElement:0}),AD=Wa(ED),yD=m({},Xo,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),TD=Wa(yD),SD=m({},Xo,{data:0}),qy=Wa(SD),bD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},CD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function RD(n){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(n):(n=CD[n])?!!s[n]:!1}function Xx(){return RD}var kD=m({},r0,{key:function(n){if(n.key){var s=bD[n.key]||n.key;if(s!=="Unidentified")return s}return n.type==="keypress"?(n=Rg(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?wD[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xx,charCode:function(n){return n.type==="keypress"?Rg(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Rg(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),OD=Wa(kD),DD=m({},Dg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wy=Wa(DD),ND=m({},r0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xx}),MD=Wa(ND),ID=m({},Xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),FD=Wa(ID),LD=m({},Dg,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),PD=Wa(LD),BD=m({},Xo,{newState:0,oldState:0}),UD=Wa(BD),HD=[9,13,27,32],qx=ys&&"CompositionEvent"in window,n0=null;ys&&"documentMode"in document&&(n0=document.documentMode);var zD=ys&&"TextEvent"in window&&!n0,Ky=ys&&(!qx||n0&&8<n0&&11>=n0),$y=" ",Qy=!1;function Zy(n,s){switch(n){case"keyup":return HD.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jy(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var ju=!1;function GD(n,s){switch(n){case"compositionend":return Jy(s);case"keypress":return s.which!==32?null:(Qy=!0,$y);case"textInput":return n=s.data,n===$y&&Qy?null:n;default:return null}}function VD(n,s){if(ju)return n==="compositionend"||!qx&&Zy(n,s)?(n=jy(),Cg=Gx=wl=null,ju=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Ky&&s.locale!=="ko"?null:s.data;default:return null}}var jD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eT(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s==="input"?!!jD[n.type]:s==="textarea"}function tT(n,s,u,h){Gu?Vu?Vu.push(h):Vu=[h]:Gu=h,s=E1(s,"onChange"),0<s.length&&(u=new Og("onChange","change",null,u,h),n.push({event:u,listeners:s}))}var i0=null,s0=null;function YD(n){PS(n,0)}function Ng(n){var s=Re(n);if(Ly(s))return n}function rT(n,s){if(n==="change")return s}var aT=!1;if(ys){var Wx;if(ys){var Kx="oninput"in document;if(!Kx){var nT=document.createElement("div");nT.setAttribute("oninput","return;"),Kx=typeof nT.oninput=="function"}Wx=Kx}else Wx=!1;aT=Wx&&(!document.documentMode||9<document.documentMode)}function iT(){i0&&(i0.detachEvent("onpropertychange",sT),s0=i0=null)}function sT(n){if(n.propertyName==="value"&&Ng(s0)){var s=[];tT(s,s0,n,Ux(n)),Vy(YD,s)}}function XD(n,s,u){n==="focusin"?(iT(),i0=s,s0=u,i0.attachEvent("onpropertychange",sT)):n==="focusout"&&iT()}function qD(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ng(s0)}function WD(n,s){if(n==="click")return Ng(s)}function KD(n,s){if(n==="input"||n==="change")return Ng(s)}function $D(n,s){return n===s&&(n!==0||1/n===1/s)||n!==n&&s!==s}var un=typeof Object.is=="function"?Object.is:$D;function l0(n,s){if(un(n,s))return!0;if(typeof n!="object"||n===null||typeof s!="object"||s===null)return!1;var u=Object.keys(n),h=Object.keys(s);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var x=u[h];if(!ca.call(s,x)||!un(n[x],s[x]))return!1}return!0}function lT(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function oT(n,s){var u=lT(n);n=0;for(var h;u;){if(u.nodeType===3){if(h=n+u.textContent.length,n<=s&&h>=s)return{node:u,offset:s-n};n=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=lT(u)}}function cT(n,s){return n&&s?n===s?!0:n&&n.nodeType===3?!1:s&&s.nodeType===3?cT(n,s.parentNode):"contains"in n?n.contains(s):n.compareDocumentPosition?!!(n.compareDocumentPosition(s)&16):!1:!1}function uT(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var s=bg(n.document);s instanceof n.HTMLIFrameElement;){try{var u=typeof s.contentWindow.location.href=="string"}catch{u=!1}if(u)n=s.contentWindow;else break;s=bg(n.document)}return s}function $x(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s&&(s==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||s==="textarea"||n.contentEditable==="true")}var QD=ys&&"documentMode"in document&&11>=document.documentMode,Yu=null,Qx=null,o0=null,Zx=!1;function fT(n,s,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Zx||Yu==null||Yu!==bg(h)||(h=Yu,"selectionStart"in h&&$x(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),o0&&l0(o0,h)||(o0=h,h=E1(Qx,"onSelect"),0<h.length&&(s=new Og("onSelect","select",null,s,u),n.push({event:s,listeners:h}),s.target=Yu)))}function qo(n,s){var u={};return u[n.toLowerCase()]=s.toLowerCase(),u["Webkit"+n]="webkit"+s,u["Moz"+n]="moz"+s,u}var Xu={animationend:qo("Animation","AnimationEnd"),animationiteration:qo("Animation","AnimationIteration"),animationstart:qo("Animation","AnimationStart"),transitionrun:qo("Transition","TransitionRun"),transitionstart:qo("Transition","TransitionStart"),transitioncancel:qo("Transition","TransitionCancel"),transitionend:qo("Transition","TransitionEnd")},Jx={},hT={};ys&&(hT=document.createElement("div").style,"AnimationEvent"in window||(delete Xu.animationend.animation,delete Xu.animationiteration.animation,delete Xu.animationstart.animation),"TransitionEvent"in window||delete Xu.transitionend.transition);function Wo(n){if(Jx[n])return Jx[n];if(!Xu[n])return n;var s=Xu[n],u;for(u in s)if(s.hasOwnProperty(u)&&u in hT)return Jx[n]=s[u];return n}var dT=Wo("animationend"),pT=Wo("animationiteration"),gT=Wo("animationstart"),ZD=Wo("transitionrun"),JD=Wo("transitionstart"),e3=Wo("transitioncancel"),mT=Wo("transitionend"),xT=new Map,ev="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ev.push("scrollEnd");function gi(n,s){xT.set(n,s),$t(s,[n])}var Mg=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},zn=[],qu=0,tv=0;function Ig(){for(var n=qu,s=tv=qu=0;s<n;){var u=zn[s];zn[s++]=null;var h=zn[s];zn[s++]=null;var x=zn[s];zn[s++]=null;var E=zn[s];if(zn[s++]=null,h!==null&&x!==null){var b=h.pending;b===null?x.next=x:(x.next=b.next,b.next=x),h.pending=x}E!==0&&vT(u,x,E)}}function Fg(n,s,u,h){zn[qu++]=n,zn[qu++]=s,zn[qu++]=u,zn[qu++]=h,tv|=h,n.lanes|=h,n=n.alternate,n!==null&&(n.lanes|=h)}function rv(n,s,u,h){return Fg(n,s,u,h),Lg(n)}function Ko(n,s){return Fg(n,null,null,s),Lg(n)}function vT(n,s,u){n.lanes|=u;var h=n.alternate;h!==null&&(h.lanes|=u);for(var x=!1,E=n.return;E!==null;)E.childLanes|=u,h=E.alternate,h!==null&&(h.childLanes|=u),E.tag===22&&(n=E.stateNode,n===null||n._visibility&1||(x=!0)),n=E,E=E.return;return n.tag===3?(E=n.stateNode,x&&s!==null&&(x=31-Ca(u),n=E.hiddenUpdates,h=n[x],h===null?n[x]=[s]:h.push(s),s.lane=u|536870912),E):null}function Lg(n){if(50<O0)throw O0=0,f_=null,Error(a(185));for(var s=n.return;s!==null;)n=s,s=n.return;return n.tag===3?n.stateNode:null}var Wu={};function t3(n,s,u,h){this.tag=n,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fn(n,s,u,h){return new t3(n,s,u,h)}function av(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Ts(n,s){var u=n.alternate;return u===null?(u=fn(n.tag,s,n.key,n.mode),u.elementType=n.elementType,u.type=n.type,u.stateNode=n.stateNode,u.alternate=n,n.alternate=u):(u.pendingProps=s,u.type=n.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=n.flags&65011712,u.childLanes=n.childLanes,u.lanes=n.lanes,u.child=n.child,u.memoizedProps=n.memoizedProps,u.memoizedState=n.memoizedState,u.updateQueue=n.updateQueue,s=n.dependencies,u.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},u.sibling=n.sibling,u.index=n.index,u.ref=n.ref,u.refCleanup=n.refCleanup,u}function _T(n,s){n.flags&=65011714;var u=n.alternate;return u===null?(n.childLanes=0,n.lanes=s,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=u.childLanes,n.lanes=u.lanes,n.child=u.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=u.memoizedProps,n.memoizedState=u.memoizedState,n.updateQueue=u.updateQueue,n.type=u.type,s=u.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),n}function Pg(n,s,u,h,x,E){var b=0;if(h=n,typeof n=="function")av(n)&&(b=1);else if(typeof n=="string")b=sN(n,u,X.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case j:return n=fn(31,u,s,x),n.elementType=j,n.lanes=E,n;case y:return $o(u.children,x,E,s);case T:b=8,x|=24;break;case S:return n=fn(12,u,s,x|2),n.elementType=S,n.lanes=E,n;case U:return n=fn(13,u,s,x),n.elementType=U,n.lanes=E,n;case B:return n=fn(19,u,s,x),n.elementType=B,n.lanes=E,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case C:b=10;break e;case R:b=9;break e;case F:b=11;break e;case k:b=14;break e;case J:b=16,h=null;break e}b=29,u=Error(a(130,n===null?"null":typeof n,"")),h=null}return s=fn(b,u,s,x),s.elementType=n,s.type=h,s.lanes=E,s}function $o(n,s,u,h){return n=fn(7,n,h,s),n.lanes=u,n}function nv(n,s,u){return n=fn(6,n,null,s),n.lanes=u,n}function ET(n){var s=fn(18,null,null,0);return s.stateNode=n,s}function iv(n,s,u){return s=fn(4,n.children!==null?n.children:[],n.key,s),s.lanes=u,s.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},s}var AT=new WeakMap;function Gn(n,s){if(typeof n=="object"&&n!==null){var u=AT.get(n);return u!==void 0?u:(s={value:n,source:s,stack:Kt(s)},AT.set(n,s),s)}return{value:n,source:s,stack:Kt(s)}}var Ku=[],$u=0,Bg=null,c0=0,Vn=[],jn=0,Cl=null,Vi=1,ji="";function Ss(n,s){Ku[$u++]=c0,Ku[$u++]=Bg,Bg=n,c0=s}function yT(n,s,u){Vn[jn++]=Vi,Vn[jn++]=ji,Vn[jn++]=Cl,Cl=n;var h=Vi;n=ji;var x=32-Ca(h)-1;h&=~(1<<x),u+=1;var E=32-Ca(s)+x;if(30<E){var b=x-x%5;E=(h&(1<<b)-1).toString(32),h>>=b,x-=b,Vi=1<<32-Ca(s)+x|u<<x|h,ji=E+n}else Vi=1<<E|u<<x|h,ji=n}function sv(n){n.return!==null&&(Ss(n,1),yT(n,1,0))}function lv(n){for(;n===Bg;)Bg=Ku[--$u],Ku[$u]=null,c0=Ku[--$u],Ku[$u]=null;for(;n===Cl;)Cl=Vn[--jn],Vn[jn]=null,ji=Vn[--jn],Vn[jn]=null,Vi=Vn[--jn],Vn[jn]=null}function TT(n,s){Vn[jn++]=Vi,Vn[jn++]=ji,Vn[jn++]=Cl,Vi=s.id,ji=s.overflow,Cl=n}var Kr=null,Yt=null,gt=!1,Rl=null,Yn=!1,ov=Error(a(519));function kl(n){var s=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw u0(Gn(s,n)),ov}function ST(n){var s=n.stateNode,u=n.type,h=n.memoizedProps;switch(s[P]=n,s[H]=h,u){case"dialog":ht("cancel",s),ht("close",s);break;case"iframe":case"object":case"embed":ht("load",s);break;case"video":case"audio":for(u=0;u<N0.length;u++)ht(N0[u],s);break;case"source":ht("error",s);break;case"img":case"image":case"link":ht("error",s),ht("load",s);break;case"details":ht("toggle",s);break;case"input":ht("invalid",s),Py(s,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":ht("invalid",s);break;case"textarea":ht("invalid",s),Uy(s,h.value,h.defaultValue,h.children)}u=h.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||s.textContent===""+u||h.suppressHydrationWarning===!0||zS(s.textContent,u)?(h.popover!=null&&(ht("beforetoggle",s),ht("toggle",s)),h.onScroll!=null&&ht("scroll",s),h.onScrollEnd!=null&&ht("scrollend",s),h.onClick!=null&&(s.onclick=As),s=!0):s=!1,s||kl(n,!0)}function bT(n){for(Kr=n.return;Kr;)switch(Kr.tag){case 5:case 31:case 13:Yn=!1;return;case 27:case 3:Yn=!0;return;default:Kr=Kr.return}}function Qu(n){if(n!==Kr)return!1;if(!gt)return bT(n),gt=!0,!1;var s=n.tag,u;if((u=s!==3&&s!==27)&&((u=s===5)&&(u=n.type,u=!(u!=="form"&&u!=="button")||w_(n.type,n.memoizedProps)),u=!u),u&&Yt&&kl(n),bT(n),s===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));Yt=$S(n)}else if(s===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));Yt=$S(n)}else s===27?(s=Yt,Vl(n.type)?(n=D_,D_=null,Yt=n):Yt=s):Yt=Kr?qn(n.stateNode.nextSibling):null;return!0}function Qo(){Yt=Kr=null,gt=!1}function cv(){var n=Rl;return n!==null&&(Za===null?Za=n:Za.push.apply(Za,n),Rl=null),n}function u0(n){Rl===null?Rl=[n]:Rl.push(n)}var uv=Y(null),Zo=null,bs=null;function Ol(n,s,u){q(uv,s._currentValue),s._currentValue=u}function ws(n){n._currentValue=uv.current,N(uv)}function fv(n,s,u){for(;n!==null;){var h=n.alternate;if((n.childLanes&s)!==s?(n.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),n===u)break;n=n.return}}function hv(n,s,u,h){var x=n.child;for(x!==null&&(x.return=n);x!==null;){var E=x.dependencies;if(E!==null){var b=x.child;E=E.firstContext;e:for(;E!==null;){var I=E;E=x;for(var Z=0;Z<s.length;Z++)if(I.context===s[Z]){E.lanes|=u,I=E.alternate,I!==null&&(I.lanes|=u),fv(E.return,u,n),h||(b=null);break e}E=I.next}}else if(x.tag===18){if(b=x.return,b===null)throw Error(a(341));b.lanes|=u,E=b.alternate,E!==null&&(E.lanes|=u),fv(b,u,n),b=null}else b=x.child;if(b!==null)b.return=x;else for(b=x;b!==null;){if(b===n){b=null;break}if(x=b.sibling,x!==null){x.return=b.return,b=x;break}b=b.return}x=b}}function Zu(n,s,u,h){n=null;for(var x=s,E=!1;x!==null;){if(!E){if((x.flags&524288)!==0)E=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var b=x.alternate;if(b===null)throw Error(a(387));if(b=b.memoizedProps,b!==null){var I=x.type;un(x.pendingProps.value,b.value)||(n!==null?n.push(I):n=[I])}}else if(x===xe.current){if(b=x.alternate,b===null)throw Error(a(387));b.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(n!==null?n.push(P0):n=[P0])}x=x.return}n!==null&&hv(s,n,u,h),s.flags|=262144}function Ug(n){for(n=n.firstContext;n!==null;){if(!un(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Jo(n){Zo=n,bs=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function $r(n){return wT(Zo,n)}function Hg(n,s){return Zo===null&&Jo(n),wT(n,s)}function wT(n,s){var u=s._currentValue;if(s={context:s,memoizedValue:u,next:null},bs===null){if(n===null)throw Error(a(308));bs=s,n.dependencies={lanes:0,firstContext:s},n.flags|=524288}else bs=bs.next=s;return u}var r3=typeof AbortController<"u"?AbortController:function(){var n=[],s=this.signal={aborted:!1,addEventListener:function(u,h){n.push(h)}};this.abort=function(){s.aborted=!0,n.forEach(function(u){return u()})}},a3=r.unstable_scheduleCallback,n3=r.unstable_NormalPriority,Er={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function dv(){return{controller:new r3,data:new Map,refCount:0}}function f0(n){n.refCount--,n.refCount===0&&a3(n3,function(){n.controller.abort()})}var h0=null,pv=0,Ju=0,ef=null;function i3(n,s){if(h0===null){var u=h0=[];pv=0,Ju=x_(),ef={status:"pending",value:void 0,then:function(h){u.push(h)}}}return pv++,s.then(CT,CT),s}function CT(){if(--pv===0&&h0!==null){ef!==null&&(ef.status="fulfilled");var n=h0;h0=null,Ju=0,ef=null;for(var s=0;s<n.length;s++)(0,n[s])()}}function s3(n,s){var u=[],h={status:"pending",value:null,reason:null,then:function(x){u.push(x)}};return n.then(function(){h.status="fulfilled",h.value=s;for(var x=0;x<u.length;x++)(0,u[x])(s)},function(x){for(h.status="rejected",h.reason=x,x=0;x<u.length;x++)(0,u[x])(void 0)}),h}var RT=G.S;G.S=function(n,s){fS=Pt(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&i3(n,s),RT!==null&&RT(n,s)};var ec=Y(null);function gv(){var n=ec.current;return n!==null?n:Bt.pooledCache}function zg(n,s){s===null?q(ec,ec.current):q(ec,s.pool)}function kT(){var n=gv();return n===null?null:{parent:Er._currentValue,pool:n}}var tf=Error(a(460)),mv=Error(a(474)),Gg=Error(a(542)),Vg={then:function(){}};function OT(n){return n=n.status,n==="fulfilled"||n==="rejected"}function DT(n,s,u){switch(u=n[u],u===void 0?n.push(s):u!==s&&(s.then(As,As),s=u),s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,MT(n),n;default:if(typeof s.status=="string")s.then(As,As);else{if(n=Bt,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=s,n.status="pending",n.then(function(h){if(s.status==="pending"){var x=s;x.status="fulfilled",x.value=h}},function(h){if(s.status==="pending"){var x=s;x.status="rejected",x.reason=h}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,MT(n),n}throw rc=s,tf}}function tc(n){try{var s=n._init;return s(n._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(rc=u,tf):u}}var rc=null;function NT(){if(rc===null)throw Error(a(459));var n=rc;return rc=null,n}function MT(n){if(n===tf||n===Gg)throw Error(a(483))}var rf=null,d0=0;function jg(n){var s=d0;return d0+=1,rf===null&&(rf=[]),DT(rf,n,s)}function p0(n,s){s=s.props.ref,n.ref=s!==void 0?s:null}function Yg(n,s){throw s.$$typeof===v?Error(a(525)):(n=Object.prototype.toString.call(s),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":n)))}function IT(n){function s(ne,re){if(n){var le=ne.deletions;le===null?(ne.deletions=[re],ne.flags|=16):le.push(re)}}function u(ne,re){if(!n)return null;for(;re!==null;)s(ne,re),re=re.sibling;return null}function h(ne){for(var re=new Map;ne!==null;)ne.key!==null?re.set(ne.key,ne):re.set(ne.index,ne),ne=ne.sibling;return re}function x(ne,re){return ne=Ts(ne,re),ne.index=0,ne.sibling=null,ne}function E(ne,re,le){return ne.index=le,n?(le=ne.alternate,le!==null?(le=le.index,le<re?(ne.flags|=67108866,re):le):(ne.flags|=67108866,re)):(ne.flags|=1048576,re)}function b(ne){return n&&ne.alternate===null&&(ne.flags|=67108866),ne}function I(ne,re,le,Ae){return re===null||re.tag!==6?(re=nv(le,ne.mode,Ae),re.return=ne,re):(re=x(re,le),re.return=ne,re)}function Z(ne,re,le,Ae){var je=le.type;return je===y?ve(ne,re,le.props.children,Ae,le.key):re!==null&&(re.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===J&&tc(je)===re.type)?(re=x(re,le.props),p0(re,le),re.return=ne,re):(re=Pg(le.type,le.key,le.props,null,ne.mode,Ae),p0(re,le),re.return=ne,re)}function oe(ne,re,le,Ae){return re===null||re.tag!==4||re.stateNode.containerInfo!==le.containerInfo||re.stateNode.implementation!==le.implementation?(re=iv(le,ne.mode,Ae),re.return=ne,re):(re=x(re,le.children||[]),re.return=ne,re)}function ve(ne,re,le,Ae,je){return re===null||re.tag!==7?(re=$o(le,ne.mode,Ae,je),re.return=ne,re):(re=x(re,le),re.return=ne,re)}function Te(ne,re,le){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return re=nv(""+re,ne.mode,le),re.return=ne,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case _:return le=Pg(re.type,re.key,re.props,null,ne.mode,le),p0(le,re),le.return=ne,le;case A:return re=iv(re,ne.mode,le),re.return=ne,re;case J:return re=tc(re),Te(ne,re,le)}if(me(re)||ee(re))return re=$o(re,ne.mode,le,null),re.return=ne,re;if(typeof re.then=="function")return Te(ne,jg(re),le);if(re.$$typeof===C)return Te(ne,Hg(ne,re),le);Yg(ne,re)}return null}function he(ne,re,le,Ae){var je=re!==null?re.key:null;if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return je!==null?null:I(ne,re,""+le,Ae);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case _:return le.key===je?Z(ne,re,le,Ae):null;case A:return le.key===je?oe(ne,re,le,Ae):null;case J:return le=tc(le),he(ne,re,le,Ae)}if(me(le)||ee(le))return je!==null?null:ve(ne,re,le,Ae,null);if(typeof le.then=="function")return he(ne,re,jg(le),Ae);if(le.$$typeof===C)return he(ne,re,Hg(ne,le),Ae);Yg(ne,le)}return null}function pe(ne,re,le,Ae,je){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return ne=ne.get(le)||null,I(re,ne,""+Ae,je);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case _:return ne=ne.get(Ae.key===null?le:Ae.key)||null,Z(re,ne,Ae,je);case A:return ne=ne.get(Ae.key===null?le:Ae.key)||null,oe(re,ne,Ae,je);case J:return Ae=tc(Ae),pe(ne,re,le,Ae,je)}if(me(Ae)||ee(Ae))return ne=ne.get(le)||null,ve(re,ne,Ae,je,null);if(typeof Ae.then=="function")return pe(ne,re,le,jg(Ae),je);if(Ae.$$typeof===C)return pe(ne,re,le,Hg(re,Ae),je);Yg(re,Ae)}return null}function Be(ne,re,le,Ae){for(var je=null,yt=null,ze=re,at=re=0,pt=null;ze!==null&&at<le.length;at++){ze.index>at?(pt=ze,ze=null):pt=ze.sibling;var Tt=he(ne,ze,le[at],Ae);if(Tt===null){ze===null&&(ze=pt);break}n&&ze&&Tt.alternate===null&&s(ne,ze),re=E(Tt,re,at),yt===null?je=Tt:yt.sibling=Tt,yt=Tt,ze=pt}if(at===le.length)return u(ne,ze),gt&&Ss(ne,at),je;if(ze===null){for(;at<le.length;at++)ze=Te(ne,le[at],Ae),ze!==null&&(re=E(ze,re,at),yt===null?je=ze:yt.sibling=ze,yt=ze);return gt&&Ss(ne,at),je}for(ze=h(ze);at<le.length;at++)pt=pe(ze,ne,at,le[at],Ae),pt!==null&&(n&&pt.alternate!==null&&ze.delete(pt.key===null?at:pt.key),re=E(pt,re,at),yt===null?je=pt:yt.sibling=pt,yt=pt);return n&&ze.forEach(function(Wl){return s(ne,Wl)}),gt&&Ss(ne,at),je}function Ye(ne,re,le,Ae){if(le==null)throw Error(a(151));for(var je=null,yt=null,ze=re,at=re=0,pt=null,Tt=le.next();ze!==null&&!Tt.done;at++,Tt=le.next()){ze.index>at?(pt=ze,ze=null):pt=ze.sibling;var Wl=he(ne,ze,Tt.value,Ae);if(Wl===null){ze===null&&(ze=pt);break}n&&ze&&Wl.alternate===null&&s(ne,ze),re=E(Wl,re,at),yt===null?je=Wl:yt.sibling=Wl,yt=Wl,ze=pt}if(Tt.done)return u(ne,ze),gt&&Ss(ne,at),je;if(ze===null){for(;!Tt.done;at++,Tt=le.next())Tt=Te(ne,Tt.value,Ae),Tt!==null&&(re=E(Tt,re,at),yt===null?je=Tt:yt.sibling=Tt,yt=Tt);return gt&&Ss(ne,at),je}for(ze=h(ze);!Tt.done;at++,Tt=le.next())Tt=pe(ze,ne,at,Tt.value,Ae),Tt!==null&&(n&&Tt.alternate!==null&&ze.delete(Tt.key===null?at:Tt.key),re=E(Tt,re,at),yt===null?je=Tt:yt.sibling=Tt,yt=Tt);return n&&ze.forEach(function(xN){return s(ne,xN)}),gt&&Ss(ne,at),je}function It(ne,re,le,Ae){if(typeof le=="object"&&le!==null&&le.type===y&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case _:e:{for(var je=le.key;re!==null;){if(re.key===je){if(je=le.type,je===y){if(re.tag===7){u(ne,re.sibling),Ae=x(re,le.props.children),Ae.return=ne,ne=Ae;break e}}else if(re.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===J&&tc(je)===re.type){u(ne,re.sibling),Ae=x(re,le.props),p0(Ae,le),Ae.return=ne,ne=Ae;break e}u(ne,re);break}else s(ne,re);re=re.sibling}le.type===y?(Ae=$o(le.props.children,ne.mode,Ae,le.key),Ae.return=ne,ne=Ae):(Ae=Pg(le.type,le.key,le.props,null,ne.mode,Ae),p0(Ae,le),Ae.return=ne,ne=Ae)}return b(ne);case A:e:{for(je=le.key;re!==null;){if(re.key===je)if(re.tag===4&&re.stateNode.containerInfo===le.containerInfo&&re.stateNode.implementation===le.implementation){u(ne,re.sibling),Ae=x(re,le.children||[]),Ae.return=ne,ne=Ae;break e}else{u(ne,re);break}else s(ne,re);re=re.sibling}Ae=iv(le,ne.mode,Ae),Ae.return=ne,ne=Ae}return b(ne);case J:return le=tc(le),It(ne,re,le,Ae)}if(me(le))return Be(ne,re,le,Ae);if(ee(le)){if(je=ee(le),typeof je!="function")throw Error(a(150));return le=je.call(le),Ye(ne,re,le,Ae)}if(typeof le.then=="function")return It(ne,re,jg(le),Ae);if(le.$$typeof===C)return It(ne,re,Hg(ne,le),Ae);Yg(ne,le)}return typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint"?(le=""+le,re!==null&&re.tag===6?(u(ne,re.sibling),Ae=x(re,le),Ae.return=ne,ne=Ae):(u(ne,re),Ae=nv(le,ne.mode,Ae),Ae.return=ne,ne=Ae),b(ne)):u(ne,re)}return function(ne,re,le,Ae){try{d0=0;var je=It(ne,re,le,Ae);return rf=null,je}catch(ze){if(ze===tf||ze===Gg)throw ze;var yt=fn(29,ze,null,ne.mode);return yt.lanes=Ae,yt.return=ne,yt}finally{}}}var ac=IT(!0),FT=IT(!1),Dl=!1;function xv(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function vv(n,s){n=n.updateQueue,s.updateQueue===n&&(s.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Nl(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ml(n,s,u){var h=n.updateQueue;if(h===null)return null;if(h=h.shared,(wt&2)!==0){var x=h.pending;return x===null?s.next=s:(s.next=x.next,x.next=s),h.pending=s,s=Lg(n),vT(n,null,u),s}return Fg(n,h,s,u),Lg(n)}function g0(n,s,u){if(s=s.updateQueue,s!==null&&(s=s.shared,(u&4194048)!==0)){var h=s.lanes;h&=n.pendingLanes,u|=h,s.lanes=u,Uu(n,u)}}function _v(n,s){var u=n.updateQueue,h=n.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var x=null,E=null;if(u=u.firstBaseUpdate,u!==null){do{var b={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};E===null?x=E=b:E=E.next=b,u=u.next}while(u!==null);E===null?x=E=s:E=E.next=s}else x=E=s;u={baseState:h.baseState,firstBaseUpdate:x,lastBaseUpdate:E,shared:h.shared,callbacks:h.callbacks},n.updateQueue=u;return}n=u.lastBaseUpdate,n===null?u.firstBaseUpdate=s:n.next=s,u.lastBaseUpdate=s}var Ev=!1;function m0(){if(Ev){var n=ef;if(n!==null)throw n}}function x0(n,s,u,h){Ev=!1;var x=n.updateQueue;Dl=!1;var E=x.firstBaseUpdate,b=x.lastBaseUpdate,I=x.shared.pending;if(I!==null){x.shared.pending=null;var Z=I,oe=Z.next;Z.next=null,b===null?E=oe:b.next=oe,b=Z;var ve=n.alternate;ve!==null&&(ve=ve.updateQueue,I=ve.lastBaseUpdate,I!==b&&(I===null?ve.firstBaseUpdate=oe:I.next=oe,ve.lastBaseUpdate=Z))}if(E!==null){var Te=x.baseState;b=0,ve=oe=Z=null,I=E;do{var he=I.lane&-536870913,pe=he!==I.lane;if(pe?(dt&he)===he:(h&he)===he){he!==0&&he===Ju&&(Ev=!0),ve!==null&&(ve=ve.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var Be=n,Ye=I;he=s;var It=u;switch(Ye.tag){case 1:if(Be=Ye.payload,typeof Be=="function"){Te=Be.call(It,Te,he);break e}Te=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=Ye.payload,he=typeof Be=="function"?Be.call(It,Te,he):Be,he==null)break e;Te=m({},Te,he);break e;case 2:Dl=!0}}he=I.callback,he!==null&&(n.flags|=64,pe&&(n.flags|=8192),pe=x.callbacks,pe===null?x.callbacks=[he]:pe.push(he))}else pe={lane:he,tag:I.tag,payload:I.payload,callback:I.callback,next:null},ve===null?(oe=ve=pe,Z=Te):ve=ve.next=pe,b|=he;if(I=I.next,I===null){if(I=x.shared.pending,I===null)break;pe=I,I=pe.next,pe.next=null,x.lastBaseUpdate=pe,x.shared.pending=null}}while(!0);ve===null&&(Z=Te),x.baseState=Z,x.firstBaseUpdate=oe,x.lastBaseUpdate=ve,E===null&&(x.shared.lanes=0),Bl|=b,n.lanes=b,n.memoizedState=Te}}function LT(n,s){if(typeof n!="function")throw Error(a(191,n));n.call(s)}function PT(n,s){var u=n.callbacks;if(u!==null)for(n.callbacks=null,n=0;n<u.length;n++)LT(u[n],s)}var af=Y(null),Xg=Y(0);function BT(n,s){n=Fs,q(Xg,n),q(af,s),Fs=n|s.baseLanes}function Av(){q(Xg,Fs),q(af,af.current)}function yv(){Fs=Xg.current,N(af),N(Xg)}var hn=Y(null),Xn=null;function Il(n){var s=n.alternate;q(dr,dr.current&1),q(hn,n),Xn===null&&(s===null||af.current!==null||s.memoizedState!==null)&&(Xn=n)}function Tv(n){q(dr,dr.current),q(hn,n),Xn===null&&(Xn=n)}function UT(n){n.tag===22?(q(dr,dr.current),q(hn,n),Xn===null&&(Xn=n)):Fl()}function Fl(){q(dr,dr.current),q(hn,hn.current)}function dn(n){N(hn),Xn===n&&(Xn=null),N(dr)}var dr=Y(0);function qg(n){for(var s=n;s!==null;){if(s.tag===13){var u=s.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||k_(u)||O_(u)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Cs=0,Ze=null,Nt=null,Ar=null,Wg=!1,nf=!1,nc=!1,Kg=0,v0=0,sf=null,l3=0;function lr(){throw Error(a(321))}function Sv(n,s){if(s===null)return!1;for(var u=0;u<s.length&&u<n.length;u++)if(!un(n[u],s[u]))return!1;return!0}function bv(n,s,u,h,x,E){return Cs=E,Ze=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,G.H=n===null||n.memoizedState===null?y2:Hv,nc=!1,E=u(h,x),nc=!1,nf&&(E=zT(s,u,h,x)),HT(n),E}function HT(n){G.H=A0;var s=Nt!==null&&Nt.next!==null;if(Cs=0,Ar=Nt=Ze=null,Wg=!1,v0=0,sf=null,s)throw Error(a(300));n===null||yr||(n=n.dependencies,n!==null&&Ug(n)&&(yr=!0))}function zT(n,s,u,h){Ze=n;var x=0;do{if(nf&&(sf=null),v0=0,nf=!1,25<=x)throw Error(a(301));if(x+=1,Ar=Nt=null,n.updateQueue!=null){var E=n.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}G.H=T2,E=s(u,h)}while(nf);return E}function o3(){var n=G.H,s=n.useState()[0];return s=typeof s.then=="function"?_0(s):s,n=n.useState()[0],(Nt!==null?Nt.memoizedState:null)!==n&&(Ze.flags|=1024),s}function wv(){var n=Kg!==0;return Kg=0,n}function Cv(n,s,u){s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~u}function Rv(n){if(Wg){for(n=n.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Wg=!1}Cs=0,Ar=Nt=Ze=null,nf=!1,v0=Kg=0,sf=null}function Ra(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ar===null?Ze.memoizedState=Ar=n:Ar=Ar.next=n,Ar}function pr(){if(Nt===null){var n=Ze.alternate;n=n!==null?n.memoizedState:null}else n=Nt.next;var s=Ar===null?Ze.memoizedState:Ar.next;if(s!==null)Ar=s,Nt=n;else{if(n===null)throw Ze.alternate===null?Error(a(467)):Error(a(310));Nt=n,n={memoizedState:Nt.memoizedState,baseState:Nt.baseState,baseQueue:Nt.baseQueue,queue:Nt.queue,next:null},Ar===null?Ze.memoizedState=Ar=n:Ar=Ar.next=n}return Ar}function $g(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function _0(n){var s=v0;return v0+=1,sf===null&&(sf=[]),n=DT(sf,n,s),s=Ze,(Ar===null?s.memoizedState:Ar.next)===null&&(s=s.alternate,G.H=s===null||s.memoizedState===null?y2:Hv),n}function Qg(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return _0(n);if(n.$$typeof===C)return $r(n)}throw Error(a(438,String(n)))}function kv(n){var s=null,u=Ze.updateQueue;if(u!==null&&(s=u.memoCache),s==null){var h=Ze.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(s={data:h.data.map(function(x){return x.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),u===null&&(u=$g(),Ze.updateQueue=u),u.memoCache=s,u=s.data[s.index],u===void 0)for(u=s.data[s.index]=Array(n),h=0;h<n;h++)u[h]=ie;return s.index++,u}function Rs(n,s){return typeof s=="function"?s(n):s}function Zg(n){var s=pr();return Ov(s,Nt,n)}function Ov(n,s,u){var h=n.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=u;var x=n.baseQueue,E=h.pending;if(E!==null){if(x!==null){var b=x.next;x.next=E.next,E.next=b}s.baseQueue=x=E,h.pending=null}if(E=n.baseState,x===null)n.memoizedState=E;else{s=x.next;var I=b=null,Z=null,oe=s,ve=!1;do{var Te=oe.lane&-536870913;if(Te!==oe.lane?(dt&Te)===Te:(Cs&Te)===Te){var he=oe.revertLane;if(he===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),Te===Ju&&(ve=!0);else if((Cs&he)===he){oe=oe.next,he===Ju&&(ve=!0);continue}else Te={lane:0,revertLane:oe.revertLane,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},Z===null?(I=Z=Te,b=E):Z=Z.next=Te,Ze.lanes|=he,Bl|=he;Te=oe.action,nc&&u(E,Te),E=oe.hasEagerState?oe.eagerState:u(E,Te)}else he={lane:Te,revertLane:oe.revertLane,gesture:oe.gesture,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},Z===null?(I=Z=he,b=E):Z=Z.next=he,Ze.lanes|=Te,Bl|=Te;oe=oe.next}while(oe!==null&&oe!==s);if(Z===null?b=E:Z.next=I,!un(E,n.memoizedState)&&(yr=!0,ve&&(u=ef,u!==null)))throw u;n.memoizedState=E,n.baseState=b,n.baseQueue=Z,h.lastRenderedState=E}return x===null&&(h.lanes=0),[n.memoizedState,h.dispatch]}function Dv(n){var s=pr(),u=s.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=n;var h=u.dispatch,x=u.pending,E=s.memoizedState;if(x!==null){u.pending=null;var b=x=x.next;do E=n(E,b.action),b=b.next;while(b!==x);un(E,s.memoizedState)||(yr=!0),s.memoizedState=E,s.baseQueue===null&&(s.baseState=E),u.lastRenderedState=E}return[E,h]}function GT(n,s,u){var h=Ze,x=pr(),E=gt;if(E){if(u===void 0)throw Error(a(407));u=u()}else u=s();var b=!un((Nt||x).memoizedState,u);if(b&&(x.memoizedState=u,yr=!0),x=x.queue,Iv(YT.bind(null,h,x,n),[n]),x.getSnapshot!==s||b||Ar!==null&&Ar.memoizedState.tag&1){if(h.flags|=2048,lf(9,{destroy:void 0},jT.bind(null,h,x,u,s),null),Bt===null)throw Error(a(349));E||(Cs&127)!==0||VT(h,s,u)}return u}function VT(n,s,u){n.flags|=16384,n={getSnapshot:s,value:u},s=Ze.updateQueue,s===null?(s=$g(),Ze.updateQueue=s,s.stores=[n]):(u=s.stores,u===null?s.stores=[n]:u.push(n))}function jT(n,s,u,h){s.value=u,s.getSnapshot=h,XT(s)&&qT(n)}function YT(n,s,u){return u(function(){XT(s)&&qT(n)})}function XT(n){var s=n.getSnapshot;n=n.value;try{var u=s();return!un(n,u)}catch{return!0}}function qT(n){var s=Ko(n,2);s!==null&&Ja(s,n,2)}function Nv(n){var s=Ra();if(typeof n=="function"){var u=n;if(n=u(),nc){pi(!0);try{u()}finally{pi(!1)}}}return s.memoizedState=s.baseState=n,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:n},s}function WT(n,s,u,h){return n.baseState=u,Ov(n,Nt,typeof h=="function"?h:Rs)}function c3(n,s,u,h,x){if(t1(n))throw Error(a(485));if(n=s.action,n!==null){var E={payload:x,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){E.listeners.push(b)}};G.T!==null?u(!0):E.isTransition=!1,h(E),u=s.pending,u===null?(E.next=s.pending=E,KT(s,E)):(E.next=u.next,s.pending=u.next=E)}}function KT(n,s){var u=s.action,h=s.payload,x=n.state;if(s.isTransition){var E=G.T,b={};G.T=b;try{var I=u(x,h),Z=G.S;Z!==null&&Z(b,I),$T(n,s,I)}catch(oe){Mv(n,s,oe)}finally{E!==null&&b.types!==null&&(E.types=b.types),G.T=E}}else try{E=u(x,h),$T(n,s,E)}catch(oe){Mv(n,s,oe)}}function $T(n,s,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(h){QT(n,s,h)},function(h){return Mv(n,s,h)}):QT(n,s,u)}function QT(n,s,u){s.status="fulfilled",s.value=u,ZT(s),n.state=u,s=n.pending,s!==null&&(u=s.next,u===s?n.pending=null:(u=u.next,s.next=u,KT(n,u)))}function Mv(n,s,u){var h=n.pending;if(n.pending=null,h!==null){h=h.next;do s.status="rejected",s.reason=u,ZT(s),s=s.next;while(s!==h)}n.action=null}function ZT(n){n=n.listeners;for(var s=0;s<n.length;s++)(0,n[s])()}function JT(n,s){return s}function e2(n,s){if(gt){var u=Bt.formState;if(u!==null){e:{var h=Ze;if(gt){if(Yt){t:{for(var x=Yt,E=Yn;x.nodeType!==8;){if(!E){x=null;break t}if(x=qn(x.nextSibling),x===null){x=null;break t}}E=x.data,x=E==="F!"||E==="F"?x:null}if(x){Yt=qn(x.nextSibling),h=x.data==="F!";break e}}kl(h)}h=!1}h&&(s=u[0])}}return u=Ra(),u.memoizedState=u.baseState=s,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:JT,lastRenderedState:s},u.queue=h,u=_2.bind(null,Ze,h),h.dispatch=u,h=Nv(!1),E=Uv.bind(null,Ze,!1,h.queue),h=Ra(),x={state:s,dispatch:null,action:n,pending:null},h.queue=x,u=c3.bind(null,Ze,x,E,u),x.dispatch=u,h.memoizedState=n,[s,u,!1]}function t2(n){var s=pr();return r2(s,Nt,n)}function r2(n,s,u){if(s=Ov(n,s,JT)[0],n=Zg(Rs)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var h=_0(s)}catch(b){throw b===tf?Gg:b}else h=s;s=pr();var x=s.queue,E=x.dispatch;return u!==s.memoizedState&&(Ze.flags|=2048,lf(9,{destroy:void 0},u3.bind(null,x,u),null)),[h,E,n]}function u3(n,s){n.action=s}function a2(n){var s=pr(),u=Nt;if(u!==null)return r2(s,u,n);pr(),s=s.memoizedState,u=pr();var h=u.queue.dispatch;return u.memoizedState=n,[s,h,!1]}function lf(n,s,u,h){return n={tag:n,create:u,deps:h,inst:s,next:null},s=Ze.updateQueue,s===null&&(s=$g(),Ze.updateQueue=s),u=s.lastEffect,u===null?s.lastEffect=n.next=n:(h=u.next,u.next=n,n.next=h,s.lastEffect=n),n}function n2(){return pr().memoizedState}function Jg(n,s,u,h){var x=Ra();Ze.flags|=n,x.memoizedState=lf(1|s,{destroy:void 0},u,h===void 0?null:h)}function e1(n,s,u,h){var x=pr();h=h===void 0?null:h;var E=x.memoizedState.inst;Nt!==null&&h!==null&&Sv(h,Nt.memoizedState.deps)?x.memoizedState=lf(s,E,u,h):(Ze.flags|=n,x.memoizedState=lf(1|s,E,u,h))}function i2(n,s){Jg(8390656,8,n,s)}function Iv(n,s){e1(2048,8,n,s)}function f3(n){Ze.flags|=4;var s=Ze.updateQueue;if(s===null)s=$g(),Ze.updateQueue=s,s.events=[n];else{var u=s.events;u===null?s.events=[n]:u.push(n)}}function s2(n){var s=pr().memoizedState;return f3({ref:s,nextImpl:n}),function(){if((wt&2)!==0)throw Error(a(440));return s.impl.apply(void 0,arguments)}}function l2(n,s){return e1(4,2,n,s)}function o2(n,s){return e1(4,4,n,s)}function c2(n,s){if(typeof s=="function"){n=n();var u=s(n);return function(){typeof u=="function"?u():s(null)}}if(s!=null)return n=n(),s.current=n,function(){s.current=null}}function u2(n,s,u){u=u!=null?u.concat([n]):null,e1(4,4,c2.bind(null,s,n),u)}function Fv(){}function f2(n,s){var u=pr();s=s===void 0?null:s;var h=u.memoizedState;return s!==null&&Sv(s,h[1])?h[0]:(u.memoizedState=[n,s],n)}function h2(n,s){var u=pr();s=s===void 0?null:s;var h=u.memoizedState;if(s!==null&&Sv(s,h[1]))return h[0];if(h=n(),nc){pi(!0);try{n()}finally{pi(!1)}}return u.memoizedState=[h,s],h}function Lv(n,s,u){return u===void 0||(Cs&1073741824)!==0&&(dt&261930)===0?n.memoizedState=s:(n.memoizedState=u,n=dS(),Ze.lanes|=n,Bl|=n,u)}function d2(n,s,u,h){return un(u,s)?u:af.current!==null?(n=Lv(n,u,h),un(n,s)||(yr=!0),n):(Cs&42)===0||(Cs&1073741824)!==0&&(dt&261930)===0?(yr=!0,n.memoizedState=u):(n=dS(),Ze.lanes|=n,Bl|=n,s)}function p2(n,s,u,h,x){var E=te.p;te.p=E!==0&&8>E?E:8;var b=G.T,I={};G.T=I,Uv(n,!1,s,u);try{var Z=x(),oe=G.S;if(oe!==null&&oe(I,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var ve=s3(Z,h);E0(n,s,ve,mn(n))}else E0(n,s,h,mn(n))}catch(Te){E0(n,s,{then:function(){},status:"rejected",reason:Te},mn())}finally{te.p=E,b!==null&&I.types!==null&&(b.types=I.types),G.T=b}}function h3(){}function Pv(n,s,u,h){if(n.tag!==5)throw Error(a(476));var x=g2(n).queue;p2(n,x,s,we,u===null?h3:function(){return m2(n),u(h)})}function g2(n){var s=n.memoizedState;if(s!==null)return s;s={memoizedState:we,baseState:we,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:we},next:null};var u={};return s.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:u},next:null},n.memoizedState=s,n=n.alternate,n!==null&&(n.memoizedState=s),s}function m2(n){var s=g2(n);s.next===null&&(s=n.alternate.memoizedState),E0(n,s.next.queue,{},mn())}function Bv(){return $r(P0)}function x2(){return pr().memoizedState}function v2(){return pr().memoizedState}function d3(n){for(var s=n.return;s!==null;){switch(s.tag){case 24:case 3:var u=mn();n=Nl(u);var h=Ml(s,n,u);h!==null&&(Ja(h,s,u),g0(h,s,u)),s={cache:dv()},n.payload=s;return}s=s.return}}function p3(n,s,u){var h=mn();u={lane:h,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},t1(n)?E2(s,u):(u=rv(n,s,u,h),u!==null&&(Ja(u,n,h),A2(u,s,h)))}function _2(n,s,u){var h=mn();E0(n,s,u,h)}function E0(n,s,u,h){var x={lane:h,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(t1(n))E2(s,x);else{var E=n.alternate;if(n.lanes===0&&(E===null||E.lanes===0)&&(E=s.lastRenderedReducer,E!==null))try{var b=s.lastRenderedState,I=E(b,u);if(x.hasEagerState=!0,x.eagerState=I,un(I,b))return Fg(n,s,x,0),Bt===null&&Ig(),!1}catch{}finally{}if(u=rv(n,s,x,h),u!==null)return Ja(u,n,h),A2(u,s,h),!0}return!1}function Uv(n,s,u,h){if(h={lane:2,revertLane:x_(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},t1(n)){if(s)throw Error(a(479))}else s=rv(n,u,h,2),s!==null&&Ja(s,n,2)}function t1(n){var s=n.alternate;return n===Ze||s!==null&&s===Ze}function E2(n,s){nf=Wg=!0;var u=n.pending;u===null?s.next=s:(s.next=u.next,u.next=s),n.pending=s}function A2(n,s,u){if((u&4194048)!==0){var h=s.lanes;h&=n.pendingLanes,u|=h,s.lanes=u,Uu(n,u)}}var A0={readContext:$r,use:Qg,useCallback:lr,useContext:lr,useEffect:lr,useImperativeHandle:lr,useLayoutEffect:lr,useInsertionEffect:lr,useMemo:lr,useReducer:lr,useRef:lr,useState:lr,useDebugValue:lr,useDeferredValue:lr,useTransition:lr,useSyncExternalStore:lr,useId:lr,useHostTransitionStatus:lr,useFormState:lr,useActionState:lr,useOptimistic:lr,useMemoCache:lr,useCacheRefresh:lr};A0.useEffectEvent=lr;var y2={readContext:$r,use:Qg,useCallback:function(n,s){return Ra().memoizedState=[n,s===void 0?null:s],n},useContext:$r,useEffect:i2,useImperativeHandle:function(n,s,u){u=u!=null?u.concat([n]):null,Jg(4194308,4,c2.bind(null,s,n),u)},useLayoutEffect:function(n,s){return Jg(4194308,4,n,s)},useInsertionEffect:function(n,s){Jg(4,2,n,s)},useMemo:function(n,s){var u=Ra();s=s===void 0?null:s;var h=n();if(nc){pi(!0);try{n()}finally{pi(!1)}}return u.memoizedState=[h,s],h},useReducer:function(n,s,u){var h=Ra();if(u!==void 0){var x=u(s);if(nc){pi(!0);try{u(s)}finally{pi(!1)}}}else x=s;return h.memoizedState=h.baseState=x,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:x},h.queue=n,n=n.dispatch=p3.bind(null,Ze,n),[h.memoizedState,n]},useRef:function(n){var s=Ra();return n={current:n},s.memoizedState=n},useState:function(n){n=Nv(n);var s=n.queue,u=_2.bind(null,Ze,s);return s.dispatch=u,[n.memoizedState,u]},useDebugValue:Fv,useDeferredValue:function(n,s){var u=Ra();return Lv(u,n,s)},useTransition:function(){var n=Nv(!1);return n=p2.bind(null,Ze,n.queue,!0,!1),Ra().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,s,u){var h=Ze,x=Ra();if(gt){if(u===void 0)throw Error(a(407));u=u()}else{if(u=s(),Bt===null)throw Error(a(349));(dt&127)!==0||VT(h,s,u)}x.memoizedState=u;var E={value:u,getSnapshot:s};return x.queue=E,i2(YT.bind(null,h,E,n),[n]),h.flags|=2048,lf(9,{destroy:void 0},jT.bind(null,h,E,u,s),null),u},useId:function(){var n=Ra(),s=Bt.identifierPrefix;if(gt){var u=ji,h=Vi;u=(h&~(1<<32-Ca(h)-1)).toString(32)+u,s="_"+s+"R_"+u,u=Kg++,0<u&&(s+="H"+u.toString(32)),s+="_"}else u=l3++,s="_"+s+"r_"+u.toString(32)+"_";return n.memoizedState=s},useHostTransitionStatus:Bv,useFormState:e2,useActionState:e2,useOptimistic:function(n){var s=Ra();s.memoizedState=s.baseState=n;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=u,s=Uv.bind(null,Ze,!0,u),u.dispatch=s,[n,s]},useMemoCache:kv,useCacheRefresh:function(){return Ra().memoizedState=d3.bind(null,Ze)},useEffectEvent:function(n){var s=Ra(),u={impl:n};return s.memoizedState=u,function(){if((wt&2)!==0)throw Error(a(440));return u.impl.apply(void 0,arguments)}}},Hv={readContext:$r,use:Qg,useCallback:f2,useContext:$r,useEffect:Iv,useImperativeHandle:u2,useInsertionEffect:l2,useLayoutEffect:o2,useMemo:h2,useReducer:Zg,useRef:n2,useState:function(){return Zg(Rs)},useDebugValue:Fv,useDeferredValue:function(n,s){var u=pr();return d2(u,Nt.memoizedState,n,s)},useTransition:function(){var n=Zg(Rs)[0],s=pr().memoizedState;return[typeof n=="boolean"?n:_0(n),s]},useSyncExternalStore:GT,useId:x2,useHostTransitionStatus:Bv,useFormState:t2,useActionState:t2,useOptimistic:function(n,s){var u=pr();return WT(u,Nt,n,s)},useMemoCache:kv,useCacheRefresh:v2};Hv.useEffectEvent=s2;var T2={readContext:$r,use:Qg,useCallback:f2,useContext:$r,useEffect:Iv,useImperativeHandle:u2,useInsertionEffect:l2,useLayoutEffect:o2,useMemo:h2,useReducer:Dv,useRef:n2,useState:function(){return Dv(Rs)},useDebugValue:Fv,useDeferredValue:function(n,s){var u=pr();return Nt===null?Lv(u,n,s):d2(u,Nt.memoizedState,n,s)},useTransition:function(){var n=Dv(Rs)[0],s=pr().memoizedState;return[typeof n=="boolean"?n:_0(n),s]},useSyncExternalStore:GT,useId:x2,useHostTransitionStatus:Bv,useFormState:a2,useActionState:a2,useOptimistic:function(n,s){var u=pr();return Nt!==null?WT(u,Nt,n,s):(u.baseState=n,[n,u.queue.dispatch])},useMemoCache:kv,useCacheRefresh:v2};T2.useEffectEvent=s2;function zv(n,s,u,h){s=n.memoizedState,u=u(h,s),u=u==null?s:m({},s,u),n.memoizedState=u,n.lanes===0&&(n.updateQueue.baseState=u)}var Gv={enqueueSetState:function(n,s,u){n=n._reactInternals;var h=mn(),x=Nl(h);x.payload=s,u!=null&&(x.callback=u),s=Ml(n,x,h),s!==null&&(Ja(s,n,h),g0(s,n,h))},enqueueReplaceState:function(n,s,u){n=n._reactInternals;var h=mn(),x=Nl(h);x.tag=1,x.payload=s,u!=null&&(x.callback=u),s=Ml(n,x,h),s!==null&&(Ja(s,n,h),g0(s,n,h))},enqueueForceUpdate:function(n,s){n=n._reactInternals;var u=mn(),h=Nl(u);h.tag=2,s!=null&&(h.callback=s),s=Ml(n,h,u),s!==null&&(Ja(s,n,u),g0(s,n,u))}};function S2(n,s,u,h,x,E,b){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(h,E,b):s.prototype&&s.prototype.isPureReactComponent?!l0(u,h)||!l0(x,E):!0}function b2(n,s,u,h){n=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(u,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(u,h),s.state!==n&&Gv.enqueueReplaceState(s,s.state,null)}function ic(n,s){var u=s;if("ref"in s){u={};for(var h in s)h!=="ref"&&(u[h]=s[h])}if(n=n.defaultProps){u===s&&(u=m({},u));for(var x in n)u[x]===void 0&&(u[x]=n[x])}return u}function w2(n){Mg(n)}function C2(n){console.error(n)}function R2(n){Mg(n)}function r1(n,s){try{var u=n.onUncaughtError;u(s.value,{componentStack:s.stack})}catch(h){setTimeout(function(){throw h})}}function k2(n,s,u){try{var h=n.onCaughtError;h(u.value,{componentStack:u.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Vv(n,s,u){return u=Nl(u),u.tag=3,u.payload={element:null},u.callback=function(){r1(n,s)},u}function O2(n){return n=Nl(n),n.tag=3,n}function D2(n,s,u,h){var x=u.type.getDerivedStateFromError;if(typeof x=="function"){var E=h.value;n.payload=function(){return x(E)},n.callback=function(){k2(s,u,h)}}var b=u.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(n.callback=function(){k2(s,u,h),typeof x!="function"&&(Ul===null?Ul=new Set([this]):Ul.add(this));var I=h.stack;this.componentDidCatch(h.value,{componentStack:I!==null?I:""})})}function g3(n,s,u,h,x){if(u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(s=u.alternate,s!==null&&Zu(s,u,x,!0),u=hn.current,u!==null){switch(u.tag){case 31:case 13:return Xn===null?p1():u.alternate===null&&or===0&&(or=3),u.flags&=-257,u.flags|=65536,u.lanes=x,h===Vg?u.flags|=16384:(s=u.updateQueue,s===null?u.updateQueue=new Set([h]):s.add(h),p_(n,h,x)),!1;case 22:return u.flags|=65536,h===Vg?u.flags|=16384:(s=u.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([h])},u.updateQueue=s):(u=s.retryQueue,u===null?s.retryQueue=new Set([h]):u.add(h)),p_(n,h,x)),!1}throw Error(a(435,u.tag))}return p_(n,h,x),p1(),!1}if(gt)return s=hn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=x,h!==ov&&(n=Error(a(422),{cause:h}),u0(Gn(n,u)))):(h!==ov&&(s=Error(a(423),{cause:h}),u0(Gn(s,u))),n=n.current.alternate,n.flags|=65536,x&=-x,n.lanes|=x,h=Gn(h,u),x=Vv(n.stateNode,h,x),_v(n,x),or!==4&&(or=2)),!1;var E=Error(a(520),{cause:h});if(E=Gn(E,u),k0===null?k0=[E]:k0.push(E),or!==4&&(or=2),s===null)return!0;h=Gn(h,u),u=s;do{switch(u.tag){case 3:return u.flags|=65536,n=x&-x,u.lanes|=n,n=Vv(u.stateNode,h,n),_v(u,n),!1;case 1:if(s=u.type,E=u.stateNode,(u.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Ul===null||!Ul.has(E))))return u.flags|=65536,x&=-x,u.lanes|=x,x=O2(x),D2(x,n,u,h),_v(u,x),!1}u=u.return}while(u!==null);return!1}var jv=Error(a(461)),yr=!1;function Qr(n,s,u,h){s.child=n===null?FT(s,null,u,h):ac(s,n.child,u,h)}function N2(n,s,u,h,x){u=u.render;var E=s.ref;if("ref"in h){var b={};for(var I in h)I!=="ref"&&(b[I]=h[I])}else b=h;return Jo(s),h=bv(n,s,u,b,E,x),I=wv(),n!==null&&!yr?(Cv(n,s,x),ks(n,s,x)):(gt&&I&&sv(s),s.flags|=1,Qr(n,s,h,x),s.child)}function M2(n,s,u,h,x){if(n===null){var E=u.type;return typeof E=="function"&&!av(E)&&E.defaultProps===void 0&&u.compare===null?(s.tag=15,s.type=E,I2(n,s,E,h,x)):(n=Pg(u.type,null,h,s,s.mode,x),n.ref=s.ref,n.return=s,s.child=n)}if(E=n.child,!Zv(n,x)){var b=E.memoizedProps;if(u=u.compare,u=u!==null?u:l0,u(b,h)&&n.ref===s.ref)return ks(n,s,x)}return s.flags|=1,n=Ts(E,h),n.ref=s.ref,n.return=s,s.child=n}function I2(n,s,u,h,x){if(n!==null){var E=n.memoizedProps;if(l0(E,h)&&n.ref===s.ref)if(yr=!1,s.pendingProps=h=E,Zv(n,x))(n.flags&131072)!==0&&(yr=!0);else return s.lanes=n.lanes,ks(n,s,x)}return Yv(n,s,u,h,x)}function F2(n,s,u,h){var x=h.children,E=n!==null?n.memoizedState:null;if(n===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((s.flags&128)!==0){if(E=E!==null?E.baseLanes|u:u,n!==null){for(h=s.child=n.child,x=0;h!==null;)x=x|h.lanes|h.childLanes,h=h.sibling;h=x&~E}else h=0,s.child=null;return L2(n,s,E,u,h)}if((u&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},n!==null&&zg(s,E!==null?E.cachePool:null),E!==null?BT(s,E):Av(),UT(s);else return h=s.lanes=536870912,L2(n,s,E!==null?E.baseLanes|u:u,u,h)}else E!==null?(zg(s,E.cachePool),BT(s,E),Fl(),s.memoizedState=null):(n!==null&&zg(s,null),Av(),Fl());return Qr(n,s,x,u),s.child}function y0(n,s){return n!==null&&n.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function L2(n,s,u,h,x){var E=gv();return E=E===null?null:{parent:Er._currentValue,pool:E},s.memoizedState={baseLanes:u,cachePool:E},n!==null&&zg(s,null),Av(),UT(s),n!==null&&Zu(n,s,h,!0),s.childLanes=x,null}function a1(n,s){return s=i1({mode:s.mode,children:s.children},n.mode),s.ref=n.ref,n.child=s,s.return=n,s}function P2(n,s,u){return ac(s,n.child,null,u),n=a1(s,s.pendingProps),n.flags|=2,dn(s),s.memoizedState=null,n}function m3(n,s,u){var h=s.pendingProps,x=(s.flags&128)!==0;if(s.flags&=-129,n===null){if(gt){if(h.mode==="hidden")return n=a1(s,h),s.lanes=536870912,y0(null,n);if(Tv(s),(n=Yt)?(n=KS(n,Yn),n=n!==null&&n.data==="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:Cl!==null?{id:Vi,overflow:ji}:null,retryLane:536870912,hydrationErrors:null},u=ET(n),u.return=s,s.child=u,Kr=s,Yt=null)):n=null,n===null)throw kl(s);return s.lanes=536870912,null}return a1(s,h)}var E=n.memoizedState;if(E!==null){var b=E.dehydrated;if(Tv(s),x)if(s.flags&256)s.flags&=-257,s=P2(n,s,u);else if(s.memoizedState!==null)s.child=n.child,s.flags|=128,s=null;else throw Error(a(558));else if(yr||Zu(n,s,u,!1),x=(u&n.childLanes)!==0,yr||x){if(h=Bt,h!==null&&(b=Tg(h,u),b!==0&&b!==E.retryLane))throw E.retryLane=b,Ko(n,b),Ja(h,n,b),jv;p1(),s=P2(n,s,u)}else n=E.treeContext,Yt=qn(b.nextSibling),Kr=s,gt=!0,Rl=null,Yn=!1,n!==null&&TT(s,n),s=a1(s,h),s.flags|=4096;return s}return n=Ts(n.child,{mode:h.mode,children:h.children}),n.ref=s.ref,s.child=n,n.return=s,n}function n1(n,s){var u=s.ref;if(u===null)n!==null&&n.ref!==null&&(s.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(a(284));(n===null||n.ref!==u)&&(s.flags|=4194816)}}function Yv(n,s,u,h,x){return Jo(s),u=bv(n,s,u,h,void 0,x),h=wv(),n!==null&&!yr?(Cv(n,s,x),ks(n,s,x)):(gt&&h&&sv(s),s.flags|=1,Qr(n,s,u,x),s.child)}function B2(n,s,u,h,x,E){return Jo(s),s.updateQueue=null,u=zT(s,h,u,x),HT(n),h=wv(),n!==null&&!yr?(Cv(n,s,E),ks(n,s,E)):(gt&&h&&sv(s),s.flags|=1,Qr(n,s,u,E),s.child)}function U2(n,s,u,h,x){if(Jo(s),s.stateNode===null){var E=Wu,b=u.contextType;typeof b=="object"&&b!==null&&(E=$r(b)),E=new u(h,E),s.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=Gv,s.stateNode=E,E._reactInternals=s,E=s.stateNode,E.props=h,E.state=s.memoizedState,E.refs={},xv(s),b=u.contextType,E.context=typeof b=="object"&&b!==null?$r(b):Wu,E.state=s.memoizedState,b=u.getDerivedStateFromProps,typeof b=="function"&&(zv(s,u,b,h),E.state=s.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(b=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),b!==E.state&&Gv.enqueueReplaceState(E,E.state,null),x0(s,h,E,x),m0(),E.state=s.memoizedState),typeof E.componentDidMount=="function"&&(s.flags|=4194308),h=!0}else if(n===null){E=s.stateNode;var I=s.memoizedProps,Z=ic(u,I);E.props=Z;var oe=E.context,ve=u.contextType;b=Wu,typeof ve=="object"&&ve!==null&&(b=$r(ve));var Te=u.getDerivedStateFromProps;ve=typeof Te=="function"||typeof E.getSnapshotBeforeUpdate=="function",I=s.pendingProps!==I,ve||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(I||oe!==b)&&b2(s,E,h,b),Dl=!1;var he=s.memoizedState;E.state=he,x0(s,h,E,x),m0(),oe=s.memoizedState,I||he!==oe||Dl?(typeof Te=="function"&&(zv(s,u,Te,h),oe=s.memoizedState),(Z=Dl||S2(s,u,Z,h,he,oe,b))?(ve||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(s.flags|=4194308)):(typeof E.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=oe),E.props=h,E.state=oe,E.context=b,h=Z):(typeof E.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{E=s.stateNode,vv(n,s),b=s.memoizedProps,ve=ic(u,b),E.props=ve,Te=s.pendingProps,he=E.context,oe=u.contextType,Z=Wu,typeof oe=="object"&&oe!==null&&(Z=$r(oe)),I=u.getDerivedStateFromProps,(oe=typeof I=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(b!==Te||he!==Z)&&b2(s,E,h,Z),Dl=!1,he=s.memoizedState,E.state=he,x0(s,h,E,x),m0();var pe=s.memoizedState;b!==Te||he!==pe||Dl||n!==null&&n.dependencies!==null&&Ug(n.dependencies)?(typeof I=="function"&&(zv(s,u,I,h),pe=s.memoizedState),(ve=Dl||S2(s,u,ve,h,he,pe,Z)||n!==null&&n.dependencies!==null&&Ug(n.dependencies))?(oe||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(h,pe,Z),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(h,pe,Z)),typeof E.componentDidUpdate=="function"&&(s.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof E.componentDidUpdate!="function"||b===n.memoizedProps&&he===n.memoizedState||(s.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||b===n.memoizedProps&&he===n.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=pe),E.props=h,E.state=pe,E.context=Z,h=ve):(typeof E.componentDidUpdate!="function"||b===n.memoizedProps&&he===n.memoizedState||(s.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||b===n.memoizedProps&&he===n.memoizedState||(s.flags|=1024),h=!1)}return E=h,n1(n,s),h=(s.flags&128)!==0,E||h?(E=s.stateNode,u=h&&typeof u.getDerivedStateFromError!="function"?null:E.render(),s.flags|=1,n!==null&&h?(s.child=ac(s,n.child,null,x),s.child=ac(s,null,u,x)):Qr(n,s,u,x),s.memoizedState=E.state,n=s.child):n=ks(n,s,x),n}function H2(n,s,u,h){return Qo(),s.flags|=256,Qr(n,s,u,h),s.child}var Xv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function qv(n){return{baseLanes:n,cachePool:kT()}}function Wv(n,s,u){return n=n!==null?n.childLanes&~u:0,s&&(n|=gn),n}function z2(n,s,u){var h=s.pendingProps,x=!1,E=(s.flags&128)!==0,b;if((b=E)||(b=n!==null&&n.memoizedState===null?!1:(dr.current&2)!==0),b&&(x=!0,s.flags&=-129),b=(s.flags&32)!==0,s.flags&=-33,n===null){if(gt){if(x?Il(s):Fl(),(n=Yt)?(n=KS(n,Yn),n=n!==null&&n.data!=="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:Cl!==null?{id:Vi,overflow:ji}:null,retryLane:536870912,hydrationErrors:null},u=ET(n),u.return=s,s.child=u,Kr=s,Yt=null)):n=null,n===null)throw kl(s);return O_(n)?s.lanes=32:s.lanes=536870912,null}var I=h.children;return h=h.fallback,x?(Fl(),x=s.mode,I=i1({mode:"hidden",children:I},x),h=$o(h,x,u,null),I.return=s,h.return=s,I.sibling=h,s.child=I,h=s.child,h.memoizedState=qv(u),h.childLanes=Wv(n,b,u),s.memoizedState=Xv,y0(null,h)):(Il(s),Kv(s,I))}var Z=n.memoizedState;if(Z!==null&&(I=Z.dehydrated,I!==null)){if(E)s.flags&256?(Il(s),s.flags&=-257,s=$v(n,s,u)):s.memoizedState!==null?(Fl(),s.child=n.child,s.flags|=128,s=null):(Fl(),I=h.fallback,x=s.mode,h=i1({mode:"visible",children:h.children},x),I=$o(I,x,u,null),I.flags|=2,h.return=s,I.return=s,h.sibling=I,s.child=h,ac(s,n.child,null,u),h=s.child,h.memoizedState=qv(u),h.childLanes=Wv(n,b,u),s.memoizedState=Xv,s=y0(null,h));else if(Il(s),O_(I)){if(b=I.nextSibling&&I.nextSibling.dataset,b)var oe=b.dgst;b=oe,h=Error(a(419)),h.stack="",h.digest=b,u0({value:h,source:null,stack:null}),s=$v(n,s,u)}else if(yr||Zu(n,s,u,!1),b=(u&n.childLanes)!==0,yr||b){if(b=Bt,b!==null&&(h=Tg(b,u),h!==0&&h!==Z.retryLane))throw Z.retryLane=h,Ko(n,h),Ja(b,n,h),jv;k_(I)||p1(),s=$v(n,s,u)}else k_(I)?(s.flags|=192,s.child=n.child,s=null):(n=Z.treeContext,Yt=qn(I.nextSibling),Kr=s,gt=!0,Rl=null,Yn=!1,n!==null&&TT(s,n),s=Kv(s,h.children),s.flags|=4096);return s}return x?(Fl(),I=h.fallback,x=s.mode,Z=n.child,oe=Z.sibling,h=Ts(Z,{mode:"hidden",children:h.children}),h.subtreeFlags=Z.subtreeFlags&65011712,oe!==null?I=Ts(oe,I):(I=$o(I,x,u,null),I.flags|=2),I.return=s,h.return=s,h.sibling=I,s.child=h,y0(null,h),h=s.child,I=n.child.memoizedState,I===null?I=qv(u):(x=I.cachePool,x!==null?(Z=Er._currentValue,x=x.parent!==Z?{parent:Z,pool:Z}:x):x=kT(),I={baseLanes:I.baseLanes|u,cachePool:x}),h.memoizedState=I,h.childLanes=Wv(n,b,u),s.memoizedState=Xv,y0(n.child,h)):(Il(s),u=n.child,n=u.sibling,u=Ts(u,{mode:"visible",children:h.children}),u.return=s,u.sibling=null,n!==null&&(b=s.deletions,b===null?(s.deletions=[n],s.flags|=16):b.push(n)),s.child=u,s.memoizedState=null,u)}function Kv(n,s){return s=i1({mode:"visible",children:s},n.mode),s.return=n,n.child=s}function i1(n,s){return n=fn(22,n,null,s),n.lanes=0,n}function $v(n,s,u){return ac(s,n.child,null,u),n=Kv(s,s.pendingProps.children),n.flags|=2,s.memoizedState=null,n}function G2(n,s,u){n.lanes|=s;var h=n.alternate;h!==null&&(h.lanes|=s),fv(n.return,s,u)}function Qv(n,s,u,h,x,E){var b=n.memoizedState;b===null?n.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:x,treeForkCount:E}:(b.isBackwards=s,b.rendering=null,b.renderingStartTime=0,b.last=h,b.tail=u,b.tailMode=x,b.treeForkCount=E)}function V2(n,s,u){var h=s.pendingProps,x=h.revealOrder,E=h.tail;h=h.children;var b=dr.current,I=(b&2)!==0;if(I?(b=b&1|2,s.flags|=128):b&=1,q(dr,b),Qr(n,s,h,u),h=gt?c0:0,!I&&n!==null&&(n.flags&128)!==0)e:for(n=s.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&G2(n,u,s);else if(n.tag===19)G2(n,u,s);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break e;for(;n.sibling===null;){if(n.return===null||n.return===s)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(x){case"forwards":for(u=s.child,x=null;u!==null;)n=u.alternate,n!==null&&qg(n)===null&&(x=u),u=u.sibling;u=x,u===null?(x=s.child,s.child=null):(x=u.sibling,u.sibling=null),Qv(s,!1,x,u,E,h);break;case"backwards":case"unstable_legacy-backwards":for(u=null,x=s.child,s.child=null;x!==null;){if(n=x.alternate,n!==null&&qg(n)===null){s.child=x;break}n=x.sibling,x.sibling=u,u=x,x=n}Qv(s,!0,u,null,E,h);break;case"together":Qv(s,!1,null,null,void 0,h);break;default:s.memoizedState=null}return s.child}function ks(n,s,u){if(n!==null&&(s.dependencies=n.dependencies),Bl|=s.lanes,(u&s.childLanes)===0)if(n!==null){if(Zu(n,s,u,!1),(u&s.childLanes)===0)return null}else return null;if(n!==null&&s.child!==n.child)throw Error(a(153));if(s.child!==null){for(n=s.child,u=Ts(n,n.pendingProps),s.child=u,u.return=s;n.sibling!==null;)n=n.sibling,u=u.sibling=Ts(n,n.pendingProps),u.return=s;u.sibling=null}return s.child}function Zv(n,s){return(n.lanes&s)!==0?!0:(n=n.dependencies,!!(n!==null&&Ug(n)))}function x3(n,s,u){switch(s.tag){case 3:ke(s,s.stateNode.containerInfo),Ol(s,Er,n.memoizedState.cache),Qo();break;case 27:case 5:be(s);break;case 4:ke(s,s.stateNode.containerInfo);break;case 10:Ol(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Tv(s),null;break;case 13:var h=s.memoizedState;if(h!==null)return h.dehydrated!==null?(Il(s),s.flags|=128,null):(u&s.child.childLanes)!==0?z2(n,s,u):(Il(s),n=ks(n,s,u),n!==null?n.sibling:null);Il(s);break;case 19:var x=(n.flags&128)!==0;if(h=(u&s.childLanes)!==0,h||(Zu(n,s,u,!1),h=(u&s.childLanes)!==0),x){if(h)return V2(n,s,u);s.flags|=128}if(x=s.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),q(dr,dr.current),h)break;return null;case 22:return s.lanes=0,F2(n,s,u,s.pendingProps);case 24:Ol(s,Er,n.memoizedState.cache)}return ks(n,s,u)}function j2(n,s,u){if(n!==null)if(n.memoizedProps!==s.pendingProps)yr=!0;else{if(!Zv(n,u)&&(s.flags&128)===0)return yr=!1,x3(n,s,u);yr=(n.flags&131072)!==0}else yr=!1,gt&&(s.flags&1048576)!==0&&yT(s,c0,s.index);switch(s.lanes=0,s.tag){case 16:e:{var h=s.pendingProps;if(n=tc(s.elementType),s.type=n,typeof n=="function")av(n)?(h=ic(n,h),s.tag=1,s=U2(null,s,n,h,u)):(s.tag=0,s=Yv(null,s,n,h,u));else{if(n!=null){var x=n.$$typeof;if(x===F){s.tag=11,s=N2(null,s,n,h,u);break e}else if(x===k){s.tag=14,s=M2(null,s,n,h,u);break e}}throw s=ye(n)||n,Error(a(306,s,""))}}return s;case 0:return Yv(n,s,s.type,s.pendingProps,u);case 1:return h=s.type,x=ic(h,s.pendingProps),U2(n,s,h,x,u);case 3:e:{if(ke(s,s.stateNode.containerInfo),n===null)throw Error(a(387));h=s.pendingProps;var E=s.memoizedState;x=E.element,vv(n,s),x0(s,h,null,u);var b=s.memoizedState;if(h=b.cache,Ol(s,Er,h),h!==E.cache&&hv(s,[Er],u,!0),m0(),h=b.element,E.isDehydrated)if(E={element:h,isDehydrated:!1,cache:b.cache},s.updateQueue.baseState=E,s.memoizedState=E,s.flags&256){s=H2(n,s,h,u);break e}else if(h!==x){x=Gn(Error(a(424)),s),u0(x),s=H2(n,s,h,u);break e}else{switch(n=s.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(Yt=qn(n.firstChild),Kr=s,gt=!0,Rl=null,Yn=!0,u=FT(s,null,h,u),s.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Qo(),h===x){s=ks(n,s,u);break e}Qr(n,s,h,u)}s=s.child}return s;case 26:return n1(n,s),n===null?(u=tb(s.type,null,s.pendingProps,null))?s.memoizedState=u:gt||(u=s.type,n=s.pendingProps,h=A1(se.current).createElement(u),h[P]=s,h[H]=n,Zr(h,u,n),He(h),s.stateNode=h):s.memoizedState=tb(s.type,n.memoizedProps,s.pendingProps,n.memoizedState),null;case 27:return be(s),n===null&&gt&&(h=s.stateNode=ZS(s.type,s.pendingProps,se.current),Kr=s,Yn=!0,x=Yt,Vl(s.type)?(D_=x,Yt=qn(h.firstChild)):Yt=x),Qr(n,s,s.pendingProps.children,u),n1(n,s),n===null&&(s.flags|=4194304),s.child;case 5:return n===null&&gt&&((x=h=Yt)&&(h=q3(h,s.type,s.pendingProps,Yn),h!==null?(s.stateNode=h,Kr=s,Yt=qn(h.firstChild),Yn=!1,x=!0):x=!1),x||kl(s)),be(s),x=s.type,E=s.pendingProps,b=n!==null?n.memoizedProps:null,h=E.children,w_(x,E)?h=null:b!==null&&w_(x,b)&&(s.flags|=32),s.memoizedState!==null&&(x=bv(n,s,o3,null,null,u),P0._currentValue=x),n1(n,s),Qr(n,s,h,u),s.child;case 6:return n===null&&gt&&((n=u=Yt)&&(u=W3(u,s.pendingProps,Yn),u!==null?(s.stateNode=u,Kr=s,Yt=null,n=!0):n=!1),n||kl(s)),null;case 13:return z2(n,s,u);case 4:return ke(s,s.stateNode.containerInfo),h=s.pendingProps,n===null?s.child=ac(s,null,h,u):Qr(n,s,h,u),s.child;case 11:return N2(n,s,s.type,s.pendingProps,u);case 7:return Qr(n,s,s.pendingProps,u),s.child;case 8:return Qr(n,s,s.pendingProps.children,u),s.child;case 12:return Qr(n,s,s.pendingProps.children,u),s.child;case 10:return h=s.pendingProps,Ol(s,s.type,h.value),Qr(n,s,h.children,u),s.child;case 9:return x=s.type._context,h=s.pendingProps.children,Jo(s),x=$r(x),h=h(x),s.flags|=1,Qr(n,s,h,u),s.child;case 14:return M2(n,s,s.type,s.pendingProps,u);case 15:return I2(n,s,s.type,s.pendingProps,u);case 19:return V2(n,s,u);case 31:return m3(n,s,u);case 22:return F2(n,s,u,s.pendingProps);case 24:return Jo(s),h=$r(Er),n===null?(x=gv(),x===null&&(x=Bt,E=dv(),x.pooledCache=E,E.refCount++,E!==null&&(x.pooledCacheLanes|=u),x=E),s.memoizedState={parent:h,cache:x},xv(s),Ol(s,Er,x)):((n.lanes&u)!==0&&(vv(n,s),x0(s,null,null,u),m0()),x=n.memoizedState,E=s.memoizedState,x.parent!==h?(x={parent:h,cache:h},s.memoizedState=x,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=x),Ol(s,Er,h)):(h=E.cache,Ol(s,Er,h),h!==x.cache&&hv(s,[Er],u,!0))),Qr(n,s,s.pendingProps.children,u),s.child;case 29:throw s.pendingProps}throw Error(a(156,s.tag))}function Os(n){n.flags|=4}function Jv(n,s,u,h,x){if((s=(n.mode&32)!==0)&&(s=!1),s){if(n.flags|=16777216,(x&335544128)===x)if(n.stateNode.complete)n.flags|=8192;else if(xS())n.flags|=8192;else throw rc=Vg,mv}else n.flags&=-16777217}function Y2(n,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!sb(s))if(xS())n.flags|=8192;else throw rc=Vg,mv}function s1(n,s){s!==null&&(n.flags|=4),n.flags&16384&&(s=n.tag!==22?Ag():536870912,n.lanes|=s,ff|=s)}function T0(n,s){if(!gt)switch(n.tailMode){case"hidden":s=n.tail;for(var u=null;s!==null;)s.alternate!==null&&(u=s),s=s.sibling;u===null?n.tail=null:u.sibling=null;break;case"collapsed":u=n.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?s||n.tail===null?n.tail=null:n.tail.sibling=null:h.sibling=null}}function Xt(n){var s=n.alternate!==null&&n.alternate.child===n.child,u=0,h=0;if(s)for(var x=n.child;x!==null;)u|=x.lanes|x.childLanes,h|=x.subtreeFlags&65011712,h|=x.flags&65011712,x.return=n,x=x.sibling;else for(x=n.child;x!==null;)u|=x.lanes|x.childLanes,h|=x.subtreeFlags,h|=x.flags,x.return=n,x=x.sibling;return n.subtreeFlags|=h,n.childLanes=u,s}function v3(n,s,u){var h=s.pendingProps;switch(lv(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xt(s),null;case 1:return Xt(s),null;case 3:return u=s.stateNode,h=null,n!==null&&(h=n.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),ws(Er),Se(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(n===null||n.child===null)&&(Qu(s)?Os(s):n===null||n.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,cv())),Xt(s),null;case 26:var x=s.type,E=s.memoizedState;return n===null?(Os(s),E!==null?(Xt(s),Y2(s,E)):(Xt(s),Jv(s,x,null,h,u))):E?E!==n.memoizedState?(Os(s),Xt(s),Y2(s,E)):(Xt(s),s.flags&=-16777217):(n=n.memoizedProps,n!==h&&Os(s),Xt(s),Jv(s,x,n,h,u)),null;case 27:if(ot(s),u=se.current,x=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==h&&Os(s);else{if(!h){if(s.stateNode===null)throw Error(a(166));return Xt(s),null}n=X.current,Qu(s)?ST(s):(n=ZS(x,h,u),s.stateNode=n,Os(s))}return Xt(s),null;case 5:if(ot(s),x=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==h&&Os(s);else{if(!h){if(s.stateNode===null)throw Error(a(166));return Xt(s),null}if(E=X.current,Qu(s))ST(s);else{var b=A1(se.current);switch(E){case 1:E=b.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:E=b.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":E=b.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":E=b.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":E=b.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof h.is=="string"?b.createElement("select",{is:h.is}):b.createElement("select"),h.multiple?E.multiple=!0:h.size&&(E.size=h.size);break;default:E=typeof h.is=="string"?b.createElement(x,{is:h.is}):b.createElement(x)}}E[P]=s,E[H]=h;e:for(b=s.child;b!==null;){if(b.tag===5||b.tag===6)E.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===s)break e;for(;b.sibling===null;){if(b.return===null||b.return===s)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}s.stateNode=E;e:switch(Zr(E,x,h),x){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&Os(s)}}return Xt(s),Jv(s,s.type,n===null?null:n.memoizedProps,s.pendingProps,u),null;case 6:if(n&&s.stateNode!=null)n.memoizedProps!==h&&Os(s);else{if(typeof h!="string"&&s.stateNode===null)throw Error(a(166));if(n=se.current,Qu(s)){if(n=s.stateNode,u=s.memoizedProps,h=null,x=Kr,x!==null)switch(x.tag){case 27:case 5:h=x.memoizedProps}n[P]=s,n=!!(n.nodeValue===u||h!==null&&h.suppressHydrationWarning===!0||zS(n.nodeValue,u)),n||kl(s,!0)}else n=A1(n).createTextNode(h),n[P]=s,s.stateNode=n}return Xt(s),null;case 31:if(u=s.memoizedState,n===null||n.memoizedState!==null){if(h=Qu(s),u!==null){if(n===null){if(!h)throw Error(a(318));if(n=s.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(557));n[P]=s}else Qo(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Xt(s),n=!1}else u=cv(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=u),n=!0;if(!n)return s.flags&256?(dn(s),s):(dn(s),null);if((s.flags&128)!==0)throw Error(a(558))}return Xt(s),null;case 13:if(h=s.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(x=Qu(s),h!==null&&h.dehydrated!==null){if(n===null){if(!x)throw Error(a(318));if(x=s.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(a(317));x[P]=s}else Qo(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Xt(s),x=!1}else x=cv(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=x),x=!0;if(!x)return s.flags&256?(dn(s),s):(dn(s),null)}return dn(s),(s.flags&128)!==0?(s.lanes=u,s):(u=h!==null,n=n!==null&&n.memoizedState!==null,u&&(h=s.child,x=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(x=h.alternate.memoizedState.cachePool.pool),E=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(E=h.memoizedState.cachePool.pool),E!==x&&(h.flags|=2048)),u!==n&&u&&(s.child.flags|=8192),s1(s,s.updateQueue),Xt(s),null);case 4:return Se(),n===null&&A_(s.stateNode.containerInfo),Xt(s),null;case 10:return ws(s.type),Xt(s),null;case 19:if(N(dr),h=s.memoizedState,h===null)return Xt(s),null;if(x=(s.flags&128)!==0,E=h.rendering,E===null)if(x)T0(h,!1);else{if(or!==0||n!==null&&(n.flags&128)!==0)for(n=s.child;n!==null;){if(E=qg(n),E!==null){for(s.flags|=128,T0(h,!1),n=E.updateQueue,s.updateQueue=n,s1(s,n),s.subtreeFlags=0,n=u,u=s.child;u!==null;)_T(u,n),u=u.sibling;return q(dr,dr.current&1|2),gt&&Ss(s,h.treeForkCount),s.child}n=n.sibling}h.tail!==null&&Pt()>f1&&(s.flags|=128,x=!0,T0(h,!1),s.lanes=4194304)}else{if(!x)if(n=qg(E),n!==null){if(s.flags|=128,x=!0,n=n.updateQueue,s.updateQueue=n,s1(s,n),T0(h,!0),h.tail===null&&h.tailMode==="hidden"&&!E.alternate&&!gt)return Xt(s),null}else 2*Pt()-h.renderingStartTime>f1&&u!==536870912&&(s.flags|=128,x=!0,T0(h,!1),s.lanes=4194304);h.isBackwards?(E.sibling=s.child,s.child=E):(n=h.last,n!==null?n.sibling=E:s.child=E,h.last=E)}return h.tail!==null?(n=h.tail,h.rendering=n,h.tail=n.sibling,h.renderingStartTime=Pt(),n.sibling=null,u=dr.current,q(dr,x?u&1|2:u&1),gt&&Ss(s,h.treeForkCount),n):(Xt(s),null);case 22:case 23:return dn(s),yv(),h=s.memoizedState!==null,n!==null?n.memoizedState!==null!==h&&(s.flags|=8192):h&&(s.flags|=8192),h?(u&536870912)!==0&&(s.flags&128)===0&&(Xt(s),s.subtreeFlags&6&&(s.flags|=8192)):Xt(s),u=s.updateQueue,u!==null&&s1(s,u.retryQueue),u=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(u=n.memoizedState.cachePool.pool),h=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),h!==u&&(s.flags|=2048),n!==null&&N(ec),null;case 24:return u=null,n!==null&&(u=n.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),ws(Er),Xt(s),null;case 25:return null;case 30:return null}throw Error(a(156,s.tag))}function _3(n,s){switch(lv(s),s.tag){case 1:return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 3:return ws(Er),Se(),n=s.flags,(n&65536)!==0&&(n&128)===0?(s.flags=n&-65537|128,s):null;case 26:case 27:case 5:return ot(s),null;case 31:if(s.memoizedState!==null){if(dn(s),s.alternate===null)throw Error(a(340));Qo()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 13:if(dn(s),n=s.memoizedState,n!==null&&n.dehydrated!==null){if(s.alternate===null)throw Error(a(340));Qo()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 19:return N(dr),null;case 4:return Se(),null;case 10:return ws(s.type),null;case 22:case 23:return dn(s),yv(),n!==null&&N(ec),n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 24:return ws(Er),null;case 25:return null;default:return null}}function X2(n,s){switch(lv(s),s.tag){case 3:ws(Er),Se();break;case 26:case 27:case 5:ot(s);break;case 4:Se();break;case 31:s.memoizedState!==null&&dn(s);break;case 13:dn(s);break;case 19:N(dr);break;case 10:ws(s.type);break;case 22:case 23:dn(s),yv(),n!==null&&N(ec);break;case 24:ws(Er)}}function S0(n,s){try{var u=s.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var x=h.next;u=x;do{if((u.tag&n)===n){h=void 0;var E=u.create,b=u.inst;h=E(),b.destroy=h}u=u.next}while(u!==x)}}catch(I){kt(s,s.return,I)}}function Ll(n,s,u){try{var h=s.updateQueue,x=h!==null?h.lastEffect:null;if(x!==null){var E=x.next;h=E;do{if((h.tag&n)===n){var b=h.inst,I=b.destroy;if(I!==void 0){b.destroy=void 0,x=s;var Z=u,oe=I;try{oe()}catch(ve){kt(x,Z,ve)}}}h=h.next}while(h!==E)}}catch(ve){kt(s,s.return,ve)}}function q2(n){var s=n.updateQueue;if(s!==null){var u=n.stateNode;try{PT(s,u)}catch(h){kt(n,n.return,h)}}}function W2(n,s,u){u.props=ic(n.type,n.memoizedProps),u.state=n.memoizedState;try{u.componentWillUnmount()}catch(h){kt(n,s,h)}}function b0(n,s){try{var u=n.ref;if(u!==null){switch(n.tag){case 26:case 27:case 5:var h=n.stateNode;break;case 30:h=n.stateNode;break;default:h=n.stateNode}typeof u=="function"?n.refCleanup=u(h):u.current=h}}catch(x){kt(n,s,x)}}function Yi(n,s){var u=n.ref,h=n.refCleanup;if(u!==null)if(typeof h=="function")try{h()}catch(x){kt(n,s,x)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(x){kt(n,s,x)}else u.current=null}function K2(n){var s=n.type,u=n.memoizedProps,h=n.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":u.autoFocus&&h.focus();break e;case"img":u.src?h.src=u.src:u.srcSet&&(h.srcset=u.srcSet)}}catch(x){kt(n,n.return,x)}}function e_(n,s,u){try{var h=n.stateNode;z3(h,n.type,u,s),h[H]=s}catch(x){kt(n,n.return,x)}}function $2(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Vl(n.type)||n.tag===4}function t_(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||$2(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Vl(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function r_(n,s,u){var h=n.tag;if(h===5||h===6)n=n.stateNode,s?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(n,s):(s=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,s.appendChild(n),u=u._reactRootContainer,u!=null||s.onclick!==null||(s.onclick=As));else if(h!==4&&(h===27&&Vl(n.type)&&(u=n.stateNode,s=null),n=n.child,n!==null))for(r_(n,s,u),n=n.sibling;n!==null;)r_(n,s,u),n=n.sibling}function l1(n,s,u){var h=n.tag;if(h===5||h===6)n=n.stateNode,s?u.insertBefore(n,s):u.appendChild(n);else if(h!==4&&(h===27&&Vl(n.type)&&(u=n.stateNode),n=n.child,n!==null))for(l1(n,s,u),n=n.sibling;n!==null;)l1(n,s,u),n=n.sibling}function Q2(n){var s=n.stateNode,u=n.memoizedProps;try{for(var h=n.type,x=s.attributes;x.length;)s.removeAttributeNode(x[0]);Zr(s,h,u),s[P]=n,s[H]=u}catch(E){kt(n,n.return,E)}}var Ds=!1,Tr=!1,a_=!1,Z2=typeof WeakSet=="function"?WeakSet:Set,Hr=null;function E3(n,s){if(n=n.containerInfo,S_=R1,n=uT(n),$x(n)){if("selectionStart"in n)var u={start:n.selectionStart,end:n.selectionEnd};else e:{u=(u=n.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var x=h.anchorOffset,E=h.focusNode;h=h.focusOffset;try{u.nodeType,E.nodeType}catch{u=null;break e}var b=0,I=-1,Z=-1,oe=0,ve=0,Te=n,he=null;t:for(;;){for(var pe;Te!==u||x!==0&&Te.nodeType!==3||(I=b+x),Te!==E||h!==0&&Te.nodeType!==3||(Z=b+h),Te.nodeType===3&&(b+=Te.nodeValue.length),(pe=Te.firstChild)!==null;)he=Te,Te=pe;for(;;){if(Te===n)break t;if(he===u&&++oe===x&&(I=b),he===E&&++ve===h&&(Z=b),(pe=Te.nextSibling)!==null)break;Te=he,he=Te.parentNode}Te=pe}u=I===-1||Z===-1?null:{start:I,end:Z}}else u=null}u=u||{start:0,end:0}}else u=null;for(b_={focusedElem:n,selectionRange:u},R1=!1,Hr=s;Hr!==null;)if(s=Hr,n=s.child,(s.subtreeFlags&1028)!==0&&n!==null)n.return=s,Hr=n;else for(;Hr!==null;){switch(s=Hr,E=s.alternate,n=s.flags,s.tag){case 0:if((n&4)!==0&&(n=s.updateQueue,n=n!==null?n.events:null,n!==null))for(u=0;u<n.length;u++)x=n[u],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&E!==null){n=void 0,u=s,x=E.memoizedProps,E=E.memoizedState,h=u.stateNode;try{var Be=ic(u.type,x);n=h.getSnapshotBeforeUpdate(Be,E),h.__reactInternalSnapshotBeforeUpdate=n}catch(Ye){kt(u,u.return,Ye)}}break;case 3:if((n&1024)!==0){if(n=s.stateNode.containerInfo,u=n.nodeType,u===9)R_(n);else if(u===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":R_(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=s.sibling,n!==null){n.return=s.return,Hr=n;break}Hr=s.return}}function J2(n,s,u){var h=u.flags;switch(u.tag){case 0:case 11:case 15:Ms(n,u),h&4&&S0(5,u);break;case 1:if(Ms(n,u),h&4)if(n=u.stateNode,s===null)try{n.componentDidMount()}catch(b){kt(u,u.return,b)}else{var x=ic(u.type,s.memoizedProps);s=s.memoizedState;try{n.componentDidUpdate(x,s,n.__reactInternalSnapshotBeforeUpdate)}catch(b){kt(u,u.return,b)}}h&64&&q2(u),h&512&&b0(u,u.return);break;case 3:if(Ms(n,u),h&64&&(n=u.updateQueue,n!==null)){if(s=null,u.child!==null)switch(u.child.tag){case 27:case 5:s=u.child.stateNode;break;case 1:s=u.child.stateNode}try{PT(n,s)}catch(b){kt(u,u.return,b)}}break;case 27:s===null&&h&4&&Q2(u);case 26:case 5:Ms(n,u),s===null&&h&4&&K2(u),h&512&&b0(u,u.return);break;case 12:Ms(n,u);break;case 31:Ms(n,u),h&4&&rS(n,u);break;case 13:Ms(n,u),h&4&&aS(n,u),h&64&&(n=u.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(u=k3.bind(null,u),K3(n,u))));break;case 22:if(h=u.memoizedState!==null||Ds,!h){s=s!==null&&s.memoizedState!==null||Tr,x=Ds;var E=Tr;Ds=h,(Tr=s)&&!E?Is(n,u,(u.subtreeFlags&8772)!==0):Ms(n,u),Ds=x,Tr=E}break;case 30:break;default:Ms(n,u)}}function eS(n){var s=n.alternate;s!==null&&(n.alternate=null,eS(s)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(s=n.stateNode,s!==null&&Ce(s)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Qt=null,Ka=!1;function Ns(n,s,u){for(u=u.child;u!==null;)tS(n,s,u),u=u.sibling}function tS(n,s,u){if(hr&&typeof hr.onCommitFiberUnmount=="function")try{hr.onCommitFiberUnmount(jt,u)}catch{}switch(u.tag){case 26:Tr||Yi(u,s),Ns(n,s,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Tr||Yi(u,s);var h=Qt,x=Ka;Vl(u.type)&&(Qt=u.stateNode,Ka=!1),Ns(n,s,u),I0(u.stateNode),Qt=h,Ka=x;break;case 5:Tr||Yi(u,s);case 6:if(h=Qt,x=Ka,Qt=null,Ns(n,s,u),Qt=h,Ka=x,Qt!==null)if(Ka)try{(Qt.nodeType===9?Qt.body:Qt.nodeName==="HTML"?Qt.ownerDocument.body:Qt).removeChild(u.stateNode)}catch(E){kt(u,s,E)}else try{Qt.removeChild(u.stateNode)}catch(E){kt(u,s,E)}break;case 18:Qt!==null&&(Ka?(n=Qt,qS(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,u.stateNode),_f(n)):qS(Qt,u.stateNode));break;case 4:h=Qt,x=Ka,Qt=u.stateNode.containerInfo,Ka=!0,Ns(n,s,u),Qt=h,Ka=x;break;case 0:case 11:case 14:case 15:Ll(2,u,s),Tr||Ll(4,u,s),Ns(n,s,u);break;case 1:Tr||(Yi(u,s),h=u.stateNode,typeof h.componentWillUnmount=="function"&&W2(u,s,h)),Ns(n,s,u);break;case 21:Ns(n,s,u);break;case 22:Tr=(h=Tr)||u.memoizedState!==null,Ns(n,s,u),Tr=h;break;default:Ns(n,s,u)}}function rS(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{_f(n)}catch(u){kt(s,s.return,u)}}}function aS(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{_f(n)}catch(u){kt(s,s.return,u)}}function A3(n){switch(n.tag){case 31:case 13:case 19:var s=n.stateNode;return s===null&&(s=n.stateNode=new Z2),s;case 22:return n=n.stateNode,s=n._retryCache,s===null&&(s=n._retryCache=new Z2),s;default:throw Error(a(435,n.tag))}}function o1(n,s){var u=A3(n);s.forEach(function(h){if(!u.has(h)){u.add(h);var x=O3.bind(null,n,h);h.then(x,x)}})}function $a(n,s){var u=s.deletions;if(u!==null)for(var h=0;h<u.length;h++){var x=u[h],E=n,b=s,I=b;e:for(;I!==null;){switch(I.tag){case 27:if(Vl(I.type)){Qt=I.stateNode,Ka=!1;break e}break;case 5:Qt=I.stateNode,Ka=!1;break e;case 3:case 4:Qt=I.stateNode.containerInfo,Ka=!0;break e}I=I.return}if(Qt===null)throw Error(a(160));tS(E,b,x),Qt=null,Ka=!1,E=x.alternate,E!==null&&(E.return=null),x.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)nS(s,n),s=s.sibling}var mi=null;function nS(n,s){var u=n.alternate,h=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:$a(s,n),Qa(n),h&4&&(Ll(3,n,n.return),S0(3,n),Ll(5,n,n.return));break;case 1:$a(s,n),Qa(n),h&512&&(Tr||u===null||Yi(u,u.return)),h&64&&Ds&&(n=n.updateQueue,n!==null&&(h=n.callbacks,h!==null&&(u=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=u===null?h:u.concat(h))));break;case 26:var x=mi;if($a(s,n),Qa(n),h&512&&(Tr||u===null||Yi(u,u.return)),h&4){var E=u!==null?u.memoizedState:null;if(h=n.memoizedState,u===null)if(h===null)if(n.stateNode===null){e:{h=n.type,u=n.memoizedProps,x=x.ownerDocument||x;t:switch(h){case"title":E=x.getElementsByTagName("title")[0],(!E||E[de]||E[P]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=x.createElement(h),x.head.insertBefore(E,x.querySelector("head > title"))),Zr(E,h,u),E[P]=n,He(E),h=E;break e;case"link":var b=nb("link","href",x).get(h+(u.href||""));if(b){for(var I=0;I<b.length;I++)if(E=b[I],E.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&E.getAttribute("rel")===(u.rel==null?null:u.rel)&&E.getAttribute("title")===(u.title==null?null:u.title)&&E.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){b.splice(I,1);break t}}E=x.createElement(h),Zr(E,h,u),x.head.appendChild(E);break;case"meta":if(b=nb("meta","content",x).get(h+(u.content||""))){for(I=0;I<b.length;I++)if(E=b[I],E.getAttribute("content")===(u.content==null?null:""+u.content)&&E.getAttribute("name")===(u.name==null?null:u.name)&&E.getAttribute("property")===(u.property==null?null:u.property)&&E.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&E.getAttribute("charset")===(u.charSet==null?null:u.charSet)){b.splice(I,1);break t}}E=x.createElement(h),Zr(E,h,u),x.head.appendChild(E);break;default:throw Error(a(468,h))}E[P]=n,He(E),h=E}n.stateNode=h}else ib(x,n.type,n.stateNode);else n.stateNode=ab(x,h,n.memoizedProps);else E!==h?(E===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):E.count--,h===null?ib(x,n.type,n.stateNode):ab(x,h,n.memoizedProps)):h===null&&n.stateNode!==null&&e_(n,n.memoizedProps,u.memoizedProps)}break;case 27:$a(s,n),Qa(n),h&512&&(Tr||u===null||Yi(u,u.return)),u!==null&&h&4&&e_(n,n.memoizedProps,u.memoizedProps);break;case 5:if($a(s,n),Qa(n),h&512&&(Tr||u===null||Yi(u,u.return)),n.flags&32){x=n.stateNode;try{zu(x,"")}catch(Be){kt(n,n.return,Be)}}h&4&&n.stateNode!=null&&(x=n.memoizedProps,e_(n,x,u!==null?u.memoizedProps:x)),h&1024&&(a_=!0);break;case 6:if($a(s,n),Qa(n),h&4){if(n.stateNode===null)throw Error(a(162));h=n.memoizedProps,u=n.stateNode;try{u.nodeValue=h}catch(Be){kt(n,n.return,Be)}}break;case 3:if(S1=null,x=mi,mi=y1(s.containerInfo),$a(s,n),mi=x,Qa(n),h&4&&u!==null&&u.memoizedState.isDehydrated)try{_f(s.containerInfo)}catch(Be){kt(n,n.return,Be)}a_&&(a_=!1,iS(n));break;case 4:h=mi,mi=y1(n.stateNode.containerInfo),$a(s,n),Qa(n),mi=h;break;case 12:$a(s,n),Qa(n);break;case 31:$a(s,n),Qa(n),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,o1(n,h)));break;case 13:$a(s,n),Qa(n),n.child.flags&8192&&n.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(u1=Pt()),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,o1(n,h)));break;case 22:x=n.memoizedState!==null;var Z=u!==null&&u.memoizedState!==null,oe=Ds,ve=Tr;if(Ds=oe||x,Tr=ve||Z,$a(s,n),Tr=ve,Ds=oe,Qa(n),h&8192)e:for(s=n.stateNode,s._visibility=x?s._visibility&-2:s._visibility|1,x&&(u===null||Z||Ds||Tr||sc(n)),u=null,s=n;;){if(s.tag===5||s.tag===26){if(u===null){Z=u=s;try{if(E=Z.stateNode,x)b=E.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{I=Z.stateNode;var Te=Z.memoizedProps.style,he=Te!=null&&Te.hasOwnProperty("display")?Te.display:null;I.style.display=he==null||typeof he=="boolean"?"":(""+he).trim()}}catch(Be){kt(Z,Z.return,Be)}}}else if(s.tag===6){if(u===null){Z=s;try{Z.stateNode.nodeValue=x?"":Z.memoizedProps}catch(Be){kt(Z,Z.return,Be)}}}else if(s.tag===18){if(u===null){Z=s;try{var pe=Z.stateNode;x?WS(pe,!0):WS(Z.stateNode,!1)}catch(Be){kt(Z,Z.return,Be)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===n)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break e;for(;s.sibling===null;){if(s.return===null||s.return===n)break e;u===s&&(u=null),s=s.return}u===s&&(u=null),s.sibling.return=s.return,s=s.sibling}h&4&&(h=n.updateQueue,h!==null&&(u=h.retryQueue,u!==null&&(h.retryQueue=null,o1(n,u))));break;case 19:$a(s,n),Qa(n),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,o1(n,h)));break;case 30:break;case 21:break;default:$a(s,n),Qa(n)}}function Qa(n){var s=n.flags;if(s&2){try{for(var u,h=n.return;h!==null;){if($2(h)){u=h;break}h=h.return}if(u==null)throw Error(a(160));switch(u.tag){case 27:var x=u.stateNode,E=t_(n);l1(n,E,x);break;case 5:var b=u.stateNode;u.flags&32&&(zu(b,""),u.flags&=-33);var I=t_(n);l1(n,I,b);break;case 3:case 4:var Z=u.stateNode.containerInfo,oe=t_(n);r_(n,oe,Z);break;default:throw Error(a(161))}}catch(ve){kt(n,n.return,ve)}n.flags&=-3}s&4096&&(n.flags&=-4097)}function iS(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var s=n;iS(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),n=n.sibling}}function Ms(n,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)J2(n,s.alternate,s),s=s.sibling}function sc(n){for(n=n.child;n!==null;){var s=n;switch(s.tag){case 0:case 11:case 14:case 15:Ll(4,s,s.return),sc(s);break;case 1:Yi(s,s.return);var u=s.stateNode;typeof u.componentWillUnmount=="function"&&W2(s,s.return,u),sc(s);break;case 27:I0(s.stateNode);case 26:case 5:Yi(s,s.return),sc(s);break;case 22:s.memoizedState===null&&sc(s);break;case 30:sc(s);break;default:sc(s)}n=n.sibling}}function Is(n,s,u){for(u=u&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var h=s.alternate,x=n,E=s,b=E.flags;switch(E.tag){case 0:case 11:case 15:Is(x,E,u),S0(4,E);break;case 1:if(Is(x,E,u),h=E,x=h.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(oe){kt(h,h.return,oe)}if(h=E,x=h.updateQueue,x!==null){var I=h.stateNode;try{var Z=x.shared.hiddenCallbacks;if(Z!==null)for(x.shared.hiddenCallbacks=null,x=0;x<Z.length;x++)LT(Z[x],I)}catch(oe){kt(h,h.return,oe)}}u&&b&64&&q2(E),b0(E,E.return);break;case 27:Q2(E);case 26:case 5:Is(x,E,u),u&&h===null&&b&4&&K2(E),b0(E,E.return);break;case 12:Is(x,E,u);break;case 31:Is(x,E,u),u&&b&4&&rS(x,E);break;case 13:Is(x,E,u),u&&b&4&&aS(x,E);break;case 22:E.memoizedState===null&&Is(x,E,u),b0(E,E.return);break;case 30:break;default:Is(x,E,u)}s=s.sibling}}function n_(n,s){var u=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(u=n.memoizedState.cachePool.pool),n=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),n!==u&&(n!=null&&n.refCount++,u!=null&&f0(u))}function i_(n,s){n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&f0(n))}function xi(n,s,u,h){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)sS(n,s,u,h),s=s.sibling}function sS(n,s,u,h){var x=s.flags;switch(s.tag){case 0:case 11:case 15:xi(n,s,u,h),x&2048&&S0(9,s);break;case 1:xi(n,s,u,h);break;case 3:xi(n,s,u,h),x&2048&&(n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&f0(n)));break;case 12:if(x&2048){xi(n,s,u,h),n=s.stateNode;try{var E=s.memoizedProps,b=E.id,I=E.onPostCommit;typeof I=="function"&&I(b,s.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(Z){kt(s,s.return,Z)}}else xi(n,s,u,h);break;case 31:xi(n,s,u,h);break;case 13:xi(n,s,u,h);break;case 23:break;case 22:E=s.stateNode,b=s.alternate,s.memoizedState!==null?E._visibility&2?xi(n,s,u,h):w0(n,s):E._visibility&2?xi(n,s,u,h):(E._visibility|=2,of(n,s,u,h,(s.subtreeFlags&10256)!==0||!1)),x&2048&&n_(b,s);break;case 24:xi(n,s,u,h),x&2048&&i_(s.alternate,s);break;default:xi(n,s,u,h)}}function of(n,s,u,h,x){for(x=x&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var E=n,b=s,I=u,Z=h,oe=b.flags;switch(b.tag){case 0:case 11:case 15:of(E,b,I,Z,x),S0(8,b);break;case 23:break;case 22:var ve=b.stateNode;b.memoizedState!==null?ve._visibility&2?of(E,b,I,Z,x):w0(E,b):(ve._visibility|=2,of(E,b,I,Z,x)),x&&oe&2048&&n_(b.alternate,b);break;case 24:of(E,b,I,Z,x),x&&oe&2048&&i_(b.alternate,b);break;default:of(E,b,I,Z,x)}s=s.sibling}}function w0(n,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var u=n,h=s,x=h.flags;switch(h.tag){case 22:w0(u,h),x&2048&&n_(h.alternate,h);break;case 24:w0(u,h),x&2048&&i_(h.alternate,h);break;default:w0(u,h)}s=s.sibling}}var C0=8192;function cf(n,s,u){if(n.subtreeFlags&C0)for(n=n.child;n!==null;)lS(n,s,u),n=n.sibling}function lS(n,s,u){switch(n.tag){case 26:cf(n,s,u),n.flags&C0&&n.memoizedState!==null&&lN(u,mi,n.memoizedState,n.memoizedProps);break;case 5:cf(n,s,u);break;case 3:case 4:var h=mi;mi=y1(n.stateNode.containerInfo),cf(n,s,u),mi=h;break;case 22:n.memoizedState===null&&(h=n.alternate,h!==null&&h.memoizedState!==null?(h=C0,C0=16777216,cf(n,s,u),C0=h):cf(n,s,u));break;default:cf(n,s,u)}}function oS(n){var s=n.alternate;if(s!==null&&(n=s.child,n!==null)){s.child=null;do s=n.sibling,n.sibling=null,n=s;while(n!==null)}}function R0(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var u=0;u<s.length;u++){var h=s[u];Hr=h,uS(h,n)}oS(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)cS(n),n=n.sibling}function cS(n){switch(n.tag){case 0:case 11:case 15:R0(n),n.flags&2048&&Ll(9,n,n.return);break;case 3:R0(n);break;case 12:R0(n);break;case 22:var s=n.stateNode;n.memoizedState!==null&&s._visibility&2&&(n.return===null||n.return.tag!==13)?(s._visibility&=-3,c1(n)):R0(n);break;default:R0(n)}}function c1(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var u=0;u<s.length;u++){var h=s[u];Hr=h,uS(h,n)}oS(n)}for(n=n.child;n!==null;){switch(s=n,s.tag){case 0:case 11:case 15:Ll(8,s,s.return),c1(s);break;case 22:u=s.stateNode,u._visibility&2&&(u._visibility&=-3,c1(s));break;default:c1(s)}n=n.sibling}}function uS(n,s){for(;Hr!==null;){var u=Hr;switch(u.tag){case 0:case 11:case 15:Ll(8,u,s);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var h=u.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:f0(u.memoizedState.cache)}if(h=u.child,h!==null)h.return=u,Hr=h;else e:for(u=n;Hr!==null;){h=Hr;var x=h.sibling,E=h.return;if(eS(h),h===u){Hr=null;break e}if(x!==null){x.return=E,Hr=x;break e}Hr=E}}}var y3={getCacheForType:function(n){var s=$r(Er),u=s.data.get(n);return u===void 0&&(u=n(),s.data.set(n,u)),u},cacheSignal:function(){return $r(Er).controller.signal}},T3=typeof WeakMap=="function"?WeakMap:Map,wt=0,Bt=null,ft=null,dt=0,Rt=0,pn=null,Pl=!1,uf=!1,s_=!1,Fs=0,or=0,Bl=0,lc=0,l_=0,gn=0,ff=0,k0=null,Za=null,o_=!1,u1=0,fS=0,f1=1/0,h1=null,Ul=null,Or=0,Hl=null,hf=null,Ls=0,c_=0,u_=null,hS=null,O0=0,f_=null;function mn(){return(wt&2)!==0&&dt!==0?dt&-dt:G.T!==null?x_():M()}function dS(){if(gn===0)if((dt&536870912)===0||gt){var n=Lu;Lu<<=1,(Lu&3932160)===0&&(Lu=262144),gn=n}else gn=536870912;return n=hn.current,n!==null&&(n.flags|=32),gn}function Ja(n,s,u){(n===Bt&&(Rt===2||Rt===9)||n.cancelPendingCommit!==null)&&(df(n,0),zl(n,dt,gn,!1)),jo(n,u),((wt&2)===0||n!==Bt)&&(n===Bt&&((wt&2)===0&&(lc|=u),or===4&&zl(n,dt,gn,!1)),Xi(n))}function pS(n,s,u){if((wt&6)!==0)throw Error(a(327));var h=!u&&(s&127)===0&&(s&n.expiredLanes)===0||Vo(n,s),x=h?w3(n,s):d_(n,s,!0),E=h;do{if(x===0){uf&&!h&&zl(n,s,0,!1);break}else{if(u=n.current.alternate,E&&!S3(u)){x=d_(n,s,!1),E=!1;continue}if(x===2){if(E=s,n.errorRecoveryDisabledLanes&E)var b=0;else b=n.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){s=b;e:{var I=n;x=k0;var Z=I.current.memoizedState.isDehydrated;if(Z&&(df(I,b).flags|=256),b=d_(I,b,!1),b!==2){if(s_&&!Z){I.errorRecoveryDisabledLanes|=E,lc|=E,x=4;break e}E=Za,Za=x,E!==null&&(Za===null?Za=E:Za.push.apply(Za,E))}x=b}if(E=!1,x!==2)continue}}if(x===1){df(n,0),zl(n,s,0,!0);break}e:{switch(h=n,E=x,E){case 0:case 1:throw Error(a(345));case 4:if((s&4194048)!==s)break;case 6:zl(h,s,gn,!Pl);break e;case 2:Za=null;break;case 3:case 5:break;default:throw Error(a(329))}if((s&62914560)===s&&(x=u1+300-Pt(),10<x)){if(zl(h,s,gn,!Pl),Bu(h,0,!0)!==0)break e;Ls=s,h.timeoutHandle=YS(gS.bind(null,h,u,Za,h1,o_,s,gn,lc,ff,Pl,E,"Throttled",-0,0),x);break e}gS(h,u,Za,h1,o_,s,gn,lc,ff,Pl,E,null,-0,0)}}break}while(!0);Xi(n)}function gS(n,s,u,h,x,E,b,I,Z,oe,ve,Te,he,pe){if(n.timeoutHandle=-1,Te=s.subtreeFlags,Te&8192||(Te&16785408)===16785408){Te={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:As},lS(s,E,Te);var Be=(E&62914560)===E?u1-Pt():(E&4194048)===E?fS-Pt():0;if(Be=oN(Te,Be),Be!==null){Ls=E,n.cancelPendingCommit=Be(TS.bind(null,n,s,E,u,h,x,b,I,Z,ve,Te,null,he,pe)),zl(n,E,b,!oe);return}}TS(n,s,E,u,h,x,b,I,Z)}function S3(n){for(var s=n;;){var u=s.tag;if((u===0||u===11||u===15)&&s.flags&16384&&(u=s.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var h=0;h<u.length;h++){var x=u[h],E=x.getSnapshot;x=x.value;try{if(!un(E(),x))return!1}catch{return!1}}if(u=s.child,s.subtreeFlags&16384&&u!==null)u.return=s,s=u;else{if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function zl(n,s,u,h){s&=~l_,s&=~lc,n.suspendedLanes|=s,n.pingedLanes&=~s,h&&(n.warmLanes|=s),h=n.expirationTimes;for(var x=s;0<x;){var E=31-Ca(x),b=1<<E;h[E]=-1,x&=~b}u!==0&&yg(n,u,s)}function d1(){return(wt&6)===0?(D0(0),!1):!0}function h_(){if(ft!==null){if(Rt===0)var n=ft.return;else n=ft,bs=Zo=null,Rv(n),rf=null,d0=0,n=ft;for(;n!==null;)X2(n.alternate,n),n=n.return;ft=null}}function df(n,s){var u=n.timeoutHandle;u!==-1&&(n.timeoutHandle=-1,j3(u)),u=n.cancelPendingCommit,u!==null&&(n.cancelPendingCommit=null,u()),Ls=0,h_(),Bt=n,ft=u=Ts(n.current,null),dt=s,Rt=0,pn=null,Pl=!1,uf=Vo(n,s),s_=!1,ff=gn=l_=lc=Bl=or=0,Za=k0=null,o_=!1,(s&8)!==0&&(s|=s&32);var h=n.entangledLanes;if(h!==0)for(n=n.entanglements,h&=s;0<h;){var x=31-Ca(h),E=1<<x;s|=n[x],h&=~E}return Fs=s,Ig(),u}function mS(n,s){Ze=null,G.H=A0,s===tf||s===Gg?(s=NT(),Rt=3):s===mv?(s=NT(),Rt=4):Rt=s===jv?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,pn=s,ft===null&&(or=1,r1(n,Gn(s,n.current)))}function xS(){var n=hn.current;return n===null?!0:(dt&4194048)===dt?Xn===null:(dt&62914560)===dt||(dt&536870912)!==0?n===Xn:!1}function vS(){var n=G.H;return G.H=A0,n===null?A0:n}function _S(){var n=G.A;return G.A=y3,n}function p1(){or=4,Pl||(dt&4194048)!==dt&&hn.current!==null||(uf=!0),(Bl&134217727)===0&&(lc&134217727)===0||Bt===null||zl(Bt,dt,gn,!1)}function d_(n,s,u){var h=wt;wt|=2;var x=vS(),E=_S();(Bt!==n||dt!==s)&&(h1=null,df(n,s)),s=!1;var b=or;e:do try{if(Rt!==0&&ft!==null){var I=ft,Z=pn;switch(Rt){case 8:h_(),b=6;break e;case 3:case 2:case 9:case 6:hn.current===null&&(s=!0);var oe=Rt;if(Rt=0,pn=null,pf(n,I,Z,oe),u&&uf){b=0;break e}break;default:oe=Rt,Rt=0,pn=null,pf(n,I,Z,oe)}}b3(),b=or;break}catch(ve){mS(n,ve)}while(!0);return s&&n.shellSuspendCounter++,bs=Zo=null,wt=h,G.H=x,G.A=E,ft===null&&(Bt=null,dt=0,Ig()),b}function b3(){for(;ft!==null;)ES(ft)}function w3(n,s){var u=wt;wt|=2;var h=vS(),x=_S();Bt!==n||dt!==s?(h1=null,f1=Pt()+500,df(n,s)):uf=Vo(n,s);e:do try{if(Rt!==0&&ft!==null){s=ft;var E=pn;t:switch(Rt){case 1:Rt=0,pn=null,pf(n,s,E,1);break;case 2:case 9:if(OT(E)){Rt=0,pn=null,AS(s);break}s=function(){Rt!==2&&Rt!==9||Bt!==n||(Rt=7),Xi(n)},E.then(s,s);break e;case 3:Rt=7;break e;case 4:Rt=5;break e;case 7:OT(E)?(Rt=0,pn=null,AS(s)):(Rt=0,pn=null,pf(n,s,E,7));break;case 5:var b=null;switch(ft.tag){case 26:b=ft.memoizedState;case 5:case 27:var I=ft;if(b?sb(b):I.stateNode.complete){Rt=0,pn=null;var Z=I.sibling;if(Z!==null)ft=Z;else{var oe=I.return;oe!==null?(ft=oe,g1(oe)):ft=null}break t}}Rt=0,pn=null,pf(n,s,E,5);break;case 6:Rt=0,pn=null,pf(n,s,E,6);break;case 8:h_(),or=6;break e;default:throw Error(a(462))}}C3();break}catch(ve){mS(n,ve)}while(!0);return bs=Zo=null,G.H=h,G.A=x,wt=u,ft!==null?0:(Bt=null,dt=0,Ig(),or)}function C3(){for(;ft!==null&&!zo();)ES(ft)}function ES(n){var s=j2(n.alternate,n,Fs);n.memoizedProps=n.pendingProps,s===null?g1(n):ft=s}function AS(n){var s=n,u=s.alternate;switch(s.tag){case 15:case 0:s=B2(u,s,s.pendingProps,s.type,void 0,dt);break;case 11:s=B2(u,s,s.pendingProps,s.type.render,s.ref,dt);break;case 5:Rv(s);default:X2(u,s),s=ft=_T(s,Fs),s=j2(u,s,Fs)}n.memoizedProps=n.pendingProps,s===null?g1(n):ft=s}function pf(n,s,u,h){bs=Zo=null,Rv(s),rf=null,d0=0;var x=s.return;try{if(g3(n,x,s,u,dt)){or=1,r1(n,Gn(u,n.current)),ft=null;return}}catch(E){if(x!==null)throw ft=x,E;or=1,r1(n,Gn(u,n.current)),ft=null;return}s.flags&32768?(gt||h===1?n=!0:uf||(dt&536870912)!==0?n=!1:(Pl=n=!0,(h===2||h===9||h===3||h===6)&&(h=hn.current,h!==null&&h.tag===13&&(h.flags|=16384))),yS(s,n)):g1(s)}function g1(n){var s=n;do{if((s.flags&32768)!==0){yS(s,Pl);return}n=s.return;var u=v3(s.alternate,s,Fs);if(u!==null){ft=u;return}if(s=s.sibling,s!==null){ft=s;return}ft=s=n}while(s!==null);or===0&&(or=5)}function yS(n,s){do{var u=_3(n.alternate,n);if(u!==null){u.flags&=32767,ft=u;return}if(u=n.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!s&&(n=n.sibling,n!==null)){ft=n;return}ft=n=u}while(n!==null);or=6,ft=null}function TS(n,s,u,h,x,E,b,I,Z){n.cancelPendingCommit=null;do m1();while(Or!==0);if((wt&6)!==0)throw Error(a(327));if(s!==null){if(s===n.current)throw Error(a(177));if(E=s.lanes|s.childLanes,E|=tv,Mx(n,u,E,b,I,Z),n===Bt&&(ft=Bt=null,dt=0),hf=s,Hl=n,Ls=u,c_=E,u_=x,hS=h,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,D3(_r,function(){return RS(),null})):(n.callbackNode=null,n.callbackPriority=0),h=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||h){h=G.T,G.T=null,x=te.p,te.p=2,b=wt,wt|=4;try{E3(n,s,u)}finally{wt=b,te.p=x,G.T=h}}Or=1,SS(),bS(),wS()}}function SS(){if(Or===1){Or=0;var n=Hl,s=hf,u=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||u){u=G.T,G.T=null;var h=te.p;te.p=2;var x=wt;wt|=4;try{nS(s,n);var E=b_,b=uT(n.containerInfo),I=E.focusedElem,Z=E.selectionRange;if(b!==I&&I&&I.ownerDocument&&cT(I.ownerDocument.documentElement,I)){if(Z!==null&&$x(I)){var oe=Z.start,ve=Z.end;if(ve===void 0&&(ve=oe),"selectionStart"in I)I.selectionStart=oe,I.selectionEnd=Math.min(ve,I.value.length);else{var Te=I.ownerDocument||document,he=Te&&Te.defaultView||window;if(he.getSelection){var pe=he.getSelection(),Be=I.textContent.length,Ye=Math.min(Z.start,Be),It=Z.end===void 0?Ye:Math.min(Z.end,Be);!pe.extend&&Ye>It&&(b=It,It=Ye,Ye=b);var ne=oT(I,Ye),re=oT(I,It);if(ne&&re&&(pe.rangeCount!==1||pe.anchorNode!==ne.node||pe.anchorOffset!==ne.offset||pe.focusNode!==re.node||pe.focusOffset!==re.offset)){var le=Te.createRange();le.setStart(ne.node,ne.offset),pe.removeAllRanges(),Ye>It?(pe.addRange(le),pe.extend(re.node,re.offset)):(le.setEnd(re.node,re.offset),pe.addRange(le))}}}}for(Te=[],pe=I;pe=pe.parentNode;)pe.nodeType===1&&Te.push({element:pe,left:pe.scrollLeft,top:pe.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<Te.length;I++){var Ae=Te[I];Ae.element.scrollLeft=Ae.left,Ae.element.scrollTop=Ae.top}}R1=!!S_,b_=S_=null}finally{wt=x,te.p=h,G.T=u}}n.current=s,Or=2}}function bS(){if(Or===2){Or=0;var n=Hl,s=hf,u=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||u){u=G.T,G.T=null;var h=te.p;te.p=2;var x=wt;wt|=4;try{J2(n,s.alternate,s)}finally{wt=x,te.p=h,G.T=u}}Or=3}}function wS(){if(Or===4||Or===3){Or=0,zi();var n=Hl,s=hf,u=Ls,h=hS;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Or=5:(Or=0,hf=Hl=null,CS(n,n.pendingLanes));var x=n.pendingLanes;if(x===0&&(Ul=null),Zh(u),s=s.stateNode,hr&&typeof hr.onCommitFiberRoot=="function")try{hr.onCommitFiberRoot(jt,s,void 0,(s.current.flags&128)===128)}catch{}if(h!==null){s=G.T,x=te.p,te.p=2,G.T=null;try{for(var E=n.onRecoverableError,b=0;b<h.length;b++){var I=h[b];E(I.value,{componentStack:I.stack})}}finally{G.T=s,te.p=x}}(Ls&3)!==0&&m1(),Xi(n),x=n.pendingLanes,(u&261930)!==0&&(x&42)!==0?n===f_?O0++:(O0=0,f_=n):O0=0,D0(0)}}function CS(n,s){(n.pooledCacheLanes&=s)===0&&(s=n.pooledCache,s!=null&&(n.pooledCache=null,f0(s)))}function m1(){return SS(),bS(),wS(),RS()}function RS(){if(Or!==5)return!1;var n=Hl,s=c_;c_=0;var u=Zh(Ls),h=G.T,x=te.p;try{te.p=32>u?32:u,G.T=null,u=u_,u_=null;var E=Hl,b=Ls;if(Or=0,hf=Hl=null,Ls=0,(wt&6)!==0)throw Error(a(331));var I=wt;if(wt|=4,cS(E.current),sS(E,E.current,b,u),wt=I,D0(0,!1),hr&&typeof hr.onPostCommitFiberRoot=="function")try{hr.onPostCommitFiberRoot(jt,E)}catch{}return!0}finally{te.p=x,G.T=h,CS(n,s)}}function kS(n,s,u){s=Gn(u,s),s=Vv(n.stateNode,s,2),n=Ml(n,s,2),n!==null&&(jo(n,2),Xi(n))}function kt(n,s,u){if(n.tag===3)kS(n,n,u);else for(;s!==null;){if(s.tag===3){kS(s,n,u);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Ul===null||!Ul.has(h))){n=Gn(u,n),u=O2(2),h=Ml(s,u,2),h!==null&&(D2(u,h,s,n),jo(h,2),Xi(h));break}}s=s.return}}function p_(n,s,u){var h=n.pingCache;if(h===null){h=n.pingCache=new T3;var x=new Set;h.set(s,x)}else x=h.get(s),x===void 0&&(x=new Set,h.set(s,x));x.has(u)||(s_=!0,x.add(u),n=R3.bind(null,n,s,u),s.then(n,n))}function R3(n,s,u){var h=n.pingCache;h!==null&&h.delete(s),n.pingedLanes|=n.suspendedLanes&u,n.warmLanes&=~u,Bt===n&&(dt&u)===u&&(or===4||or===3&&(dt&62914560)===dt&&300>Pt()-u1?(wt&2)===0&&df(n,0):l_|=u,ff===dt&&(ff=0)),Xi(n)}function OS(n,s){s===0&&(s=Ag()),n=Ko(n,s),n!==null&&(jo(n,s),Xi(n))}function k3(n){var s=n.memoizedState,u=0;s!==null&&(u=s.retryLane),OS(n,u)}function O3(n,s){var u=0;switch(n.tag){case 31:case 13:var h=n.stateNode,x=n.memoizedState;x!==null&&(u=x.retryLane);break;case 19:h=n.stateNode;break;case 22:h=n.stateNode._retryCache;break;default:throw Error(a(314))}h!==null&&h.delete(s),OS(n,u)}function D3(n,s){return Ya(n,s)}var x1=null,gf=null,g_=!1,v1=!1,m_=!1,Gl=0;function Xi(n){n!==gf&&n.next===null&&(gf===null?x1=gf=n:gf=gf.next=n),v1=!0,g_||(g_=!0,M3())}function D0(n,s){if(!m_&&v1){m_=!0;do for(var u=!1,h=x1;h!==null;){if(n!==0){var x=h.pendingLanes;if(x===0)var E=0;else{var b=h.suspendedLanes,I=h.pingedLanes;E=(1<<31-Ca(42|n)+1)-1,E&=x&~(b&~I),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(u=!0,IS(h,E))}else E=dt,E=Bu(h,h===Bt?E:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(E&3)===0||Vo(h,E)||(u=!0,IS(h,E));h=h.next}while(u);m_=!1}}function N3(){DS()}function DS(){v1=g_=!1;var n=0;Gl!==0&&V3()&&(n=Gl);for(var s=Pt(),u=null,h=x1;h!==null;){var x=h.next,E=NS(h,s);E===0?(h.next=null,u===null?x1=x:u.next=x,x===null&&(gf=u)):(u=h,(n!==0||(E&3)!==0)&&(v1=!0)),h=x}Or!==0&&Or!==5||D0(n),Gl!==0&&(Gl=0)}function NS(n,s){for(var u=n.suspendedLanes,h=n.pingedLanes,x=n.expirationTimes,E=n.pendingLanes&-62914561;0<E;){var b=31-Ca(E),I=1<<b,Z=x[b];Z===-1?((I&u)===0||(I&h)!==0)&&(x[b]=Nx(I,s)):Z<=s&&(n.expiredLanes|=I),E&=~I}if(s=Bt,u=dt,u=Bu(n,n===s?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),h=n.callbackNode,u===0||n===s&&(Rt===2||Rt===9)||n.cancelPendingCommit!==null)return h!==null&&h!==null&&cn(h),n.callbackNode=null,n.callbackPriority=0;if((u&3)===0||Vo(n,u)){if(s=u&-u,s===n.callbackPriority)return s;switch(h!==null&&cn(h),Zh(u)){case 2:case 8:u=Sl;break;case 32:u=_r;break;case 268435456:u=rt;break;default:u=_r}return h=MS.bind(null,n),u=Ya(u,h),n.callbackPriority=s,n.callbackNode=u,s}return h!==null&&h!==null&&cn(h),n.callbackPriority=2,n.callbackNode=null,2}function MS(n,s){if(Or!==0&&Or!==5)return n.callbackNode=null,n.callbackPriority=0,null;var u=n.callbackNode;if(m1()&&n.callbackNode!==u)return null;var h=dt;return h=Bu(n,n===Bt?h:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),h===0?null:(pS(n,h,s),NS(n,Pt()),n.callbackNode!=null&&n.callbackNode===u?MS.bind(null,n):null)}function IS(n,s){if(m1())return null;pS(n,s,!0)}function M3(){Y3(function(){(wt&6)!==0?Ya(di,N3):DS()})}function x_(){if(Gl===0){var n=Ju;n===0&&(n=Go,Go<<=1,(Go&261888)===0&&(Go=256)),Gl=n}return Gl}function FS(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:wg(""+n)}function LS(n,s){var u=s.ownerDocument.createElement("input");return u.name=s.name,u.value=s.value,n.id&&u.setAttribute("form",n.id),s.parentNode.insertBefore(u,s),n=new FormData(n),u.parentNode.removeChild(u),n}function I3(n,s,u,h,x){if(s==="submit"&&u&&u.stateNode===x){var E=FS((x[H]||null).action),b=h.submitter;b&&(s=(s=b[H]||null)?FS(s.formAction):b.getAttribute("formAction"),s!==null&&(E=s,b=null));var I=new Og("action","action",null,h,x);n.push({event:I,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Gl!==0){var Z=b?LS(x,b):new FormData(x);Pv(u,{pending:!0,data:Z,method:x.method,action:E},null,Z)}}else typeof E=="function"&&(I.preventDefault(),Z=b?LS(x,b):new FormData(x),Pv(u,{pending:!0,data:Z,method:x.method,action:E},E,Z))},currentTarget:x}]})}}for(var v_=0;v_<ev.length;v_++){var __=ev[v_],F3=__.toLowerCase(),L3=__[0].toUpperCase()+__.slice(1);gi(F3,"on"+L3)}gi(dT,"onAnimationEnd"),gi(pT,"onAnimationIteration"),gi(gT,"onAnimationStart"),gi("dblclick","onDoubleClick"),gi("focusin","onFocus"),gi("focusout","onBlur"),gi(ZD,"onTransitionRun"),gi(JD,"onTransitionStart"),gi(e3,"onTransitionCancel"),gi(mT,"onTransitionEnd"),Bn("onMouseEnter",["mouseout","mouseover"]),Bn("onMouseLeave",["mouseout","mouseover"]),Bn("onPointerEnter",["pointerout","pointerover"]),Bn("onPointerLeave",["pointerout","pointerover"]),$t("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$t("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$t("onBeforeInput",["compositionend","keypress","textInput","paste"]),$t("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$t("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$t("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var N0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),P3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(N0));function PS(n,s){s=(s&4)!==0;for(var u=0;u<n.length;u++){var h=n[u],x=h.event;h=h.listeners;e:{var E=void 0;if(s)for(var b=h.length-1;0<=b;b--){var I=h[b],Z=I.instance,oe=I.currentTarget;if(I=I.listener,Z!==E&&x.isPropagationStopped())break e;E=I,x.currentTarget=oe;try{E(x)}catch(ve){Mg(ve)}x.currentTarget=null,E=Z}else for(b=0;b<h.length;b++){if(I=h[b],Z=I.instance,oe=I.currentTarget,I=I.listener,Z!==E&&x.isPropagationStopped())break e;E=I,x.currentTarget=oe;try{E(x)}catch(ve){Mg(ve)}x.currentTarget=null,E=Z}}}}function ht(n,s){var u=s[ce];u===void 0&&(u=s[ce]=new Set);var h=n+"__bubble";u.has(h)||(BS(s,n,2,!1),u.add(h))}function E_(n,s,u){var h=0;s&&(h|=4),BS(u,n,h,s)}var _1="_reactListening"+Math.random().toString(36).slice(2);function A_(n){if(!n[_1]){n[_1]=!0,Ht.forEach(function(u){u!=="selectionchange"&&(P3.has(u)||E_(u,!1,n),E_(u,!0,n))});var s=n.nodeType===9?n:n.ownerDocument;s===null||s[_1]||(s[_1]=!0,E_("selectionchange",!1,s))}}function BS(n,s,u,h){switch(db(s)){case 2:var x=fN;break;case 8:x=hN;break;default:x=L_}u=x.bind(null,s,u,n),x=void 0,!zx||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(x=!0),h?x!==void 0?n.addEventListener(s,u,{capture:!0,passive:x}):n.addEventListener(s,u,!0):x!==void 0?n.addEventListener(s,u,{passive:x}):n.addEventListener(s,u,!1)}function y_(n,s,u,h,x){var E=h;if((s&1)===0&&(s&2)===0&&h!==null)e:for(;;){if(h===null)return;var b=h.tag;if(b===3||b===4){var I=h.stateNode.containerInfo;if(I===x)break;if(b===4)for(b=h.return;b!==null;){var Z=b.tag;if((Z===3||Z===4)&&b.stateNode.containerInfo===x)return;b=b.return}for(;I!==null;){if(b=De(I),b===null)return;if(Z=b.tag,Z===5||Z===6||Z===26||Z===27){h=E=b;continue e}I=I.parentNode}}h=h.return}Vy(function(){var oe=E,ve=Ux(u),Te=[];e:{var he=xT.get(n);if(he!==void 0){var pe=Og,Be=n;switch(n){case"keypress":if(Rg(u)===0)break e;case"keydown":case"keyup":pe=OD;break;case"focusin":Be="focus",pe=Yx;break;case"focusout":Be="blur",pe=Yx;break;case"beforeblur":case"afterblur":pe=Yx;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=Xy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=vD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=MD;break;case dT:case pT:case gT:pe=AD;break;case mT:pe=FD;break;case"scroll":case"scrollend":pe=mD;break;case"wheel":pe=PD;break;case"copy":case"cut":case"paste":pe=TD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=Wy;break;case"toggle":case"beforetoggle":pe=UD}var Ye=(s&4)!==0,It=!Ye&&(n==="scroll"||n==="scrollend"),ne=Ye?he!==null?he+"Capture":null:he;Ye=[];for(var re=oe,le;re!==null;){var Ae=re;if(le=Ae.stateNode,Ae=Ae.tag,Ae!==5&&Ae!==26&&Ae!==27||le===null||ne===null||(Ae=e0(re,ne),Ae!=null&&Ye.push(M0(re,Ae,le))),It)break;re=re.return}0<Ye.length&&(he=new pe(he,Be,null,u,ve),Te.push({event:he,listeners:Ye}))}}if((s&7)===0){e:{if(he=n==="mouseover"||n==="pointerover",pe=n==="mouseout"||n==="pointerout",he&&u!==Bx&&(Be=u.relatedTarget||u.fromElement)&&(De(Be)||Be[V]))break e;if((pe||he)&&(he=ve.window===ve?ve:(he=ve.ownerDocument)?he.defaultView||he.parentWindow:window,pe?(Be=u.relatedTarget||u.toElement,pe=oe,Be=Be?De(Be):null,Be!==null&&(It=l(Be),Ye=Be.tag,Be!==It||Ye!==5&&Ye!==27&&Ye!==6)&&(Be=null)):(pe=null,Be=oe),pe!==Be)){if(Ye=Xy,Ae="onMouseLeave",ne="onMouseEnter",re="mouse",(n==="pointerout"||n==="pointerover")&&(Ye=Wy,Ae="onPointerLeave",ne="onPointerEnter",re="pointer"),It=pe==null?he:Re(pe),le=Be==null?he:Re(Be),he=new Ye(Ae,re+"leave",pe,u,ve),he.target=It,he.relatedTarget=le,Ae=null,De(ve)===oe&&(Ye=new Ye(ne,re+"enter",Be,u,ve),Ye.target=le,Ye.relatedTarget=It,Ae=Ye),It=Ae,pe&&Be)t:{for(Ye=B3,ne=pe,re=Be,le=0,Ae=ne;Ae;Ae=Ye(Ae))le++;Ae=0;for(var je=re;je;je=Ye(je))Ae++;for(;0<le-Ae;)ne=Ye(ne),le--;for(;0<Ae-le;)re=Ye(re),Ae--;for(;le--;){if(ne===re||re!==null&&ne===re.alternate){Ye=ne;break t}ne=Ye(ne),re=Ye(re)}Ye=null}else Ye=null;pe!==null&&US(Te,he,pe,Ye,!1),Be!==null&&It!==null&&US(Te,It,Be,Ye,!0)}}e:{if(he=oe?Re(oe):window,pe=he.nodeName&&he.nodeName.toLowerCase(),pe==="select"||pe==="input"&&he.type==="file")var yt=rT;else if(eT(he))if(aT)yt=KD;else{yt=qD;var ze=XD}else pe=he.nodeName,!pe||pe.toLowerCase()!=="input"||he.type!=="checkbox"&&he.type!=="radio"?oe&&Px(oe.elementType)&&(yt=rT):yt=WD;if(yt&&(yt=yt(n,oe))){tT(Te,yt,u,ve);break e}ze&&ze(n,he,oe),n==="focusout"&&oe&&he.type==="number"&&oe.memoizedProps.value!=null&&Lx(he,"number",he.value)}switch(ze=oe?Re(oe):window,n){case"focusin":(eT(ze)||ze.contentEditable==="true")&&(Yu=ze,Qx=oe,o0=null);break;case"focusout":o0=Qx=Yu=null;break;case"mousedown":Zx=!0;break;case"contextmenu":case"mouseup":case"dragend":Zx=!1,fT(Te,u,ve);break;case"selectionchange":if(QD)break;case"keydown":case"keyup":fT(Te,u,ve)}var at;if(qx)e:{switch(n){case"compositionstart":var pt="onCompositionStart";break e;case"compositionend":pt="onCompositionEnd";break e;case"compositionupdate":pt="onCompositionUpdate";break e}pt=void 0}else ju?Zy(n,u)&&(pt="onCompositionEnd"):n==="keydown"&&u.keyCode===229&&(pt="onCompositionStart");pt&&(Ky&&u.locale!=="ko"&&(ju||pt!=="onCompositionStart"?pt==="onCompositionEnd"&&ju&&(at=jy()):(wl=ve,Gx="value"in wl?wl.value:wl.textContent,ju=!0)),ze=E1(oe,pt),0<ze.length&&(pt=new qy(pt,n,null,u,ve),Te.push({event:pt,listeners:ze}),at?pt.data=at:(at=Jy(u),at!==null&&(pt.data=at)))),(at=zD?GD(n,u):VD(n,u))&&(pt=E1(oe,"onBeforeInput"),0<pt.length&&(ze=new qy("onBeforeInput","beforeinput",null,u,ve),Te.push({event:ze,listeners:pt}),ze.data=at)),I3(Te,n,oe,u,ve)}PS(Te,s)})}function M0(n,s,u){return{instance:n,listener:s,currentTarget:u}}function E1(n,s){for(var u=s+"Capture",h=[];n!==null;){var x=n,E=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||E===null||(x=e0(n,u),x!=null&&h.unshift(M0(n,x,E)),x=e0(n,s),x!=null&&h.push(M0(n,x,E))),n.tag===3)return h;n=n.return}return[]}function B3(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function US(n,s,u,h,x){for(var E=s._reactName,b=[];u!==null&&u!==h;){var I=u,Z=I.alternate,oe=I.stateNode;if(I=I.tag,Z!==null&&Z===h)break;I!==5&&I!==26&&I!==27||oe===null||(Z=oe,x?(oe=e0(u,E),oe!=null&&b.unshift(M0(u,oe,Z))):x||(oe=e0(u,E),oe!=null&&b.push(M0(u,oe,Z)))),u=u.return}b.length!==0&&n.push({event:s,listeners:b})}var U3=/\r\n?/g,H3=/\u0000|\uFFFD/g;function HS(n){return(typeof n=="string"?n:""+n).replace(U3,`
`).replace(H3,"")}function zS(n,s){return s=HS(s),HS(n)===s}function Mt(n,s,u,h,x,E){switch(u){case"children":typeof h=="string"?s==="body"||s==="textarea"&&h===""||zu(n,h):(typeof h=="number"||typeof h=="bigint")&&s!=="body"&&zu(n,""+h);break;case"className":Sg(n,"class",h);break;case"tabIndex":Sg(n,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Sg(n,u,h);break;case"style":zy(n,h,E);break;case"data":if(s!=="object"){Sg(n,"data",h);break}case"src":case"href":if(h===""&&(s!=="a"||u!=="href")){n.removeAttribute(u);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){n.removeAttribute(u);break}h=wg(""+h),n.setAttribute(u,h);break;case"action":case"formAction":if(typeof h=="function"){n.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(u==="formAction"?(s!=="input"&&Mt(n,s,"name",x.name,x,null),Mt(n,s,"formEncType",x.formEncType,x,null),Mt(n,s,"formMethod",x.formMethod,x,null),Mt(n,s,"formTarget",x.formTarget,x,null)):(Mt(n,s,"encType",x.encType,x,null),Mt(n,s,"method",x.method,x,null),Mt(n,s,"target",x.target,x,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){n.removeAttribute(u);break}h=wg(""+h),n.setAttribute(u,h);break;case"onClick":h!=null&&(n.onclick=As);break;case"onScroll":h!=null&&ht("scroll",n);break;case"onScrollEnd":h!=null&&ht("scrollend",n);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(a(61));if(u=h.__html,u!=null){if(x.children!=null)throw Error(a(60));n.innerHTML=u}}break;case"multiple":n.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":n.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){n.removeAttribute("xlink:href");break}u=wg(""+h),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(u,""+h):n.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(u,""):n.removeAttribute(u);break;case"capture":case"download":h===!0?n.setAttribute(u,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(u,h):n.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?n.setAttribute(u,h):n.removeAttribute(u);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?n.removeAttribute(u):n.setAttribute(u,h);break;case"popover":ht("beforetoggle",n),ht("toggle",n),qa(n,"popover",h);break;case"xlinkActuate":Es(n,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Es(n,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Es(n,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Es(n,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Es(n,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Es(n,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Es(n,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Es(n,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Es(n,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":qa(n,"is",h);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=pD.get(u)||u,qa(n,u,h))}}function T_(n,s,u,h,x,E){switch(u){case"style":zy(n,h,E);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(a(61));if(u=h.__html,u!=null){if(x.children!=null)throw Error(a(60));n.innerHTML=u}}break;case"children":typeof h=="string"?zu(n,h):(typeof h=="number"||typeof h=="bigint")&&zu(n,""+h);break;case"onScroll":h!=null&&ht("scroll",n);break;case"onScrollEnd":h!=null&&ht("scrollend",n);break;case"onClick":h!=null&&(n.onclick=As);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zt.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(x=u.endsWith("Capture"),s=u.slice(2,x?u.length-7:void 0),E=n[H]||null,E=E!=null?E[u]:null,typeof E=="function"&&n.removeEventListener(s,E,x),typeof h=="function")){typeof E!="function"&&E!==null&&(u in n?n[u]=null:n.hasAttribute(u)&&n.removeAttribute(u)),n.addEventListener(s,h,x);break e}u in n?n[u]=h:h===!0?n.setAttribute(u,""):qa(n,u,h)}}}function Zr(n,s,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ht("error",n),ht("load",n);var h=!1,x=!1,E;for(E in u)if(u.hasOwnProperty(E)){var b=u[E];if(b!=null)switch(E){case"src":h=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:Mt(n,s,E,b,u,null)}}x&&Mt(n,s,"srcSet",u.srcSet,u,null),h&&Mt(n,s,"src",u.src,u,null);return;case"input":ht("invalid",n);var I=E=b=x=null,Z=null,oe=null;for(h in u)if(u.hasOwnProperty(h)){var ve=u[h];if(ve!=null)switch(h){case"name":x=ve;break;case"type":b=ve;break;case"checked":Z=ve;break;case"defaultChecked":oe=ve;break;case"value":E=ve;break;case"defaultValue":I=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(a(137,s));break;default:Mt(n,s,h,ve,u,null)}}Py(n,E,I,Z,oe,b,x,!1);return;case"select":ht("invalid",n),h=b=E=null;for(x in u)if(u.hasOwnProperty(x)&&(I=u[x],I!=null))switch(x){case"value":E=I;break;case"defaultValue":b=I;break;case"multiple":h=I;default:Mt(n,s,x,I,u,null)}s=E,u=b,n.multiple=!!h,s!=null?Hu(n,!!h,s,!1):u!=null&&Hu(n,!!h,u,!0);return;case"textarea":ht("invalid",n),E=x=h=null;for(b in u)if(u.hasOwnProperty(b)&&(I=u[b],I!=null))switch(b){case"value":h=I;break;case"defaultValue":x=I;break;case"children":E=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(a(91));break;default:Mt(n,s,b,I,u,null)}Uy(n,h,x,E);return;case"option":for(Z in u)if(u.hasOwnProperty(Z)&&(h=u[Z],h!=null))switch(Z){case"selected":n.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Mt(n,s,Z,h,u,null)}return;case"dialog":ht("beforetoggle",n),ht("toggle",n),ht("cancel",n),ht("close",n);break;case"iframe":case"object":ht("load",n);break;case"video":case"audio":for(h=0;h<N0.length;h++)ht(N0[h],n);break;case"image":ht("error",n),ht("load",n);break;case"details":ht("toggle",n);break;case"embed":case"source":case"link":ht("error",n),ht("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(oe in u)if(u.hasOwnProperty(oe)&&(h=u[oe],h!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:Mt(n,s,oe,h,u,null)}return;default:if(Px(s)){for(ve in u)u.hasOwnProperty(ve)&&(h=u[ve],h!==void 0&&T_(n,s,ve,h,u,void 0));return}}for(I in u)u.hasOwnProperty(I)&&(h=u[I],h!=null&&Mt(n,s,I,h,u,null))}function z3(n,s,u,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,E=null,b=null,I=null,Z=null,oe=null,ve=null;for(pe in u){var Te=u[pe];if(u.hasOwnProperty(pe)&&Te!=null)switch(pe){case"checked":break;case"value":break;case"defaultValue":Z=Te;default:h.hasOwnProperty(pe)||Mt(n,s,pe,null,h,Te)}}for(var he in h){var pe=h[he];if(Te=u[he],h.hasOwnProperty(he)&&(pe!=null||Te!=null))switch(he){case"type":E=pe;break;case"name":x=pe;break;case"checked":oe=pe;break;case"defaultChecked":ve=pe;break;case"value":b=pe;break;case"defaultValue":I=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(a(137,s));break;default:pe!==Te&&Mt(n,s,he,pe,h,Te)}}Fx(n,b,I,Z,oe,ve,E,x);return;case"select":pe=b=I=he=null;for(E in u)if(Z=u[E],u.hasOwnProperty(E)&&Z!=null)switch(E){case"value":break;case"multiple":pe=Z;default:h.hasOwnProperty(E)||Mt(n,s,E,null,h,Z)}for(x in h)if(E=h[x],Z=u[x],h.hasOwnProperty(x)&&(E!=null||Z!=null))switch(x){case"value":he=E;break;case"defaultValue":I=E;break;case"multiple":b=E;default:E!==Z&&Mt(n,s,x,E,h,Z)}s=I,u=b,h=pe,he!=null?Hu(n,!!u,he,!1):!!h!=!!u&&(s!=null?Hu(n,!!u,s,!0):Hu(n,!!u,u?[]:"",!1));return;case"textarea":pe=he=null;for(I in u)if(x=u[I],u.hasOwnProperty(I)&&x!=null&&!h.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:Mt(n,s,I,null,h,x)}for(b in h)if(x=h[b],E=u[b],h.hasOwnProperty(b)&&(x!=null||E!=null))switch(b){case"value":he=x;break;case"defaultValue":pe=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(a(91));break;default:x!==E&&Mt(n,s,b,x,h,E)}By(n,he,pe);return;case"option":for(var Be in u)if(he=u[Be],u.hasOwnProperty(Be)&&he!=null&&!h.hasOwnProperty(Be))switch(Be){case"selected":n.selected=!1;break;default:Mt(n,s,Be,null,h,he)}for(Z in h)if(he=h[Z],pe=u[Z],h.hasOwnProperty(Z)&&he!==pe&&(he!=null||pe!=null))switch(Z){case"selected":n.selected=he&&typeof he!="function"&&typeof he!="symbol";break;default:Mt(n,s,Z,he,h,pe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ye in u)he=u[Ye],u.hasOwnProperty(Ye)&&he!=null&&!h.hasOwnProperty(Ye)&&Mt(n,s,Ye,null,h,he);for(oe in h)if(he=h[oe],pe=u[oe],h.hasOwnProperty(oe)&&he!==pe&&(he!=null||pe!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(a(137,s));break;default:Mt(n,s,oe,he,h,pe)}return;default:if(Px(s)){for(var It in u)he=u[It],u.hasOwnProperty(It)&&he!==void 0&&!h.hasOwnProperty(It)&&T_(n,s,It,void 0,h,he);for(ve in h)he=h[ve],pe=u[ve],!h.hasOwnProperty(ve)||he===pe||he===void 0&&pe===void 0||T_(n,s,ve,he,h,pe);return}}for(var ne in u)he=u[ne],u.hasOwnProperty(ne)&&he!=null&&!h.hasOwnProperty(ne)&&Mt(n,s,ne,null,h,he);for(Te in h)he=h[Te],pe=u[Te],!h.hasOwnProperty(Te)||he===pe||he==null&&pe==null||Mt(n,s,Te,he,h,pe)}function GS(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function G3(){if(typeof performance.getEntriesByType=="function"){for(var n=0,s=0,u=performance.getEntriesByType("resource"),h=0;h<u.length;h++){var x=u[h],E=x.transferSize,b=x.initiatorType,I=x.duration;if(E&&I&&GS(b)){for(b=0,I=x.responseEnd,h+=1;h<u.length;h++){var Z=u[h],oe=Z.startTime;if(oe>I)break;var ve=Z.transferSize,Te=Z.initiatorType;ve&&GS(Te)&&(Z=Z.responseEnd,b+=ve*(Z<I?1:(I-oe)/(Z-oe)))}if(--h,s+=8*(E+b)/(x.duration/1e3),n++,10<n)break}}if(0<n)return s/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var S_=null,b_=null;function A1(n){return n.nodeType===9?n:n.ownerDocument}function VS(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function jS(n,s){if(n===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&s==="foreignObject"?0:n}function w_(n,s){return n==="textarea"||n==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var C_=null;function V3(){var n=window.event;return n&&n.type==="popstate"?n===C_?!1:(C_=n,!0):(C_=null,!1)}var YS=typeof setTimeout=="function"?setTimeout:void 0,j3=typeof clearTimeout=="function"?clearTimeout:void 0,XS=typeof Promise=="function"?Promise:void 0,Y3=typeof queueMicrotask=="function"?queueMicrotask:typeof XS<"u"?function(n){return XS.resolve(null).then(n).catch(X3)}:YS;function X3(n){setTimeout(function(){throw n})}function Vl(n){return n==="head"}function qS(n,s){var u=s,h=0;do{var x=u.nextSibling;if(n.removeChild(u),x&&x.nodeType===8)if(u=x.data,u==="/$"||u==="/&"){if(h===0){n.removeChild(x),_f(s);return}h--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")h++;else if(u==="html")I0(n.ownerDocument.documentElement);else if(u==="head"){u=n.ownerDocument.head,I0(u);for(var E=u.firstChild;E;){var b=E.nextSibling,I=E.nodeName;E[de]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&E.rel.toLowerCase()==="stylesheet"||u.removeChild(E),E=b}}else u==="body"&&I0(n.ownerDocument.body);u=x}while(u);_f(s)}function WS(n,s){var u=n;n=0;do{var h=u.nextSibling;if(u.nodeType===1?s?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(s?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),h&&h.nodeType===8)if(u=h.data,u==="/$"){if(n===0)break;n--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||n++;u=h}while(u)}function R_(n){var s=n.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var u=s;switch(s=s.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":R_(u),Ce(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}n.removeChild(u)}}function q3(n,s,u,h){for(;n.nodeType===1;){var x=u;if(n.nodeName.toLowerCase()!==s.toLowerCase()){if(!h&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(h){if(!n[de])switch(s){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(E=n.getAttribute("rel"),E==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(E!==x.rel||n.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||n.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||n.getAttribute("title")!==(x.title==null?null:x.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(E=n.getAttribute("src"),(E!==(x.src==null?null:x.src)||n.getAttribute("type")!==(x.type==null?null:x.type)||n.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&E&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(s==="input"&&n.type==="hidden"){var E=x.name==null?null:""+x.name;if(x.type==="hidden"&&n.getAttribute("name")===E)return n}else return n;if(n=qn(n.nextSibling),n===null)break}return null}function W3(n,s,u){if(s==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!u||(n=qn(n.nextSibling),n===null))return null;return n}function KS(n,s){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!s||(n=qn(n.nextSibling),n===null))return null;return n}function k_(n){return n.data==="$?"||n.data==="$~"}function O_(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function K3(n,s){var u=n.ownerDocument;if(n.data==="$~")n._reactRetry=s;else if(n.data!=="$?"||u.readyState!=="loading")s();else{var h=function(){s(),u.removeEventListener("DOMContentLoaded",h)};u.addEventListener("DOMContentLoaded",h),n._reactRetry=h}}function qn(n){for(;n!=null;n=n.nextSibling){var s=n.nodeType;if(s===1||s===3)break;if(s===8){if(s=n.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return n}var D_=null;function $S(n){n=n.nextSibling;for(var s=0;n;){if(n.nodeType===8){var u=n.data;if(u==="/$"||u==="/&"){if(s===0)return qn(n.nextSibling);s--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||s++}n=n.nextSibling}return null}function QS(n){n=n.previousSibling;for(var s=0;n;){if(n.nodeType===8){var u=n.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(s===0)return n;s--}else u!=="/$"&&u!=="/&"||s++}n=n.previousSibling}return null}function ZS(n,s,u){switch(s=A1(u),n){case"html":if(n=s.documentElement,!n)throw Error(a(452));return n;case"head":if(n=s.head,!n)throw Error(a(453));return n;case"body":if(n=s.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}function I0(n){for(var s=n.attributes;s.length;)n.removeAttributeNode(s[0]);Ce(n)}var Wn=new Map,JS=new Set;function y1(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Ps=te.d;te.d={f:$3,r:Q3,D:Z3,C:J3,L:eN,m:tN,X:aN,S:rN,M:nN};function $3(){var n=Ps.f(),s=d1();return n||s}function Q3(n){var s=Fe(n);s!==null&&s.tag===5&&s.type==="form"?m2(s):Ps.r(n)}var mf=typeof document>"u"?null:document;function eb(n,s,u){var h=mf;if(h&&typeof s=="string"&&s){var x=Hn(s);x='link[rel="'+n+'"][href="'+x+'"]',typeof u=="string"&&(x+='[crossorigin="'+u+'"]'),JS.has(x)||(JS.add(x),n={rel:n,crossOrigin:u,href:s},h.querySelector(x)===null&&(s=h.createElement("link"),Zr(s,"link",n),He(s),h.head.appendChild(s)))}}function Z3(n){Ps.D(n),eb("dns-prefetch",n,null)}function J3(n,s){Ps.C(n,s),eb("preconnect",n,s)}function eN(n,s,u){Ps.L(n,s,u);var h=mf;if(h&&n&&s){var x='link[rel="preload"][as="'+Hn(s)+'"]';s==="image"&&u&&u.imageSrcSet?(x+='[imagesrcset="'+Hn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(x+='[imagesizes="'+Hn(u.imageSizes)+'"]')):x+='[href="'+Hn(n)+'"]';var E=x;switch(s){case"style":E=xf(n);break;case"script":E=vf(n)}Wn.has(E)||(n=m({rel:"preload",href:s==="image"&&u&&u.imageSrcSet?void 0:n,as:s},u),Wn.set(E,n),h.querySelector(x)!==null||s==="style"&&h.querySelector(F0(E))||s==="script"&&h.querySelector(L0(E))||(s=h.createElement("link"),Zr(s,"link",n),He(s),h.head.appendChild(s)))}}function tN(n,s){Ps.m(n,s);var u=mf;if(u&&n){var h=s&&typeof s.as=="string"?s.as:"script",x='link[rel="modulepreload"][as="'+Hn(h)+'"][href="'+Hn(n)+'"]',E=x;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=vf(n)}if(!Wn.has(E)&&(n=m({rel:"modulepreload",href:n},s),Wn.set(E,n),u.querySelector(x)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(L0(E)))return}h=u.createElement("link"),Zr(h,"link",n),He(h),u.head.appendChild(h)}}}function rN(n,s,u){Ps.S(n,s,u);var h=mf;if(h&&n){var x=Ne(h).hoistableStyles,E=xf(n);s=s||"default";var b=x.get(E);if(!b){var I={loading:0,preload:null};if(b=h.querySelector(F0(E)))I.loading=5;else{n=m({rel:"stylesheet",href:n,"data-precedence":s},u),(u=Wn.get(E))&&N_(n,u);var Z=b=h.createElement("link");He(Z),Zr(Z,"link",n),Z._p=new Promise(function(oe,ve){Z.onload=oe,Z.onerror=ve}),Z.addEventListener("load",function(){I.loading|=1}),Z.addEventListener("error",function(){I.loading|=2}),I.loading|=4,T1(b,s,h)}b={type:"stylesheet",instance:b,count:1,state:I},x.set(E,b)}}}function aN(n,s){Ps.X(n,s);var u=mf;if(u&&n){var h=Ne(u).hoistableScripts,x=vf(n),E=h.get(x);E||(E=u.querySelector(L0(x)),E||(n=m({src:n,async:!0},s),(s=Wn.get(x))&&M_(n,s),E=u.createElement("script"),He(E),Zr(E,"link",n),u.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},h.set(x,E))}}function nN(n,s){Ps.M(n,s);var u=mf;if(u&&n){var h=Ne(u).hoistableScripts,x=vf(n),E=h.get(x);E||(E=u.querySelector(L0(x)),E||(n=m({src:n,async:!0,type:"module"},s),(s=Wn.get(x))&&M_(n,s),E=u.createElement("script"),He(E),Zr(E,"link",n),u.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},h.set(x,E))}}function tb(n,s,u,h){var x=(x=se.current)?y1(x):null;if(!x)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(s=xf(u.href),u=Ne(x).hoistableStyles,h=u.get(s),h||(h={type:"style",instance:null,count:0,state:null},u.set(s,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){n=xf(u.href);var E=Ne(x).hoistableStyles,b=E.get(n);if(b||(x=x.ownerDocument||x,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(n,b),(E=x.querySelector(F0(n)))&&!E._p&&(b.instance=E,b.state.loading=5),Wn.has(n)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Wn.set(n,u),E||iN(x,n,u,b.state))),s&&h===null)throw Error(a(528,""));return b}if(s&&h!==null)throw Error(a(529,""));return null;case"script":return s=u.async,u=u.src,typeof u=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=vf(u),u=Ne(x).hoistableScripts,h=u.get(s),h||(h={type:"script",instance:null,count:0,state:null},u.set(s,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function xf(n){return'href="'+Hn(n)+'"'}function F0(n){return'link[rel="stylesheet"]['+n+"]"}function rb(n){return m({},n,{"data-precedence":n.precedence,precedence:null})}function iN(n,s,u,h){n.querySelector('link[rel="preload"][as="style"]['+s+"]")?h.loading=1:(s=n.createElement("link"),h.preload=s,s.addEventListener("load",function(){return h.loading|=1}),s.addEventListener("error",function(){return h.loading|=2}),Zr(s,"link",u),He(s),n.head.appendChild(s))}function vf(n){return'[src="'+Hn(n)+'"]'}function L0(n){return"script[async]"+n}function ab(n,s,u){if(s.count++,s.instance===null)switch(s.type){case"style":var h=n.querySelector('style[data-href~="'+Hn(u.href)+'"]');if(h)return s.instance=h,He(h),h;var x=m({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return h=(n.ownerDocument||n).createElement("style"),He(h),Zr(h,"style",x),T1(h,u.precedence,n),s.instance=h;case"stylesheet":x=xf(u.href);var E=n.querySelector(F0(x));if(E)return s.state.loading|=4,s.instance=E,He(E),E;h=rb(u),(x=Wn.get(x))&&N_(h,x),E=(n.ownerDocument||n).createElement("link"),He(E);var b=E;return b._p=new Promise(function(I,Z){b.onload=I,b.onerror=Z}),Zr(E,"link",h),s.state.loading|=4,T1(E,u.precedence,n),s.instance=E;case"script":return E=vf(u.src),(x=n.querySelector(L0(E)))?(s.instance=x,He(x),x):(h=u,(x=Wn.get(E))&&(h=m({},u),M_(h,x)),n=n.ownerDocument||n,x=n.createElement("script"),He(x),Zr(x,"link",h),n.head.appendChild(x),s.instance=x);case"void":return null;default:throw Error(a(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(h=s.instance,s.state.loading|=4,T1(h,u.precedence,n));return s.instance}function T1(n,s,u){for(var h=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=h.length?h[h.length-1]:null,E=x,b=0;b<h.length;b++){var I=h[b];if(I.dataset.precedence===s)E=I;else if(E!==x)break}E?E.parentNode.insertBefore(n,E.nextSibling):(s=u.nodeType===9?u.head:u,s.insertBefore(n,s.firstChild))}function N_(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.title==null&&(n.title=s.title)}function M_(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.integrity==null&&(n.integrity=s.integrity)}var S1=null;function nb(n,s,u){if(S1===null){var h=new Map,x=S1=new Map;x.set(u,h)}else x=S1,h=x.get(u),h||(h=new Map,x.set(u,h));if(h.has(n))return h;for(h.set(n,null),u=u.getElementsByTagName(n),x=0;x<u.length;x++){var E=u[x];if(!(E[de]||E[P]||n==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var b=E.getAttribute(s)||"";b=n+b;var I=h.get(b);I?I.push(E):h.set(b,[E])}}return h}function ib(n,s,u){n=n.ownerDocument||n,n.head.insertBefore(u,s==="title"?n.querySelector("head > title"):null)}function sN(n,s,u){if(u===1||s.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return n=s.disabled,typeof s.precedence=="string"&&n==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function sb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function lN(n,s,u,h){if(u.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var x=xf(h.href),E=s.querySelector(F0(x));if(E){s=E._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(n.count++,n=b1.bind(n),s.then(n,n)),u.state.loading|=4,u.instance=E,He(E);return}E=s.ownerDocument||s,h=rb(h),(x=Wn.get(x))&&N_(h,x),E=E.createElement("link"),He(E);var b=E;b._p=new Promise(function(I,Z){b.onload=I,b.onerror=Z}),Zr(E,"link",h),u.instance=E}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(u,s),(s=u.state.preload)&&(u.state.loading&3)===0&&(n.count++,u=b1.bind(n),s.addEventListener("load",u),s.addEventListener("error",u))}}var I_=0;function oN(n,s){return n.stylesheets&&n.count===0&&C1(n,n.stylesheets),0<n.count||0<n.imgCount?function(u){var h=setTimeout(function(){if(n.stylesheets&&C1(n,n.stylesheets),n.unsuspend){var E=n.unsuspend;n.unsuspend=null,E()}},6e4+s);0<n.imgBytes&&I_===0&&(I_=62500*G3());var x=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&C1(n,n.stylesheets),n.unsuspend)){var E=n.unsuspend;n.unsuspend=null,E()}},(n.imgBytes>I_?50:800)+s);return n.unsuspend=u,function(){n.unsuspend=null,clearTimeout(h),clearTimeout(x)}}:null}function b1(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)C1(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var w1=null;function C1(n,s){n.stylesheets=null,n.unsuspend!==null&&(n.count++,w1=new Map,s.forEach(cN,n),w1=null,b1.call(n))}function cN(n,s){if(!(s.state.loading&4)){var u=w1.get(n);if(u)var h=u.get(null);else{u=new Map,w1.set(n,u);for(var x=n.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<x.length;E++){var b=x[E];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(u.set(b.dataset.precedence,b),h=b)}h&&u.set(null,h)}x=s.instance,b=x.getAttribute("data-precedence"),E=u.get(b)||h,E===h&&u.set(null,x),u.set(b,x),this.count++,h=b1.bind(this),x.addEventListener("load",h),x.addEventListener("error",h),E?E.parentNode.insertBefore(x,E.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(x,n.firstChild)),s.state.loading|=4}}var P0={$$typeof:C,Provider:null,Consumer:null,_currentValue:we,_currentValue2:we,_threadCount:0};function uN(n,s,u,h,x,E,b,I,Z){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=$h(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$h(0),this.hiddenUpdates=$h(null),this.identifierPrefix=h,this.onUncaughtError=x,this.onCaughtError=E,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function lb(n,s,u,h,x,E,b,I,Z,oe,ve,Te){return n=new uN(n,s,u,b,Z,oe,ve,Te,I),s=1,E===!0&&(s|=24),E=fn(3,null,null,s),n.current=E,E.stateNode=n,s=dv(),s.refCount++,n.pooledCache=s,s.refCount++,E.memoizedState={element:h,isDehydrated:u,cache:s},xv(E),n}function ob(n){return n?(n=Wu,n):Wu}function cb(n,s,u,h,x,E){x=ob(x),h.context===null?h.context=x:h.pendingContext=x,h=Nl(s),h.payload={element:u},E=E===void 0?null:E,E!==null&&(h.callback=E),u=Ml(n,h,s),u!==null&&(Ja(u,n,s),g0(u,n,s))}function ub(n,s){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var u=n.retryLane;n.retryLane=u!==0&&u<s?u:s}}function F_(n,s){ub(n,s),(n=n.alternate)&&ub(n,s)}function fb(n){if(n.tag===13||n.tag===31){var s=Ko(n,67108864);s!==null&&Ja(s,n,67108864),F_(n,67108864)}}function hb(n){if(n.tag===13||n.tag===31){var s=mn();s=Qh(s);var u=Ko(n,s);u!==null&&Ja(u,n,s),F_(n,s)}}var R1=!0;function fN(n,s,u,h){var x=G.T;G.T=null;var E=te.p;try{te.p=2,L_(n,s,u,h)}finally{te.p=E,G.T=x}}function hN(n,s,u,h){var x=G.T;G.T=null;var E=te.p;try{te.p=8,L_(n,s,u,h)}finally{te.p=E,G.T=x}}function L_(n,s,u,h){if(R1){var x=P_(h);if(x===null)y_(n,s,h,k1,u),pb(n,h);else if(pN(x,n,s,u,h))h.stopPropagation();else if(pb(n,h),s&4&&-1<dN.indexOf(n)){for(;x!==null;){var E=Fe(x);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var b=Pn(E.pendingLanes);if(b!==0){var I=E;for(I.pendingLanes|=2,I.entangledLanes|=2;b;){var Z=1<<31-Ca(b);I.entanglements[1]|=Z,b&=~Z}Xi(E),(wt&6)===0&&(f1=Pt()+500,D0(0))}}break;case 31:case 13:I=Ko(E,2),I!==null&&Ja(I,E,2),d1(),F_(E,2)}if(E=P_(h),E===null&&y_(n,s,h,k1,u),E===x)break;x=E}x!==null&&h.stopPropagation()}else y_(n,s,h,null,u)}}function P_(n){return n=Ux(n),B_(n)}var k1=null;function B_(n){if(k1=null,n=De(n),n!==null){var s=l(n);if(s===null)n=null;else{var u=s.tag;if(u===13){if(n=o(s),n!==null)return n;n=null}else if(u===31){if(n=c(s),n!==null)return n;n=null}else if(u===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null)}}return k1=n,null}function db(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(hi()){case di:return 2;case Sl:return 8;case _r:case Ln:return 32;case rt:return 268435456;default:return 32}default:return 32}}var U_=!1,jl=null,Yl=null,Xl=null,B0=new Map,U0=new Map,ql=[],dN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function pb(n,s){switch(n){case"focusin":case"focusout":jl=null;break;case"dragenter":case"dragleave":Yl=null;break;case"mouseover":case"mouseout":Xl=null;break;case"pointerover":case"pointerout":B0.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":U0.delete(s.pointerId)}}function H0(n,s,u,h,x,E){return n===null||n.nativeEvent!==E?(n={blockedOn:s,domEventName:u,eventSystemFlags:h,nativeEvent:E,targetContainers:[x]},s!==null&&(s=Fe(s),s!==null&&fb(s)),n):(n.eventSystemFlags|=h,s=n.targetContainers,x!==null&&s.indexOf(x)===-1&&s.push(x),n)}function pN(n,s,u,h,x){switch(s){case"focusin":return jl=H0(jl,n,s,u,h,x),!0;case"dragenter":return Yl=H0(Yl,n,s,u,h,x),!0;case"mouseover":return Xl=H0(Xl,n,s,u,h,x),!0;case"pointerover":var E=x.pointerId;return B0.set(E,H0(B0.get(E)||null,n,s,u,h,x)),!0;case"gotpointercapture":return E=x.pointerId,U0.set(E,H0(U0.get(E)||null,n,s,u,h,x)),!0}return!1}function gb(n){var s=De(n.target);if(s!==null){var u=l(s);if(u!==null){if(s=u.tag,s===13){if(s=o(u),s!==null){n.blockedOn=s,z(n.priority,function(){hb(u)});return}}else if(s===31){if(s=c(u),s!==null){n.blockedOn=s,z(n.priority,function(){hb(u)});return}}else if(s===3&&u.stateNode.current.memoizedState.isDehydrated){n.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}n.blockedOn=null}function O1(n){if(n.blockedOn!==null)return!1;for(var s=n.targetContainers;0<s.length;){var u=P_(n.nativeEvent);if(u===null){u=n.nativeEvent;var h=new u.constructor(u.type,u);Bx=h,u.target.dispatchEvent(h),Bx=null}else return s=Fe(u),s!==null&&fb(s),n.blockedOn=u,!1;s.shift()}return!0}function mb(n,s,u){O1(n)&&u.delete(s)}function gN(){U_=!1,jl!==null&&O1(jl)&&(jl=null),Yl!==null&&O1(Yl)&&(Yl=null),Xl!==null&&O1(Xl)&&(Xl=null),B0.forEach(mb),U0.forEach(mb)}function D1(n,s){n.blockedOn===s&&(n.blockedOn=null,U_||(U_=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,gN)))}var N1=null;function xb(n){N1!==n&&(N1=n,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){N1===n&&(N1=null);for(var s=0;s<n.length;s+=3){var u=n[s],h=n[s+1],x=n[s+2];if(typeof h!="function"){if(B_(h||u)===null)continue;break}var E=Fe(u);E!==null&&(n.splice(s,3),s-=3,Pv(E,{pending:!0,data:x,method:u.method,action:h},h,x))}}))}function _f(n){function s(Z){return D1(Z,n)}jl!==null&&D1(jl,n),Yl!==null&&D1(Yl,n),Xl!==null&&D1(Xl,n),B0.forEach(s),U0.forEach(s);for(var u=0;u<ql.length;u++){var h=ql[u];h.blockedOn===n&&(h.blockedOn=null)}for(;0<ql.length&&(u=ql[0],u.blockedOn===null);)gb(u),u.blockedOn===null&&ql.shift();if(u=(n.ownerDocument||n).$$reactFormReplay,u!=null)for(h=0;h<u.length;h+=3){var x=u[h],E=u[h+1],b=x[H]||null;if(typeof E=="function")b||xb(u);else if(b){var I=null;if(E&&E.hasAttribute("formAction")){if(x=E,b=E[H]||null)I=b.formAction;else if(B_(x)!==null)continue}else I=b.action;typeof I=="function"?u[h+1]=I:(u.splice(h,3),h-=3),xb(u)}}}function vb(){function n(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(b){return x=b})},focusReset:"manual",scroll:"manual"})}function s(){x!==null&&(x(),x=null),h||setTimeout(u,20)}function u(){if(!h&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,x=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(u,100),function(){h=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),x!==null&&(x(),x=null)}}}function H_(n){this._internalRoot=n}M1.prototype.render=H_.prototype.render=function(n){var s=this._internalRoot;if(s===null)throw Error(a(409));var u=s.current,h=mn();cb(u,h,n,s,null,null)},M1.prototype.unmount=H_.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var s=n.containerInfo;cb(n.current,2,null,n,null,null),d1(),s[V]=null}};function M1(n){this._internalRoot=n}M1.prototype.unstable_scheduleHydration=function(n){if(n){var s=M();n={blockedOn:null,target:n,priority:s};for(var u=0;u<ql.length&&s!==0&&s<ql[u].priority;u++);ql.splice(u,0,n),u===0&&gb(n)}};var _b=t.version;if(_b!=="19.2.3")throw Error(a(527,_b,"19.2.3"));te.findDOMNode=function(n){var s=n._reactInternals;if(s===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=d(s),n=n!==null?g(n):null,n=n===null?null:n.stateNode,n};var mN={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var I1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!I1.isDisabled&&I1.supportsFiber)try{jt=I1.inject(mN),hr=I1}catch{}}return G0.createRoot=function(n,s){if(!i(n))throw Error(a(299));var u=!1,h="",x=w2,E=C2,b=R2;return s!=null&&(s.unstable_strictMode===!0&&(u=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onUncaughtError!==void 0&&(x=s.onUncaughtError),s.onCaughtError!==void 0&&(E=s.onCaughtError),s.onRecoverableError!==void 0&&(b=s.onRecoverableError)),s=lb(n,1,!1,null,null,u,h,null,x,E,b,vb),n[V]=s.current,A_(n),new H_(s)},G0.hydrateRoot=function(n,s,u){if(!i(n))throw Error(a(299));var h=!1,x="",E=w2,b=C2,I=R2,Z=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(x=u.identifierPrefix),u.onUncaughtError!==void 0&&(E=u.onUncaughtError),u.onCaughtError!==void 0&&(b=u.onCaughtError),u.onRecoverableError!==void 0&&(I=u.onRecoverableError),u.formState!==void 0&&(Z=u.formState)),s=lb(n,1,!0,s,u??null,h,x,Z,E,b,I,vb),s.context=ob(null),u=s.current,h=mn(),h=Qh(h),x=Nl(h),x.callback=null,Ml(u,x,h),u=h,s.current.lanes=u,jo(s,u),Xi(s),n[V]=s.current,A_(n),new M1(s)},G0.version="19.2.3",G0}var Ob;function kN(){if(Ob)return j_.exports;Ob=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),j_.exports=RN(),j_.exports}var ON=kN();const DN=fR(ON);var NN={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Db;(function(r){r.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",r.OUTCOME_OK="OUTCOME_OK",r.OUTCOME_FAILED="OUTCOME_FAILED",r.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Db||(Db={}));var Nb;(function(r){r.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",r.PYTHON="PYTHON"})(Nb||(Nb={}));var Mb;(function(r){r.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",r.SILENT="SILENT",r.WHEN_IDLE="WHEN_IDLE",r.INTERRUPT="INTERRUPT"})(Mb||(Mb={}));var Ib;(function(r){r.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",r.STRING="STRING",r.NUMBER="NUMBER",r.INTEGER="INTEGER",r.BOOLEAN="BOOLEAN",r.ARRAY="ARRAY",r.OBJECT="OBJECT",r.NULL="NULL"})(Ib||(Ib={}));var Fb;(function(r){r.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",r.SIMPLE_SEARCH="SIMPLE_SEARCH",r.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Fb||(Fb={}));var Lb;(function(r){r.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",r.NO_AUTH="NO_AUTH",r.API_KEY_AUTH="API_KEY_AUTH",r.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",r.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",r.OAUTH="OAUTH",r.OIDC_AUTH="OIDC_AUTH"})(Lb||(Lb={}));var Pb;(function(r){r.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",r.HTTP_IN_QUERY="HTTP_IN_QUERY",r.HTTP_IN_HEADER="HTTP_IN_HEADER",r.HTTP_IN_PATH="HTTP_IN_PATH",r.HTTP_IN_BODY="HTTP_IN_BODY",r.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Pb||(Pb={}));var Bb;(function(r){r.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",r.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",r.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",r.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",r.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",r.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",r.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Bb||(Bb={}));var Ub;(function(r){r.UNSPECIFIED="UNSPECIFIED",r.BLOCKING="BLOCKING",r.NON_BLOCKING="NON_BLOCKING"})(Ub||(Ub={}));var Hb;(function(r){r.MODE_UNSPECIFIED="MODE_UNSPECIFIED",r.MODE_DYNAMIC="MODE_DYNAMIC"})(Hb||(Hb={}));var zb;(function(r){r.MODE_UNSPECIFIED="MODE_UNSPECIFIED",r.AUTO="AUTO",r.ANY="ANY",r.NONE="NONE",r.VALIDATED="VALIDATED"})(zb||(zb={}));var Gb;(function(r){r.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",r.LOW="LOW",r.MEDIUM="MEDIUM",r.HIGH="HIGH",r.MINIMAL="MINIMAL"})(Gb||(Gb={}));var Vb;(function(r){r.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",r.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",r.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",r.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",r.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",r.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",r.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",r.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",r.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",r.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",r.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Vb||(Vb={}));var jb;(function(r){r.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",r.SEVERITY="SEVERITY",r.PROBABILITY="PROBABILITY"})(jb||(jb={}));var Yb;(function(r){r.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",r.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",r.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",r.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",r.BLOCK_NONE="BLOCK_NONE",r.OFF="OFF"})(Yb||(Yb={}));var Xb;(function(r){r.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",r.STOP="STOP",r.MAX_TOKENS="MAX_TOKENS",r.SAFETY="SAFETY",r.RECITATION="RECITATION",r.LANGUAGE="LANGUAGE",r.OTHER="OTHER",r.BLOCKLIST="BLOCKLIST",r.PROHIBITED_CONTENT="PROHIBITED_CONTENT",r.SPII="SPII",r.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",r.IMAGE_SAFETY="IMAGE_SAFETY",r.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",r.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",r.NO_IMAGE="NO_IMAGE",r.IMAGE_RECITATION="IMAGE_RECITATION",r.IMAGE_OTHER="IMAGE_OTHER"})(Xb||(Xb={}));var qb;(function(r){r.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",r.NEGLIGIBLE="NEGLIGIBLE",r.LOW="LOW",r.MEDIUM="MEDIUM",r.HIGH="HIGH"})(qb||(qb={}));var Wb;(function(r){r.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",r.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",r.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",r.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",r.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Wb||(Wb={}));var Kb;(function(r){r.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",r.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",r.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",r.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",r.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Kb||(Kb={}));var $b;(function(r){r.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",r.SAFETY="SAFETY",r.OTHER="OTHER",r.BLOCKLIST="BLOCKLIST",r.PROHIBITED_CONTENT="PROHIBITED_CONTENT",r.IMAGE_SAFETY="IMAGE_SAFETY",r.MODEL_ARMOR="MODEL_ARMOR",r.JAILBREAK="JAILBREAK"})($b||($b={}));var Qb;(function(r){r.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",r.ON_DEMAND="ON_DEMAND",r.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Qb||(Qb={}));var Zb;(function(r){r.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",r.TEXT="TEXT",r.IMAGE="IMAGE",r.AUDIO="AUDIO"})(Zb||(Zb={}));var Jb;(function(r){r.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",r.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",r.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",r.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Jb||(Jb={}));var ew;(function(r){r.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",r.TUNING_MODE_FULL="TUNING_MODE_FULL",r.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(ew||(ew={}));var tw;(function(r){r.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",r.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",r.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",r.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",r.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",r.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",r.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(tw||(tw={}));var rw;(function(r){r.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",r.JOB_STATE_QUEUED="JOB_STATE_QUEUED",r.JOB_STATE_PENDING="JOB_STATE_PENDING",r.JOB_STATE_RUNNING="JOB_STATE_RUNNING",r.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",r.JOB_STATE_FAILED="JOB_STATE_FAILED",r.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",r.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",r.JOB_STATE_PAUSED="JOB_STATE_PAUSED",r.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",r.JOB_STATE_UPDATING="JOB_STATE_UPDATING",r.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(rw||(rw={}));var aw;(function(r){r.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",r.TUNING_TASK_I2V="TUNING_TASK_I2V",r.TUNING_TASK_T2V="TUNING_TASK_T2V",r.TUNING_TASK_R2V="TUNING_TASK_R2V"})(aw||(aw={}));var nw;(function(r){r.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",r.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",r.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",r.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",r.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(nw||(nw={}));var iw;(function(r){r.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",r.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",r.BALANCED="BALANCED",r.PRIORITIZE_COST="PRIORITIZE_COST"})(iw||(iw={}));var sw;(function(r){r.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",r.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(sw||(sw={}));var lw;(function(r){r.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",r.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",r.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",r.BLOCK_NONE="BLOCK_NONE"})(lw||(lw={}));var ow;(function(r){r.DONT_ALLOW="DONT_ALLOW",r.ALLOW_ADULT="ALLOW_ADULT",r.ALLOW_ALL="ALLOW_ALL"})(ow||(ow={}));var cw;(function(r){r.auto="auto",r.en="en",r.ja="ja",r.ko="ko",r.hi="hi",r.zh="zh",r.pt="pt",r.es="es"})(cw||(cw={}));var uw;(function(r){r.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",r.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",r.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",r.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",r.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(uw||(uw={}));var fw;(function(r){r.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",r.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",r.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",r.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(fw||(fw={}));var hw;(function(r){r.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",r.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",r.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",r.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(hw||(hw={}));var dw;(function(r){r.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",r.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",r.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",r.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",r.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",r.EDIT_MODE_STYLE="EDIT_MODE_STYLE",r.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",r.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(dw||(dw={}));var pw;(function(r){r.FOREGROUND="FOREGROUND",r.BACKGROUND="BACKGROUND",r.PROMPT="PROMPT",r.SEMANTIC="SEMANTIC",r.INTERACTIVE="INTERACTIVE"})(pw||(pw={}));var gw;(function(r){r.ASSET="ASSET",r.STYLE="STYLE"})(gw||(gw={}));var mw;(function(r){r.INSERT="INSERT",r.REMOVE="REMOVE",r.REMOVE_STATIC="REMOVE_STATIC",r.OUTPAINT="OUTPAINT"})(mw||(mw={}));var xw;(function(r){r.OPTIMIZED="OPTIMIZED",r.LOSSLESS="LOSSLESS"})(xw||(xw={}));var vw;(function(r){r.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",r.PREFERENCE_TUNING="PREFERENCE_TUNING"})(vw||(vw={}));var _w;(function(r){r.STATE_UNSPECIFIED="STATE_UNSPECIFIED",r.STATE_PENDING="STATE_PENDING",r.STATE_ACTIVE="STATE_ACTIVE",r.STATE_FAILED="STATE_FAILED"})(_w||(_w={}));var Ew;(function(r){r.STATE_UNSPECIFIED="STATE_UNSPECIFIED",r.PROCESSING="PROCESSING",r.ACTIVE="ACTIVE",r.FAILED="FAILED"})(Ew||(Ew={}));var Aw;(function(r){r.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",r.UPLOADED="UPLOADED",r.GENERATED="GENERATED",r.REGISTERED="REGISTERED"})(Aw||(Aw={}));var yw;(function(r){r.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",r.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",r.RESPONSE_REJECTED="RESPONSE_REJECTED",r.NEED_MORE_INPUT="NEED_MORE_INPUT"})(yw||(yw={}));var Tw;(function(r){r.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",r.TEXT="TEXT",r.IMAGE="IMAGE",r.VIDEO="VIDEO",r.AUDIO="AUDIO",r.DOCUMENT="DOCUMENT"})(Tw||(Tw={}));var Sw;(function(r){r.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",r.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",r.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(Sw||(Sw={}));var bw;(function(r){r.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",r.ACTIVITY_START="ACTIVITY_START",r.ACTIVITY_END="ACTIVITY_END"})(bw||(bw={}));var ww;(function(r){r.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",r.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",r.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(ww||(ww={}));var Cw;(function(r){r.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",r.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",r.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Cw||(Cw={}));var Rw;(function(r){r.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",r.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",r.NO_INTERRUPTION="NO_INTERRUPTION"})(Rw||(Rw={}));var kw;(function(r){r.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",r.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",r.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(kw||(kw={}));var Ow;(function(r){r.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",r.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",r.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",r.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",r.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",r.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",r.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",r.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",r.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",r.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",r.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",r.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",r.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Ow||(Ow={}));var Dw;(function(r){r.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",r.QUALITY="QUALITY",r.DIVERSITY="DIVERSITY",r.VOCALIZATION="VOCALIZATION"})(Dw||(Dw={}));var Nw;(function(r){r.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",r.PLAY="PLAY",r.PAUSE="PAUSE",r.STOP="STOP",r.RESET_CONTEXT="RESET_CONTEXT"})(Nw||(Nw={}));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Mw;(function(r){r.PAGED_ITEM_BATCH_JOBS="batchJobs",r.PAGED_ITEM_MODELS="models",r.PAGED_ITEM_TUNING_JOBS="tuningJobs",r.PAGED_ITEM_FILES="files",r.PAGED_ITEM_CACHED_CONTENTS="cachedContents",r.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",r.PAGED_ITEM_DOCUMENTS="documents"})(Mw||(Mw={}));function Om(r,t){var e={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&t.indexOf(a)<0&&(e[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,a=Object.getOwnPropertySymbols(r);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(r,a[i])&&(e[a[i]]=r[a[i]]);return e}function Iw(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],a=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&a>=r.length&&(r=void 0),{value:r&&r[a++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ir(r){return this instanceof ir?(this.v=r,this):new ir(r)}function gd(r,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=e.apply(r,t||[]),i,l=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(A){return Promise.resolve(A).then(_,m)}}function c(_,A){a[_]&&(i[_]=function(y){return new Promise(function(T,S){l.push([_,y,T,S])>1||f(_,y)})},A&&(i[_]=A(i[_])))}function f(_,A){try{d(a[_](A))}catch(y){v(l[0][3],y)}}function d(_){_.value instanceof ir?Promise.resolve(_.value.v).then(g,m):v(l[0][2],_)}function g(_){f("next",_)}function m(_){f("throw",_)}function v(_,A){_(A),l.shift(),l.length&&f(l[0][0],l[0][1])}}function If(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=r[Symbol.asyncIterator],e;return t?t.call(r):(r=typeof Iw=="function"?Iw(r):r[Symbol.iterator](),e={},a("next"),a("throw"),a("return"),e[Symbol.asyncIterator]=function(){return this},e);function a(l){e[l]=r[l]&&function(o){return new Promise(function(c,f){o=r[l](o),i(c,f,o.done,o.value)})}}function i(l,o,c,f){Promise.resolve(f).then(function(d){l({value:d,done:c})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let hR=function(){const{crypto:r}=globalThis;if(r!=null&&r.randomUUID)return hR=r.randomUUID.bind(r),r.randomUUID();const t=new Uint8Array(1),e=r?()=>r.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>(+a^e()&15>>+a/4).toString(16))};const MN=()=>hR();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dE(r){return typeof r=="object"&&r!==null&&("name"in r&&r.name==="AbortError"||"message"in r&&String(r.message).includes("FetchRequestCanceledException"))}const pE=r=>{if(r instanceof Error)return r;if(typeof r=="object"&&r!==null){try{if(Object.prototype.toString.call(r)==="[object Error]"){const t=new Error(r.message,r.cause?{cause:r.cause}:{});return r.stack&&(t.stack=r.stack),r.cause&&!t.cause&&(t.cause=r.cause),r.name&&(t.name=r.name),t}}catch{}try{return new Error(JSON.stringify(r))}catch{}}return new Error(r)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ci extends Error{}class Va extends ci{constructor(t,e,a,i){super(`${Va.makeMessage(t,e,a)}`),this.status=t,this.headers=i,this.error=e}static makeMessage(t,e,a){const i=e!=null&&e.message?typeof e.message=="string"?e.message:JSON.stringify(e.message):e?JSON.stringify(e):a;return t&&i?`${t} ${i}`:t?`${t} status code (no body)`:i||"(no status code or body)"}static generate(t,e,a,i){if(!t||!i)return new mx({message:a,cause:pE(e)});const l=e;return t===400?new pR(t,l,a,i):t===401?new gR(t,l,a,i):t===403?new mR(t,l,a,i):t===404?new xR(t,l,a,i):t===409?new vR(t,l,a,i):t===422?new _R(t,l,a,i):t===429?new ER(t,l,a,i):t>=500?new AR(t,l,a,i):new Va(t,l,a,i)}}class gE extends Va{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class mx extends Va{constructor({message:t,cause:e}){super(void 0,void 0,t||"Connection error.",void 0),e&&(this.cause=e)}}class dR extends mx{constructor({message:t}={}){super({message:t??"Request timed out."})}}class pR extends Va{}class gR extends Va{}class mR extends Va{}class xR extends Va{}class vR extends Va{}class _R extends Va{}class ER extends Va{}class AR extends Va{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const IN=/^[a-z][a-z0-9+.-]*:/i,FN=r=>IN.test(r);let mE=r=>(mE=Array.isArray,mE(r));const LN=mE;let PN=LN;const Fw=PN;function BN(r){if(!r)return!0;for(const t in r)return!1;return!0}function UN(r,t){return Object.prototype.hasOwnProperty.call(r,t)}const HN=(r,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new ci(`${r} must be an integer`);if(t<0)throw new ci(`${r} must be a positive integer`);return t},zN=r=>{try{return JSON.parse(r)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const GN=r=>new Promise(t=>setTimeout(t,r));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Af="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function VN(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const jN=()=>{var r,t,e,a,i;const l=VN();if(l==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Af,"X-Stainless-OS":Pw(Deno.build.os),"X-Stainless-Arch":Lw(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(t=(r=Deno.version)===null||r===void 0?void 0:r.deno)!==null&&t!==void 0?t:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Af,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(l==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Af,"X-Stainless-OS":Pw((e=globalThis.process.platform)!==null&&e!==void 0?e:"unknown"),"X-Stainless-Arch":Lw((a=globalThis.process.arch)!==null&&a!==void 0?a:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!==null&&i!==void 0?i:"unknown"};const o=YN();return o?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Af,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${o.browser}`,"X-Stainless-Runtime-Version":o.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Af,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function YN(){if(typeof navigator>"u"||!navigator)return null;const r=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:e}of r){const a=e.exec(navigator.userAgent);if(a){const i=a[1]||0,l=a[2]||0,o=a[3]||0;return{browser:t,version:`${i}.${l}.${o}`}}}return null}const Lw=r=>r==="x32"?"x32":r==="x86_64"||r==="x64"?"x64":r==="arm"?"arm":r==="aarch64"||r==="arm64"?"arm64":r?`other:${r}`:"unknown",Pw=r=>(r=r.toLowerCase(),r.includes("ios")?"iOS":r==="android"?"Android":r==="darwin"?"MacOS":r==="win32"?"Windows":r==="freebsd"?"FreeBSD":r==="openbsd"?"OpenBSD":r==="linux"?"Linux":r?`Other:${r}`:"Unknown");let F1;const XN=()=>F1??(F1=jN());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qN(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function yR(...r){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...r)}function WN(r){let t=Symbol.asyncIterator in r?r[Symbol.asyncIterator]():r[Symbol.iterator]();return yR({start(){},async pull(e){const{done:a,value:i}=await t.next();a?e.close():e.enqueue(i)},async cancel(){var e;await((e=t.return)===null||e===void 0?void 0:e.call(t))}})}function TR(r){if(r[Symbol.asyncIterator])return r;const t=r.getReader();return{async next(){try{const e=await t.read();return e!=null&&e.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function KN(r){var t,e;if(r===null||typeof r!="object")return;if(r[Symbol.asyncIterator]){await((e=(t=r[Symbol.asyncIterator]()).return)===null||e===void 0?void 0:e.call(t));return}const a=r.getReader(),i=a.cancel();a.releaseLock(),await i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $N=({headers:r,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const SR=()=>{var r;if(typeof File>"u"){const{process:t}=globalThis,e=typeof((r=t==null?void 0:t.versions)===null||r===void 0?void 0:r.node)=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(e?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function W_(r,t,e){return SR(),new File(r,t??"unknown_file",e)}function QN(r){return(typeof r=="object"&&r!==null&&("name"in r&&r.name&&String(r.name)||"url"in r&&r.url&&String(r.url)||"filename"in r&&r.filename&&String(r.filename)||"path"in r&&r.path&&String(r.path))||"").split(/[\\/]/).pop()||void 0}const ZN=r=>r!=null&&typeof r=="object"&&typeof r[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bR=r=>r!=null&&typeof r=="object"&&typeof r.size=="number"&&typeof r.type=="string"&&typeof r.text=="function"&&typeof r.slice=="function"&&typeof r.arrayBuffer=="function",JN=r=>r!=null&&typeof r=="object"&&typeof r.name=="string"&&typeof r.lastModified=="number"&&bR(r),eM=r=>r!=null&&typeof r=="object"&&typeof r.url=="string"&&typeof r.blob=="function";async function tM(r,t,e){if(SR(),r=await r,JN(r))return r instanceof File?r:W_([await r.arrayBuffer()],r.name);if(eM(r)){const i=await r.blob();return t||(t=new URL(r.url).pathname.split(/[\\/]/).pop()),W_(await xE(i),t,e)}const a=await xE(r);if(t||(t=QN(r)),!(e!=null&&e.type)){const i=a.find(l=>typeof l=="object"&&"type"in l&&l.type);typeof i=="string"&&(e=Object.assign(Object.assign({},e),{type:i}))}return W_(a,t,e)}async function xE(r){var t,e,a,i,l;let o=[];if(typeof r=="string"||ArrayBuffer.isView(r)||r instanceof ArrayBuffer)o.push(r);else if(bR(r))o.push(r instanceof Blob?r:await r.arrayBuffer());else if(ZN(r))try{for(var c=!0,f=If(r),d;d=await f.next(),t=d.done,!t;c=!0){i=d.value,c=!1;const g=i;o.push(...await xE(g))}}catch(g){e={error:g}}finally{try{!c&&!t&&(a=f.return)&&await a.call(f)}finally{if(e)throw e.error}}else{const g=(l=r==null?void 0:r.constructor)===null||l===void 0?void 0:l.name;throw new Error(`Unexpected data type: ${typeof r}${g?`; constructor: ${g}`:""}${rM(r)}`)}return o}function rM(r){return typeof r!="object"||r===null?"":`; props: [${Object.getOwnPropertyNames(r).map(e=>`"${e}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wR{constructor(t){this._client=t}}wR._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function CR(r){return r.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Bw=Object.freeze(Object.create(null)),aM=(r=CR)=>(function(e,...a){if(e.length===1)return e[0];let i=!1;const l=[],o=e.reduce((g,m,v)=>{var _,A,y;/[?#]/.test(m)&&(i=!0);const T=a[v];let S=(i?encodeURIComponent:r)(""+T);return v!==a.length&&(T==null||typeof T=="object"&&T.toString===((y=Object.getPrototypeOf((A=Object.getPrototypeOf((_=T.hasOwnProperty)!==null&&_!==void 0?_:Bw))!==null&&A!==void 0?A:Bw))===null||y===void 0?void 0:y.toString))&&(S=T+"",l.push({start:g.length+m.length,length:S.length,error:`Value of type ${Object.prototype.toString.call(T).slice(8,-1)} is not a valid path parameter`})),g+m+(v===a.length?"":S)},""),c=o.split(/[?#]/,1)[0],f=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let d;for(;(d=f.exec(c))!==null;)l.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(l.sort((g,m)=>g.start-m.start),l.length>0){let g=0;const m=l.reduce((v,_)=>{const A=" ".repeat(_.start-g),y="^".repeat(_.length);return g=_.start+_.length,v+A+y},"");throw new ci(`Path parameters result in path with invalid segments:
${l.map(v=>v.error).join(`
`)}
${o}
${m}`)}return o}),L1=aM(CR);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RR extends wR{create(t,e){var a;const{api_version:i=this._client.apiVersion}=t,l=Om(t,["api_version"]);if("model"in l&&"agent_config"in l)throw new ci("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in l&&"generation_config"in l)throw new ci("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(L1`/${i}/interactions`,Object.assign(Object.assign({body:l},e),{stream:(a=t.stream)!==null&&a!==void 0?a:!1}))}delete(t,e={},a){const{api_version:i=this._client.apiVersion}=e??{};return this._client.delete(L1`/${i}/interactions/${t}`,a)}cancel(t,e={},a){const{api_version:i=this._client.apiVersion}=e??{};return this._client.post(L1`/${i}/interactions/${t}/cancel`,a)}get(t,e={},a){var i;const l=e??{},{api_version:o=this._client.apiVersion}=l,c=Om(l,["api_version"]);return this._client.get(L1`/${o}/interactions/${t}`,Object.assign(Object.assign({query:c},a),{stream:(i=e==null?void 0:e.stream)!==null&&i!==void 0?i:!1}))}}RR._key=Object.freeze(["interactions"]);class kR extends RR{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nM(r){let t=0;for(const i of r)t+=i.length;const e=new Uint8Array(t);let a=0;for(const i of r)e.set(i,a),a+=i.length;return e}let P1;function jA(r){let t;return(P1??(t=new globalThis.TextEncoder,P1=t.encode.bind(t)))(r)}let B1;function Uw(r){let t;return(B1??(t=new globalThis.TextDecoder,B1=t.decode.bind(t)))(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xx{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(t){if(t==null)return[];const e=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?jA(t):t;this.buffer=nM([this.buffer,e]);const a=[];let i;for(;(i=iM(this.buffer,this.carriageReturnIndex))!=null;){if(i.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=i.index;continue}if(this.carriageReturnIndex!=null&&(i.index!==this.carriageReturnIndex+1||i.carriage)){a.push(Uw(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const l=this.carriageReturnIndex!==null?i.preceding-1:i.preceding,o=Uw(this.buffer.subarray(0,l));a.push(o),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return a}flush(){return this.buffer.length?this.decode(`
`):[]}}xx.NEWLINE_CHARS=new Set([`
`,"\r"]);xx.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function iM(r,t){for(let i=t??0;i<r.length;i++){if(r[i]===10)return{preceding:i,index:i+1,carriage:!1};if(r[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function sM(r){for(let a=0;a<r.length-1;a++){if(r[a]===10&&r[a+1]===10||r[a]===13&&r[a+1]===13)return a+2;if(r[a]===13&&r[a+1]===10&&a+3<r.length&&r[a+2]===13&&r[a+3]===10)return a+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Dm={off:0,error:200,warn:300,info:400,debug:500},Hw=(r,t,e)=>{if(r){if(UN(Dm,r))return r;Fa(e).warn(`${t} was set to ${JSON.stringify(r)}, expected one of ${JSON.stringify(Object.keys(Dm))}`)}};function W0(){}function U1(r,t,e){return!t||Dm[r]>Dm[e]?W0:t[r].bind(t)}const lM={error:W0,warn:W0,info:W0,debug:W0};let zw=new WeakMap;function Fa(r){var t;const e=r.logger,a=(t=r.logLevel)!==null&&t!==void 0?t:"off";if(!e)return lM;const i=zw.get(e);if(i&&i[0]===a)return i[1];const l={error:U1("error",e,a),warn:U1("warn",e,a),info:U1("info",e,a),debug:U1("debug",e,a)};return zw.set(e,[a,l]),l}const oc=r=>(r.options&&(r.options=Object.assign({},r.options),delete r.options.headers),r.headers&&(r.headers=Object.fromEntries((r.headers instanceof Headers?[...r.headers]:Object.entries(r.headers)).map(([t,e])=>[t,t.toLowerCase()==="x-goog-api-key"||t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":e]))),"retryOfRequestLogID"in r&&(r.retryOfRequestLogID&&(r.retryOf=r.retryOfRequestLogID),delete r.retryOfRequestLogID),r);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Of{constructor(t,e,a){this.iterator=t,this.controller=e,this.client=a}static fromSSEResponse(t,e,a){let i=!1;const l=a?Fa(a):console;function o(){return gd(this,arguments,function*(){var f,d,g,m;if(i)throw new ci("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let v=!1;try{try{for(var _=!0,A=If(oM(t,e)),y;y=yield ir(A.next()),f=y.done,!f;_=!0){m=y.value,_=!1;const T=m;if(!v)if(T.data.startsWith("[DONE]")){v=!0;continue}else try{yield yield ir(JSON.parse(T.data))}catch(S){throw l.error("Could not parse message into JSON:",T.data),l.error("From chunk:",T.raw),S}}}catch(T){d={error:T}}finally{try{!_&&!f&&(g=A.return)&&(yield ir(g.call(A)))}finally{if(d)throw d.error}}v=!0}catch(T){if(dE(T))return yield ir(void 0);throw T}finally{v||e.abort()}})}return new Of(o,e,a)}static fromReadableStream(t,e,a){let i=!1;function l(){return gd(this,arguments,function*(){var f,d,g,m;const v=new xx,_=TR(t);try{for(var A=!0,y=If(_),T;T=yield ir(y.next()),f=T.done,!f;A=!0){m=T.value,A=!1;const S=m;for(const R of v.decode(S))yield yield ir(R)}}catch(S){d={error:S}}finally{try{!A&&!f&&(g=y.return)&&(yield ir(g.call(y)))}finally{if(d)throw d.error}}for(const S of v.flush())yield yield ir(S)})}function o(){return gd(this,arguments,function*(){var f,d,g,m;if(i)throw new ci("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let v=!1;try{try{for(var _=!0,A=If(l()),y;y=yield ir(A.next()),f=y.done,!f;_=!0){m=y.value,_=!1;const T=m;v||T&&(yield yield ir(JSON.parse(T)))}}catch(T){d={error:T}}finally{try{!_&&!f&&(g=A.return)&&(yield ir(g.call(A)))}finally{if(d)throw d.error}}v=!0}catch(T){if(dE(T))return yield ir(void 0);throw T}finally{v||e.abort()}})}return new Of(o,e,a)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],e=[],a=this.iterator(),i=l=>({next:()=>{if(l.length===0){const o=a.next();t.push(o),e.push(o)}return l.shift()}});return[new Of(()=>i(t),this.controller,this.client),new Of(()=>i(e),this.controller,this.client)]}toReadableStream(){const t=this;let e;return yR({async start(){e=t[Symbol.asyncIterator]()},async pull(a){try{const{value:i,done:l}=await e.next();if(l)return a.close();const o=jA(JSON.stringify(i)+`
`);a.enqueue(o)}catch(i){a.error(i)}},async cancel(){var a;await((a=e.return)===null||a===void 0?void 0:a.call(e))}})}}function oM(r,t){return gd(this,arguments,function*(){var a,i,l,o;if(!r.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new ci("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new ci("Attempted to iterate over a response with no body");const c=new uM,f=new xx,d=TR(r.body);try{for(var g=!0,m=If(cM(d)),v;v=yield ir(m.next()),a=v.done,!a;g=!0){o=v.value,g=!1;const _=o;for(const A of f.decode(_)){const y=c.decode(A);y&&(yield yield ir(y))}}}catch(_){i={error:_}}finally{try{!g&&!a&&(l=m.return)&&(yield ir(l.call(m)))}finally{if(i)throw i.error}}for(const _ of f.flush()){const A=c.decode(_);A&&(yield yield ir(A))}})}function cM(r){return gd(this,arguments,function*(){var e,a,i,l;let o=new Uint8Array;try{for(var c=!0,f=If(r),d;d=yield ir(f.next()),e=d.done,!e;c=!0){l=d.value,c=!1;const g=l;if(g==null)continue;const m=g instanceof ArrayBuffer?new Uint8Array(g):typeof g=="string"?jA(g):g;let v=new Uint8Array(o.length+m.length);v.set(o),v.set(m,o.length),o=v;let _;for(;(_=sM(o))!==-1;)yield yield ir(o.slice(0,_)),o=o.slice(_)}}catch(g){a={error:g}}finally{try{!c&&!e&&(i=f.return)&&(yield ir(i.call(f)))}finally{if(a)throw a.error}}o.length>0&&(yield yield ir(o))})}class uM{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const l={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],l}if(this.chunks.push(t),t.startsWith(":"))return null;let[e,a,i]=fM(t,":");return i.startsWith(" ")&&(i=i.substring(1)),e==="event"?this.event=i:e==="data"&&this.data.push(i),null}}function fM(r,t){const e=r.indexOf(t);return e!==-1?[r.substring(0,e),t,r.substring(e+t.length)]:[r,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function hM(r,t){const{response:e,requestLogID:a,retryOfRequestLogID:i,startTime:l}=t,o=await(async()=>{var c;if(t.options.stream)return Fa(r).debug("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller,r):Of.fromSSEResponse(e,t.controller,r);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const f=e.headers.get("content-type"),d=(c=f==null?void 0:f.split(";")[0])===null||c===void 0?void 0:c.trim();return(d==null?void 0:d.includes("application/json"))||(d==null?void 0:d.endsWith("+json"))?await e.json():await e.text()})();return Fa(r).debug(`[${a}] response parsed`,oc({retryOfRequestLogID:i,url:e.url,status:e.status,body:o,durationMs:Date.now()-l})),o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class YA extends Promise{constructor(t,e,a=hM){super(i=>{i(null)}),this.responsePromise=e,this.parseResponse=a,this.client=t}_thenUnwrap(t){return new YA(this.client,this.responsePromise,async(e,a)=>t(await this.parseResponse(e,a),a))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,e]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:e}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(this.client,t))),this.parsedPromise}then(t,e){return this.parse().then(t,e)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const OR=Symbol("brand.privateNullableHeaders");function*dM(r){if(!r)return;if(OR in r){const{values:a,nulls:i}=r;yield*a.entries();for(const l of i)yield[l,null];return}let t=!1,e;r instanceof Headers?e=r.entries():Fw(r)?e=r:(t=!0,e=Object.entries(r??{}));for(let a of e){const i=a[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const l=Fw(a[1])?a[1]:[a[1]];let o=!1;for(const c of l)c!==void 0&&(t&&!o&&(o=!0,yield[i,null]),yield[i,c])}}const V0=r=>{const t=new Headers,e=new Set;for(const a of r){const i=new Set;for(const[l,o]of dM(a)){const c=l.toLowerCase();i.has(c)||(t.delete(l),i.add(c)),o===null?(t.delete(l),e.add(c)):(t.append(l,o),e.delete(c))}}return{[OR]:!0,values:t,nulls:e}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const K_=r=>{var t,e,a,i,l,o;if(typeof globalThis.process<"u")return(a=(e=(t=NN)===null||t===void 0?void 0:t[r])===null||e===void 0?void 0:e.trim())!==null&&a!==void 0?a:void 0;if(typeof globalThis.Deno<"u")return(o=(l=(i=globalThis.Deno.env)===null||i===void 0?void 0:i.get)===null||l===void 0?void 0:l.call(i,r))===null||o===void 0?void 0:o.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var DR;class vx{constructor(t){var e,a,i,l,o,c,f,{baseURL:d=K_("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:g=(e=K_("GEMINI_API_KEY"))!==null&&e!==void 0?e:null,apiVersion:m="v1beta"}=t,v=Om(t,["baseURL","apiKey","apiVersion"]);const _=Object.assign(Object.assign({apiKey:g,apiVersion:m},v),{baseURL:d||"https://generativelanguage.googleapis.com"});this.baseURL=_.baseURL,this.timeout=(a=_.timeout)!==null&&a!==void 0?a:vx.DEFAULT_TIMEOUT,this.logger=(i=_.logger)!==null&&i!==void 0?i:console;const A="warn";this.logLevel=A,this.logLevel=(o=(l=Hw(_.logLevel,"ClientOptions.logLevel",this))!==null&&l!==void 0?l:Hw(K_("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&o!==void 0?o:A,this.fetchOptions=_.fetchOptions,this.maxRetries=(c=_.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(f=_.fetch)!==null&&f!==void 0?f:qN(),this.encoder=$N,this._options=_,this.apiKey=g,this.apiVersion=m,this.clientAdapter=_.clientAdapter}withOptions(t){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),t))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:e}){if(!(t.has("authorization")||t.has("x-goog-api-key"))&&!(this.apiKey&&t.get("x-goog-api-key"))&&!e.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(t){const e=V0([t.headers]);if(!(e.values.has("authorization")||e.values.has("x-goog-api-key"))){if(this.apiKey)return V0([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return V0([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(t){return Object.entries(t).filter(([e,a])=>typeof a<"u").map(([e,a])=>{if(typeof a=="string"||typeof a=="number"||typeof a=="boolean")return`${encodeURIComponent(e)}=${encodeURIComponent(a)}`;if(a===null)return`${encodeURIComponent(e)}=`;throw new ci(`Cannot stringify type ${typeof a}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Af}`}defaultIdempotencyKey(){return`stainless-node-retry-${MN()}`}makeStatusError(t,e,a,i){return Va.generate(t,e,a,i)}buildURL(t,e,a){const i=!this.baseURLOverridden()&&a||this.baseURL,l=FN(t)?new URL(t):new URL(i+(i.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),o=this.defaultQuery();return BN(o)||(e=Object.assign(Object.assign({},o),e)),typeof e=="object"&&e&&!Array.isArray(e)&&(l.search=this.stringifyQuery(e)),l.toString()}async prepareOptions(t){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!t.path.startsWith(`/${this.apiVersion}/projects/`)){const e=t.path.slice(this.apiVersion.length+1);t.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${e}`}}async prepareRequest(t,{url:e,options:a}){}get(t,e){return this.methodRequest("get",t,e)}post(t,e){return this.methodRequest("post",t,e)}patch(t,e){return this.methodRequest("patch",t,e)}put(t,e){return this.methodRequest("put",t,e)}delete(t,e){return this.methodRequest("delete",t,e)}methodRequest(t,e,a){return this.request(Promise.resolve(a).then(i=>Object.assign({method:t,path:e},i)))}request(t,e=null){return new YA(this,this.makeRequest(t,e,void 0))}async makeRequest(t,e,a){var i,l,o;const c=await t,f=(i=c.maxRetries)!==null&&i!==void 0?i:this.maxRetries;e==null&&(e=f),await this.prepareOptions(c);const{req:d,url:g,timeout:m}=await this.buildRequest(c,{retryCount:f-e});await this.prepareRequest(d,{url:g,options:c});const v="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),_=a===void 0?"":`, retryOf: ${a}`,A=Date.now();if(Fa(this).debug(`[${v}] sending request`,oc({retryOfRequestLogID:a,method:c.method,url:g,options:c,headers:d.headers})),!((l=c.signal)===null||l===void 0)&&l.aborted)throw new gE;const y=new AbortController,T=await this.fetchWithTimeout(g,d,m,y).catch(pE),S=Date.now();if(T instanceof globalThis.Error){const C=`retrying, ${e} attempts remaining`;if(!((o=c.signal)===null||o===void 0)&&o.aborted)throw new gE;const F=dE(T)||/timed? ?out/i.test(String(T)+("cause"in T?String(T.cause):""));if(e)return Fa(this).info(`[${v}] connection ${F?"timed out":"failed"} - ${C}`),Fa(this).debug(`[${v}] connection ${F?"timed out":"failed"} (${C})`,oc({retryOfRequestLogID:a,url:g,durationMs:S-A,message:T.message})),this.retryRequest(c,e,a??v);throw Fa(this).info(`[${v}] connection ${F?"timed out":"failed"} - error; no more retries left`),Fa(this).debug(`[${v}] connection ${F?"timed out":"failed"} (error; no more retries left)`,oc({retryOfRequestLogID:a,url:g,durationMs:S-A,message:T.message})),F?new dR:new mx({cause:T})}const R=`[${v}${_}] ${d.method} ${g} ${T.ok?"succeeded":"failed"} with status ${T.status} in ${S-A}ms`;if(!T.ok){const C=await this.shouldRetry(T);if(e&&C){const j=`retrying, ${e} attempts remaining`;return await KN(T.body),Fa(this).info(`${R} - ${j}`),Fa(this).debug(`[${v}] response error (${j})`,oc({retryOfRequestLogID:a,url:T.url,status:T.status,headers:T.headers,durationMs:S-A})),this.retryRequest(c,e,a??v,T.headers)}const F=C?"error; no more retries left":"error; not retryable";Fa(this).info(`${R} - ${F}`);const U=await T.text().catch(j=>pE(j).message),B=zN(U),k=B?void 0:U;throw Fa(this).debug(`[${v}] response error (${F})`,oc({retryOfRequestLogID:a,url:T.url,status:T.status,headers:T.headers,message:k,durationMs:Date.now()-A})),this.makeStatusError(T.status,B,k,T.headers)}return Fa(this).info(R),Fa(this).debug(`[${v}] response start`,oc({retryOfRequestLogID:a,url:T.url,status:T.status,headers:T.headers,durationMs:S-A})),{response:T,options:c,controller:y,requestLogID:v,retryOfRequestLogID:a,startTime:A}}async fetchWithTimeout(t,e,a,i){const l=e||{},{signal:o,method:c}=l,f=Om(l,["signal","method"]);o&&o.addEventListener("abort",()=>i.abort());const d=setTimeout(()=>i.abort(),a),g=globalThis.ReadableStream&&f.body instanceof globalThis.ReadableStream||typeof f.body=="object"&&f.body!==null&&Symbol.asyncIterator in f.body,m=Object.assign(Object.assign(Object.assign({signal:i.signal},g?{duplex:"half"}:{}),{method:"GET"}),f);c&&(m.method=c.toUpperCase());try{return await this.fetch.call(void 0,t,m)}finally{clearTimeout(d)}}async shouldRetry(t){const e=t.headers.get("x-should-retry");return e==="true"?!0:e==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,e,a,i){var l;let o;const c=i==null?void 0:i.get("retry-after-ms");if(c){const d=parseFloat(c);Number.isNaN(d)||(o=d)}const f=i==null?void 0:i.get("retry-after");if(f&&!o){const d=parseFloat(f);Number.isNaN(d)?o=Date.parse(f)-Date.now():o=d*1e3}if(!(o&&0<=o&&o<60*1e3)){const d=(l=t.maxRetries)!==null&&l!==void 0?l:this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(e,d)}return await GN(o),this.makeRequest(t,e-1,a)}calculateDefaultRetryTimeoutMillis(t,e){const l=e-t,o=Math.min(.5*Math.pow(2,l),8),c=1-Math.random()*.25;return o*c*1e3}async buildRequest(t,{retryCount:e=0}={}){var a,i,l;const o=Object.assign({},t),{method:c,path:f,query:d,defaultBaseURL:g}=o,m=this.buildURL(f,d,g);"timeout"in o&&HN("timeout",o.timeout),o.timeout=(a=o.timeout)!==null&&a!==void 0?a:this.timeout;const{bodyHeaders:v,body:_}=this.buildBody({options:o}),A=await this.buildHeaders({options:t,method:c,bodyHeaders:v,retryCount:e});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:A},o.signal&&{signal:o.signal}),globalThis.ReadableStream&&_ instanceof globalThis.ReadableStream&&{duplex:"half"}),_&&{body:_}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(l=o.fetchOptions)!==null&&l!==void 0?l:{}),url:m,timeout:o.timeout}}async buildHeaders({options:t,method:e,bodyHeaders:a,retryCount:i}){let l={};this.idempotencyHeader&&e!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=t.idempotencyKey);const o=await this.authHeaders(t);let c=V0([l,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),XN()),this._options.defaultHeaders,a,t.headers,o]);return this.validateHeaders(c),c.values}buildBody({options:{body:t,headers:e}}){if(!t)return{bodyHeaders:void 0,body:void 0};const a=V0([e]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&a.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:WN(t)}:this.encoder({body:t,headers:a})}}vx.DEFAULT_TIMEOUT=6e4;class oa extends vx{constructor(){super(...arguments),this.interactions=new kR(this)}}DR=oa;oa.GeminiNextGenAPIClient=DR;oa.GeminiNextGenAPIClientError=ci;oa.APIError=Va;oa.APIConnectionError=mx;oa.APIConnectionTimeoutError=dR;oa.APIUserAbortError=gE;oa.NotFoundError=xR;oa.ConflictError=vR;oa.RateLimitError=ER;oa.BadRequestError=pR;oa.AuthenticationError=gR;oa.InternalServerError=AR;oa.PermissionDeniedError=mR;oa.UnprocessableEntityError=_R;oa.toFile=tM;oa.Interactions=kR;const pM="gemini-3-pro-preview";class gM{constructor(){throw new Error("Gemini API key is missing (VITE_GEMINI_API_KEY)")}async askAboutDocuments(t,e,a,i,l){const o="confidential-dir",f=`
      You are the "Smart College Bot". You are an expert interface for a project directory.
      Your knowledge base is strictly limited to the provided sources in the /sources/ directory.

      STRICT SECURITY PROTOCOL:
      1. If a user asks a question that matches a file in the /sources/confidential/ directory while it is [LOCKED], you MUST NOT provide any information from it.
      2. In this case, you MUST respond with this EXACT phrase and NOTHING ELSE:
         "The information you are requesting is part of our confidential records. To view this data, please verify your administrator credentials."
         (Arabic: "       .          .")

      GENERAL RULES:
      - Answer in English or Arabic based on the user's language.
      - If you have access (UNLOCKED), answer fully and cite the source like [FileName].
      - If the query is general and not in the docs, politely explain you only know what's in the Smart College records.

      VIRTUAL PROJECT CONTEXT:
      ${e.map(d=>{const g=d.folderId===o;return g&&!l?`--- SOURCE: /sources/confidential/${d.name} ---
[SECURITY: LOCKED]
[INFO: This file exists in the confidential directory. Content is hidden from the AI until Administrator Login is completed.]
`:`--- SOURCE: /sources/${g?"confidential":"general"}/${d.name} ---
[SECURITY: UNLOCKED]
[CONTENT]:
${d.content}
`}).join(`
`)}
    `;try{const d=i.slice(-6).map(A=>({role:A.role,parts:[{text:A.text}]})),m=(await this.ai.models.generateContent({model:pM,contents:[...d,{role:"user",parts:[{text:t}]}],config:{systemInstruction:f,temperature:0}})).text||"Connection failed.",v=m.toLowerCase().includes("administrator credentials")||m.includes("  "),_=e.filter(A=>m.includes(`[${A.name}]`)||m.toLowerCase().includes(A.name.toLowerCase())).map(A=>A.name);return{text:m,sources:Array.from(new Set(_)),needsAdmin:v}}catch(d){throw console.error("Gemini API Error:",d),d}}}const mM=new gM,xM="SMartCollegeDB",qi="documents",vM=1;class _M{constructor(){this.db=null}async init(){return new Promise((t,e)=>{const a=indexedDB.open(xM,vM);a.onerror=()=>e(a.error),a.onsuccess=()=>{this.db=a.result,t()},a.onupgradeneeded=i=>{const l=i.target.result;l.objectStoreNames.contains(qi)||l.createObjectStore(qi,{keyPath:"id"})}})}async getAllDocuments(){return await this.ensureInit(),new Promise((t,e)=>{const l=this.db.transaction(qi,"readonly").objectStore(qi).getAll();l.onsuccess=()=>t(l.result),l.onerror=()=>e(l.error)})}async saveDocument(t){return await this.ensureInit(),new Promise((e,a)=>{const o=this.db.transaction(qi,"readwrite").objectStore(qi).put(t);o.onsuccess=()=>e(),o.onerror=()=>a(o.error)})}async deleteDocument(t){return await this.ensureInit(),new Promise((e,a)=>{const o=this.db.transaction(qi,"readwrite").objectStore(qi).delete(t);o.onsuccess=()=>e(),o.onerror=()=>a(o.error)})}async clearAllDocuments(){return await this.ensureInit(),new Promise((t,e)=>{const l=this.db.transaction(qi,"readwrite").objectStore(qi).clear();l.onsuccess=()=>t(),l.onerror=()=>e(l.error)})}async ensureInit(){this.db||await this.init()}}const H1=new _M;var md={};md.d=(r,t)=>{for(var e in t)md.o(t,e)&&!md.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:t[e]})};md.o=(r,t)=>Object.prototype.hasOwnProperty.call(r,t);var Ke=globalThis.pdfjsLib={};md.d(Ke,{AbortException:()=>Io,AnnotationEditorLayer:()=>wA,AnnotationEditorParamsType:()=>mt,AnnotationEditorType:()=>nt,AnnotationEditorUIManager:()=>Tu,AnnotationLayer:()=>pF,AnnotationMode:()=>Ql,ColorPicker:()=>Pm,DOMSVGFactory:()=>ey,DrawLayer:()=>kA,FeatureTest:()=>Ua,GlobalWorkerOptions:()=>pl,ImageKind:()=>em,InvalidPDFException:()=>_E,MissingPDFException:()=>Cd,OPS:()=>Ai,OutputScale:()=>AE,PDFDataRangeTransport:()=>Mk,PDFDateString:()=>$A,PDFWorker:()=>Lf,PasswordResponses:()=>TM,PermissionFlag:()=>yM,PixelsPerInch:()=>Fo,RenderingCancelledException:()=>WA,TextLayer:()=>Rd,TouchManager:()=>Fm,UnexpectedResponseException:()=>Nm,Util:()=>Ve,VerbosityLevel:()=>_x,XfaLayer:()=>Fk,build:()=>WI,createValidAbsoluteUrl:()=>CM,fetchData:()=>Tx,getDocument:()=>UI,getFilenameFromUrl:()=>LM,getPdfFilenameFromUrl:()=>PM,getXfaPageViewport:()=>BM,isDataScheme:()=>Sx,isPdfFile:()=>KA,noContextMenu:()=>Ui,normalizeUnicode:()=>MM,setLayerDimensions:()=>yu,shadow:()=>ut,stopEvent:()=>Nn,version:()=>qI});const Aa=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),NR=[1,0,0,1,0,0],vE=[.001,0,0,.001,0,0],EM=1e7,$_=1.35,kn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ql={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},AM="pdfjs_internal_editor_",nt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},mt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},yM={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},ha={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},em={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Dr={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},j0={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},_x={ERRORS:0,WARNINGS:1,INFOS:5},Ai={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},TM={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Ex=_x.WARNINGS;function SM(r){Number.isInteger(r)&&(Ex=r)}function bM(){return Ex}function Ax(r){Ex>=_x.INFOS&&console.log(`Info: ${r}`)}function it(r){Ex>=_x.WARNINGS&&console.log(`Warning: ${r}`)}function Ut(r){throw new Error(r)}function Rr(r,t){r||Ut(t)}function wM(r){switch(r==null?void 0:r.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function CM(r,t=null,e=null){if(!r)return null;try{if(e&&typeof r=="string"){if(e.addDefaultProtocol&&r.startsWith("www.")){const i=r.match(/\./g);(i==null?void 0:i.length)>=2&&(r=`http://${r}`)}if(e.tryConvertEncoding)try{r=NM(r)}catch{}}const a=t?new URL(r,t):new URL(r);if(wM(a))return a}catch{}return null}function ut(r,t,e,a=!1){return Object.defineProperty(r,t,{value:e,enumerable:!a,configurable:!0,writable:!1}),e}const Uo=(function(){function t(e,a){this.message=e,this.name=a}return t.prototype=new Error,t.constructor=t,t})();class Gw extends Uo{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Q_ extends Uo{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class _E extends Uo{constructor(t){super(t,"InvalidPDFException")}}class Cd extends Uo{constructor(t){super(t,"MissingPDFException")}}class Nm extends Uo{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class RM extends Uo{constructor(t){super(t,"FormatError")}}class Io extends Uo{constructor(t){super(t,"AbortException")}}function MR(r){(typeof r!="object"||(r==null?void 0:r.length)===void 0)&&Ut("Invalid argument for bytesToString");const t=r.length,e=8192;if(t<e)return String.fromCharCode.apply(null,r);const a=[];for(let i=0;i<t;i+=e){const l=Math.min(i+e,t),o=r.subarray(i,l);a.push(String.fromCharCode.apply(null,o))}return a.join("")}function yx(r){typeof r!="string"&&Ut("Invalid argument for stringToBytes");const t=r.length,e=new Uint8Array(t);for(let a=0;a<t;++a)e[a]=r.charCodeAt(a)&255;return e}function kM(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function XA(r){const t=Object.create(null);for(const[e,a]of r)t[e]=a;return t}function OM(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function DM(){try{return new Function(""),!0}catch{return!1}}class Ua{static get isLittleEndian(){return ut(this,"isLittleEndian",OM())}static get isEvalSupported(){return ut(this,"isEvalSupported",DM())}static get isOffscreenCanvasSupported(){return ut(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ut(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?ut(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):ut(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var t,e;return ut(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const Z_=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));var vl,tm,EE;class Ve{static makeHexColor(t,e,a){return`#${Z_[t]}${Z_[e]}${Z_[a]}`}static scaleMinMax(t,e){let a;t[0]?(t[0]<0&&(a=e[0],e[0]=e[2],e[2]=a),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(a=e[1],e[1]=e[3],e[3]=a),e[1]*=t[3],e[3]*=t[3]):(a=e[0],e[0]=e[1],e[1]=a,a=e[2],e[2]=e[3],e[3]=a,t[1]<0&&(a=e[1],e[1]=e[3],e[3]=a),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(a=e[0],e[0]=e[2],e[2]=a),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const a=t[0]*e[0]+t[1]*e[2]+e[4],i=t[0]*e[1]+t[1]*e[3]+e[5];return[a,i]}static applyInverseTransform(t,e){const a=e[0]*e[3]-e[1]*e[2],i=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/a,l=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/a;return[i,l]}static getAxialAlignedBoundingBox(t,e){const a=this.applyTransform(t,e),i=this.applyTransform(t.slice(2,4),e),l=this.applyTransform([t[0],t[3]],e),o=this.applyTransform([t[2],t[1]],e);return[Math.min(a[0],i[0],l[0],o[0]),Math.min(a[1],i[1],l[1],o[1]),Math.max(a[0],i[0],l[0],o[0]),Math.max(a[1],i[1],l[1],o[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],a=t[0]*e[0]+t[1]*e[2],i=t[0]*e[1]+t[1]*e[3],l=t[2]*e[0]+t[3]*e[2],o=t[2]*e[1]+t[3]*e[3],c=(a+o)/2,f=Math.sqrt((a+o)**2-4*(a*o-l*i))/2,d=c+f||1,g=c-f||1;return[Math.sqrt(d),Math.sqrt(g)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const a=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(a>i)return null;const l=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return l>o?null:[a,l,i,o]}static bezierBoundingBox(t,e,a,i,l,o,c,f,d){return d?(d[0]=Math.min(d[0],t,c),d[1]=Math.min(d[1],e,f),d[2]=Math.max(d[2],t,c),d[3]=Math.max(d[3],e,f)):d=[Math.min(t,c),Math.min(e,f),Math.max(t,c),Math.max(e,f)],D(this,vl,EE).call(this,t,a,l,c,e,i,o,f,3*(-t+3*(a-l)+c),6*(t-2*a+l),3*(a-t),d),D(this,vl,EE).call(this,t,a,l,c,e,i,o,f,3*(-e+3*(i-o)+f),6*(e-2*i+o),3*(i-e),d),d}}vl=new WeakSet,tm=function(t,e,a,i,l,o,c,f,d,g){if(d<=0||d>=1)return;const m=1-d,v=d*d,_=v*d,A=m*(m*(m*t+3*d*e)+3*v*a)+_*i,y=m*(m*(m*l+3*d*o)+3*v*c)+_*f;g[0]=Math.min(g[0],A),g[1]=Math.min(g[1],y),g[2]=Math.max(g[2],A),g[3]=Math.max(g[3],y)},EE=function(t,e,a,i,l,o,c,f,d,g,m,v){if(Math.abs(d)<1e-12){Math.abs(g)>=1e-12&&D(this,vl,tm).call(this,t,e,a,i,l,o,c,f,-m/g,v);return}const _=g**2-4*m*d;if(_<0)return;const A=Math.sqrt(_),y=2*d;D(this,vl,tm).call(this,t,e,a,i,l,o,c,f,(-g+A)/y,v),D(this,vl,tm).call(this,t,e,a,i,l,o,c,f,(-g-A)/y,v)},O(Ve,vl);function NM(r){return decodeURIComponent(escape(r))}let J_=null,Vw=null;function MM(r){return J_||(J_=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Vw=new Map([["","t"]])),r.replaceAll(J_,(t,e,a)=>e?e.normalize("NFKC"):Vw.get(a))}function IM(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),MR(r)}const qA="pdfjs_internal_id_";function FM(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(MR(r))}typeof Promise.try!="function"&&(Promise.try=function(r,...t){return new Promise(e=>{e(r(...t))})});const Bs="http://www.w3.org/2000/svg",dc=class dc{};Xe(dc,"CSS",96),Xe(dc,"PDF",72),Xe(dc,"PDF_TO_CSS_UNITS",dc.CSS/dc.PDF);let Fo=dc;async function Tx(r,t="text"){if(K0(r,document.baseURI)){const e=await fetch(r);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,a)=>{const i=new XMLHttpRequest;i.open("GET",r,!0),i.responseType=t,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(i.response);return}e(i.responseText);return}a(new Error(i.statusText))}},i.send(null)})}class ug{constructor({viewBox:t,userUnit:e,scale:a,rotation:i,offsetX:l=0,offsetY:o=0,dontFlip:c=!1}){this.viewBox=t,this.userUnit=e,this.scale=a,this.rotation=i,this.offsetX=l,this.offsetY=o,a*=e;const f=(t[2]+t[0])/2,d=(t[3]+t[1])/2;let g,m,v,_;switch(i%=360,i<0&&(i+=360),i){case 180:g=-1,m=0,v=0,_=1;break;case 90:g=0,m=1,v=1,_=0;break;case 270:g=0,m=-1,v=-1,_=0;break;case 0:g=1,m=0,v=0,_=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(v=-v,_=-_);let A,y,T,S;g===0?(A=Math.abs(d-t[1])*a+l,y=Math.abs(f-t[0])*a+o,T=(t[3]-t[1])*a,S=(t[2]-t[0])*a):(A=Math.abs(f-t[0])*a+l,y=Math.abs(d-t[1])*a+o,T=(t[2]-t[0])*a,S=(t[3]-t[1])*a),this.transform=[g*a,m*a,v*a,_*a,A-g*a*f-v*a*d,y-m*a*f-_*a*d],this.width=T,this.height=S}get rawDims(){const{userUnit:t,viewBox:e}=this,a=e.map(i=>i*t);return ut(this,"rawDims",{pageWidth:a[2]-a[0],pageHeight:a[3]-a[1],pageX:a[0],pageY:a[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:a=this.offsetX,offsetY:i=this.offsetY,dontFlip:l=!1}={}){return new ug({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:a,offsetY:i,dontFlip:l})}convertToViewportPoint(t,e){return Ve.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=Ve.applyTransform([t[0],t[1]],this.transform),a=Ve.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],a[0],a[1]]}convertToPdfPoint(t,e){return Ve.applyInverseTransform([t,e],this.transform)}}class WA extends Uo{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Sx(r){const t=r.length;let e=0;for(;e<t&&r[e].trim()==="";)e++;return r.substring(e,e+5).toLowerCase()==="data:"}function KA(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function LM(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function PM(r,t="document.pdf"){if(typeof r!="string")return t;if(Sx(r))return it('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,a=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=e.exec(r);let l=a.exec(i[1])||a.exec(i[2])||a.exec(i[3]);if(l&&(l=l[0],l.includes("%")))try{l=a.exec(decodeURIComponent(l))[0]}catch{}return l||t}class jw{constructor(){Xe(this,"started",Object.create(null));Xe(this,"times",[])}time(t){t in this.started&&it(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||it(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:a}of this.times)e=Math.max(a.length,e);for(const{name:a,start:i,end:l}of this.times)t.push(`${a.padEnd(e)} ${l-i}ms
`);return t.join("")}}function K0(r,t){try{const{protocol:e}=t?new URL(r,t):new URL(r);return e==="http:"||e==="https:"}catch{return!1}}function Ui(r){r.preventDefault()}function Nn(r){r.preventDefault(),r.stopPropagation()}var Ud;class $A{static toDateObject(t){if(!t||typeof t!="string")return null;p(this,Ud)||w(this,Ud,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=p(this,Ud).exec(t);if(!e)return null;const a=parseInt(e[1],10);let i=parseInt(e[2],10);i=i>=1&&i<=12?i-1:0;let l=parseInt(e[3],10);l=l>=1&&l<=31?l:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let c=parseInt(e[5],10);c=c>=0&&c<=59?c:0;let f=parseInt(e[6],10);f=f>=0&&f<=59?f:0;const d=e[7]||"Z";let g=parseInt(e[8],10);g=g>=0&&g<=23?g:0;let m=parseInt(e[9],10)||0;return m=m>=0&&m<=59?m:0,d==="-"?(o+=g,c+=m):d==="+"&&(o-=g,c-=m),new Date(Date.UTC(a,i,l,o,c,f))}}Ud=new WeakMap,O($A,Ud);function BM(r,{scale:t=1,rotation:e=0}){const{width:a,height:i}=r.attributes.style,l=[0,0,parseInt(a),parseInt(i)];return new ug({viewBox:l,userUnit:1,scale:t,rotation:e})}function QA(r){if(r.startsWith("#")){const t=parseInt(r.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(t=>parseInt(t)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(it(`Not a valid color format: "${r}"`),[0,0,0])}function UM(r){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of r.keys()){t.style.color=e;const a=window.getComputedStyle(t).color;r.set(e,QA(a))}t.remove()}function Jt(r){const{a:t,b:e,c:a,d:i,e:l,f:o}=r.getTransform();return[t,e,a,i,l,o]}function Wi(r){const{a:t,b:e,c:a,d:i,e:l,f:o}=r.getTransform().invertSelf();return[t,e,a,i,l,o]}function yu(r,t,e=!1,a=!0){if(t instanceof ug){const{pageWidth:i,pageHeight:l}=t.rawDims,{style:o}=r,c=Ua.isCSSRoundSupported,f=`var(--scale-factor) * ${i}px`,d=`var(--scale-factor) * ${l}px`,g=c?`round(down, ${f}, var(--scale-round-x, 1px))`:`calc(${f})`,m=c?`round(down, ${d}, var(--scale-round-y, 1px))`:`calc(${d})`;!e||t.rotation%180===0?(o.width=g,o.height=m):(o.width=m,o.height=g)}a&&r.setAttribute("data-main-rotation",t.rotation)}class AE{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Jl,mc,yi,xc,Hd,zd,Qm,IR,za,FR,LR,rm,PR,TE;const zs=class zs{constructor(t){O(this,za);O(this,Jl,null);O(this,mc,null);O(this,yi);O(this,xc,null);O(this,Hd,null);w(this,yi,t),p(zs,zd)||w(zs,zd,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const t=w(this,Jl,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=p(this,yi)._uiManager._signal;t.addEventListener("contextmenu",Ui,{signal:e}),t.addEventListener("pointerdown",D(zs,Qm,IR),{signal:e});const a=w(this,xc,document.createElement("div"));a.className="buttons",t.append(a);const i=p(this,yi).toolbarPosition;if(i){const{style:l}=t,o=p(this,yi)._uiManager.direction==="ltr"?1-i[0]:i[0];l.insetInlineEnd=`${100*o}%`,l.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return D(this,za,PR).call(this),t}get div(){return p(this,Jl)}hide(){var t;p(this,Jl).classList.add("hidden"),(t=p(this,mc))==null||t.hideDropdown()}show(){var t;p(this,Jl).classList.remove("hidden"),(t=p(this,Hd))==null||t.shown()}async addAltText(t){const e=await t.render();D(this,za,rm).call(this,e),p(this,xc).prepend(e,p(this,za,TE)),w(this,Hd,t)}addColorPicker(t){w(this,mc,t);const e=t.renderButton();D(this,za,rm).call(this,e),p(this,xc).prepend(e,p(this,za,TE))}remove(){var t;p(this,Jl).remove(),(t=p(this,mc))==null||t.destroy(),w(this,mc,null)}};Jl=new WeakMap,mc=new WeakMap,yi=new WeakMap,xc=new WeakMap,Hd=new WeakMap,zd=new WeakMap,Qm=new WeakSet,IR=function(t){t.stopPropagation()},za=new WeakSet,FR=function(t){p(this,yi)._focusEventsAllowed=!1,Nn(t)},LR=function(t){p(this,yi)._focusEventsAllowed=!0,Nn(t)},rm=function(t){const e=p(this,yi)._uiManager._signal;t.addEventListener("focusin",D(this,za,FR).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",D(this,za,LR).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Ui,{signal:e})},PR=function(){const{editorType:t,_uiManager:e}=p(this,yi),a=document.createElement("button");a.className="delete",a.tabIndex=0,a.setAttribute("data-l10n-id",p(zs,zd)[t]),D(this,za,rm).call(this,a),a.addEventListener("click",i=>{e.delete()},{signal:e._signal}),p(this,xc).append(a)},TE=function(){const t=document.createElement("div");return t.className="divider",t},O(zs,Qm),O(zs,zd,null);let yE=zs;var Gd,vc,_c,Bo,BR,UR,HR;class HM{constructor(t){O(this,Bo);O(this,Gd,null);O(this,vc,null);O(this,_c);w(this,_c,t)}show(t,e,a){const[i,l]=D(this,Bo,UR).call(this,e,a),{style:o}=p(this,vc)||w(this,vc,D(this,Bo,BR).call(this));t.append(p(this,vc)),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){p(this,vc).remove()}}Gd=new WeakMap,vc=new WeakMap,_c=new WeakMap,Bo=new WeakSet,BR=function(){const t=w(this,vc,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Ui,{signal:p(this,_c)._signal});const e=w(this,Gd,document.createElement("div"));return e.className="buttons",t.append(e),D(this,Bo,HR).call(this),t},UR=function(t,e){let a=0,i=0;for(const l of t){const o=l.y+l.height;if(o<a)continue;const c=l.x+(e?l.width:0);if(o>a){i=c,a=o;continue}e?c>i&&(i=c):c<i&&(i=c)}return[e?1-i:i,a]},HR=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const a=p(this,_c)._signal;t.addEventListener("contextmenu",Ui,{signal:a}),t.addEventListener("click",()=>{p(this,_c).highlightSelection("floating_button")},{signal:a}),p(this,Gd).append(t)};function Mm(r,t,e){for(const a of e)t.addEventListener(a,r[a].bind(r))}var Zm;class zM{constructor(){O(this,Zm,0)}get id(){return`${AM}${ka(this,Zm)._++}`}}Zm=new WeakMap;var Hf,Vd,ga,zf,am;const ky=class ky{constructor(){O(this,zf);O(this,Hf,IM());O(this,Vd,0);O(this,ga,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',a=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=t;const l=i.decode().then(()=>(a.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(a.getImageData(0,0,1,1).data.buffer)[0]===0));return ut(this,"_isSVGFittingCanvas",l)}async getFromFile(t){const{lastModified:e,name:a,size:i,type:l}=t;return D(this,zf,am).call(this,`${e}_${a}_${i}_${l}`,t)}async getFromUrl(t){return D(this,zf,am).call(this,t,t)}async getFromBlob(t,e){const a=await e;return D(this,zf,am).call(this,t,a)}async getFromId(t){p(this,ga)||w(this,ga,new Map);const e=p(this,ga).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:a}=e;return delete e.blobPromise,this.getFromBlob(e.id,a)}return this.getFromUrl(e.url)}getFromCanvas(t,e){p(this,ga)||w(this,ga,new Map);let a=p(this,ga).get(t);if(a!=null&&a.bitmap)return a.refCounter+=1,a;const i=new OffscreenCanvas(e.width,e.height);return i.getContext("2d").drawImage(e,0,0),a={bitmap:i.transferToImageBitmap(),id:`image_${p(this,Hf)}_${ka(this,Vd)._++}`,refCounter:1,isSvg:!1},p(this,ga).set(t,a),p(this,ga).set(a.id,a),a}getSvgUrl(t){const e=p(this,ga).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var i;p(this,ga)||w(this,ga,new Map);const e=p(this,ga).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:a}=e;if(!e.url&&!e.file){const l=new OffscreenCanvas(a.width,a.height);l.getContext("bitmaprenderer").transferFromImageBitmap(a),e.blobPromise=l.convertToBlob()}(i=a.close)==null||i.call(a),e.bitmap=null}isValidId(t){return t.startsWith(`image_${p(this,Hf)}_`)}};Hf=new WeakMap,Vd=new WeakMap,ga=new WeakMap,zf=new WeakSet,am=async function(t,e){p(this,ga)||w(this,ga,new Map);let a=p(this,ga).get(t);if(a===null)return null;if(a!=null&&a.bitmap)return a.refCounter+=1,a;try{a||(a={bitmap:null,id:`image_${p(this,Hf)}_${ka(this,Vd)._++}`,refCounter:0,isSvg:!1});let i;if(typeof e=="string"?(a.url=e,i=await Tx(e,"blob")):e instanceof File?i=a.file=e:e instanceof Blob&&(i=e),i.type==="image/svg+xml"){const l=ky._isSVGFittingCanvas,o=new FileReader,c=new Image,f=new Promise((d,g)=>{c.onload=()=>{a.bitmap=c,a.isSvg=!0,d()},o.onload=async()=>{const m=a.svgUrl=o.result;c.src=await l?`${m}#svgView(preserveAspectRatio(none))`:m},c.onerror=o.onerror=g});o.readAsDataURL(i),await f}else a.bitmap=await createImageBitmap(i);a.refCounter=1}catch(i){it(i),a=null}return p(this,ga).set(t,a),a&&p(this,ga).set(a.id,a),a};let SE=ky;var mr,eo,jd,ar;class GM{constructor(t=128){O(this,mr,[]);O(this,eo,!1);O(this,jd);O(this,ar,-1);w(this,jd,t)}add({cmd:t,undo:e,post:a,mustExec:i,type:l=NaN,overwriteIfSameType:o=!1,keepUndo:c=!1}){if(i&&t(),p(this,eo))return;const f={cmd:t,undo:e,post:a,type:l};if(p(this,ar)===-1){p(this,mr).length>0&&(p(this,mr).length=0),w(this,ar,0),p(this,mr).push(f);return}if(o&&p(this,mr)[p(this,ar)].type===l){c&&(f.undo=p(this,mr)[p(this,ar)].undo),p(this,mr)[p(this,ar)]=f;return}const d=p(this,ar)+1;d===p(this,jd)?p(this,mr).splice(0,1):(w(this,ar,d),d<p(this,mr).length&&p(this,mr).splice(d)),p(this,mr).push(f)}undo(){if(p(this,ar)===-1)return;w(this,eo,!0);const{undo:t,post:e}=p(this,mr)[p(this,ar)];t(),e==null||e(),w(this,eo,!1),w(this,ar,p(this,ar)-1)}redo(){if(p(this,ar)<p(this,mr).length-1){w(this,ar,p(this,ar)+1),w(this,eo,!0);const{cmd:t,post:e}=p(this,mr)[p(this,ar)];t(),e==null||e(),w(this,eo,!1)}}hasSomethingToUndo(){return p(this,ar)!==-1}hasSomethingToRedo(){return p(this,ar)<p(this,mr).length-1}cleanType(t){if(p(this,ar)!==-1){for(let e=p(this,ar);e>=0;e--)if(p(this,mr)[e].type!==t){p(this,mr).splice(e+1,p(this,ar)-e),w(this,ar,e);return}p(this,mr).length=0,w(this,ar,-1)}}destroy(){w(this,mr,null)}}mr=new WeakMap,eo=new WeakMap,jd=new WeakMap,ar=new WeakMap;var Jm,zR;class fg{constructor(t){O(this,Jm);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Ua.platform;for(const[a,i,l={}]of t)for(const o of a){const c=o.startsWith("mac+");e&&c?(this.callbacks.set(o.slice(4),{callback:i,options:l}),this.allKeys.add(o.split("+").at(-1))):!e&&!c&&(this.callbacks.set(o,{callback:i,options:l}),this.allKeys.add(o.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const a=this.callbacks.get(D(this,Jm,zR).call(this,e));if(!a)return;const{callback:i,options:{bubbles:l=!1,args:o=[],checker:c=null}}=a;c&&!c(t,e)||(i.bind(t,...o,e)(),l||Nn(e))}}Jm=new WeakSet,zR=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const ex=class ex{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return UM(t),ut(this,"_colors",t)}convert(t){const e=QA(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[a,i]of this._colors)if(i.every((l,o)=>l===e[o]))return ex._colorsMapping.get(a);return e}getHexCode(t){const e=this._colors.get(t);return e?Ve.makeHexColor(...e):t}};Xe(ex,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let bE=ex;var Gf,xn,Mr,Jr,Vf,Vs,jf,Jn,to,Ec,Yf,Ac,Ji,Ti,yc,Yd,Xd,Xf,qd,es,ro,qf,ao,ts,tx,no,Wd,io,Tc,Kd,$d,zr,Ot,js,Sc,Qd,Zd,so,rs,Ys,Jd,ei,Me,nm,wE,GR,VR,im,jR,YR,XR,CE,qR,RE,kE,WR,Oa,Us,KR,$R,OE,QR,$0,DE;const Nf=class Nf{constructor(t,e,a,i,l,o,c,f,d,g,m,v,_){O(this,Me);O(this,Gf,new AbortController);O(this,xn,null);O(this,Mr,new Map);O(this,Jr,new Map);O(this,Vf,null);O(this,Vs,null);O(this,jf,null);O(this,Jn,new GM);O(this,to,null);O(this,Ec,null);O(this,Yf,0);O(this,Ac,new Set);O(this,Ji,null);O(this,Ti,null);O(this,yc,new Set);Xe(this,"_editorUndoBar",null);O(this,Yd,!1);O(this,Xd,!1);O(this,Xf,!1);O(this,qd,null);O(this,es,null);O(this,ro,null);O(this,qf,null);O(this,ao,!1);O(this,ts,null);O(this,tx,new zM);O(this,no,!1);O(this,Wd,!1);O(this,io,null);O(this,Tc,null);O(this,Kd,null);O(this,$d,null);O(this,zr,nt.NONE);O(this,Ot,new Set);O(this,js,null);O(this,Sc,null);O(this,Qd,null);O(this,Zd,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});O(this,so,[0,0]);O(this,rs,null);O(this,Ys,null);O(this,Jd,null);O(this,ei,null);const A=this._signal=p(this,Gf).signal;w(this,Ys,t),w(this,Jd,e),w(this,Vf,a),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:A}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:A}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:A}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:A}),i._on("setpreference",this.onSetPreference.bind(this),{signal:A}),i._on("switchannotationeditorparams",y=>this.updateParams(y.type,y.value),{signal:A}),D(this,Me,jR).call(this),D(this,Me,WR).call(this),D(this,Me,CE).call(this),w(this,Vs,l.annotationStorage),w(this,qd,l.filterFactory),w(this,Sc,o),w(this,qf,c||null),w(this,Yd,f),w(this,Xd,d),w(this,Xf,g),w(this,$d,m||null),this.viewParameters={realScale:Fo.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=v||null,this._supportsPinchToZoom=_!==!1}static get _keyboardManager(){const t=Nf.prototype,e=o=>p(o,Ys).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),a=(o,{target:c})=>{if(c instanceof HTMLInputElement){const{type:f}=c;return f!=="text"&&f!=="number"}return!0},i=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return ut(this,"_keyboardManager",new fg([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:a}],[["ctrl+z","mac+meta+z"],t.undo,{checker:a}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:a}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:a}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:c})=>!(c instanceof HTMLButtonElement)&&p(o,Ys).contains(c)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:c})=>!(c instanceof HTMLButtonElement)&&p(o,Ys).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-l,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[l,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-l],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,l],checker:e}]]))}destroy(){var t,e,a,i,l;(t=p(this,ei))==null||t.resolve(),w(this,ei,null),(e=p(this,Gf))==null||e.abort(),w(this,Gf,null),this._signal=null;for(const o of p(this,Jr).values())o.destroy();p(this,Jr).clear(),p(this,Mr).clear(),p(this,yc).clear(),w(this,xn,null),p(this,Ot).clear(),p(this,Jn).destroy(),(a=p(this,Vf))==null||a.destroy(),(i=p(this,ts))==null||i.hide(),w(this,ts,null),p(this,es)&&(clearTimeout(p(this,es)),w(this,es,null)),p(this,rs)&&(clearTimeout(p(this,rs)),w(this,rs,null)),(l=this._editorUndoBar)==null||l.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return p(this,$d)}get useNewAltTextFlow(){return p(this,Xd)}get useNewAltTextWhenAddingImage(){return p(this,Xf)}get hcmFilter(){return ut(this,"hcmFilter",p(this,Sc)?p(this,qd).addHCMFilter(p(this,Sc).foreground,p(this,Sc).background):"none")}get direction(){return ut(this,"direction",getComputedStyle(p(this,Ys)).direction)}get highlightColors(){return ut(this,"highlightColors",p(this,qf)?new Map(p(this,qf).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return ut(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),w(this,Ec,t)}setMainHighlightColorPicker(t){w(this,Kd,t)}editAltText(t,e=!1){var a;(a=p(this,Vf))==null||a.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":w(this,Xf,e);break}}onPageChanging({pageNumber:t}){w(this,Yf,t-1)}focusMainContainer(){p(this,Ys).focus()}findParent(t,e){for(const a of p(this,Jr).values()){const{x:i,y:l,width:o,height:c}=a.div.getBoundingClientRect();if(t>=i&&t<=i+o&&e>=l&&e<=l+c)return a}return null}disableUserSelect(t=!1){p(this,Jd).classList.toggle("noUserSelect",t)}addShouldRescale(t){p(this,yc).add(t)}removeShouldRescale(t){p(this,yc).delete(t)}onScaleChanging({scale:t}){var e;this.commitOrRemove(),this.viewParameters.realScale=t*Fo.PDF_TO_CSS_UNITS;for(const a of p(this,yc))a.onScaleChanging();(e=p(this,Ec))==null||e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:a,anchorOffset:i,focusNode:l,focusOffset:o}=e,c=e.toString(),d=D(this,Me,nm).call(this,e).closest(".textLayer"),g=this.getSelectionBoxes(d);if(!g)return;e.empty();const m=D(this,Me,wE).call(this,d),v=p(this,zr)===nt.NONE,_=()=>{m==null||m.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:g,anchorNode:a,anchorOffset:i,focusNode:l,focusOffset:o,text:c}),v&&this.showAllEditors("highlight",!0,!0)};if(v){this.switchToMode(nt.HIGHLIGHT,_);return}_()}addToAnnotationStorage(t){!t.isEmpty()&&p(this,Vs)&&!p(this,Vs).has(t.id)&&p(this,Vs).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,p(this,ao)&&(w(this,ao,!1),D(this,Me,im).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of p(this,Ot))if(e.div.contains(t)){w(this,Tc,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!p(this,Tc))return;const[t,e]=p(this,Tc);w(this,Tc,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){D(this,Me,CE).call(this),D(this,Me,RE).call(this)}removeEditListeners(){D(this,Me,qR).call(this),D(this,Me,kE).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const a of p(this,Ti))if(a.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const a of p(this,Ti))if(a.isHandlingMimeForPasting(e.type)){a.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var a;if(t.preventDefault(),(a=p(this,xn))==null||a.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of p(this,Ot)){const l=i.serialize(!0);l&&e.push(l)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const l of e.items)for(const o of p(this,Ti))if(o.isHandlingMimeForPasting(l.type)){o.paste(l,this.currentLayer);return}let a=e.getData("application/pdfjs");if(!a)return;try{a=JSON.parse(a)}catch(l){it(`paste: "${l.message}".`);return}if(!Array.isArray(a))return;this.unselectAll();const i=this.currentLayer;try{const l=[];for(const f of a){const d=await i.deserialize(f);if(!d)return;l.push(d)}const o=()=>{for(const f of l)D(this,Me,OE).call(this,f);D(this,Me,DE).call(this,l)},c=()=>{for(const f of l)f.remove()};this.addCommands({cmd:o,undo:c,mustExec:!0})}catch(l){it(`paste: "${l.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),p(this,zr)!==nt.NONE&&!this.isEditorHandlingKeyboard&&Nf._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,p(this,ao)&&(w(this,ao,!1),D(this,Me,im).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(D(this,Me,YR).call(this),D(this,Me,RE).call(this),D(this,Me,Oa).call(this,{isEditing:p(this,zr)!==nt.NONE,isEmpty:D(this,Me,$0).call(this),hasSomethingToUndo:p(this,Jn).hasSomethingToUndo(),hasSomethingToRedo:p(this,Jn).hasSomethingToRedo(),hasSelectedEditor:!1})):(D(this,Me,XR).call(this),D(this,Me,kE).call(this),D(this,Me,Oa).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!p(this,Ti)){w(this,Ti,t);for(const e of p(this,Ti))D(this,Me,Us).call(this,e.defaultPropertiesToUpdate)}}getId(){return p(this,tx).id}get currentLayer(){return p(this,Jr).get(p(this,Yf))}getLayer(t){return p(this,Jr).get(t)}get currentPageIndex(){return p(this,Yf)}addLayer(t){p(this,Jr).set(t.pageIndex,t),p(this,no)?t.enable():t.disable()}removeLayer(t){p(this,Jr).delete(t.pageIndex)}async updateMode(t,e=null,a=!1){var i;if(p(this,zr)!==t&&!(p(this,ei)&&(await p(this,ei).promise,!p(this,ei)))){if(w(this,ei,Promise.withResolvers()),w(this,zr,t),t===nt.NONE){this.setEditingState(!1),D(this,Me,$R).call(this),(i=this._editorUndoBar)==null||i.hide(),p(this,ei).resolve();return}this.setEditingState(!0),await D(this,Me,KR).call(this),this.unselectAll();for(const l of p(this,Jr).values())l.updateMode(t);if(!e){a&&this.addNewEditorFromKeyboard(),p(this,ei).resolve();return}for(const l of p(this,Mr).values())l.annotationElementId===e?(this.setSelected(l),l.enterInEditMode()):l.unselect();p(this,ei).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==p(this,zr)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var a;if(p(this,Ti)){switch(t){case mt.CREATE:this.currentLayer.addNewEditor();return;case mt.HIGHLIGHT_DEFAULT_COLOR:(a=p(this,Kd))==null||a.updateColor(e);break;case mt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(p(this,Qd)||w(this,Qd,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const i of p(this,Ot))i.updateParams(t,e);for(const i of p(this,Ti))i.updateDefaultParams(t,e)}}showAllEditors(t,e,a=!1){var l;for(const o of p(this,Mr).values())o.editorType===t&&o.show(e);(((l=p(this,Qd))==null?void 0:l.get(mt.HIGHLIGHT_SHOW_ALL))??!0)!==e&&D(this,Me,Us).call(this,[[mt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(p(this,Wd)!==t){w(this,Wd,t);for(const e of p(this,Jr).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const a of p(this,Mr).values())a.pageIndex===t&&e.push(a);return e}getEditor(t){return p(this,Mr).get(t)}addEditor(t){p(this,Mr).set(t.id,t)}removeEditor(t){var e;t.div.contains(document.activeElement)&&(p(this,es)&&clearTimeout(p(this,es)),w(this,es,setTimeout(()=>{this.focusMainContainer(),w(this,es,null)},0))),p(this,Mr).delete(t.id),this.unselect(t),(!t.annotationElementId||!p(this,Ac).has(t.annotationElementId))&&((e=p(this,Vs))==null||e.remove(t.id))}addDeletedAnnotationElement(t){p(this,Ac).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return p(this,Ac).has(t)}removeDeletedAnnotationElement(t){p(this,Ac).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){p(this,xn)!==t&&(w(this,xn,t),t&&D(this,Me,Us).call(this,t.propertiesToUpdate))}updateUI(t){p(this,Me,QR)===t&&D(this,Me,Us).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){D(this,Me,Us).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(p(this,Ot).has(t)){p(this,Ot).delete(t),t.unselect(),D(this,Me,Oa).call(this,{hasSelectedEditor:this.hasSelection});return}p(this,Ot).add(t),t.select(),D(this,Me,Us).call(this,t.propertiesToUpdate),D(this,Me,Oa).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;(e=p(this,Ec))==null||e.commitOrRemove();for(const a of p(this,Ot))a!==t&&a.unselect();p(this,Ot).clear(),p(this,Ot).add(t),t.select(),D(this,Me,Us).call(this,t.propertiesToUpdate),D(this,Me,Oa).call(this,{hasSelectedEditor:!0})}isSelected(t){return p(this,Ot).has(t)}get firstSelectedEditor(){return p(this,Ot).values().next().value}unselect(t){t.unselect(),p(this,Ot).delete(t),D(this,Me,Oa).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return p(this,Ot).size!==0}get isEnterHandled(){return p(this,Ot).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;p(this,Jn).undo(),D(this,Me,Oa).call(this,{hasSomethingToUndo:p(this,Jn).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:D(this,Me,$0).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){p(this,Jn).redo(),D(this,Me,Oa).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:p(this,Jn).hasSomethingToRedo(),isEmpty:D(this,Me,$0).call(this)})}addCommands(t){p(this,Jn).add(t),D(this,Me,Oa).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:D(this,Me,$0).call(this)})}cleanUndoStack(t){p(this,Jn).cleanType(t)}delete(){var l;this.commitOrRemove();const t=(l=this.currentLayer)==null?void 0:l.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...p(this,Ot)],a=()=>{var o;(o=this._editorUndoBar)==null||o.show(i,e.length===1?e[0].editorType:e.length);for(const c of e)c.remove()},i=()=>{for(const o of e)D(this,Me,OE).call(this,o)};this.addCommands({cmd:a,undo:i,mustExec:!0})}commitOrRemove(){var t;(t=p(this,xn))==null||t.commitOrRemove()}hasSomethingToControl(){return p(this,xn)||this.hasSelection}selectAll(){for(const t of p(this,Ot))t.commit();D(this,Me,DE).call(this,p(this,Mr).values())}unselectAll(){var t;if(!(p(this,xn)&&(p(this,xn).commitOrRemove(),p(this,zr)!==nt.NONE))&&!((t=p(this,Ec))!=null&&t.commitOrRemove())&&this.hasSelection){for(const e of p(this,Ot))e.unselect();p(this,Ot).clear(),D(this,Me,Oa).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,a=!1){if(a||this.commitOrRemove(),!this.hasSelection)return;p(this,so)[0]+=t,p(this,so)[1]+=e;const[i,l]=p(this,so),o=[...p(this,Ot)],c=1e3;p(this,rs)&&clearTimeout(p(this,rs)),w(this,rs,setTimeout(()=>{w(this,rs,null),p(this,so)[0]=p(this,so)[1]=0,this.addCommands({cmd:()=>{for(const f of o)p(this,Mr).has(f.id)&&f.translateInPage(i,l)},undo:()=>{for(const f of o)p(this,Mr).has(f.id)&&f.translateInPage(-i,-l)},mustExec:!1})},c));for(const f of o)f.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),w(this,Ji,new Map);for(const t of p(this,Ot))p(this,Ji).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!p(this,Ji))return!1;this.disableUserSelect(!1);const t=p(this,Ji);w(this,Ji,null);let e=!1;for(const[{x:i,y:l,pageIndex:o},c]of t)c.newX=i,c.newY=l,c.newPageIndex=o,e||(e=i!==c.savedX||l!==c.savedY||o!==c.savedPageIndex);if(!e)return!1;const a=(i,l,o,c)=>{if(p(this,Mr).has(i.id)){const f=p(this,Jr).get(c);f?i._setParentAndPosition(f,l,o):(i.pageIndex=c,i.x=l,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:l,newY:o,newPageIndex:c}]of t)a(i,l,o,c)},undo:()=>{for(const[i,{savedX:l,savedY:o,savedPageIndex:c}]of t)a(i,l,o,c)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(p(this,Ji))for(const a of p(this,Ji).keys())a.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||p(this,Ot).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return p(this,xn)===t}getActive(){return p(this,xn)}getMode(){return p(this,zr)}get imageManager(){return ut(this,"imageManager",new SE)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let d=0,g=e.rangeCount;d<g;d++)if(!t.contains(e.getRangeAt(d).commonAncestorContainer))return null;const{x:a,y:i,width:l,height:o}=t.getBoundingClientRect();let c;switch(t.getAttribute("data-main-rotation")){case"90":c=(d,g,m,v)=>({x:(g-i)/o,y:1-(d+m-a)/l,width:v/o,height:m/l});break;case"180":c=(d,g,m,v)=>({x:1-(d+m-a)/l,y:1-(g+v-i)/o,width:m/l,height:v/o});break;case"270":c=(d,g,m,v)=>({x:1-(g+v-i)/o,y:(d-a)/l,width:v/o,height:m/l});break;default:c=(d,g,m,v)=>({x:(d-a)/l,y:(g-i)/o,width:m/l,height:v/o});break}const f=[];for(let d=0,g=e.rangeCount;d<g;d++){const m=e.getRangeAt(d);if(!m.collapsed)for(const{x:v,y:_,width:A,height:y}of m.getClientRects())A===0||y===0||f.push(c(v,_,A,y))}return f.length===0?null:f}addChangedExistingAnnotation({annotationElementId:t,id:e}){(p(this,jf)||w(this,jf,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=p(this,jf))==null||e.delete(t)}renderAnnotationElement(t){var i;const e=(i=p(this,jf))==null?void 0:i.get(t.data.id);if(!e)return;const a=p(this,Vs).getRawValue(e);a&&(p(this,zr)===nt.NONE&&!a.hasBeenModified||a.renderAnnotationElement(t))}};Gf=new WeakMap,xn=new WeakMap,Mr=new WeakMap,Jr=new WeakMap,Vf=new WeakMap,Vs=new WeakMap,jf=new WeakMap,Jn=new WeakMap,to=new WeakMap,Ec=new WeakMap,Yf=new WeakMap,Ac=new WeakMap,Ji=new WeakMap,Ti=new WeakMap,yc=new WeakMap,Yd=new WeakMap,Xd=new WeakMap,Xf=new WeakMap,qd=new WeakMap,es=new WeakMap,ro=new WeakMap,qf=new WeakMap,ao=new WeakMap,ts=new WeakMap,tx=new WeakMap,no=new WeakMap,Wd=new WeakMap,io=new WeakMap,Tc=new WeakMap,Kd=new WeakMap,$d=new WeakMap,zr=new WeakMap,Ot=new WeakMap,js=new WeakMap,Sc=new WeakMap,Qd=new WeakMap,Zd=new WeakMap,so=new WeakMap,rs=new WeakMap,Ys=new WeakMap,Jd=new WeakMap,ei=new WeakMap,Me=new WeakSet,nm=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},wE=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const a of p(this,Jr).values())if(a.hasTextLayer(t))return a;return null},GR=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const a=D(this,Me,nm).call(this,t).closest(".textLayer"),i=this.getSelectionBoxes(a);i&&(p(this,ts)||w(this,ts,new HM(this)),p(this,ts).show(a,i,this.direction==="ltr"))},VR=function(){var l,o,c;const t=document.getSelection();if(!t||t.isCollapsed){p(this,js)&&((l=p(this,ts))==null||l.hide(),w(this,js,null),D(this,Me,Oa).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===p(this,js))return;const i=D(this,Me,nm).call(this,t).closest(".textLayer");if(!i){p(this,js)&&((o=p(this,ts))==null||o.hide(),w(this,js,null),D(this,Me,Oa).call(this,{hasSelectedText:!1}));return}if((c=p(this,ts))==null||c.hide(),w(this,js,e),D(this,Me,Oa).call(this,{hasSelectedText:!0}),!(p(this,zr)!==nt.HIGHLIGHT&&p(this,zr)!==nt.NONE)&&(p(this,zr)===nt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),w(this,ao,this.isShiftKeyDown),!this.isShiftKeyDown)){const f=p(this,zr)===nt.HIGHLIGHT?D(this,Me,wE).call(this,i):null;f==null||f.toggleDrawing();const d=new AbortController,g=this.combinedSignal(d),m=v=>{v.type==="pointerup"&&v.button!==0||(d.abort(),f==null||f.toggleDrawing(!0),v.type==="pointerup"&&D(this,Me,im).call(this,"main_toolbar"))};window.addEventListener("pointerup",m,{signal:g}),window.addEventListener("blur",m,{signal:g})}},im=function(t=""){p(this,zr)===nt.HIGHLIGHT?this.highlightSelection(t):p(this,Yd)&&D(this,Me,GR).call(this)},jR=function(){document.addEventListener("selectionchange",D(this,Me,VR).bind(this),{signal:this._signal})},YR=function(){if(p(this,ro))return;w(this,ro,new AbortController);const t=this.combinedSignal(p(this,ro));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},XR=function(){var t;(t=p(this,ro))==null||t.abort(),w(this,ro,null)},CE=function(){if(p(this,io))return;w(this,io,new AbortController);const t=this.combinedSignal(p(this,io));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},qR=function(){var t;(t=p(this,io))==null||t.abort(),w(this,io,null)},RE=function(){if(p(this,to))return;w(this,to,new AbortController);const t=this.combinedSignal(p(this,to));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},kE=function(){var t;(t=p(this,to))==null||t.abort(),w(this,to,null)},WR=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Oa=function(t){Object.entries(t).some(([a,i])=>p(this,Zd)[a]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(p(this,Zd),t)}),p(this,zr)===nt.HIGHLIGHT&&t.hasSelectedEditor===!1&&D(this,Me,Us).call(this,[[mt.HIGHLIGHT_FREE,!0]]))},Us=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},KR=async function(){if(!p(this,no)){w(this,no,!0);const t=[];for(const e of p(this,Jr).values())t.push(e.enable());await Promise.all(t);for(const e of p(this,Mr).values())e.enable()}},$R=function(){if(this.unselectAll(),p(this,no)){w(this,no,!1);for(const t of p(this,Jr).values())t.disable();for(const t of p(this,Mr).values())t.disable()}},OE=function(t){const e=p(this,Jr).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},QR=function(){let t=null;for(t of p(this,Ot));return t},$0=function(){if(p(this,Mr).size===0)return!0;if(p(this,Mr).size===1)for(const t of p(this,Mr).values())return t.isEmpty();return!1},DE=function(t){for(const e of p(this,Ot))e.unselect();p(this,Ot).clear();for(const e of t)e.isEmpty()||(p(this,Ot).add(e),e.select());D(this,Me,Oa).call(this,{hasSelectedEditor:this.hasSelection})},Xe(Nf,"TRANSLATE_SMALL",1),Xe(Nf,"TRANSLATE_BIG",10);let Tu=Nf;var Gr,as,Si,Wf,ns,vn,Kf,is,an,Xs,bc,ss,lo,Pi,Q0,sm;const Da=class Da{constructor(t){O(this,Pi);O(this,Gr,null);O(this,as,!1);O(this,Si,null);O(this,Wf,null);O(this,ns,null);O(this,vn,null);O(this,Kf,!1);O(this,is,null);O(this,an,null);O(this,Xs,null);O(this,bc,null);O(this,ss,!1);w(this,an,t),w(this,ss,t._uiManager.useNewAltTextFlow),p(Da,lo)||w(Da,lo,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Da._l10n??(Da._l10n=t)}async render(){const t=w(this,Si,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=w(this,Wf,document.createElement("span"));t.append(e),p(this,ss)?(t.classList.add("new"),t.setAttribute("data-l10n-id",p(Da,lo).missing),e.setAttribute("data-l10n-id",p(Da,lo)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const a=p(this,an)._uiManager._signal;t.addEventListener("contextmenu",Ui,{signal:a}),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:a});const i=l=>{l.preventDefault(),p(this,an)._uiManager.editAltText(p(this,an)),p(this,ss)&&p(this,an)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:p(this,Pi,Q0)}})};return t.addEventListener("click",i,{capture:!0,signal:a}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(w(this,Kf,!0),i(l))},{signal:a}),await D(this,Pi,sm).call(this),t}finish(){p(this,Si)&&(p(this,Si).focus({focusVisible:p(this,Kf)}),w(this,Kf,!1))}isEmpty(){return p(this,ss)?p(this,Gr)===null:!p(this,Gr)&&!p(this,as)}hasData(){return p(this,ss)?p(this,Gr)!==null||!!p(this,Xs):this.isEmpty()}get guessedText(){return p(this,Xs)}async setGuessedText(t){p(this,Gr)===null&&(w(this,Xs,t),w(this,bc,await Da._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),D(this,Pi,sm).call(this))}toggleAltTextBadge(t=!1){var e;if(!p(this,ss)||p(this,Gr)){(e=p(this,is))==null||e.remove(),w(this,is,null);return}if(!p(this,is)){const a=w(this,is,document.createElement("div"));a.className="noAltTextBadge",p(this,an).div.append(a)}p(this,is).classList.toggle("hidden",!t)}serialize(t){let e=p(this,Gr);return!t&&p(this,Xs)===e&&(e=p(this,bc)),{altText:e,decorative:p(this,as),guessedText:p(this,Xs),textWithDisclaimer:p(this,bc)}}get data(){return{altText:p(this,Gr),decorative:p(this,as)}}set data({altText:t,decorative:e,guessedText:a,textWithDisclaimer:i,cancel:l=!1}){a&&(w(this,Xs,a),w(this,bc,i)),!(p(this,Gr)===t&&p(this,as)===e)&&(l||(w(this,Gr,t),w(this,as,e)),D(this,Pi,sm).call(this))}toggle(t=!1){p(this,Si)&&(!t&&p(this,vn)&&(clearTimeout(p(this,vn)),w(this,vn,null)),p(this,Si).disabled=!t)}shown(){p(this,an)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:p(this,Pi,Q0)}})}destroy(){var t,e;(t=p(this,Si))==null||t.remove(),w(this,Si,null),w(this,Wf,null),w(this,ns,null),(e=p(this,is))==null||e.remove(),w(this,is,null)}};Gr=new WeakMap,as=new WeakMap,Si=new WeakMap,Wf=new WeakMap,ns=new WeakMap,vn=new WeakMap,Kf=new WeakMap,is=new WeakMap,an=new WeakMap,Xs=new WeakMap,bc=new WeakMap,ss=new WeakMap,lo=new WeakMap,Pi=new WeakSet,Q0=function(){return p(this,Gr)&&"added"||p(this,Gr)===null&&this.guessedText&&"review"||"missing"},sm=async function(){var i,l,o;const t=p(this,Si);if(!t)return;if(p(this,ss)){if(t.classList.toggle("done",!!p(this,Gr)),t.setAttribute("data-l10n-id",p(Da,lo)[p(this,Pi,Q0)]),(i=p(this,Wf))==null||i.setAttribute("data-l10n-id",p(Da,lo)[`${p(this,Pi,Q0)}-label`]),!p(this,Gr)){(l=p(this,ns))==null||l.remove();return}}else{if(!p(this,Gr)&&!p(this,as)){t.classList.remove("done"),(o=p(this,ns))==null||o.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=p(this,ns);if(!e){w(this,ns,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${p(this,an).id}`;const c=100,f=p(this,an)._uiManager._signal;f.addEventListener("abort",()=>{clearTimeout(p(this,vn)),w(this,vn,null)},{once:!0}),t.addEventListener("mouseenter",()=>{w(this,vn,setTimeout(()=>{w(this,vn,null),p(this,ns).classList.add("show"),p(this,an)._reportTelemetry({action:"alt_text_tooltip"})},c))},{signal:f}),t.addEventListener("mouseleave",()=>{var d;p(this,vn)&&(clearTimeout(p(this,vn)),w(this,vn,null)),(d=p(this,ns))==null||d.classList.remove("show")},{signal:f})}p(this,as)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=p(this,Gr)),e.parentNode||t.append(e);const a=p(this,an).getImageForAltText();a==null||a.setAttribute("aria-describedby",e.id)},O(Da,lo,null),Xe(Da,"_l10n",null);let Im=Da;var ep,wc,tp,rp,ap,np,ip,$f,qs,Cc,oo,Al,ZR,JR,NE;const Oy=class Oy{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:a=null,onPinchStart:i=null,onPinching:l=null,onPinchEnd:o=null,signal:c}){O(this,Al);O(this,ep);O(this,wc,!1);O(this,tp,null);O(this,rp);O(this,ap);O(this,np);O(this,ip);O(this,$f);O(this,qs,null);O(this,Cc);O(this,oo,null);w(this,ep,t),w(this,tp,a),w(this,rp,e),w(this,ap,i),w(this,np,l),w(this,ip,o),w(this,Cc,new AbortController),w(this,$f,AbortSignal.any([c,p(this,Cc).signal])),t.addEventListener("touchstart",D(this,Al,ZR).bind(this),{passive:!1,signal:p(this,$f)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return ut(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var t;(t=p(this,Cc))==null||t.abort(),w(this,Cc,null)}};ep=new WeakMap,wc=new WeakMap,tp=new WeakMap,rp=new WeakMap,ap=new WeakMap,np=new WeakMap,ip=new WeakMap,$f=new WeakMap,qs=new WeakMap,Cc=new WeakMap,oo=new WeakMap,Al=new WeakSet,ZR=function(t){var i,l,o;if((i=p(this,rp))!=null&&i.call(this)||t.touches.length<2)return;if(!p(this,oo)){w(this,oo,new AbortController);const c=AbortSignal.any([p(this,$f),p(this,oo).signal]),f=p(this,ep),d={signal:c,passive:!1};f.addEventListener("touchmove",D(this,Al,JR).bind(this),d),f.addEventListener("touchend",D(this,Al,NE).bind(this),d),f.addEventListener("touchcancel",D(this,Al,NE).bind(this),d),(l=p(this,ap))==null||l.call(this)}if(Nn(t),t.touches.length!==2||(o=p(this,tp))!=null&&o.call(this)){w(this,qs,null);return}let[e,a]=t.touches;e.identifier>a.identifier&&([e,a]=[a,e]),w(this,qs,{touch0X:e.screenX,touch0Y:e.screenY,touch1X:a.screenX,touch1Y:a.screenY})},JR=function(t){var F;if(!p(this,qs)||t.touches.length!==2)return;let[e,a]=t.touches;e.identifier>a.identifier&&([e,a]=[a,e]);const{screenX:i,screenY:l}=e,{screenX:o,screenY:c}=a,f=p(this,qs),{touch0X:d,touch0Y:g,touch1X:m,touch1Y:v}=f,_=m-d,A=v-g,y=o-i,T=c-l,S=Math.hypot(y,T)||1,R=Math.hypot(_,A)||1;if(!p(this,wc)&&Math.abs(R-S)<=Oy.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(f.touch0X=i,f.touch0Y=l,f.touch1X=o,f.touch1Y=c,t.preventDefault(),!p(this,wc)){w(this,wc,!0);return}const C=[(i+o)/2,(l+c)/2];(F=p(this,np))==null||F.call(this,C,R,S)},NE=function(t){var e;p(this,oo).abort(),w(this,oo,null),(e=p(this,ip))==null||e.call(this),p(this,qs)&&(t.preventDefault(),w(this,qs,null),w(this,wc,!1))};let Fm=Oy;var Rc,bi,qt,Qf,co,sp,kc,ea,Oc,Ws,uo,lp,Dc,_n,op,Nc,Ks,ls,Zf,Jf,ti,Mc,cp,rx,qe,ME,up,IE,lm,ek,tk,FE,om,LE,rk,ak,nk,PE,ik,BE,sk,lk,ok,UE,Z0;const lt=class lt{constructor(t){O(this,qe);O(this,Rc,null);O(this,bi,null);O(this,qt,null);O(this,Qf,!1);O(this,co,null);O(this,sp,"");O(this,kc,!1);O(this,ea,null);O(this,Oc,null);O(this,Ws,null);O(this,uo,null);O(this,lp,"");O(this,Dc,!1);O(this,_n,null);O(this,op,!1);O(this,Nc,!1);O(this,Ks,!1);O(this,ls,null);O(this,Zf,0);O(this,Jf,0);O(this,ti,null);O(this,Mc,null);Xe(this,"_editToolbar",null);Xe(this,"_initialOptions",Object.create(null));Xe(this,"_initialData",null);Xe(this,"_isVisible",!0);Xe(this,"_uiManager",null);Xe(this,"_focusEventsAllowed",!0);O(this,cp,!1);O(this,rx,lt._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:a,pageHeight:i,pageX:l,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[a,i],this.pageTranslation=[l,o];const[c,f]=this.parentDimensions;this.x=t.x/c,this.y=t.y/f,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=lt.prototype._resizeWithKeyboard,e=Tu.TRANSLATE_SMALL,a=Tu.TRANSLATE_BIG;return ut(this,"_resizerKeyboardManager",new fg([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-a,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[a,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-a]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,a]}],[["Escape","mac+Escape"],lt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return ut(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new VM({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(lt._l10n??(lt._l10n=t),lt._l10nResizer||(lt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),lt._borderLineWidth!==-1)return;const a=getComputedStyle(document.documentElement);lt._borderLineWidth=parseFloat(a.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Ut("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return p(this,cp)}set _isDraggable(t){var e;w(this,cp,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=p(this,rx)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):D(this,qe,Z0).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(p(this,Dc)?w(this,Dc,!1):this.parent.setSelected(this))}focusout(t){var a;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(a=this.parent)!=null&&a.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,a,i){const[l,o]=this.parentDimensions;[a,i]=this.screenToPageTranslation(a,i),this.x=(t+a)/l,this.y=(e+i)/o,this.fixAndSetPosition()}translate(t,e){D(this,qe,ME).call(this,this.parentDimensions,t,e)}translateInPage(t,e){p(this,_n)||w(this,_n,[this.x,this.y,this.width,this.height]),D(this,qe,ME).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){p(this,_n)||w(this,_n,[this.x,this.y,this.width,this.height]);const{div:a,parentDimensions:[i,l]}=this;if(this.x+=t/i,this.y+=e/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:c}=this;const[f,d]=this.getBaseTranslation();o+=f,c+=d;const{style:g}=a;g.left=`${(100*o).toFixed(2)}%`,g.top=`${(100*c).toFixed(2)}%`,this._onTranslating(o,c),a.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!p(this,_n)&&(p(this,_n)[0]!==this.x||p(this,_n)[1]!==this.y)}get _hasBeenResized(){return!!p(this,_n)&&(p(this,_n)[2]!==this.width||p(this,_n)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:a}=lt,i=a/t,l=a/e;switch(this.rotation){case 90:return[-i,l];case 180:return[i,l];case 270:return[i,-l];default:return[-i,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[a,i]}=this;let{x:l,y:o,width:c,height:f}=this;if(c*=a,f*=i,l*=a,o*=i,this._mustFixPosition)switch(t){case 0:l=Math.max(0,Math.min(a-c,l)),o=Math.max(0,Math.min(i-f,o));break;case 90:l=Math.max(0,Math.min(a-f,l)),o=Math.min(i,Math.max(c,o));break;case 180:l=Math.min(a,Math.max(c,l)),o=Math.min(i,Math.max(f,o));break;case 270:l=Math.min(a,Math.max(f,l)),o=Math.max(0,Math.min(i-c,o));break}this.x=l/=a,this.y=o/=i;const[d,g]=this.getBaseTranslation();l+=d,o+=g,e.left=`${(100*l).toFixed(2)}%`,e.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var a;return D(a=lt,up,IE).call(a,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var a;return D(a=lt,up,IE).call(a,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,a]}=this;return[e*t,a*t]}setDims(t,e){const[a,i]=this.parentDimensions,{style:l}=this.div;l.width=`${(100*t/a).toFixed(2)}%`,p(this,kc)||(l.height=`${(100*e/i).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:a}=t,i=a.endsWith("%"),l=!p(this,kc)&&e.endsWith("%");if(i&&l)return;const[o,c]=this.parentDimensions;i||(t.width=`${(100*parseFloat(a)/o).toFixed(2)}%`),!p(this,kc)&&!l&&(t.height=`${(100*parseFloat(e)/c).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=p(this,qt))==null||t.finish()}async addEditToolbar(){return this._editToolbar||p(this,Nc)?this._editToolbar:(this._editToolbar=new yE(this),this.div.append(this._editToolbar.render()),p(this,qt)&&await this._editToolbar.addAltText(p(this,qt)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=p(this,qt))==null||t.destroy())}addContainer(t){var a;const e=(a=this._editToolbar)==null?void 0:a.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){p(this,qt)||(Im.initialize(lt._l10n),w(this,qt,new Im(this)),p(this,Rc)&&(p(this,qt).data=p(this,Rc),w(this,Rc,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=p(this,qt))==null?void 0:t.data}set altTextData(t){p(this,qt)&&(p(this,qt).data=t)}get guessedAltText(){var t;return(t=p(this,qt))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=p(this,qt))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=p(this,qt))==null?void 0:e.serialize(t)}hasAltText(){return!!p(this,qt)&&!p(this,qt).isEmpty()}hasAltTextData(){var t;return((t=p(this,qt))==null?void 0:t.hasData())??!1}render(){var l;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=p(this,Qf)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),D(this,qe,BE).call(this);const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[a,i]=this.getInitialTranslation();return this.translate(a,i),Mm(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(p(this,Mc)||w(this,Mc,new Fm({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:D(this,qe,rk).bind(this),onPinching:D(this,qe,ak).bind(this),onPinchEnd:D(this,qe,nk).bind(this),signal:this._uiManager._signal}))),(l=this._uiManager._editorUndoBar)==null||l.hide(),this.div}pointerdown(t){const{isMac:e}=Ua.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(w(this,Dc,!0),this._isDraggable){D(this,qe,ik).call(this,t);return}D(this,qe,PE).call(this,t)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){p(this,ls)&&clearTimeout(p(this,ls)),w(this,ls,setTimeout(()=>{var t;w(this,ls,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,a){t.changeParent(this),this.x=e,this.y=a,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,a=this.rotation){const i=this.parentScale,[l,o]=this.pageDimensions,[c,f]=this.pageTranslation,d=t/i,g=e/i,m=this.x*l,v=this.y*o,_=this.width*l,A=this.height*o;switch(a){case 0:return[m+d+c,o-v-g-A+f,m+d+_+c,o-v-g+f];case 90:return[m+g+c,o-v+d+f,m+g+A+c,o-v+d+_+f];case 180:return[m-d-_+c,o-v+g+f,m-d+c,o-v+g+A+f];case 270:return[m-g-A+c,o-v-d-_+f,m-g+c,o-v-d+f];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[a,i,l,o]=t,c=l-a,f=o-i;switch(this.rotation){case 0:return[a,e-o,c,f];case 90:return[a,e-i,f,c];case 180:return[l,e-i,c,f];case 270:return[l,e-o,f,c];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){w(this,Nc,!0)}disableEditMode(){w(this,Nc,!1)}isInEditMode(){return p(this,Nc)}shouldGetKeyboardEvents(){return p(this,Ks)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:a,right:i}=this.getClientDimensions(),{innerHeight:l,innerWidth:o}=window;return e<o&&i>0&&t<l&&a>0}rebuild(){D(this,qe,BE).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){Ut("An editor must be serializable")}static async deserialize(t,e,a){const i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:a});i.rotation=t.rotation,w(i,Rc,t.accessibilityData);const[l,o]=i.pageDimensions,[c,f,d,g]=i.getRectInCurrentCoords(t.rect,o);return i.x=c/l,i.y=f/o,i.width=d/l,i.height=g/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,e;if((t=p(this,uo))==null||t.abort(),w(this,uo,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),p(this,ls)&&(clearTimeout(p(this,ls)),w(this,ls,null)),D(this,qe,Z0).call(this),this.removeEditToolbar(),p(this,ti)){for(const a of p(this,ti).values())clearTimeout(a);w(this,ti,null)}this.parent=null,(e=p(this,Mc))==null||e.destroy(),w(this,Mc,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(D(this,qe,ek).call(this),p(this,ea).classList.remove("hidden"),Mm(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),w(this,Ws,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=p(this,ea).children;if(!p(this,bi)){w(this,bi,Array.from(e));const o=D(this,qe,sk).bind(this),c=D(this,qe,lk).bind(this),f=this._uiManager._signal;for(const d of p(this,bi)){const g=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",o,{signal:f}),d.addEventListener("blur",c,{signal:f}),d.addEventListener("focus",D(this,qe,ok).bind(this,g),{signal:f}),d.setAttribute("data-l10n-id",lt._l10nResizer[g])}}const a=p(this,bi)[0];let i=0;for(const o of e){if(o===a)break;i++}const l=(360-this.rotation+this.parentRotation)%360/90*(p(this,bi).length/4);if(l!==i){if(l<i)for(let c=0;c<i-l;c++)p(this,ea).append(p(this,ea).firstChild);else if(l>i)for(let c=0;c<l-i;c++)p(this,ea).firstChild.before(p(this,ea).lastChild);let o=0;for(const c of e){const d=p(this,bi)[o++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",lt._l10nResizer[d])}}D(this,qe,UE).call(this,0),w(this,Ks,!0),p(this,ea).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){p(this,Ks)&&D(this,qe,LE).call(this,p(this,lp),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){D(this,qe,Z0).call(this),this.div.focus()}select(){var t,e,a;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,l;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((l=this._editToolbar)==null||l.show())});return}(e=this._editToolbar)==null||e.show(),(a=p(this,qt))==null||a.toggleAltTextBadge(!1)}unselect(){var t,e,a,i,l;(t=p(this,ea))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(a=this.div)!=null&&a.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(l=p(this,qt))==null||l.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return p(this,op)}set isEditing(t){w(this,op,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){w(this,kc,!0);const a=t/e,{style:i}=this.div;i.aspectRatio=a,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){p(this,ti)||w(this,ti,new Map);const{action:a}=t;let i=p(this,ti).get(a);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(t),p(this,ti).delete(a),p(this,ti).size===0&&w(this,ti,null)},lt._telemetryTimeout),p(this,ti).set(a,i);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),w(this,Qf,!1)}disable(){this.div&&(this.div.tabIndex=-1),w(this,Qf,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const a=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),a.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};Rc=new WeakMap,bi=new WeakMap,qt=new WeakMap,Qf=new WeakMap,co=new WeakMap,sp=new WeakMap,kc=new WeakMap,ea=new WeakMap,Oc=new WeakMap,Ws=new WeakMap,uo=new WeakMap,lp=new WeakMap,Dc=new WeakMap,_n=new WeakMap,op=new WeakMap,Nc=new WeakMap,Ks=new WeakMap,ls=new WeakMap,Zf=new WeakMap,Jf=new WeakMap,ti=new WeakMap,Mc=new WeakMap,cp=new WeakMap,rx=new WeakMap,qe=new WeakSet,ME=function([t,e],a,i){[a,i]=this.screenToPageTranslation(a,i),this.x+=a/t,this.y+=i/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},up=new WeakSet,IE=function(t,e,a){switch(a){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},lm=function(t){switch(t){case 90:{const[e,a]=this.pageDimensions;return[0,-e/a,a/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,a]=this.pageDimensions;return[0,e/a,-a/e,0]}default:return[1,0,0,1]}},ek=function(){if(p(this,ea))return;w(this,ea,document.createElement("div")),p(this,ea).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const a of t){const i=document.createElement("div");p(this,ea).append(i),i.classList.add("resizer",a),i.setAttribute("data-resizer-name",a),i.addEventListener("pointerdown",D(this,qe,tk).bind(this,a),{signal:e}),i.addEventListener("contextmenu",Ui,{signal:e}),i.tabIndex=-1}this.div.prepend(p(this,ea))},tk=function(t,e){var g;e.preventDefault();const{isMac:a}=Ua.platform;if(e.button!==0||e.ctrlKey&&a)return;(g=p(this,qt))==null||g.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,w(this,Oc,[e.screenX,e.screenY]);const l=new AbortController,o=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",D(this,qe,LE).bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Nn,{passive:!1,signal:o}),window.addEventListener("contextmenu",Ui,{signal:o}),w(this,Ws,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const c=this.parent.div.style.cursor,f=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const d=()=>{var m;l.abort(),this.parent.togglePointerEvents(!0),(m=p(this,qt))==null||m.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=c,this.div.style.cursor=f,D(this,qe,om).call(this)};window.addEventListener("pointerup",d,{signal:o}),window.addEventListener("blur",d,{signal:o})},FE=function(t,e,a,i){this.width=a,this.height=i,this.x=t,this.y=e;const[l,o]=this.parentDimensions;this.setDims(l*a,o*i),this.fixAndSetPosition(),this._onResized()},om=function(){if(!p(this,Ws))return;const{savedX:t,savedY:e,savedWidth:a,savedHeight:i}=p(this,Ws);w(this,Ws,null);const l=this.x,o=this.y,c=this.width,f=this.height;l===t&&o===e&&c===a&&f===i||this.addCommands({cmd:D(this,qe,FE).bind(this,l,o,c,f),undo:D(this,qe,FE).bind(this,t,e,a,i),mustExec:!0})},LE=function(t,e){const[a,i]=this.parentDimensions,l=this.x,o=this.y,c=this.width,f=this.height,d=lt.MIN_SIZE/a,g=lt.MIN_SIZE/i,m=D(this,qe,lm).call(this,this.rotation),v=(G,te)=>[m[0]*G+m[2]*te,m[1]*G+m[3]*te],_=D(this,qe,lm).call(this,360-this.rotation),A=(G,te)=>[_[0]*G+_[2]*te,_[1]*G+_[3]*te];let y,T,S=!1,R=!1;switch(t){case"topLeft":S=!0,y=(G,te)=>[0,0],T=(G,te)=>[G,te];break;case"topMiddle":y=(G,te)=>[G/2,0],T=(G,te)=>[G/2,te];break;case"topRight":S=!0,y=(G,te)=>[G,0],T=(G,te)=>[0,te];break;case"middleRight":R=!0,y=(G,te)=>[G,te/2],T=(G,te)=>[0,te/2];break;case"bottomRight":S=!0,y=(G,te)=>[G,te],T=(G,te)=>[0,0];break;case"bottomMiddle":y=(G,te)=>[G/2,te],T=(G,te)=>[G/2,0];break;case"bottomLeft":S=!0,y=(G,te)=>[0,te],T=(G,te)=>[G,0];break;case"middleLeft":R=!0,y=(G,te)=>[0,te/2],T=(G,te)=>[G,te/2];break}const C=y(c,f),F=T(c,f);let U=v(...F);const B=lt._round(l+U[0]),k=lt._round(o+U[1]);let J=1,j=1,ie,Q;if(e.fromKeyboard)({deltaX:ie,deltaY:Q}=e);else{const{screenX:G,screenY:te}=e,[we,ae]=p(this,Oc);[ie,Q]=this.screenToPageTranslation(G-we,te-ae),p(this,Oc)[0]=G,p(this,Oc)[1]=te}if([ie,Q]=A(ie/a,Q/i),S){const G=Math.hypot(c,f);J=j=Math.max(Math.min(Math.hypot(F[0]-C[0]-ie,F[1]-C[1]-Q)/G,1/c,1/f),d/c,g/f)}else R?J=Math.max(d,Math.min(1,Math.abs(F[0]-C[0]-ie)))/c:j=Math.max(g,Math.min(1,Math.abs(F[1]-C[1]-Q)))/f;const ee=lt._round(c*J),ge=lt._round(f*j);U=v(...T(ee,ge));const ye=B-U[0],me=k-U[1];p(this,_n)||w(this,_n,[this.x,this.y,this.width,this.height]),this.width=ee,this.height=ge,this.x=ye,this.y=me,this.setDims(a*ee,i*ge),this.fixAndSetPosition(),this._onResizing()},rk=function(){var t;w(this,Ws,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=p(this,qt))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},ak=function(t,e,a){let l=.7*(a/e)+1-.7;if(l===1)return;const o=D(this,qe,lm).call(this,this.rotation),c=(B,k)=>[o[0]*B+o[2]*k,o[1]*B+o[3]*k],[f,d]=this.parentDimensions,g=this.x,m=this.y,v=this.width,_=this.height,A=lt.MIN_SIZE/f,y=lt.MIN_SIZE/d;l=Math.max(Math.min(l,1/v,1/_),A/v,y/_);const T=lt._round(v*l),S=lt._round(_*l);if(T===v&&S===_)return;p(this,_n)||w(this,_n,[g,m,v,_]);const R=c(v/2,_/2),C=lt._round(g+R[0]),F=lt._round(m+R[1]),U=c(T/2,S/2);this.x=C-U[0],this.y=F-U[1],this.width=T,this.height=S,this.setDims(f*T,d*S),this.fixAndSetPosition(),this._onResizing()},nk=function(){var t;(t=p(this,qt))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),D(this,qe,om).call(this)},PE=function(t){const{isMac:e}=Ua.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},ik=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let a=!1;const i=new AbortController,l=this._uiManager.combinedSignal(i),o={capture:!0,passive:!1,signal:l},c=d=>{i.abort(),w(this,co,null),w(this,Dc,!1),this._uiManager.endDragSession()||D(this,qe,PE).call(this,d),a&&this._onStopDragging()};e&&(w(this,Zf,t.clientX),w(this,Jf,t.clientY),w(this,co,t.pointerId),w(this,sp,t.pointerType),window.addEventListener("pointermove",d=>{a||(a=!0,this._onStartDragging());const{clientX:g,clientY:m,pointerId:v}=d;if(v!==p(this,co)){Nn(d);return}const[_,A]=this.screenToPageTranslation(g-p(this,Zf),m-p(this,Jf));w(this,Zf,g),w(this,Jf,m),this._uiManager.dragSelectedEditors(_,A)},o),window.addEventListener("touchmove",Nn,o),window.addEventListener("pointerdown",d=>{d.pointerType===p(this,sp)&&(p(this,Mc)||d.isPrimary)&&c(d),Nn(d)},o));const f=d=>{if(!p(this,co)||p(this,co)===d.pointerId){c(d);return}Nn(d)};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})},BE=function(){if(p(this,uo)||!this.div)return;w(this,uo,new AbortController);const t=this._uiManager.combinedSignal(p(this,uo));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},sk=function(t){lt._resizerKeyboardManager.exec(this,t)},lk=function(t){var e;p(this,Ks)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==p(this,ea)&&D(this,qe,Z0).call(this)},ok=function(t){w(this,lp,p(this,Ks)?t:"")},UE=function(t){if(p(this,bi))for(const e of p(this,bi))e.tabIndex=t},Z0=function(){w(this,Ks,!1),D(this,qe,UE).call(this,-1),D(this,qe,om).call(this)},O(lt,up),Xe(lt,"_l10n",null),Xe(lt,"_l10nResizer",null),Xe(lt,"_borderLineWidth",-1),Xe(lt,"_colorManager",new bE),Xe(lt,"_zIndex",1),Xe(lt,"_telemetryTimeout",1e3);let sr=lt;class VM extends sr{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Yw=3285377520,Kn=4294901760,Ki=65535;class ck{constructor(t){this.h1=t?t&4294967295:Yw,this.h2=t?t&4294967295:Yw}update(t){let e,a;if(typeof t=="string"){e=new Uint8Array(t.length*2),a=0;for(let y=0,T=t.length;y<T;y++){const S=t.charCodeAt(y);S<=255?e[a++]=S:(e[a++]=S>>>8,e[a++]=S&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),a=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=a>>2,l=a-i*4,o=new Uint32Array(e.buffer,0,i);let c=0,f=0,d=this.h1,g=this.h2;const m=3432918353,v=461845907,_=m&Ki,A=v&Ki;for(let y=0;y<i;y++)y&1?(c=o[y],c=c*m&Kn|c*_&Ki,c=c<<15|c>>>17,c=c*v&Kn|c*A&Ki,d^=c,d=d<<13|d>>>19,d=d*5+3864292196):(f=o[y],f=f*m&Kn|f*_&Ki,f=f<<15|f>>>17,f=f*v&Kn|f*A&Ki,g^=f,g=g<<13|g>>>19,g=g*5+3864292196);switch(c=0,l){case 3:c^=e[i*4+2]<<16;case 2:c^=e[i*4+1]<<8;case 1:c^=e[i*4],c=c*m&Kn|c*_&Ki,c=c<<15|c>>>17,c=c*v&Kn|c*A&Ki,i&1?d^=c:g^=c}this.h1=d,this.h2=g}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Kn|t*36045&Ki,e=e*4283543511&Kn|((e<<16|t>>>16)*2950163797&Kn)>>>16,t^=e>>>1,t=t*444984403&Kn|t*60499&Ki,e=e*3301882366&Kn|((e<<16|t>>>16)*3120437893&Kn)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const HE=Object.freeze({map:null,hash:"",transfer:void 0});var Ic,Fc,Vr,ax,uk;class ZA{constructor(){O(this,ax);O(this,Ic,!1);O(this,Fc,null);O(this,Vr,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const a=p(this,Vr).get(t);return a===void 0?e:Object.assign(e,a)}getRawValue(t){return p(this,Vr).get(t)}remove(t){if(p(this,Vr).delete(t),p(this,Vr).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of p(this,Vr).values())if(e instanceof sr)return;this.onAnnotationEditor(null)}}setValue(t,e){const a=p(this,Vr).get(t);let i=!1;if(a!==void 0)for(const[l,o]of Object.entries(e))a[l]!==o&&(i=!0,a[l]=o);else i=!0,p(this,Vr).set(t,e);i&&D(this,ax,uk).call(this),e instanceof sr&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return p(this,Vr).has(t)}getAll(){return p(this,Vr).size>0?XA(p(this,Vr)):null}setAll(t){for(const[e,a]of Object.entries(t))this.setValue(e,a)}get size(){return p(this,Vr).size}resetModified(){p(this,Ic)&&(w(this,Ic,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new fk(this)}get serializable(){if(p(this,Vr).size===0)return HE;const t=new Map,e=new ck,a=[],i=Object.create(null);let l=!1;for(const[o,c]of p(this,Vr)){const f=c instanceof sr?c.serialize(!1,i):c;f&&(t.set(o,f),e.update(`${o}:${JSON.stringify(f)}`),l||(l=!!f.bitmap))}if(l)for(const o of t.values())o.bitmap&&a.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:a}:HE}get editorStats(){let t=null;const e=new Map;for(const a of p(this,Vr).values()){if(!(a instanceof sr))continue;const i=a.telemetryFinalData;if(!i)continue;const{type:l}=i;e.has(l)||e.set(l,Object.getPrototypeOf(a).constructor),t||(t=Object.create(null));const o=t[l]||(t[l]=new Map);for(const[c,f]of Object.entries(i)){if(c==="type")continue;let d=o.get(c);d||(d=new Map,o.set(c,d));const g=d.get(f)??0;d.set(f,g+1)}}for(const[a,i]of e)t[a]=i.computeTelemetryFinalData(t[a]);return t}resetModifiedIds(){w(this,Fc,null)}get modifiedIds(){if(p(this,Fc))return p(this,Fc);const t=[];for(const e of p(this,Vr).values())!(e instanceof sr)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return w(this,Fc,{ids:new Set(t),hash:t.join(",")})}}Ic=new WeakMap,Fc=new WeakMap,Vr=new WeakMap,ax=new WeakSet,uk=function(){p(this,Ic)||(w(this,Ic,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var fp;class fk extends ZA{constructor(e){super();O(this,fp);const{map:a,hash:i,transfer:l}=e.serializable,o=structuredClone(a,l?{transfer:l}:null);w(this,fp,{map:o,hash:i,transfer:l})}get print(){Ut("Should not call PrintAnnotationStorage.print")}get serializable(){return p(this,fp)}get modifiedIds(){return ut(this,"modifiedIds",{ids:new Set,hash:""})}}fp=new WeakMap;var eh;class jM{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){O(this,eh,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),p(this,eh).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||p(this,eh).has(t.loadedName))){if(Rr(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:a,src:i,style:l}=t,o=new FontFace(a,i,l);this.addNativeFontFace(o);try{await o.load(),p(this,eh).add(a),e==null||e(t)}catch{it(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Ut("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const a=t.createNativeFontFace();if(a){this.addNativeFontFace(a);try{await a.loaded}catch(i){throw it(`Failed to load font '${a.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(a=>{const i=this._queueLoadingCallback(a);this._prepareFontLoadEvent(t,i)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return ut(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(Aa||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),ut(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(Rr(!i.done,"completeRequest() cannot be called twice."),i.done=!0;a.length>0&&a[0].done;){const l=a.shift();setTimeout(l.callback,0)}}const{loadingRequests:a}=this,i={done:!1,complete:e,callback:t};return a.push(i),i}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ut(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function a(F,U){return F.charCodeAt(U)<<24|F.charCodeAt(U+1)<<16|F.charCodeAt(U+2)<<8|F.charCodeAt(U+3)&255}function i(F,U,B,k){const J=F.substring(0,U),j=F.substring(U+B);return J+k+j}let l,o;const c=this._document.createElement("canvas");c.width=1,c.height=1;const f=c.getContext("2d");let d=0;function g(F,U){if(++d>30){it("Load test font never loaded."),U();return}if(f.font="30px "+F,f.fillText(".",0,20),f.getImageData(0,0,1,1).data[3]>0){U();return}setTimeout(g.bind(null,F,U))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=i(v,976,m.length,m);const A=16,y=1482184792;let T=a(v,A);for(l=0,o=m.length-3;l<o;l+=4)T=T-y+a(m,l)|0;l<m.length&&(T=T-y+a(m+"XXX",l)|0),v=i(v,A,4,kM(T));const S=`url(data:font/opentype;base64,${btoa(v)});`,R=`@font-face {font-family:"${m}";src:${S}}`;this.insertRule(R);const C=this._document.createElement("div");C.style.visibility="hidden",C.style.width=C.style.height="10px",C.style.position="absolute",C.style.top=C.style.left="0px";for(const F of[t.loadedName,m]){const U=this._document.createElement("span");U.textContent="Hi",U.style.fontFamily=F,C.append(U)}this._document.body.append(C),g(m,()=>{C.remove(),e.complete()})}}eh=new WeakMap;class YM{constructor(t,{disableFontFace:e=!1,fontExtraProperties:a=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const l in t)this[l]=t[l];this.disableFontFace=e===!0,this.fontExtraProperties=a===!0,this._inspectFont=i}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const a={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(a.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,a)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var a;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${FM(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return(a=this._inspectFont)==null||a.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const a=this.loadedName+"_path_"+e;let i;try{i=t.get(a)}catch(o){it(`getPathGenerator - ignoring character: "${o}".`)}const l=new Path2D(i||"");return this.fontExtraProperties||t.delete(a),this.compiledGlyphs[e]=l}}const z1={DATA:1,ERROR:2},Sr={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Xw(){}function tn(r){if(r instanceof Io||r instanceof _E||r instanceof Cd||r instanceof Gw||r instanceof Nm||r instanceof Q_)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||Ut('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new Io(r.message);case"InvalidPDFException":return new _E(r.message);case"MissingPDFException":return new Cd(r.message);case"PasswordException":return new Gw(r.message,r.code);case"UnexpectedResponseException":return new Nm(r.message,r.status);case"UnknownErrorException":return new Q_(r.message,r.details)}return new Q_(r.message,r.toString())}var th,oi,hk,dk,pk,cm;class J0{constructor(t,e,a){O(this,oi);O(this,th,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=a,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),a.addEventListener("message",D(this,oi,hk).bind(this),{signal:p(this,th).signal})}on(t,e){const a=this.actionHandler;if(a[t])throw new Error(`There is already an actionName called "${t}"`);a[t]=e}send(t,e,a){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},a)}sendWithPromise(t,e,a){const i=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[i]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},a)}catch(o){l.reject(o)}return l.promise}sendWithStream(t,e,a,i){const l=this.streamId++,o=this.sourceName,c=this.targetName,f=this.comObj;return new ReadableStream({start:d=>{const g=Promise.withResolvers();return this.streamControllers[l]={controller:d,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},f.postMessage({sourceName:o,targetName:c,action:t,streamId:l,data:e,desiredSize:d.desiredSize},i),g.promise},pull:d=>{const g=Promise.withResolvers();return this.streamControllers[l].pullCall=g,f.postMessage({sourceName:o,targetName:c,stream:Sr.PULL,streamId:l,desiredSize:d.desiredSize}),g.promise},cancel:d=>{Rr(d instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[l].cancelCall=g,this.streamControllers[l].isClosed=!0,f.postMessage({sourceName:o,targetName:c,stream:Sr.CANCEL,streamId:l,reason:tn(d)}),g.promise}},a)}destroy(){var t;(t=p(this,th))==null||t.abort(),w(this,th,null)}}th=new WeakMap,oi=new WeakSet,hk=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){D(this,oi,pk).call(this,t);return}if(t.callback){const a=t.callbackId,i=this.callbackCapabilities[a];if(!i)throw new Error(`Cannot resolve callback ${a}`);if(delete this.callbackCapabilities[a],t.callback===z1.DATA)i.resolve(t.data);else if(t.callback===z1.ERROR)i.reject(tn(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const a=this.sourceName,i=t.sourceName,l=this.comObj;Promise.try(e,t.data).then(function(o){l.postMessage({sourceName:a,targetName:i,callback:z1.DATA,callbackId:t.callbackId,data:o})},function(o){l.postMessage({sourceName:a,targetName:i,callback:z1.ERROR,callbackId:t.callbackId,reason:tn(o)})});return}if(t.streamId){D(this,oi,dk).call(this,t);return}e(t.data)},dk=function(t){const e=t.streamId,a=this.sourceName,i=t.sourceName,l=this.comObj,o=this,c=this.actionHandler[t.action],f={enqueue(d,g=1,m){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=g,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:a,targetName:i,stream:Sr.ENQUEUE,streamId:e,chunk:d},m)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:a,targetName:i,stream:Sr.CLOSE,streamId:e}),delete o.streamSinks[e])},error(d){Rr(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:a,targetName:i,stream:Sr.ERROR,streamId:e,reason:tn(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};f.sinkCapability.resolve(),f.ready=f.sinkCapability.promise,this.streamSinks[e]=f,Promise.try(c,t.data,f).then(function(){l.postMessage({sourceName:a,targetName:i,stream:Sr.START_COMPLETE,streamId:e,success:!0})},function(d){l.postMessage({sourceName:a,targetName:i,stream:Sr.START_COMPLETE,streamId:e,reason:tn(d)})})},pk=function(t){const e=t.streamId,a=this.sourceName,i=t.sourceName,l=this.comObj,o=this.streamControllers[e],c=this.streamSinks[e];switch(t.stream){case Sr.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(tn(t.reason));break;case Sr.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(tn(t.reason));break;case Sr.PULL:if(!c){l.postMessage({sourceName:a,targetName:i,stream:Sr.PULL_COMPLETE,streamId:e,success:!0});break}c.desiredSize<=0&&t.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=t.desiredSize,Promise.try(c.onPull||Xw).then(function(){l.postMessage({sourceName:a,targetName:i,stream:Sr.PULL_COMPLETE,streamId:e,success:!0})},function(d){l.postMessage({sourceName:a,targetName:i,stream:Sr.PULL_COMPLETE,streamId:e,reason:tn(d)})});break;case Sr.ENQUEUE:if(Rr(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case Sr.CLOSE:if(Rr(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),D(this,oi,cm).call(this,o,e);break;case Sr.ERROR:Rr(o,"error should have stream controller"),o.controller.error(tn(t.reason)),D(this,oi,cm).call(this,o,e);break;case Sr.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(tn(t.reason)),D(this,oi,cm).call(this,o,e);break;case Sr.CANCEL:if(!c)break;const f=tn(t.reason);Promise.try(c.onCancel||Xw,f).then(function(){l.postMessage({sourceName:a,targetName:i,stream:Sr.CANCEL_COMPLETE,streamId:e,success:!0})},function(d){l.postMessage({sourceName:a,targetName:i,stream:Sr.CANCEL_COMPLETE,streamId:e,reason:tn(d)})}),c.sinkCapability.reject(f),c.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},cm=async function(t,e){var a,i,l;await Promise.allSettled([(a=t.startCall)==null?void 0:a.promise,(i=t.pullCall)==null?void 0:i.promise,(l=t.cancelCall)==null?void 0:l.promise]),delete this.streamControllers[e]};var hp;class gk{constructor({enableHWA:t=!1}){O(this,hp,!1);w(this,hp,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const a=this._createCanvas(t,e);return{canvas:a,context:a.getContext("2d",{willReadFrequently:!p(this,hp)})}}reset(t,e,a){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||a<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=a}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Ut("Abstract method `_createCanvas` called.")}}hp=new WeakMap;class XM extends gk{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const a=this._document.createElement("canvas");return a.width=t,a.height=e,a}}class mk{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(a=>({cMapData:a,isCompressed:this.isCompressed})).catch(a=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Ut("Abstract method `_fetch` called.")}}class xk extends mk{async _fetch(t){const e=await Tx(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):yx(e)}}class vk{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,a,i,l){return"none"}destroy(t=!1){}}var Lc,rh,$s,Qs,ma,Pc,Bc,Le,da,ed,yf,um,Tf,_k,zE,Sf,td,rd,GE,ad;class qM extends vk{constructor({docId:e,ownerDocument:a=globalThis.document}){super();O(this,Le);O(this,Lc);O(this,rh);O(this,$s);O(this,Qs);O(this,ma);O(this,Pc);O(this,Bc,0);w(this,Qs,e),w(this,ma,a)}addFilter(e){if(!e)return"none";let a=p(this,Le,da).get(e);if(a)return a;const[i,l,o]=D(this,Le,um).call(this,e),c=e.length===1?i:`${i}${l}${o}`;if(a=p(this,Le,da).get(c),a)return p(this,Le,da).set(e,a),a;const f=`g_${p(this,Qs)}_transfer_map_${ka(this,Bc)._++}`,d=D(this,Le,Tf).call(this,f);p(this,Le,da).set(e,d),p(this,Le,da).set(c,d);const g=D(this,Le,Sf).call(this,f);return D(this,Le,rd).call(this,i,l,o,g),d}addHCMFilter(e,a){var A;const i=`${e}-${a}`,l="base";let o=p(this,Le,ed).get(l);if((o==null?void 0:o.key)===i||(o?((A=o.filter)==null||A.remove(),o.key=i,o.url="none",o.filter=null):(o={key:i,url:"none",filter:null},p(this,Le,ed).set(l,o)),!e||!a))return o.url;const c=D(this,Le,ad).call(this,e);e=Ve.makeHexColor(...c);const f=D(this,Le,ad).call(this,a);if(a=Ve.makeHexColor(...f),p(this,Le,yf).style.color="",e==="#000000"&&a==="#ffffff"||e===a)return o.url;const d=new Array(256);for(let y=0;y<=255;y++){const T=y/255;d[y]=T<=.03928?T/12.92:((T+.055)/1.055)**2.4}const g=d.join(","),m=`g_${p(this,Qs)}_hcm_filter`,v=o.filter=D(this,Le,Sf).call(this,m);D(this,Le,rd).call(this,g,g,g,v),D(this,Le,zE).call(this,v);const _=(y,T)=>{const S=c[y]/255,R=f[y]/255,C=new Array(T+1);for(let F=0;F<=T;F++)C[F]=S+F/T*(R-S);return C.join(",")};return D(this,Le,rd).call(this,_(0,5),_(1,5),_(2,5),v),o.url=D(this,Le,Tf).call(this,m),o.url}addAlphaFilter(e){let a=p(this,Le,da).get(e);if(a)return a;const[i]=D(this,Le,um).call(this,[e]),l=`alpha_${i}`;if(a=p(this,Le,da).get(l),a)return p(this,Le,da).set(e,a),a;const o=`g_${p(this,Qs)}_alpha_map_${ka(this,Bc)._++}`,c=D(this,Le,Tf).call(this,o);p(this,Le,da).set(e,c),p(this,Le,da).set(l,c);const f=D(this,Le,Sf).call(this,o);return D(this,Le,GE).call(this,i,f),c}addLuminosityFilter(e){let a=p(this,Le,da).get(e||"luminosity");if(a)return a;let i,l;if(e?([i]=D(this,Le,um).call(this,[e]),l=`luminosity_${i}`):l="luminosity",a=p(this,Le,da).get(l),a)return p(this,Le,da).set(e,a),a;const o=`g_${p(this,Qs)}_luminosity_map_${ka(this,Bc)._++}`,c=D(this,Le,Tf).call(this,o);p(this,Le,da).set(e,c),p(this,Le,da).set(l,c);const f=D(this,Le,Sf).call(this,o);return D(this,Le,_k).call(this,f),e&&D(this,Le,GE).call(this,i,f),c}addHighlightHCMFilter(e,a,i,l,o){var R;const c=`${a}-${i}-${l}-${o}`;let f=p(this,Le,ed).get(e);if((f==null?void 0:f.key)===c||(f?((R=f.filter)==null||R.remove(),f.key=c,f.url="none",f.filter=null):(f={key:c,url:"none",filter:null},p(this,Le,ed).set(e,f)),!a||!i))return f.url;const[d,g]=[a,i].map(D(this,Le,ad).bind(this));let m=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),v=Math.round(.2126*g[0]+.7152*g[1]+.0722*g[2]),[_,A]=[l,o].map(D(this,Le,ad).bind(this));v<m&&([m,v,_,A]=[v,m,A,_]),p(this,Le,yf).style.color="";const y=(C,F,U)=>{const B=new Array(256),k=(v-m)/U,J=C/255,j=(F-C)/(255*U);let ie=0;for(let Q=0;Q<=U;Q++){const ee=Math.round(m+Q*k),ge=J+Q*j;for(let ye=ie;ye<=ee;ye++)B[ye]=ge;ie=ee+1}for(let Q=ie;Q<256;Q++)B[Q]=B[ie-1];return B.join(",")},T=`g_${p(this,Qs)}_hcm_${e}_filter`,S=f.filter=D(this,Le,Sf).call(this,T);return D(this,Le,zE).call(this,S),D(this,Le,rd).call(this,y(_[0],A[0],5),y(_[1],A[1],5),y(_[2],A[2],5),S),f.url=D(this,Le,Tf).call(this,T),f.url}destroy(e=!1){var a,i,l,o;e&&((a=p(this,Pc))!=null&&a.size)||((i=p(this,$s))==null||i.parentNode.parentNode.remove(),w(this,$s,null),(l=p(this,rh))==null||l.clear(),w(this,rh,null),(o=p(this,Pc))==null||o.clear(),w(this,Pc,null),w(this,Bc,0))}}Lc=new WeakMap,rh=new WeakMap,$s=new WeakMap,Qs=new WeakMap,ma=new WeakMap,Pc=new WeakMap,Bc=new WeakMap,Le=new WeakSet,da=function(){return p(this,rh)||w(this,rh,new Map)},ed=function(){return p(this,Pc)||w(this,Pc,new Map)},yf=function(){if(!p(this,$s)){const e=p(this,ma).createElement("div"),{style:a}=e;a.visibility="hidden",a.contain="strict",a.width=a.height=0,a.position="absolute",a.top=a.left=0,a.zIndex=-1;const i=p(this,ma).createElementNS(Bs,"svg");i.setAttribute("width",0),i.setAttribute("height",0),w(this,$s,p(this,ma).createElementNS(Bs,"defs")),e.append(i),i.append(p(this,$s)),p(this,ma).body.append(e)}return p(this,$s)},um=function(e){if(e.length===1){const d=e[0],g=new Array(256);for(let v=0;v<256;v++)g[v]=d[v]/255;const m=g.join(",");return[m,m,m]}const[a,i,l]=e,o=new Array(256),c=new Array(256),f=new Array(256);for(let d=0;d<256;d++)o[d]=a[d]/255,c[d]=i[d]/255,f[d]=l[d]/255;return[o.join(","),c.join(","),f.join(",")]},Tf=function(e){if(p(this,Lc)===void 0){w(this,Lc,"");const a=p(this,ma).URL;a!==p(this,ma).baseURI&&(Sx(a)?it('#createUrl: ignore "data:"-URL for performance reasons.'):w(this,Lc,a.split("#",1)[0]))}return`url(${p(this,Lc)}#${e})`},_k=function(e){const a=p(this,ma).createElementNS(Bs,"feColorMatrix");a.setAttribute("type","matrix"),a.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(a)},zE=function(e){const a=p(this,ma).createElementNS(Bs,"feColorMatrix");a.setAttribute("type","matrix"),a.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(a)},Sf=function(e){const a=p(this,ma).createElementNS(Bs,"filter");return a.setAttribute("color-interpolation-filters","sRGB"),a.setAttribute("id",e),p(this,Le,yf).append(a),a},td=function(e,a,i){const l=p(this,ma).createElementNS(Bs,a);l.setAttribute("type","discrete"),l.setAttribute("tableValues",i),e.append(l)},rd=function(e,a,i,l){const o=p(this,ma).createElementNS(Bs,"feComponentTransfer");l.append(o),D(this,Le,td).call(this,o,"feFuncR",e),D(this,Le,td).call(this,o,"feFuncG",a),D(this,Le,td).call(this,o,"feFuncB",i)},GE=function(e,a){const i=p(this,ma).createElementNS(Bs,"feComponentTransfer");a.append(i),D(this,Le,td).call(this,i,"feFuncA",e)},ad=function(e){return p(this,Le,yf).style.color=e,QA(getComputedStyle(p(this,Le,yf)).getPropertyValue("color"))};class Ek{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(a=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Ut("Abstract method `_fetch` called.")}}class Ak extends Ek{async _fetch(t){const e=await Tx(t,"arraybuffer");return new Uint8Array(e)}}Aa&&it("Please use the `legacy` build in Node.js environments.");async function yk(r){const e=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(e)}class WM extends vk{}class KM extends gk{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class $M extends mk{async _fetch(t){return yk(t)}}class QM extends Ek{async _fetch(t){return yk(t)}}const _a={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function VE(r,t){if(!t)return;const e=t[2]-t[0],a=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],e,a),r.clip(i)}class JA{getPattern(){Ut("Abstract method `getPattern` called.")}}class ZM extends JA{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const a of this._colorStops)e.addColorStop(a[0],a[1]);return e}getPattern(t,e,a,i){let l;if(i===_a.STROKE||i===_a.FILL){const o=e.current.getClippedPathBoundingBox(i,Jt(t))||[0,0,0,0],c=Math.ceil(o[2]-o[0])||1,f=Math.ceil(o[3]-o[1])||1,d=e.cachedCanvases.getCanvas("pattern",c,f),g=d.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-o[0],-o[1]),a=Ve.transform(a,[1,0,0,1,o[0],o[1]]),g.transform(...e.baseTransform),this.matrix&&g.transform(...this.matrix),VE(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),l=t.createPattern(d.canvas,"no-repeat");const m=new DOMMatrix(a);l.setTransform(m)}else VE(t,this._bbox),l=this._createGradient(t);return l}}function eE(r,t,e,a,i,l,o,c){const f=t.coords,d=t.colors,g=r.data,m=r.width*4;let v;f[e+1]>f[a+1]&&(v=e,e=a,a=v,v=l,l=o,o=v),f[a+1]>f[i+1]&&(v=a,a=i,i=v,v=o,o=c,c=v),f[e+1]>f[a+1]&&(v=e,e=a,a=v,v=l,l=o,o=v);const _=(f[e]+t.offsetX)*t.scaleX,A=(f[e+1]+t.offsetY)*t.scaleY,y=(f[a]+t.offsetX)*t.scaleX,T=(f[a+1]+t.offsetY)*t.scaleY,S=(f[i]+t.offsetX)*t.scaleX,R=(f[i+1]+t.offsetY)*t.scaleY;if(A>=R)return;const C=d[l],F=d[l+1],U=d[l+2],B=d[o],k=d[o+1],J=d[o+2],j=d[c],ie=d[c+1],Q=d[c+2],ee=Math.round(A),ge=Math.round(R);let ye,me,G,te,we,ae,Oe,Y;for(let N=ee;N<=ge;N++){if(N<T){const xe=N<A?0:(A-N)/(A-T);ye=_-(_-y)*xe,me=C-(C-B)*xe,G=F-(F-k)*xe,te=U-(U-J)*xe}else{let xe;N>R?xe=1:T===R?xe=0:xe=(T-N)/(T-R),ye=y-(y-S)*xe,me=B-(B-j)*xe,G=k-(k-ie)*xe,te=J-(J-Q)*xe}let q;N<A?q=0:N>R?q=1:q=(A-N)/(A-R),we=_-(_-S)*q,ae=C-(C-j)*q,Oe=F-(F-ie)*q,Y=U-(U-Q)*q;const X=Math.round(Math.min(ye,we)),K=Math.round(Math.max(ye,we));let se=m*N+X*4;for(let xe=X;xe<=K;xe++)q=(ye-xe)/(ye-we),q<0?q=0:q>1&&(q=1),g[se++]=me-(me-ae)*q|0,g[se++]=G-(G-Oe)*q|0,g[se++]=te-(te-Y)*q|0,g[se++]=255}}function JM(r,t,e){const a=t.coords,i=t.colors;let l,o;switch(t.type){case"lattice":const c=t.verticesPerRow,f=Math.floor(a.length/c)-1,d=c-1;for(l=0;l<f;l++){let g=l*c;for(let m=0;m<d;m++,g++)eE(r,e,a[g],a[g+1],a[g+c],i[g],i[g+1],i[g+c]),eE(r,e,a[g+c+1],a[g+1],a[g+c],i[g+c+1],i[g+1],i[g+c])}break;case"triangles":for(l=0,o=a.length;l<o;l+=3)eE(r,e,a[l],a[l+1],a[l+2],i[l],i[l+1],i[l+2]);break;default:throw new Error("illegal figure")}}class eI extends JA{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,a){const c=Math.floor(this._bounds[0]),f=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-c,g=Math.ceil(this._bounds[3])-f,m=Math.min(Math.ceil(Math.abs(d*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(g*t[1]*1.1)),3e3),_=d/m,A=g/v,y={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-f,scaleX:1/_,scaleY:1/A},T=m+4,S=v+4,R=a.getCanvas("mesh",T,S),C=R.context,F=C.createImageData(m,v);if(e){const B=F.data;for(let k=0,J=B.length;k<J;k+=4)B[k]=e[0],B[k+1]=e[1],B[k+2]=e[2],B[k+3]=255}for(const B of this._figures)JM(F,B,y);return C.putImageData(F,2,2),{canvas:R.canvas,offsetX:c-2*_,offsetY:f-2*A,scaleX:_,scaleY:A}}getPattern(t,e,a,i){VE(t,this._bbox);let l;if(i===_a.SHADING)l=Ve.singularValueDecompose2dScale(Jt(t));else if(l=Ve.singularValueDecompose2dScale(e.baseTransform),this.matrix){const c=Ve.singularValueDecompose2dScale(this.matrix);l=[l[0]*c[0],l[1]*c[1]]}const o=this._createMeshCanvas(l,i===_a.SHADING?null:this._background,e.cachedCanvases);return i!==_a.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}}class tI extends JA{getPattern(){return"hotpink"}}function rI(r){switch(r[0]){case"RadialAxial":return new ZM(r);case"Mesh":return new eI(r);case"Dummy":return new tI}throw new Error(`Unknown IR type: ${r[0]}`)}const qw={COLORED:1,UNCOLORED:2},nx=class nx{constructor(t,e,a,i,l){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=a,this.canvasGraphicsFactory=i,this.baseTransform=l}createPatternCanvas(t){const{bbox:e,operatorList:a,paintType:i,tilingType:l,color:o,canvasGraphicsFactory:c}=this;let{xstep:f,ystep:d}=this;f=Math.abs(f),d=Math.abs(d),Ax("TilingType: "+l);const g=e[0],m=e[1],v=e[2],_=e[3],A=v-g,y=_-m,T=Ve.singularValueDecompose2dScale(this.matrix),S=Ve.singularValueDecompose2dScale(this.baseTransform),R=T[0]*S[0],C=T[1]*S[1];let F=A,U=y,B=!1,k=!1;const J=Math.ceil(f*R),j=Math.ceil(d*C),ie=Math.ceil(A*R),Q=Math.ceil(y*C);J>=ie?F=f:B=!0,j>=Q?U=d:k=!0;const ee=this.getSizeAndScale(F,this.ctx.canvas.width,R),ge=this.getSizeAndScale(U,this.ctx.canvas.height,C),ye=t.cachedCanvases.getCanvas("pattern",ee.size,ge.size),me=ye.context,G=c.createCanvasGraphics(me);if(G.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(G,i,o),me.translate(-ee.scale*g,-ge.scale*m),G.transform(ee.scale,0,0,ge.scale,0,0),me.save(),this.clipBbox(G,g,m,v,_),G.baseTransform=Jt(G.ctx),G.executeOperatorList(a),G.endDrawing(),me.restore(),B||k){const te=ye.canvas;B&&(F=f),k&&(U=d);const we=this.getSizeAndScale(F,this.ctx.canvas.width,R),ae=this.getSizeAndScale(U,this.ctx.canvas.height,C),Oe=we.size,Y=ae.size,N=t.cachedCanvases.getCanvas("pattern-workaround",Oe,Y),q=N.context,X=B?Math.floor(A/f):0,K=k?Math.floor(y/d):0;for(let se=0;se<=X;se++)for(let xe=0;xe<=K;xe++)q.drawImage(te,Oe*se,Y*xe,Oe,Y,0,0,Oe,Y);return{canvas:N.canvas,scaleX:we.scale,scaleY:ae.scale,offsetX:g,offsetY:m}}return{canvas:ye.canvas,scaleX:ee.scale,scaleY:ge.scale,offsetX:g,offsetY:m}}getSizeAndScale(t,e,a){const i=Math.max(nx.MAX_PATTERN_SIZE,e);let l=Math.ceil(t*a);return l>=i?l=i:a=l/t,{scale:a,size:l}}clipBbox(t,e,a,i,l){const o=i-e,c=l-a;t.ctx.rect(e,a,o,c),t.current.updateRectMinMax(Jt(t.ctx),[e,a,i,l]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,a){const i=t.ctx,l=t.current;switch(e){case qw.COLORED:const o=this.ctx;i.fillStyle=o.fillStyle,i.strokeStyle=o.strokeStyle,l.fillColor=o.fillStyle,l.strokeColor=o.strokeStyle;break;case qw.UNCOLORED:const c=Ve.makeHexColor(a[0],a[1],a[2]);i.fillStyle=c,i.strokeStyle=c,l.fillColor=c,l.strokeColor=c;break;default:throw new RM(`Unsupported paint type: ${e}`)}}getPattern(t,e,a,i){let l=a;i!==_a.SHADING&&(l=Ve.transform(l,e.baseTransform),this.matrix&&(l=Ve.transform(l,this.matrix)));const o=this.createPatternCanvas(e);let c=new DOMMatrix(l);c=c.translate(o.offsetX,o.offsetY),c=c.scale(1/o.scaleX,1/o.scaleY);const f=t.createPattern(o.canvas,"repeat");return f.setTransform(c),f}};Xe(nx,"MAX_PATTERN_SIZE",3e3);let jE=nx;function aI({src:r,srcPos:t=0,dest:e,width:a,height:i,nonBlackColor:l=4294967295,inverseDecode:o=!1}){const c=Ua.isLittleEndian?4278190080:255,[f,d]=o?[l,c]:[c,l],g=a>>3,m=a&7,v=r.length;e=new Uint32Array(e.buffer);let _=0;for(let A=0;A<i;A++){for(const T=t+g;t<T;t++){const S=t<v?r[t]:255;e[_++]=S&128?d:f,e[_++]=S&64?d:f,e[_++]=S&32?d:f,e[_++]=S&16?d:f,e[_++]=S&8?d:f,e[_++]=S&4?d:f,e[_++]=S&2?d:f,e[_++]=S&1?d:f}if(m===0)continue;const y=t<v?r[t++]:255;for(let T=0;T<m;T++)e[_++]=y&1<<7-T?d:f}return{srcPos:t,destPos:_}}const Ww=16,Kw=100,nI=15,$w=10,Qw=1e3,ln=16;function iI(r,t){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){t.save(),this.__originalSave()},r.restore=function(){t.restore(),this.__originalRestore()},r.translate=function(a,i){t.translate(a,i),this.__originalTranslate(a,i)},r.scale=function(a,i){t.scale(a,i),this.__originalScale(a,i)},r.transform=function(a,i,l,o,c,f){t.transform(a,i,l,o,c,f),this.__originalTransform(a,i,l,o,c,f)},r.setTransform=function(a,i,l,o,c,f){t.setTransform(a,i,l,o,c,f),this.__originalSetTransform(a,i,l,o,c,f)},r.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},r.rotate=function(a){t.rotate(a),this.__originalRotate(a)},r.clip=function(a){t.clip(a),this.__originalClip(a)},r.moveTo=function(e,a){t.moveTo(e,a),this.__originalMoveTo(e,a)},r.lineTo=function(e,a){t.lineTo(e,a),this.__originalLineTo(e,a)},r.bezierCurveTo=function(e,a,i,l,o,c){t.bezierCurveTo(e,a,i,l,o,c),this.__originalBezierCurveTo(e,a,i,l,o,c)},r.rect=function(e,a,i,l){t.rect(e,a,i,l),this.__originalRect(e,a,i,l)},r.closePath=function(){t.closePath(),this.__originalClosePath()},r.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class sI{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,a){let i;return this.cache[t]!==void 0?(i=this.cache[t],this.canvasFactory.reset(i,e,a)):(i=this.canvasFactory.create(e,a),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function G1(r,t,e,a,i,l,o,c,f,d){const[g,m,v,_,A,y]=Jt(r);if(m===0&&v===0){const R=o*g+A,C=Math.round(R),F=c*_+y,U=Math.round(F),B=(o+f)*g+A,k=Math.abs(Math.round(B)-C)||1,J=(c+d)*_+y,j=Math.abs(Math.round(J)-U)||1;return r.setTransform(Math.sign(g),0,0,Math.sign(_),C,U),r.drawImage(t,e,a,i,l,0,0,k,j),r.setTransform(g,m,v,_,A,y),[k,j]}if(g===0&&_===0){const R=c*v+A,C=Math.round(R),F=o*m+y,U=Math.round(F),B=(c+d)*v+A,k=Math.abs(Math.round(B)-C)||1,J=(o+f)*m+y,j=Math.abs(Math.round(J)-U)||1;return r.setTransform(0,Math.sign(m),Math.sign(v),0,C,U),r.drawImage(t,e,a,i,l,0,0,j,k),r.setTransform(g,m,v,_,A,y),[j,k]}r.drawImage(t,e,a,i,l,o,c,f,d);const T=Math.hypot(g,m),S=Math.hypot(v,_);return[T*f,S*d]}function lI(r){const{width:t,height:e}=r;if(t>Qw||e>Qw)return null;const a=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),l=t+1;let o=new Uint8Array(l*(e+1)),c,f,d;const g=t+7&-8;let m=new Uint8Array(g*e),v=0;for(const S of r.data){let R=128;for(;R>0;)m[v++]=S&R?0:255,R>>=1}let _=0;for(v=0,m[v]!==0&&(o[0]=1,++_),f=1;f<t;f++)m[v]!==m[v+1]&&(o[f]=m[v]?2:1,++_),v++;for(m[v]!==0&&(o[f]=2,++_),c=1;c<e;c++){v=c*g,d=c*l,m[v-g]!==m[v]&&(o[d]=m[v]?1:8,++_);let S=(m[v]?4:0)+(m[v-g]?8:0);for(f=1;f<t;f++)S=(S>>2)+(m[v+1]?4:0)+(m[v-g+1]?8:0),i[S]&&(o[d+f]=i[S],++_),v++;if(m[v-g]!==m[v]&&(o[d+f]=m[v]?2:4,++_),_>a)return null}for(v=g*(e-1),d=c*l,m[v]!==0&&(o[d]=8,++_),f=1;f<t;f++)m[v]!==m[v+1]&&(o[d+f]=m[v]?4:8,++_),v++;if(m[v]!==0&&(o[d+f]=4,++_),_>a)return null;const A=new Int32Array([0,l,-1,0,-l,0,0,0,1]),y=new Path2D;for(c=0;_&&c<=e;c++){let S=c*l;const R=S+t;for(;S<R&&!o[S];)S++;if(S===R)continue;y.moveTo(S%l,c);const C=S;let F=o[S];do{const U=A[F];do S+=U;while(!o[S]);const B=o[S];B!==5&&B!==10?(F=B,o[S]=0):(F=B&51*F>>4,o[S]&=F>>2|F<<2),y.lineTo(S%l,S/l|0),o[S]||--_}while(C!==S);--c}return m=null,o=null,function(S){S.save(),S.scale(1/t,-1/e),S.translate(0,-e),S.fill(y),S.beginPath(),S.restore()}}class Zw{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=NR,this.textMatrixScale=1,this.fontMatrix=vE,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=ha.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,a){[e,a]=Ve.applyTransform([e,a],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,a),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,a)}updateRectMinMax(t,e){const a=Ve.applyTransform(e,t),i=Ve.applyTransform(e.slice(2),t),l=Ve.applyTransform([e[0],e[3]],t),o=Ve.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,a[0],i[0],l[0],o[0]),this.minY=Math.min(this.minY,a[1],i[1],l[1],o[1]),this.maxX=Math.max(this.maxX,a[0],i[0],l[0],o[0]),this.maxY=Math.max(this.maxY,a[1],i[1],l[1],o[1])}updateScalingPathMinMax(t,e){Ve.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,a,i,l,o,c,f,d,g){const m=Ve.bezierBoundingBox(e,a,i,l,o,c,f,d,g);g||this.updateRectMinMax(t,m)}getPathBoundingBox(t=_a.FILL,e=null){const a=[this.minX,this.minY,this.maxX,this.maxY];if(t===_a.STROKE){e||Ut("Stroke bounding box must include transform.");const i=Ve.singularValueDecompose2dScale(e),l=i[0]*this.lineWidth/2,o=i[1]*this.lineWidth/2;a[0]-=l,a[1]-=o,a[2]+=l,a[3]+=o}return a}updateClipFromPath(){const t=Ve.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=_a.FILL,e=null){return Ve.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Jw(r,t){if(t instanceof ImageData){r.putImageData(t,0,0);return}const e=t.height,a=t.width,i=e%ln,l=(e-i)/ln,o=i===0?l:l+1,c=r.createImageData(a,ln);let f=0,d;const g=t.data,m=c.data;let v,_,A,y;if(t.kind===em.GRAYSCALE_1BPP){const T=g.byteLength,S=new Uint32Array(m.buffer,0,m.byteLength>>2),R=S.length,C=a+7>>3,F=4294967295,U=Ua.isLittleEndian?4278190080:255;for(v=0;v<o;v++){for(A=v<l?ln:i,d=0,_=0;_<A;_++){const B=T-f;let k=0;const J=B>C?a:B*8-7,j=J&-8;let ie=0,Q=0;for(;k<j;k+=8)Q=g[f++],S[d++]=Q&128?F:U,S[d++]=Q&64?F:U,S[d++]=Q&32?F:U,S[d++]=Q&16?F:U,S[d++]=Q&8?F:U,S[d++]=Q&4?F:U,S[d++]=Q&2?F:U,S[d++]=Q&1?F:U;for(;k<J;k++)ie===0&&(Q=g[f++],ie=128),S[d++]=Q&ie?F:U,ie>>=1}for(;d<R;)S[d++]=0;r.putImageData(c,0,v*ln)}}else if(t.kind===em.RGBA_32BPP){for(_=0,y=a*ln*4,v=0;v<l;v++)m.set(g.subarray(f,f+y)),f+=y,r.putImageData(c,0,_),_+=ln;v<o&&(y=a*i*4,m.set(g.subarray(f,f+y)),r.putImageData(c,0,_))}else if(t.kind===em.RGB_24BPP)for(A=ln,y=a*A,v=0;v<o;v++){for(v>=l&&(A=i,y=a*A),d=0,_=y;_--;)m[d++]=g[f++],m[d++]=g[f++],m[d++]=g[f++],m[d++]=255;r.putImageData(c,0,v*ln)}else throw new Error(`bad image kind: ${t.kind}`)}function eC(r,t){if(t.bitmap){r.drawImage(t.bitmap,0,0);return}const e=t.height,a=t.width,i=e%ln,l=(e-i)/ln,o=i===0?l:l+1,c=r.createImageData(a,ln);let f=0;const d=t.data,g=c.data;for(let m=0;m<o;m++){const v=m<l?ln:i;({srcPos:f}=aI({src:d,srcPos:f,dest:g,width:a,height:v,nonBlackColor:0})),r.putImageData(c,0,m*ln)}}function Y0(r,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const a of e)r[a]!==void 0&&(t[a]=r[a]);r.setLineDash!==void 0&&(t.setLineDash(r.getLineDash()),t.lineDashOffset=r.lineDashOffset)}function V1(r){if(r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0),!Aa){const{filter:t}=r;t!=="none"&&t!==""&&(r.filter="none")}}function tC(r,t){if(t)return!0;const e=Ve.singularValueDecompose2dScale(r);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const a=Math.fround((globalThis.devicePixelRatio||1)*Fo.PDF_TO_CSS_UNITS);return e[0]<=a&&e[1]<=a}const oI=["butt","round","square"],cI=["miter","round","bevel"],uI={},rC={};var Hi,YE,XE,qE;const Dy=class Dy{constructor(t,e,a,i,l,{optionalContentConfig:o,markedContentStack:c=null},f,d){O(this,Hi);this.ctx=t,this.current=new Zw(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=a,this.canvasFactory=i,this.filterFactory=l,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=o,this.cachedCanvases=new sI(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=f,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:a=!1,background:i=null}){const l=this.ctx.canvas.width,o=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,l,o),this.ctx.fillStyle=c,a){const f=this.cachedCanvases.getCanvas("transparent",l,o);this.compositeCtx=this.ctx,this.transparentCanvas=f.canvas,this.ctx=f.context,this.ctx.save(),this.ctx.transform(...Jt(this.compositeCtx))}this.ctx.save(),V1(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Jt(this.ctx)}executeOperatorList(t,e,a,i){const l=t.argsArray,o=t.fnArray;let c=e||0;const f=l.length;if(f===c)return c;const d=f-c>$w&&typeof a=="function",g=d?Date.now()+nI:0;let m=0;const v=this.commonObjs,_=this.objs;let A;for(;;){if(i!==void 0&&c===i.nextBreakPoint)return i.breakIt(c,a),c;if(A=o[c],A!==Ai.dependency)this[A].apply(this,l[c]);else for(const y of l[c]){const T=y.startsWith("g_")?v:_;if(!T.has(y))return T.get(y,a),c}if(c++,c===f)return c;if(d&&++m>$w){if(Date.now()>g)return a(),c;m=0}}}endDrawing(){D(this,Hi,YE).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),D(this,Hi,XE).call(this)}_scaleImage(t,e){const a=t.width??t.displayWidth,i=t.height??t.displayHeight;let l=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),c=a,f=i,d="prescale1",g,m;for(;l>2&&c>1||o>2&&f>1;){let v=c,_=f;l>2&&c>1&&(v=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),l/=c/v),o>2&&f>1&&(_=f>=16384?Math.floor(f/2)-1||1:Math.ceil(f)/2,o/=f/_),g=this.cachedCanvases.getCanvas(d,v,_),m=g.context,m.clearRect(0,0,v,_),m.drawImage(t,0,0,c,f,0,0,v,_),t=g.canvas,c=v,f=_,d=d==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:c,paintHeight:f}}_createMaskCanvas(t){const e=this.ctx,{width:a,height:i}=t,l=this.current.fillColor,o=this.current.patternFill,c=Jt(e);let f,d,g,m;if((t.bitmap||t.data)&&t.count>1){const J=t.bitmap||t.data.buffer;d=JSON.stringify(o?c:[c.slice(0,4),l]),f=this._cachedBitmapsMap.get(J),f||(f=new Map,this._cachedBitmapsMap.set(J,f));const j=f.get(d);if(j&&!o){const ie=Math.round(Math.min(c[0],c[2])+c[4]),Q=Math.round(Math.min(c[1],c[3])+c[5]);return{canvas:j,offsetX:ie,offsetY:Q}}g=j}g||(m=this.cachedCanvases.getCanvas("maskCanvas",a,i),eC(m.context,t));let v=Ve.transform(c,[1/a,0,0,-1/i,0,0]);v=Ve.transform(v,[1,0,0,1,0,-i]);const[_,A,y,T]=Ve.getAxialAlignedBoundingBox([0,0,a,i],v),S=Math.round(y-_)||1,R=Math.round(T-A)||1,C=this.cachedCanvases.getCanvas("fillCanvas",S,R),F=C.context,U=_,B=A;F.translate(-U,-B),F.transform(...v),g||(g=this._scaleImage(m.canvas,Wi(F)),g=g.img,f&&o&&f.set(d,g)),F.imageSmoothingEnabled=tC(Jt(F),t.interpolate),G1(F,g,0,0,g.width,g.height,0,0,a,i),F.globalCompositeOperation="source-in";const k=Ve.transform(Wi(F),[1,0,0,1,-U,-B]);return F.fillStyle=o?l.getPattern(e,this,k,_a.FILL):l,F.fillRect(0,0,a,i),f&&!o&&(this.cachedCanvases.delete("fillCanvas"),f.set(d,C.canvas)),{canvas:C.canvas,offsetX:Math.round(U),offsetY:Math.round(B)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=oI[t]}setLineJoin(t){this.ctx.lineJoin=cI[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(t),a.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,a]of t)switch(e){case"LW":this.setLineWidth(a);break;case"LC":this.setLineCap(a);break;case"LJ":this.setLineJoin(a);break;case"ML":this.setMiterLimit(a);break;case"D":this.setDash(a[0],a[1]);break;case"RI":this.setRenderingIntent(a);break;case"FL":this.setFlatness(a);break;case"Font":this.setFont(a[0],a[1]);break;case"CA":this.current.strokeAlpha=a;break;case"ca":this.current.fillAlpha=a,this.ctx.globalAlpha=a;break;case"BM":this.ctx.globalCompositeOperation=a;break;case"SMask":this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(a,t,e);this.suspendedCtx=this.ctx,this.ctx=i.context;const l=this.ctx;l.setTransform(...Jt(this.suspendedCtx)),Y0(this.suspendedCtx,l),iI(l,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Y0(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,a=this.suspendedCtx;this.composeSMask(a,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,a,i){const l=i[0],o=i[1],c=i[2]-l,f=i[3]-o;c===0||f===0||(this.genericComposeSMask(e.context,a,c,f,e.subtype,e.backdrop,e.transferMap,l,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(a.canvas,0,0),t.restore())}genericComposeSMask(t,e,a,i,l,o,c,f,d,g,m){let v=t.canvas,_=f-g,A=d-m;if(o){const T=Ve.makeHexColor(...o);if(_<0||A<0||_+a>v.width||A+i>v.height){const S=this.cachedCanvases.getCanvas("maskExtension",a,i),R=S.context;R.drawImage(v,-_,-A),R.globalCompositeOperation="destination-atop",R.fillStyle=T,R.fillRect(0,0,a,i),R.globalCompositeOperation="source-over",v=S.canvas,_=A=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const S=new Path2D;S.rect(_,A,a,i),t.clip(S),t.globalCompositeOperation="destination-atop",t.fillStyle=T,t.fillRect(_,A,a,i),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),l==="Alpha"&&c?e.filter=this.filterFactory.addAlphaFilter(c):l==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(c));const y=new Path2D;y.rect(f,d,a,i),e.clip(y),e.globalCompositeOperation="destination-in",e.drawImage(v,_,A,a,i,f,d,a,i),e.restore()}save(){this.inSMaskMode?(Y0(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Y0(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,a,i,l,o){this.ctx.transform(t,e,a,i,l,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,a){const i=this.ctx,l=this.current;let o=l.x,c=l.y,f,d;const g=Jt(i),m=g[0]===0&&g[3]===0||g[1]===0&&g[2]===0,v=m?a.slice(0):null;for(let _=0,A=0,y=t.length;_<y;_++)switch(t[_]|0){case Ai.rectangle:o=e[A++],c=e[A++];const T=e[A++],S=e[A++],R=o+T,C=c+S;i.moveTo(o,c),T===0||S===0?i.lineTo(R,C):(i.lineTo(R,c),i.lineTo(R,C),i.lineTo(o,C)),m||l.updateRectMinMax(g,[o,c,R,C]),i.closePath();break;case Ai.moveTo:o=e[A++],c=e[A++],i.moveTo(o,c),m||l.updatePathMinMax(g,o,c);break;case Ai.lineTo:o=e[A++],c=e[A++],i.lineTo(o,c),m||l.updatePathMinMax(g,o,c);break;case Ai.curveTo:f=o,d=c,o=e[A+4],c=e[A+5],i.bezierCurveTo(e[A],e[A+1],e[A+2],e[A+3],o,c),l.updateCurvePathMinMax(g,f,d,e[A],e[A+1],e[A+2],e[A+3],o,c,v),A+=6;break;case Ai.curveTo2:f=o,d=c,i.bezierCurveTo(o,c,e[A],e[A+1],e[A+2],e[A+3]),l.updateCurvePathMinMax(g,f,d,o,c,e[A],e[A+1],e[A+2],e[A+3],v),o=e[A+2],c=e[A+3],A+=4;break;case Ai.curveTo3:f=o,d=c,o=e[A+2],c=e[A+3],i.bezierCurveTo(e[A],e[A+1],o,c,o,c),l.updateCurvePathMinMax(g,f,d,e[A],e[A+1],o,c,o,c,v),A+=4;break;case Ai.closePath:i.closePath();break}m&&l.updateScalingPathMinMax(g,v),l.setCurrentPoint(o,c)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,a=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof a=="object"&&(a!=null&&a.getPattern)?(e.save(),e.strokeStyle=a.getPattern(e,this,Wi(e),_a.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,a=this.current.fillColor,i=this.current.patternFill;let l=!1;i&&(e.save(),e.fillStyle=a.getPattern(e,this,Wi(e),_a.FILL),l=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),l&&e.restore(),t&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=uI}eoClip(){this.pendingClip=rC}beginText(){this.current.textMatrix=NR,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}const a=new Path2D,i=e.getTransform().invertSelf();for(const{transform:l,x:o,y:c,fontSize:f,path:d}of t)a.addPath(d,new DOMMatrix(l).preMultiplySelf(i).translate(o,c).scale(f,-f));e.clip(a),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var g;const a=this.commonObjs.get(t),i=this.current;if(!a)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=a.fontMatrix||vE,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&it("Invalid font matrix for font "+t),e<0?(e=-e,i.fontDirection=-1):i.fontDirection=1,this.current.font=a,this.current.fontSize=e,a.isType3Font)return;const l=a.loadedName||"sans-serif",o=((g=a.systemFontInfo)==null?void 0:g.css)||`"${l}", ${a.fallbackName}`;let c="normal";a.black?c="900":a.bold&&(c="bold");const f=a.italic?"italic":"normal";let d=e;e<Ww?d=Ww:e>Kw&&(d=Kw),this.current.fontSizeScale=e/d,this.ctx.font=`${f} ${c} ${d}px ${o}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,a,i,l,o){this.current.textMatrix=[t,e,a,i,l,o],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,a,i,l){const o=this.ctx,c=this.current,f=c.font,d=c.textRenderingMode,g=c.fontSize/c.fontSizeScale,m=d&ha.FILL_STROKE_MASK,v=!!(d&ha.ADD_TO_PATH_FLAG),_=c.patternFill&&!f.missingFile,A=c.patternStroke&&!f.missingFile;let y;if((f.disableFontFace||v||_||A)&&(y=f.getPathGenerator(this.commonObjs,t)),f.disableFontFace||_||A){if(o.save(),o.translate(e,a),o.scale(g,-g),m===ha.FILL||m===ha.FILL_STROKE)if(i){const T=o.getTransform();o.setTransform(...i),o.fill(D(this,Hi,qE).call(this,y,T,i))}else o.fill(y);if(m===ha.STROKE||m===ha.FILL_STROKE)if(l){const T=o.getTransform();o.setTransform(...l),o.stroke(D(this,Hi,qE).call(this,y,T,l))}else o.lineWidth/=g,o.stroke(y);o.restore()}else(m===ha.FILL||m===ha.FILL_STROKE)&&o.fillText(t,e,a),(m===ha.STROKE||m===ha.FILL_STROKE)&&o.strokeText(t,e,a);v&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Jt(o),x:e,y:a,fontSize:g,path:y})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let a=!1;for(let i=3;i<e.length;i+=4)if(e[i]>0&&e[i]<255){a=!0;break}return ut(this,"isFontSubpixelAAEnabled",a)}showText(t){const e=this.current,a=e.font;if(a.isType3Font)return this.showType3Text(t);const i=e.fontSize;if(i===0)return;const l=this.ctx,o=e.fontSizeScale,c=e.charSpacing,f=e.wordSpacing,d=e.fontDirection,g=e.textHScale*d,m=t.length,v=a.vertical,_=v?1:-1,A=a.defaultVMetrics,y=i*e.fontMatrix[0],T=e.textRenderingMode===ha.FILL&&!a.disableFontFace&&!e.patternFill;l.save(),l.transform(...e.textMatrix),l.translate(e.x,e.y+e.textRise),d>0?l.scale(g,-1):l.scale(g,1);let S,R;if(e.patternFill){l.save();const k=e.fillColor.getPattern(l,this,Wi(l),_a.FILL);S=Jt(l),l.restore(),l.fillStyle=k}if(e.patternStroke){l.save();const k=e.strokeColor.getPattern(l,this,Wi(l),_a.STROKE);R=Jt(l),l.restore(),l.strokeStyle=k}let C=e.lineWidth;const F=e.textMatrixScale;if(F===0||C===0){const k=e.textRenderingMode&ha.FILL_STROKE_MASK;(k===ha.STROKE||k===ha.FILL_STROKE)&&(C=this.getSinglePixelWidth())}else C/=F;if(o!==1&&(l.scale(o,o),C/=o),l.lineWidth=C,a.isInvalidPDFjsFont){const k=[];let J=0;for(const j of t)k.push(j.unicode),J+=j.width;l.fillText(k.join(""),0,0),e.x+=J*y*g,l.restore(),this.compose();return}let U=0,B;for(B=0;B<m;++B){const k=t[B];if(typeof k=="number"){U+=_*k*i/1e3;continue}let J=!1;const j=(k.isSpace?f:0)+c,ie=k.fontChar,Q=k.accent;let ee,ge,ye=k.width;if(v){const G=k.vmetric||A,te=-(k.vmetric?G[1]:ye*.5)*y,we=G[2]*y;ye=G?-G[0]:ye,ee=te/o,ge=(U+we)/o}else ee=U/o,ge=0;if(a.remeasure&&ye>0){const G=l.measureText(ie).width*1e3/i*o;if(ye<G&&this.isFontSubpixelAAEnabled){const te=ye/G;J=!0,l.save(),l.scale(te,1),ee/=te}else ye!==G&&(ee+=(ye-G)/2e3*i/o)}if(this.contentVisible&&(k.isInFont||a.missingFile)){if(T&&!Q)l.fillText(ie,ee,ge);else if(this.paintChar(ie,ee,ge,S,R),Q){const G=ee+i*Q.offset.x/o,te=ge-i*Q.offset.y/o;this.paintChar(Q.fontChar,G,te,S,R)}}const me=v?ye*y-j*d:ye*y+j*d;U+=me,J&&l.restore()}v?e.y-=U:e.x+=U*g,l.restore(),this.compose()}showType3Text(t){const e=this.ctx,a=this.current,i=a.font,l=a.fontSize,o=a.fontDirection,c=i.vertical?1:-1,f=a.charSpacing,d=a.wordSpacing,g=a.textHScale*o,m=a.fontMatrix||vE,v=t.length,_=a.textRenderingMode===ha.INVISIBLE;let A,y,T,S;if(!(_||l===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...a.textMatrix),e.translate(a.x,a.y),e.scale(g,o),A=0;A<v;++A){if(y=t[A],typeof y=="number"){S=c*y*l/1e3,this.ctx.translate(S,0),a.x+=S*g;continue}const R=(y.isSpace?d:0)+f,C=i.charProcOperatorList[y.operatorListId];if(!C){it(`Type3 character "${y.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=y,this.save(),e.scale(l,l),e.transform(...m),this.executeOperatorList(C),this.restore()),T=Ve.applyTransform([y.width,0],m)[0]*l+R,e.translate(T,0),a.x+=T*g}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,a,i,l,o){this.ctx.rect(a,i,l-a,o-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const a=t[1],i=this.baseTransform||Jt(this.ctx),l={createCanvasGraphics:o=>new Dy(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new jE(t,a,this.ctx,l,i)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,a){this.ctx.strokeStyle=this.current.strokeColor=Ve.makeHexColor(t,e,a),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e,a){this.ctx.fillStyle=this.current.fillColor=Ve.makeHexColor(t,e,a),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let a;return this.cachedPatterns.has(t)?a=this.cachedPatterns.get(t):(a=rI(this.getObject(t)),this.cachedPatterns.set(t,a)),e&&(a.matrix=e),a}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const a=this._getPattern(t);e.fillStyle=a.getPattern(e,this,Wi(e),_a.SHADING);const i=Wi(e);if(i){const{width:l,height:o}=e.canvas,[c,f,d,g]=Ve.getAxialAlignedBoundingBox([0,0,l,o],i);this.ctx.fillRect(c,f,d-c,g-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Ut("Should not call beginInlineImage")}beginImageData(){Ut("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Jt(this.ctx),e)){const a=e[2]-e[0],i=e[3]-e[1];this.ctx.rect(e[0],e[1],a,i),this.current.updateRectMinMax(Jt(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||Ax("TODO: Support non-isolated groups."),t.knockout&&it("Knockout groups not supported.");const a=Jt(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=Ve.getAxialAlignedBoundingBox(t.bbox,Jt(e));const l=[0,0,e.canvas.width,e.canvas.height];i=Ve.intersect(i,l)||[0,0,0,0];const o=Math.floor(i[0]),c=Math.floor(i[1]),f=Math.max(Math.ceil(i[2])-o,1),d=Math.max(Math.ceil(i[3])-c,1);this.current.startNewPathAndClipBox([0,0,f,d]);let g="groupAt"+this.groupLevel;t.smask&&(g+="_smask_"+this.smaskCounter++%2);const m=this.cachedCanvases.getCanvas(g,f,d),v=m.context;v.translate(-o,-c),v.transform(...a),t.smask?this.smaskStack.push({canvas:m.canvas,context:v,offsetX:o,offsetY:c,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(o,c),e.save()),Y0(e,v),this.ctx=v,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Jt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const l=Ve.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],i);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,e,a,i,l){if(D(this,Hi,YE).call(this),V1(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const o=e[2]-e[0],c=e[3]-e[1];if(l&&this.annotationCanvasMap){a=a.slice(),a[4]-=e[0],a[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=o,e[3]=c;const[f,d]=Ve.singularValueDecompose2dScale(Jt(this.ctx)),{viewportScale:g}=this,m=Math.ceil(o*this.outputScaleX*g),v=Math.ceil(c*this.outputScaleY*g);this.annotationCanvas=this.canvasFactory.create(m,v);const{canvas:_,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(t,_),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(f,0,0,-d,0,c*d),V1(this.ctx)}else V1(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],o,c),this.ctx.clip(),this.ctx.beginPath()}this.current=new Zw(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...a),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),D(this,Hi,XE).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const a=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=lI(t)),i.compiled)){i.compiled(a);return}const l=this._createMaskCanvas(t),o=l.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(o,l.offsetX,l.offsetY),a.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,a=0,i=0,l,o){if(!this.contentVisible)return;t=this.getObject(t.data,t);const c=this.ctx;c.save();const f=Jt(c);c.transform(e,a,i,l,0,0);const d=this._createMaskCanvas(t);c.setTransform(1,0,0,1,d.offsetX-f[4],d.offsetY-f[5]);for(let g=0,m=o.length;g<m;g+=2){const v=Ve.transform(f,[e,a,i,l,o[g],o[g+1]]),[_,A]=Ve.applyTransform([0,0],v);c.drawImage(d.canvas,_,A)}c.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,a=this.current.fillColor,i=this.current.patternFill;for(const l of t){const{data:o,width:c,height:f,transform:d}=l,g=this.cachedCanvases.getCanvas("maskCanvas",c,f),m=g.context;m.save();const v=this.getObject(o,l);eC(m,v),m.globalCompositeOperation="source-in",m.fillStyle=i?a.getPattern(m,this,Wi(e),_a.FILL):a,m.fillRect(0,0,c,f),m.restore(),e.save(),e.transform(...d),e.scale(1,-1),G1(e,g.canvas,0,0,c,f,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){it("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,a,i){if(!this.contentVisible)return;const l=this.getObject(t);if(!l){it("Dependent image isn't ready yet");return}const o=l.width,c=l.height,f=[];for(let d=0,g=i.length;d<g;d+=2)f.push({transform:[e,0,0,a,i[d],i[d+1]],x:0,y:0,w:o,h:c});this.paintInlineImageXObjectGroup(l,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:a,height:i}=t,l=this.cachedCanvases.getCanvas("inlineImage",a,i),o=l.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",l.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,a=t.height,i=this.ctx;if(this.save(),!Aa){const{filter:c}=i;c!=="none"&&c!==""&&(i.filter="none")}i.scale(1/e,-1/a);let l;if(t.bitmap)l=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)l=t;else{const f=this.cachedCanvases.getCanvas("inlineImage",e,a).context;Jw(f,t),l=this.applyTransferMapsToCanvas(f)}const o=this._scaleImage(l,Wi(i));i.imageSmoothingEnabled=tC(Jt(i),t.interpolate),G1(i,o.img,0,0,o.paintWidth,o.paintHeight,0,-a,e,a),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const a=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const l=t.width,o=t.height,f=this.cachedCanvases.getCanvas("inlineImage",l,o).context;Jw(f,t),i=this.applyTransferMapsToCanvas(f)}for(const l of e)a.save(),a.transform(...l.transform),a.scale(1,-1),G1(a,i,l.x,l.y,l.w,l.h,0,-1,1,1),a.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const a=this.ctx;this.pendingClip&&(e||(this.pendingClip===rC?a.clip("evenodd"):a.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),a.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Jt(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),a=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(a,i)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:a,c:i,d:l}=this.ctx.getTransform();let o,c;if(a===0&&i===0){const f=Math.abs(e),d=Math.abs(l);if(f===d)if(t===0)o=c=1/f;else{const g=f*t;o=c=g<1?1/g:1}else if(t===0)o=1/f,c=1/d;else{const g=f*t,m=d*t;o=g<1?1/g:1,c=m<1?1/m:1}}else{const f=Math.abs(e*l-a*i),d=Math.hypot(e,a),g=Math.hypot(i,l);if(t===0)o=g/f,c=d/f;else{const m=t*f;o=g>m?g/m:1,c=d>m?d/m:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:a}=this.current,[i,l]=this.getScaleForStroking();if(e.lineWidth=a||1,i===1&&l===1){e.stroke();return}const o=e.getLineDash();if(t&&e.save(),e.scale(i,l),o.length>0){const c=Math.max(i,l);e.setLineDash(o.map(f=>f/c)),e.lineDashOffset/=c}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};Hi=new WeakSet,YE=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},XE=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},qE=function(t,e,a){const i=new Path2D;return i.addPath(t,new DOMMatrix(a).invertSelf().multiplySelf(e)),i};let Ff=Dy;for(const r in Ai)Ff.prototype[r]!==void 0&&(Ff.prototype[Ai[r]]=Ff.prototype[r]);var dp,pp;class pl{static get workerPort(){return p(this,dp)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");w(this,dp,t)}static get workerSrc(){return p(this,pp)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");w(this,pp,t)}}dp=new WeakMap,pp=new WeakMap,O(pl,dp,null),O(pl,pp,"");var Uc,gp;class fI{constructor({parsedData:t,rawData:e}){O(this,Uc);O(this,gp);w(this,Uc,t),w(this,gp,e)}getRaw(){return p(this,gp)}get(t){return p(this,Uc).get(t)??null}getAll(){return XA(p(this,Uc))}has(t){return p(this,Uc).has(t)}}Uc=new WeakMap,gp=new WeakMap;const bf=Symbol("INTERNAL");var mp,xp,vp,ah;class hI{constructor(t,{name:e,intent:a,usage:i,rbGroups:l}){O(this,mp,!1);O(this,xp,!1);O(this,vp,!1);O(this,ah,!0);w(this,mp,!!(t&kn.DISPLAY)),w(this,xp,!!(t&kn.PRINT)),this.name=e,this.intent=a,this.usage=i,this.rbGroups=l}get visible(){if(p(this,vp))return p(this,ah);if(!p(this,ah))return!1;const{print:t,view:e}=this.usage;return p(this,mp)?(e==null?void 0:e.viewState)!=="OFF":p(this,xp)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,a=!1){t!==bf&&Ut("Internal method `_setVisible` called."),w(this,vp,a),w(this,ah,e)}}mp=new WeakMap,xp=new WeakMap,vp=new WeakMap,ah=new WeakMap;var fo,Dt,nh,ih,_p,WE;class dI{constructor(t,e=kn.DISPLAY){O(this,_p);O(this,fo,null);O(this,Dt,new Map);O(this,nh,null);O(this,ih,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,w(this,ih,t.order);for(const a of t.groups)p(this,Dt).set(a.id,new hI(e,a));if(t.baseState==="OFF")for(const a of p(this,Dt).values())a._setVisible(bf,!1);for(const a of t.on)p(this,Dt).get(a)._setVisible(bf,!0);for(const a of t.off)p(this,Dt).get(a)._setVisible(bf,!1);w(this,nh,this.getHash())}}isVisible(t){if(p(this,Dt).size===0)return!0;if(!t)return Ax("Optional content group not defined."),!0;if(t.type==="OCG")return p(this,Dt).has(t.id)?p(this,Dt).get(t.id).visible:(it(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return D(this,_p,WE).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!p(this,Dt).has(e))return it(`Optional content group not found: ${e}`),!0;if(p(this,Dt).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!p(this,Dt).has(e))return it(`Optional content group not found: ${e}`),!0;if(!p(this,Dt).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!p(this,Dt).has(e))return it(`Optional content group not found: ${e}`),!0;if(!p(this,Dt).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!p(this,Dt).has(e))return it(`Optional content group not found: ${e}`),!0;if(p(this,Dt).get(e).visible)return!1}return!0}return it(`Unknown optional content policy ${t.policy}.`),!0}return it(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,a=!0){var l;const i=p(this,Dt).get(t);if(!i){it(`Optional content group not found: ${t}`);return}if(a&&e&&i.rbGroups.length)for(const o of i.rbGroups)for(const c of o)c!==t&&((l=p(this,Dt).get(c))==null||l._setVisible(bf,!1,!0));i._setVisible(bf,!!e,!0),w(this,fo,null)}setOCGState({state:t,preserveRB:e}){let a;for(const i of t){switch(i){case"ON":case"OFF":case"Toggle":a=i;continue}const l=p(this,Dt).get(i);if(l)switch(a){case"ON":this.setVisibility(i,!0,e);break;case"OFF":this.setVisibility(i,!1,e);break;case"Toggle":this.setVisibility(i,!l.visible,e);break}}w(this,fo,null)}get hasInitialVisibility(){return p(this,nh)===null||this.getHash()===p(this,nh)}getOrder(){return p(this,Dt).size?p(this,ih)?p(this,ih).slice():[...p(this,Dt).keys()]:null}getGroups(){return p(this,Dt).size>0?XA(p(this,Dt)):null}getGroup(t){return p(this,Dt).get(t)||null}getHash(){if(p(this,fo)!==null)return p(this,fo);const t=new ck;for(const[e,a]of p(this,Dt))t.update(`${e}:${a.visible}`);return w(this,fo,t.hexdigest())}}fo=new WeakMap,Dt=new WeakMap,nh=new WeakMap,ih=new WeakMap,_p=new WeakSet,WE=function(t){const e=t.length;if(e<2)return!0;const a=t[0];for(let i=1;i<e;i++){const l=t[i];let o;if(Array.isArray(l))o=D(this,_p,WE).call(this,l);else if(p(this,Dt).has(l))o=p(this,Dt).get(l).visible;else return it(`Optional content group not found: ${l}`),!0;switch(a){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return a==="And"};class pI{constructor(t,{disableRange:e=!1,disableStream:a=!1}){Rr(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:l,progressiveDone:o,contentDispositionFilename:c}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=c,(l==null?void 0:l.length)>0){const f=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!a,this._isRangeSupported=!e,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((f,d)=>{this._onReceiveData({begin:f,chunk:d})}),t.addProgressListener((f,d)=>{this._onProgress({loaded:f,total:d})}),t.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const a=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(a):this._queuedChunks.push(a);else{const i=this._rangeReaders.some(function(l){return l._begin!==t?!1:(l._enqueue(a),!0)});Rr(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,a,i,l;t.total===void 0?(a=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||a.call(e,{loaded:t.loaded}):(l=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||l.call(i,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Rr(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new gI(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const a=new mI(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(a),a}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const a of this._rangeReaders.slice(0))a.cancel(t);this._pdfDataRangeTransport.abort()}}class gI{constructor(t,e,a=!1,i=null){this._stream=t,this._done=a||!1,this._filename=KA(i)?i:null,this._queuedChunks=e||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class mI{constructor(t,e,a){this._stream=t,this._begin=e,this._end=a,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function xI(r){let t=!0,e=a("filename\\*","i").exec(r);if(e){e=e[1];let g=c(e);return g=unescape(g),g=f(g),g=d(g),l(g)}if(e=o(r),e){const g=d(e);return l(g)}if(e=a("filename","i").exec(r),e){e=e[1];let g=c(e);return g=d(g),l(g)}function a(g,m){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function i(g,m){if(g){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const v=new TextDecoder(g,{fatal:!0}),_=yx(m);m=v.decode(_),t=!1}catch{}}return m}function l(g){return t&&/[\x80-\xff]/.test(g)&&(g=i("utf-8",g),t&&(g=i("iso-8859-1",g))),g}function o(g){const m=[];let v;const _=a("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=_.exec(g))!==null;){let[,y,T,S]=v;if(y=parseInt(y,10),y in m){if(y===0)break;continue}m[y]=[T,S]}const A=[];for(let y=0;y<m.length&&y in m;++y){let[T,S]=m[y];S=c(S),T&&(S=unescape(S),y===0&&(S=f(S))),A.push(S)}return A.join("")}function c(g){if(g.startsWith('"')){const m=g.slice(1).split('\\"');for(let v=0;v<m.length;++v){const _=m[v].indexOf('"');_!==-1&&(m[v]=m[v].slice(0,_),m.length=v+1),m[v]=m[v].replaceAll(/\\(.)/g,"$1")}g=m.join('"')}return g}function f(g){const m=g.indexOf("'");if(m===-1)return g;const v=g.slice(0,m),A=g.slice(m+1).replace(/^[^']*'/,"");return i(v,A)}function d(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,v,_,A){if(_==="q"||_==="Q")return A=A.replaceAll("_"," "),A=A.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,T){return String.fromCharCode(parseInt(T,16))}),i(v,A);try{A=atob(A)}catch{}return i(v,A)})}return""}function Tk(r,t){const e=new Headers;if(!r||!t||typeof t!="object")return e;for(const a in t){const i=t[a];i!==void 0&&e.append(a,i)}return e}function bx(r){try{return new URL(r).origin}catch{}return null}function Sk({responseHeaders:r,isHttp:t,rangeChunkSize:e,disableRange:a}){const i={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(r.get("Content-Length"),10);return!Number.isInteger(l)||(i.suggestedLength=l,l<=2*e)||a||!t||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function bk(r){const t=r.get("Content-Disposition");if(t){let e=xI(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(KA(e))return e}return null}function wx(r,t){return r===404||r===0&&t.startsWith("file:")?new Cd('Missing PDF "'+t+'".'):new Nm(`Unexpected server response (${r}) while retrieving PDF "${t}".`,r)}function wk(r){return r===200||r===206}function Ck(r,t,e){return{method:"GET",headers:r,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Rk(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(it(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class aC{constructor(t){Xe(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Tk(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Rr(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new vI(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const a=new _I(this,t,e);return this._rangeRequestReaders.push(a),a}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const a of this._rangeRequestReaders.slice(0))a.cancel(t)}}class vI{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const a=new Headers(t.headers),i=e.url;fetch(i,Ck(a,this._withCredentials,this._abortController)).then(l=>{if(t._responseOrigin=bx(l.url),!wk(l.status))throw wx(l.status,i);this._reader=l.body.getReader(),this._headersCapability.resolve();const o=l.headers,{allowRangeRequests:c,suggestedLength:f}=Sk({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=f||this._contentLength,this._filename=bk(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Io("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var a;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(a=this.onProgress)==null||a.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Rk(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class _I{constructor(t,e,a){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const l=new Headers(t.headers);l.append("Range",`bytes=${e}-${a-1}`);const o=i.url;fetch(o,Ck(l,this._withCredentials,this._abortController)).then(c=>{const f=bx(c.url);if(f!==t._responseOrigin)throw new Error(`Expected range response-origin "${f}" to match "${t._responseOrigin}".`);if(!wk(c.status))throw wx(c.status,o);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var a;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(a=this.onProgress)==null||a.call(this,{loaded:this._loaded}),{value:Rk(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const tE=200,rE=206;function EI(r){const t=r.response;return typeof t!="string"?t:yx(t).buffer}class AI{constructor({url:t,httpHeaders:e,withCredentials:a}){Xe(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Tk(this.isHttp,e),this.withCredentials=a||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,a=this.currXhrId++,i=this.pendingRequests[a]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[l,o]of this.headers)e.setRequestHeader(l,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.expectedStatus=rE):i.expectedStatus=tE,e.responseType="arraybuffer",Rr(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,a),e.onprogress=this.onProgress.bind(this,a),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),a}onProgress(t,e){var i;const a=this.pendingRequests[t];a&&((i=a.onProgress)==null||i.call(a,e))}onStateChange(t,e){const a=this.pendingRequests[t];if(!a)return;const i=a.xhr;if(i.readyState>=2&&a.onHeadersReceived&&(a.onHeadersReceived(),delete a.onHeadersReceived),i.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],i.status===0&&this.isHttp){a.onError(i.status);return}const l=i.status||tE;if(!(l===tE&&a.expectedStatus===rE)&&l!==a.expectedStatus){a.onError(i.status);return}const c=EI(i);if(l===rE){const f=i.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);d?a.onDone({begin:parseInt(d[1],10),chunk:c}):(it('Missing or invalid "Content-Range" header.'),a.onError(0))}else c?a.onDone({begin:0,chunk:c}):a.onError(i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class yI{constructor(t){this._source=t,this._manager=new AI(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Rr(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new TI(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const a=new SI(this._manager,t,e);return a.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(a),a}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const a of this._rangeRequestReaders.slice(0))a.cancel(t)}}class TI{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=bx(e.responseURL);const a=e.getAllResponseHeaders(),i=new Headers(a?a.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[f,...d]=c.split(": ");return[f,d.join(": ")]}):[]),{allowRangeRequests:l,suggestedLength:o}=Sk({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=bk(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=wx(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class SI{constructor(t,e,a){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:a,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=bx((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=wx(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const bI=/^[a-z][a-z0-9\-+.]+:/i;function wI(r){if(bI.test(r))return new URL(r);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(r))}class CI{constructor(t){this.source=t,this.url=wI(t.url),Rr(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Rr(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new RI(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const a=new kI(this,t,e);return this._rangeRequestReaders.push(a),a}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const a of this._rangeRequestReaders.slice(0))a.cancel(t)}}class RI{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const a=process.getBuiltinModule("fs");a.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(a.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new Cd(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var a;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(a=this.onProgress)==null||a.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Io("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class kI{constructor(t,e,a){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=t.source;this._isStreamingSupported=!i.disableStream;const l=process.getBuiltinModule("fs");this._setReadableStream(l.createReadStream(this._url,{start:e,end:a-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var a;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(a=this.onProgress)==null||a.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const OI=1e5,en=30,DI=.8;var uR,ho,nn,Ep,Ap,Hc,Zs,yp,Tp,zc,sh,lh,po,oh,Sp,ch,Gc,bp,wp,Vc,jc,Cp,go,uh,yl,kk,Ok,KE,In,fm,$E,Dk,Nk;const Nr=class Nr{constructor({textContentSource:t,container:e,viewport:a}){O(this,yl);O(this,ho,Promise.withResolvers());O(this,nn,null);O(this,Ep,!1);O(this,Ap,!!((uR=globalThis.FontInspector)!=null&&uR.enabled));O(this,Hc,null);O(this,Zs,null);O(this,yp,0);O(this,Tp,0);O(this,zc,null);O(this,sh,null);O(this,lh,0);O(this,po,0);O(this,oh,Object.create(null));O(this,Sp,[]);O(this,ch,null);O(this,Gc,[]);O(this,bp,new WeakMap);O(this,wp,null);var f;if(t instanceof ReadableStream)w(this,ch,t);else if(typeof t=="object")w(this,ch,new ReadableStream({start(d){d.enqueue(t),d.close()}}));else throw new Error('No "textContentSource" parameter specified.');w(this,nn,w(this,sh,e)),w(this,po,a.scale*(globalThis.devicePixelRatio||1)),w(this,lh,a.rotation),w(this,Zs,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:l,pageX:o,pageY:c}=a.rawDims;w(this,wp,[1,0,0,-1,-o,c+l]),w(this,Tp,i),w(this,yp,l),D(f=Nr,In,Dk).call(f),yu(e,a),p(this,ho).promise.finally(()=>{p(Nr,uh).delete(this),w(this,Zs,null),w(this,oh,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Ua.platform;return ut(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{p(this,zc).read().then(({value:e,done:a})=>{if(a){p(this,ho).resolve();return}p(this,Hc)??w(this,Hc,e.lang),Object.assign(p(this,oh),e.styles),D(this,yl,kk).call(this,e.items),t()},p(this,ho).reject)};return w(this,zc,p(this,ch).getReader()),p(Nr,uh).add(this),t(),p(this,ho).promise}update({viewport:t,onBefore:e=null}){var l;const a=t.scale*(globalThis.devicePixelRatio||1),i=t.rotation;if(i!==p(this,lh)&&(e==null||e(),w(this,lh,i),yu(p(this,sh),{rotation:i})),a!==p(this,po)){e==null||e(),w(this,po,a);const o={div:null,properties:null,ctx:D(l=Nr,In,fm).call(l,p(this,Hc))};for(const c of p(this,Gc))o.properties=p(this,bp).get(c),o.div=c,D(this,yl,KE).call(this,o)}}cancel(){var e;const t=new Io("TextLayer task cancelled.");(e=p(this,zc))==null||e.cancel(t).catch(()=>{}),w(this,zc,null),p(this,ho).reject(t)}get textDivs(){return p(this,Gc)}get textContentItemsStr(){return p(this,Sp)}static cleanup(){if(!(p(this,uh).size>0)){p(this,Vc).clear();for(const{canvas:t}of p(this,jc).values())t.remove();p(this,jc).clear()}}};ho=new WeakMap,nn=new WeakMap,Ep=new WeakMap,Ap=new WeakMap,Hc=new WeakMap,Zs=new WeakMap,yp=new WeakMap,Tp=new WeakMap,zc=new WeakMap,sh=new WeakMap,lh=new WeakMap,po=new WeakMap,oh=new WeakMap,Sp=new WeakMap,ch=new WeakMap,Gc=new WeakMap,bp=new WeakMap,wp=new WeakMap,Vc=new WeakMap,jc=new WeakMap,Cp=new WeakMap,go=new WeakMap,uh=new WeakMap,yl=new WeakSet,kk=function(t){var i,l;if(p(this,Ep))return;(l=p(this,Zs)).ctx??(l.ctx=D(i=Nr,In,fm).call(i,p(this,Hc)));const e=p(this,Gc),a=p(this,Sp);for(const o of t){if(e.length>OI){it("Ignoring additional textDivs for performance reasons."),w(this,Ep,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const c=p(this,nn);w(this,nn,document.createElement("span")),p(this,nn).classList.add("markedContent"),o.id!==null&&p(this,nn).setAttribute("id",`${o.id}`),c.append(p(this,nn))}else o.type==="endMarkedContent"&&w(this,nn,p(this,nn).parentNode);continue}a.push(o.str),D(this,yl,Ok).call(this,o)}},Ok=function(t){var y;const e=document.createElement("span"),a={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};p(this,Gc).push(e);const i=Ve.transform(p(this,wp),t.transform);let l=Math.atan2(i[1],i[0]);const o=p(this,oh)[t.fontName];o.vertical&&(l+=Math.PI/2);let c=p(this,Ap)&&o.fontSubstitution||o.fontFamily;c=Nr.fontFamilyMap.get(c)||c;const f=Math.hypot(i[2],i[3]),d=f*D(y=Nr,In,Nk).call(y,c,p(this,Hc));let g,m;l===0?(g=i[4],m=i[5]-d):(g=i[4]+d*Math.sin(l),m=i[5]-d*Math.cos(l));const v="calc(var(--scale-factor)*",_=e.style;p(this,nn)===p(this,sh)?(_.left=`${(100*g/p(this,Tp)).toFixed(2)}%`,_.top=`${(100*m/p(this,yp)).toFixed(2)}%`):(_.left=`${v}${g.toFixed(2)}px)`,_.top=`${v}${m.toFixed(2)}px)`),_.fontSize=`${v}${(p(Nr,go)*f).toFixed(2)}px)`,_.fontFamily=c,a.fontSize=f,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,p(this,Ap)&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),l!==0&&(a.angle=l*(180/Math.PI));let A=!1;if(t.str.length>1)A=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const T=Math.abs(t.transform[0]),S=Math.abs(t.transform[3]);T!==S&&Math.max(T,S)/Math.min(T,S)>1.5&&(A=!0)}if(A&&(a.canvasWidth=o.vertical?t.height:t.width),p(this,bp).set(e,a),p(this,Zs).div=e,p(this,Zs).properties=a,D(this,yl,KE).call(this,p(this,Zs)),a.hasText&&p(this,nn).append(e),a.hasEOL){const T=document.createElement("br");T.setAttribute("role","presentation"),p(this,nn).append(T)}},KE=function(t){var c;const{div:e,properties:a,ctx:i}=t,{style:l}=e;let o="";if(p(Nr,go)>1&&(o=`scale(${1/p(Nr,go)})`),a.canvasWidth!==0&&a.hasText){const{fontFamily:f}=l,{canvasWidth:d,fontSize:g}=a;D(c=Nr,In,$E).call(c,i,g*p(this,po),f);const{width:m}=i.measureText(e.textContent);m>0&&(o=`scaleX(${d*p(this,po)/m}) ${o}`)}a.angle!==0&&(o=`rotate(${a.angle}deg) ${o}`),o.length>0&&(l.transform=o)},In=new WeakSet,fm=function(t=null){let e=p(this,jc).get(t||(t=""));if(!e){const a=document.createElement("canvas");a.className="hiddenCanvasElement",a.lang=t,document.body.append(a),e=a.getContext("2d",{alpha:!1,willReadFrequently:!0}),p(this,jc).set(t,e),p(this,Cp).set(e,{size:0,family:""})}return e},$E=function(t,e,a){const i=p(this,Cp).get(t);e===i.size&&a===i.family||(t.font=`${e}px ${a}`,i.size=e,i.family=a)},Dk=function(){if(p(this,go)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),w(this,go,t.getBoundingClientRect().height),t.remove()},Nk=function(t,e){const a=p(this,Vc).get(t);if(a)return a;const i=D(this,In,fm).call(this,e);i.canvas.width=i.canvas.height=en,D(this,In,$E).call(this,i,en,t);const l=i.measureText("");let o=l.fontBoundingBoxAscent,c=Math.abs(l.fontBoundingBoxDescent);if(o){const g=o/(o+c);return p(this,Vc).set(t,g),i.canvas.width=i.canvas.height=0,g}i.strokeStyle="red",i.clearRect(0,0,en,en),i.strokeText("g",0,0);let f=i.getImageData(0,0,en,en).data;c=0;for(let g=f.length-1-3;g>=0;g-=4)if(f[g]>0){c=Math.ceil(g/4/en);break}i.clearRect(0,0,en,en),i.strokeText("A",0,en),f=i.getImageData(0,0,en,en).data,o=0;for(let g=0,m=f.length;g<m;g+=4)if(f[g]>0){o=en-Math.floor(g/4/en);break}i.canvas.width=i.canvas.height=0;const d=o?o/(o+c):DI;return p(this,Vc).set(t,d),d},O(Nr,In),O(Nr,Vc,new Map),O(Nr,jc,new Map),O(Nr,Cp,new WeakMap),O(Nr,go,null),O(Nr,uh,new Set);let Rd=Nr;class kd{static textContent(t){const e=[],a={items:e,styles:Object.create(null)};function i(l){var f;if(!l)return;let o=null;const c=l.name;if(c==="#text")o=l.value;else if(kd.shouldBuildText(c))(f=l==null?void 0:l.attributes)!=null&&f.textContent?o=l.attributes.textContent:l.value&&(o=l.value);else return;if(o!==null&&e.push({str:o}),!!l.children)for(const d of l.children)i(d)}return i(t),a}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const NI=65536,MI=100,II=5e3,FI=Aa?KM:XM,LI=Aa?$M:xk,PI=Aa?WM:qM,BI=Aa?QM:Ak;function UI(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const t=new QE,{docId:e}=t,a=r.url?HI(r.url):null,i=r.data?zI(r.data):null,l=r.httpHeaders||null,o=r.withCredentials===!0,c=r.password??null,f=r.range instanceof Mk?r.range:null,d=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:NI;let g=r.worker instanceof Lf?r.worker:null;const m=r.verbosity,v=typeof r.docBaseUrl=="string"&&!Sx(r.docBaseUrl)?r.docBaseUrl:null,_=typeof r.cMapUrl=="string"?r.cMapUrl:null,A=r.cMapPacked!==!1,y=r.CMapReaderFactory||LI,T=typeof r.standardFontDataUrl=="string"?r.standardFontDataUrl:null,S=r.StandardFontDataFactory||BI,R=r.stopAtErrors!==!0,C=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,F=r.isEvalSupported!==!1,U=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!Aa,B=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!Aa&&(Ua.platform.isFirefox||!globalThis.chrome),k=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,J=typeof r.disableFontFace=="boolean"?r.disableFontFace:Aa,j=r.fontExtraProperties===!0,ie=r.enableXfa===!0,Q=r.ownerDocument||globalThis.document,ee=r.disableRange===!0,ge=r.disableStream===!0,ye=r.disableAutoFetch===!0,me=r.pdfBug===!0,G=r.CanvasFactory||FI,te=r.FilterFactory||PI,we=r.enableHWA===!0,ae=f?f.length:r.length??NaN,Oe=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!Aa&&!J,Y=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:y===xk&&S===Ak&&_&&T&&K0(_,document.baseURI)&&K0(T,document.baseURI),N=null;SM(m);const q={canvasFactory:new G({ownerDocument:Q,enableHWA:we}),filterFactory:new te({docId:e,ownerDocument:Q}),cMapReaderFactory:Y?null:new y({baseUrl:_,isCompressed:A}),standardFontDataFactory:Y?null:new S({baseUrl:T})};if(!g){const se={verbosity:m,port:pl.workerPort};g=se.port?Lf.fromPort(se):new Lf(se),t._worker=g}const X={docId:e,apiVersion:"4.10.38",data:i,password:c,disableAutoFetch:ye,rangeChunkSize:d,length:ae,docBaseUrl:v,enableXfa:ie,evaluatorOptions:{maxImageSize:C,disableFontFace:J,ignoreErrors:R,isEvalSupported:F,isOffscreenCanvasSupported:U,isImageDecoderSupported:B,canvasMaxAreaInBytes:k,fontExtraProperties:j,useSystemFonts:Oe,cMapUrl:Y?_:null,standardFontDataUrl:Y?T:null}},K={disableFontFace:J,fontExtraProperties:j,ownerDocument:Q,pdfBug:me,styleElement:N,loadingParams:{disableAutoFetch:ye,enableXfa:ie}};return g.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const se=g.messageHandler.sendWithPromise("GetDocRequest",X,i?[i.buffer]:null);let xe;if(f)xe=new pI(f,{disableRange:ee,disableStream:ge});else if(!i){if(!a)throw new Error("getDocument - no `url` parameter provided.");let ke;if(Aa)if(K0(a)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");ke=aC}else ke=CI;else ke=K0(a)?aC:yI;xe=new ke({url:a,length:ae,httpHeaders:l,withCredentials:o,rangeChunkSize:d,disableRange:ee,disableStream:ge})}return se.then(ke=>{if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const Se=new J0(e,ke,g.port),be=new YI(Se,t,xe,K,q);t._transport=be,Se.send("Ready",null)})}).catch(t._capability.reject),t}function HI(r){if(r instanceof URL)return r.href;try{return new URL(r,window.location).href}catch{if(Aa&&typeof r=="string")return r}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function zI(r){if(Aa&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return yx(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r==null?void 0:r.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function nC(r){return typeof r=="object"&&Number.isInteger(r==null?void 0:r.num)&&r.num>=0&&Number.isInteger(r==null?void 0:r.gen)&&r.gen>=0}var ix;const sx=class sx{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${ka(sx,ix)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,e,a,i;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(l){throw(a=this._worker)!=null&&a.port&&delete this._worker._pendingDestroy,l}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}};ix=new WeakMap,O(sx,ix,0);let QE=sx;class Mk{constructor(t,e,a=!1,i=null){this.length=t,this.initialData=e,this.progressiveDone=a,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const a of this._rangeListeners)a(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const a of this._progressListeners)a(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){Ut("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class GI{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ut(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var mo,Js,si,wf,hm;class VI{constructor(t,e,a,i=!1){O(this,si);O(this,mo,null);O(this,Js,!1);this._pageIndex=t,this._pageInfo=e,this._transport=a,this._stats=i?new jw:null,this._pdfBug=i,this.commonObjs=a.commonObjs,this.objs=new Ik,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:a=0,offsetY:i=0,dontFlip:l=!1}={}){return new ug({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:a,offsetY:i,dontFlip:l})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ut(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:a="display",annotationMode:i=Ql.ENABLE,transform:l=null,background:o=null,optionalContentConfigPromise:c=null,annotationCanvasMap:f=null,pageColors:d=null,printAnnotationStorage:g=null,isEditing:m=!1}){var F,U;(F=this._stats)==null||F.time("Overall");const v=this._transport.getRenderingIntent(a,i,g,m),{renderingIntent:_,cacheKey:A}=v;w(this,Js,!1),D(this,si,hm).call(this),c||(c=this._transport.getOptionalContentConfig(_));let y=this._intentStates.get(A);y||(y=Object.create(null),this._intentStates.set(A,y)),y.streamReaderCancelTimeout&&(clearTimeout(y.streamReaderCancelTimeout),y.streamReaderCancelTimeout=null);const T=!!(_&kn.PRINT);y.displayReadyCapability||(y.displayReadyCapability=Promise.withResolvers(),y.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(U=this._stats)==null||U.time("Page Request"),this._pumpOperatorList(v));const S=B=>{var k;y.renderTasks.delete(R),(this._maybeCleanupAfterRender||T)&&w(this,Js,!0),D(this,si,wf).call(this,!T),B?(R.capability.reject(B),this._abortOperatorList({intentState:y,reason:B instanceof Error?B:new Error(B)})):R.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(k=globalThis.Stats)!=null&&k.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},R=new JE({callback:S,params:{canvasContext:t,viewport:e,transform:l,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:y.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:d});(y.renderTasks||(y.renderTasks=new Set)).add(R);const C=R.task;return Promise.all([y.displayReadyCapability.promise,c]).then(([B,k])=>{var J;if(this.destroyed){S();return}if((J=this._stats)==null||J.time("Rendering"),!(k.renderingIntent&_))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");R.initializeGraphics({transparency:B,optionalContentConfig:k}),R.operatorListChanged()}).catch(S),C}getOperatorList({intent:t="display",annotationMode:e=Ql.ENABLE,printAnnotationStorage:a=null,isEditing:i=!1}={}){var d;function l(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(f))}const o=this._transport.getRenderingIntent(t,e,a,i,!0);let c=this._intentStates.get(o.cacheKey);c||(c=Object.create(null),this._intentStates.set(o.cacheKey,c));let f;return c.opListReadCapability||(f=Object.create(null),f.operatorListChanged=l,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||(c.renderTasks=new Set)).add(f),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(d=this._stats)==null||d.time("Page Request"),this._pumpOperatorList(o)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(a=>kd.textContent(a));const e=this.streamTextContent(t);return new Promise(function(a,i){function l(){o.read().then(function({value:f,done:d}){if(d){a(c);return}c.lang??(c.lang=f.lang),Object.assign(c.styles,f.styles),c.items.push(...f.items),l()},i)}const o=e.getReader(),c={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const a of e.renderTasks)t.push(a.completed),a.cancel();return this.objs.clear(),w(this,Js,!1),D(this,si,hm).call(this),Promise.all(t)}cleanup(t=!1){w(this,Js,!0);const e=D(this,si,wf).call(this,!1);return t&&e&&this._stats&&(this._stats=new jw),e}_startRenderPage(t,e){var i,l;const a=this._intentStates.get(e);a&&((i=this._stats)==null||i.timeEnd("Page Request"),(l=a.displayReadyCapability)==null||l.resolve(t))}_renderPageChunk(t,e){for(let a=0,i=t.length;a<i;a++)e.operatorList.fnArray.push(t.fnArray[a]),e.operatorList.argsArray.push(t.argsArray[a]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const a of e.renderTasks)a.operatorListChanged();t.lastChunk&&D(this,si,wf).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:a,modifiedIds:i}){const{map:l,transfer:o}=a,f=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:l,modifiedIds:i},o).getReader(),d=this._intentStates.get(e);d.streamReader=f;const g=()=>{f.read().then(({value:m,done:v})=>{if(v){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,d),g())},m=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const v of d.renderTasks)v.operatorListChanged();D(this,si,wf).call(this,!0)}if(d.displayReadyCapability)d.displayReadyCapability.reject(m);else if(d.opListReadCapability)d.opListReadCapability.reject(m);else throw m}})};g()}_abortOperatorList({intentState:t,reason:e,force:a=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!a){if(t.renderTasks.size>0)return;if(e instanceof WA){let i=MI;e.extraDelay>0&&e.extraDelay<1e3&&(i+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},i);return}}if(t.streamReader.cancel(new Io(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[i,l]of this._intentStates)if(l===t){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}mo=new WeakMap,Js=new WeakMap,si=new WeakSet,wf=function(t=!1){if(D(this,si,hm).call(this),!p(this,Js)||this.destroyed)return!1;if(t)return w(this,mo,setTimeout(()=>{w(this,mo,null),D(this,si,wf).call(this,!1)},II)),!1;for(const{renderTasks:e,operatorList:a}of this._intentStates.values())if(e.size>0||!a.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),w(this,Js,!1),!0},hm=function(){p(this,mo)&&(clearTimeout(p(this,mo)),w(this,mo,null))};var el,lx;class jI{constructor(){O(this,el,new Map);O(this,lx,Promise.resolve())}postMessage(t,e){const a={data:structuredClone(t,e?{transfer:e}:null)};p(this,lx).then(()=>{for(const[i]of p(this,el))i.call(this,a)})}addEventListener(t,e,a=null){let i=null;if((a==null?void 0:a.signal)instanceof AbortSignal){const{signal:l}=a;if(l.aborted){it("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);i=()=>l.removeEventListener("abort",o),l.addEventListener("abort",o)}p(this,el).set(e,i)}removeEventListener(t,e){const a=p(this,el).get(e);a==null||a(),p(this,el).delete(e)}terminate(){for(const[,t]of p(this,el))t==null||t();p(this,el).clear()}}el=new WeakMap,lx=new WeakMap;var ox,Yc,Xc,fh,dm,hh,pm;const Zt=class Zt{constructor({name:t=null,port:e=null,verbosity:a=bM()}={}){O(this,fh);var i;if(this.name=t,this.destroyed=!1,this.verbosity=a,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((i=p(Zt,Xc))!=null&&i.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(p(Zt,Xc)||w(Zt,Xc,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new J0("main","worker",t),this._messageHandler.on("ready",function(){}),D(this,fh,dm).call(this)}_initialize(){if(p(Zt,Yc)||p(Zt,hh,pm)){this._setupFakeWorker();return}let{workerSrc:t}=Zt;try{Zt._isSameOrigin(window.location.href,t)||(t=Zt._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),a=new J0("main","worker",e),i=()=>{l.abort(),a.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},l=new AbortController;e.addEventListener("error",()=>{this._webWorker||i()},{signal:l.signal}),a.on("test",c=>{if(l.abort(),this.destroyed||!c){i();return}this._messageHandler=a,this._port=e,this._webWorker=e,D(this,fh,dm).call(this)}),a.on("ready",c=>{if(l.abort(),this.destroyed){i();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const c=new Uint8Array;a.send("test",c,[c.buffer])};o();return}catch{Ax("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){p(Zt,Yc)||(it("Setting up fake worker."),w(Zt,Yc,!0)),Zt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new jI;this._port=e;const a=`fake${ka(Zt,ox)._++}`,i=new J0(a+"_worker",a,e);t.setup(i,e),this._messageHandler=new J0(a,a+"_worker",e),D(this,fh,dm).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t,e,a;this.destroyed=!0,(t=this._webWorker)==null||t.terminate(),this._webWorker=null,(e=p(Zt,Xc))==null||e.delete(this._port),this._port=null,(a=this._messageHandler)==null||a.destroy(),this._messageHandler=null}static fromPort(t){var a;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(a=p(this,Xc))==null?void 0:a.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Zt(t)}static get workerSrc(){if(pl.workerSrc)return pl.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ut(this,"_setupFakeWorkerGlobal",(async()=>p(this,hh,pm)?p(this,hh,pm):(await import(this.workerSrc)).WorkerMessageHandler)())}};ox=new WeakMap,Yc=new WeakMap,Xc=new WeakMap,fh=new WeakSet,dm=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},hh=new WeakSet,pm=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},O(Zt,hh),O(Zt,ox,0),O(Zt,Yc,!1),O(Zt,Xc),Aa&&(w(Zt,Yc,!0),pl.workerSrc||(pl.workerSrc="./pdf.worker.mjs")),Zt._isSameOrigin=(t,e)=>{let a;try{if(a=new URL(t),!a.origin||a.origin==="null")return!1}catch{return!1}const i=new URL(e,a);return a.origin===i.origin},Zt._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};let Lf=Zt;var tl,os,dh,ph,rl,qc,nd;class YI{constructor(t,e,a,i,l){O(this,qc);O(this,tl,new Map);O(this,os,new Map);O(this,dh,new Map);O(this,ph,new Map);O(this,rl,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new Ik,this.fontLoader=new jM({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=a,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return ut(this,"annotationStorage",new ZA)}getRenderingIntent(t,e=Ql.ENABLE,a=null,i=!1,l=!1){let o=kn.DISPLAY,c=HE;switch(t){case"any":o=kn.ANY;break;case"display":break;case"print":o=kn.PRINT;break;default:it(`getRenderingIntent - invalid intent: ${t}`)}const f=o&kn.PRINT&&a instanceof fk?a:this.annotationStorage;switch(e){case Ql.DISABLE:o+=kn.ANNOTATIONS_DISABLE;break;case Ql.ENABLE:break;case Ql.ENABLE_FORMS:o+=kn.ANNOTATIONS_FORMS;break;case Ql.ENABLE_STORAGE:o+=kn.ANNOTATIONS_STORAGE,c=f.serializable;break;default:it(`getRenderingIntent - invalid annotationMode: ${e}`)}i&&(o+=kn.IS_EDITING),l&&(o+=kn.OPLIST);const{ids:d,hash:g}=f.modifiedIds,m=[o,c.hash,g];return{renderingIntent:o,cacheKey:m.join("_"),annotationStorageSerializable:c,modifiedIds:d}}destroy(){var a;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(a=p(this,rl))==null||a.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of p(this,os).values())t.push(i._destroy());p(this,os).clear(),p(this,dh).clear(),p(this,ph).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var i,l;this.commonObjs.clear(),this.fontLoader.clear(),p(this,tl).clear(),this.filterFactory.destroy(),Rd.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Io("Worker was terminated.")),(l=this.messageHandler)==null||l.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(a,i)=>{Rr(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=l=>{this._lastProgress={loaded:l.loaded,total:l.total}},i.onPull=()=>{this._fullReader.read().then(function({value:l,done:o}){if(o){i.close();return}Rr(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{i.error(l)})},i.onCancel=l=>{this._fullReader.cancel(l),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async a=>{var c;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:l,contentLength:o}=this._fullReader;return(!i||!l)&&(this._lastProgress&&((c=e.onProgress)==null||c.call(e,this._lastProgress)),this._fullReader.onProgress=f=>{var d;(d=e.onProgress)==null||d.call(e,{loaded:f.loaded,total:f.total})}),{isStreamingSupported:i,isRangeSupported:l,contentLength:o}}),t.on("GetRangeReader",(a,i)=>{Rr(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const l=this._networkStream.getRangeReader(a.begin,a.end);if(!l){i.close();return}i.onPull=()=>{l.read().then(function({value:o,done:c}){if(c){i.close();return}Rr(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{l.cancel(o),i.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("GetDoc",({pdfInfo:a})=>{this._numPages=a.numPages,this._htmlForXfa=a.htmlForXfa,delete a.htmlForXfa,e._capability.resolve(new GI(a,this))}),t.on("DocException",a=>{e._capability.reject(tn(a))}),t.on("PasswordRequest",a=>{w(this,rl,Promise.withResolvers());try{if(!e.onPassword)throw tn(a);const i=l=>{l instanceof Error?p(this,rl).reject(l):p(this,rl).resolve({password:l})};e.onPassword(i,a.code)}catch(i){p(this,rl).reject(i)}return p(this,rl).promise}),t.on("DataLoaded",a=>{var i;(i=e.onProgress)==null||i.call(e,{loaded:a.length,total:a.length}),this.downloadInfoCapability.resolve(a)}),t.on("StartRenderPage",a=>{if(this.destroyed)return;p(this,os).get(a.pageIndex)._startRenderPage(a.transparency,a.cacheKey)}),t.on("commonobj",([a,i,l])=>{var o;if(this.destroyed||this.commonObjs.has(a))return null;switch(i){case"Font":const{disableFontFace:c,fontExtraProperties:f,pdfBug:d}=this._params;if("error"in l){const _=l.error;it(`Error during font loading: ${_}`),this.commonObjs.resolve(a,_);break}const g=d&&((o=globalThis.FontInspector)!=null&&o.enabled)?(_,A)=>globalThis.FontInspector.fontAdded(_,A):null,m=new YM(l,{disableFontFace:c,fontExtraProperties:f,inspectFont:g});this.fontLoader.bind(m).catch(()=>t.sendWithPromise("FontFallback",{id:a})).finally(()=>{!f&&m.data&&(m.data=null),this.commonObjs.resolve(a,m)});break;case"CopyLocalImage":const{imageRef:v}=l;Rr(v,"The imageRef must be defined.");for(const _ of p(this,os).values())for(const[,A]of _.objs)if((A==null?void 0:A.ref)===v)return A.dataLen?(this.commonObjs.resolve(a,structuredClone(A)),A.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(a,l);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),t.on("obj",([a,i,l,o])=>{var f;if(this.destroyed)return;const c=p(this,os).get(i);if(!c.objs.has(a)){if(c._intentStates.size===0){(f=o==null?void 0:o.bitmap)==null||f.close();return}switch(l){case"Image":c.objs.resolve(a,o),(o==null?void 0:o.dataLen)>EM&&(c._maybeCleanupAfterRender=!0);break;case"Pattern":c.objs.resolve(a,o);break;default:throw new Error(`Got unknown object type ${l}`)}}}),t.on("DocProgress",a=>{var i;this.destroyed||(i=e.onProgress)==null||i.call(e,{loaded:a.loaded,total:a.total})}),t.on("FetchBuiltInCMap",async a=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(a)}),t.on("FetchStandardFontData",async a=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(a)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var a;this.annotationStorage.size<=0&&it("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((a=this._fullReader)==null?void 0:a.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,a=p(this,dh).get(e);if(a)return a;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&p(this,ph).set(l.refStr,t);const o=new VI(e,l,this,this._params.pdfBug);return p(this,os).set(e,o),o});return p(this,dh).set(e,i),i}getPageIndex(t){return nC(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return D(this,qc,nd).call(this,"GetFieldObjects")}hasJSActions(){return D(this,qc,nd).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return D(this,qc,nd).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return D(this,qc,nd).call(this,"GetOptionalContentConfig").then(e=>new dI(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=p(this,tl).get(t);if(e)return e;const a=this.messageHandler.sendWithPromise(t,null).then(i=>{var l,o;return{info:i[0],metadata:i[1]?new fI(i[1]):null,contentDispositionFilename:((l=this._fullReader)==null?void 0:l.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return p(this,tl).set(t,a),a}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of p(this,os).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),p(this,tl).clear(),this.filterFactory.destroy(!0),Rd.cleanup()}}cachedPageNumber(t){if(!nC(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return p(this,ph).get(e)??null}}tl=new WeakMap,os=new WeakMap,dh=new WeakMap,ph=new WeakMap,rl=new WeakMap,qc=new WeakSet,nd=function(t,e=null){const a=p(this,tl).get(t);if(a)return a;const i=this.messageHandler.sendWithPromise(t,e);return p(this,tl).set(t,i),i};const X0=Symbol("INITIAL_DATA");var En,Rp,ZE;class Ik{constructor(){O(this,Rp);O(this,En,Object.create(null))}get(t,e=null){if(e){const i=D(this,Rp,ZE).call(this,t);return i.promise.then(()=>e(i.data)),null}const a=p(this,En)[t];if(!a||a.data===X0)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return a.data}has(t){const e=p(this,En)[t];return!!e&&e.data!==X0}delete(t){const e=p(this,En)[t];return!e||e.data===X0?!1:(delete p(this,En)[t],!0)}resolve(t,e=null){const a=D(this,Rp,ZE).call(this,t);a.data=e,a.resolve()}clear(){var t;for(const e in p(this,En)){const{data:a}=p(this,En)[e];(t=a==null?void 0:a.bitmap)==null||t.close()}w(this,En,Object.create(null))}*[Symbol.iterator](){for(const t in p(this,En)){const{data:e}=p(this,En)[t];e!==X0&&(yield[t,e])}}}En=new WeakMap,Rp=new WeakSet,ZE=function(t){var e;return(e=p(this,En))[t]||(e[t]={...Promise.withResolvers(),data:X0})};var xo;class XI{constructor(t){O(this,xo,null);w(this,xo,t),this.onContinue=null}get promise(){return p(this,xo).capability.promise}cancel(t=0){p(this,xo).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=p(this,xo).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=p(this,xo);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}xo=new WeakMap;var vo,Wc;const pc=class pc{constructor({callback:t,params:e,objs:a,commonObjs:i,annotationCanvasMap:l,operatorList:o,pageIndex:c,canvasFactory:f,filterFactory:d,useRequestAnimationFrame:g=!1,pdfBug:m=!1,pageColors:v=null}){O(this,vo,null);this.callback=t,this.params=e,this.objs=a,this.commonObjs=i,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=c,this.canvasFactory=f,this.filterFactory=d,this._pdfBug=m,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new XI(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var c,f;if(this.cancelled)return;if(this._canvas){if(p(pc,Wc).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");p(pc,Wc).add(this._canvas)}this._pdfBug&&((c=globalThis.StepperManager)!=null&&c.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:a,viewport:i,transform:l,background:o}=this.params;this.gfx=new Ff(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:l,viewport:i,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(f=this.graphicsReadyCallback)==null||f.call(this)}cancel(t=null,e=0){var a;this.running=!1,this.cancelled=!0,(a=this.gfx)==null||a.endDrawing(),p(this,vo)&&(window.cancelAnimationFrame(p(this,vo)),w(this,vo,null)),p(pc,Wc).delete(this._canvas),this.callback(t||new WA(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?w(this,vo,window.requestAnimationFrame(()=>{w(this,vo,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),p(pc,Wc).delete(this._canvas),this.callback())))}};vo=new WeakMap,Wc=new WeakMap,O(pc,Wc,new WeakSet);let JE=pc;const qI="4.10.38",WI="f9bea397f";function iC(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function q0(r){return Math.max(0,Math.min(255,255*r))}class sC{static CMYK_G([t,e,a,i]){return["G",1-Math.min(1,.3*t+.59*a+.11*e+i)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=q0(t),[t,t,t]}static G_HTML([t]){const e=iC(t);return`#${e}${e}${e}`}static RGB_G([t,e,a]){return["G",.3*t+.59*e+.11*a]}static RGB_rgb(t){return t.map(q0)}static RGB_HTML(t){return`#${t.map(iC).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,a,i]){return["RGB",1-Math.min(1,t+i),1-Math.min(1,a+i),1-Math.min(1,e+i)]}static CMYK_rgb([t,e,a,i]){return[q0(1-Math.min(1,t+i)),q0(1-Math.min(1,a+i)),q0(1-Math.min(1,e+i))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,a]){const i=1-t,l=1-e,o=1-a,c=Math.min(i,l,o);return["CMYK",i,l,o,c]}}class KI{create(t,e,a=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),a||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${e}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${e}`),i}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Ut("Abstract method `_createSVG` called.")}}class ey extends KI{_createSVG(t){return document.createElementNS(Bs,t)}}class Fk{static setupStorage(t,e,a,i,l){const o=i.getValue(e,{value:null});switch(a.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),l==="print")break;t.addEventListener("input",c=>{i.setValue(e,{value:c.target.value})});break;case"input":if(a.attributes.type==="radio"||a.attributes.type==="checkbox"){if(o.value===a.attributes.xfaOn?t.setAttribute("checked",!0):o.value===a.attributes.xfaOff&&t.removeAttribute("checked"),l==="print")break;t.addEventListener("change",c=>{i.setValue(e,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),l==="print")break;t.addEventListener("input",c=>{i.setValue(e,{value:c.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const c of a.children)c.attributes.value===o.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}t.addEventListener("input",c=>{const f=c.target.options,d=f.selectedIndex===-1?"":f[f.selectedIndex].value;i.setValue(e,{value:d})});break}}static setAttributes({html:t,element:e,storage:a=null,intent:i,linkService:l}){const{attributes:o}=e,c=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[f,d]of Object.entries(o))if(d!=null)switch(f){case"class":d.length&&t.setAttribute(f,d.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",d);break;case"style":Object.assign(t.style,d);break;case"textContent":t.textContent=d;break;default:(!c||f!=="href"&&f!=="newWindow")&&t.setAttribute(f,d)}c&&l.addLinkAttributes(t,o.href,o.newWindow),a&&o.dataId&&this.setupStorage(t,o.dataId,e,a)}static render(t){var m,v;const e=t.annotationStorage,a=t.linkService,i=t.xfaHtml,l=t.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:l,linkService:a});const c=l!=="richText",f=t.div;if(f.append(o),t.viewport){const _=`matrix(${t.viewport.transform.join(",")})`;f.style.transform=_}c&&f.setAttribute("class","xfaLayer xfaFont");const d=[];if(i.children.length===0){if(i.value){const _=document.createTextNode(i.value);o.append(_),c&&kd.shouldBuildText(i.name)&&d.push(_)}return{textDivs:d}}const g=[[i,-1,o]];for(;g.length>0;){const[_,A,y]=g.at(-1);if(A+1===_.children.length){g.pop();continue}const T=_.children[++g.at(-1)[1]];if(T===null)continue;const{name:S}=T;if(S==="#text"){const C=document.createTextNode(T.value);d.push(C),y.append(C);continue}const R=(m=T==null?void 0:T.attributes)!=null&&m.xmlns?document.createElementNS(T.attributes.xmlns,S):document.createElement(S);if(y.append(R),T.attributes&&this.setAttributes({html:R,element:T,storage:e,intent:l,linkService:a}),((v=T.children)==null?void 0:v.length)>0)g.push([T,-1,R]);else if(T.value){const C=document.createTextNode(T.value);c&&kd.shouldBuildText(S)&&d.push(C),R.append(C)}}for(const _ of f.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))_.setAttribute("readOnly",!0);return{textDivs:d}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const hg=1e3,$I=9,Su=new WeakSet;function No(r){return{width:r[2]-r[0],height:r[3]-r[1]}}class QI{static create(t){switch(t.data.annotationType){case Dr.LINK:return new Lk(t);case Dr.TEXT:return new ZI(t);case Dr.WIDGET:switch(t.data.fieldType){case"Tx":return new JI(t);case"Btn":return t.data.radioButton?new Uk(t):t.data.checkBox?new tF(t):new rF(t);case"Ch":return new aF(t);case"Sig":return new eF(t)}return new ku(t);case Dr.POPUP:return new tA(t);case Dr.FREETEXT:return new jk(t);case Dr.LINE:return new iF(t);case Dr.SQUARE:return new sF(t);case Dr.CIRCLE:return new lF(t);case Dr.POLYLINE:return new Yk(t);case Dr.CARET:return new cF(t);case Dr.INK:return new ty(t);case Dr.POLYGON:return new oF(t);case Dr.HIGHLIGHT:return new Xk(t);case Dr.UNDERLINE:return new uF(t);case Dr.SQUIGGLY:return new fF(t);case Dr.STRIKEOUT:return new hF(t);case Dr.STAMP:return new qk(t);case Dr.FILEATTACHMENT:return new dF(t);default:return new vr(t)}}}var Kc,gh,mh,kp,eA;const Ny=class Ny{constructor(t,{isRenderable:e=!1,ignoreBorder:a=!1,createQuadrilaterals:i=!1}={}){O(this,kp);O(this,Kc,null);O(this,gh,!1);O(this,mh,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(a)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:a}){return!!(t!=null&&t.str||e!=null&&e.str||a!=null&&a.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ny._hasPopupData(this.data)}updateEdited(t){var a;if(!this.container)return;p(this,Kc)||w(this,Kc,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&D(this,kp,eA).call(this,e),(a=p(this,mh))==null||a.popup.updateEdited(t)}resetEdited(){var t;p(this,Kc)&&(D(this,kp,eA).call(this,p(this,Kc).rect),(t=p(this,mh))==null||t.popup.resetEdited(),w(this,Kc,null))}_createContainer(t){const{data:e,parent:{page:a,viewport:i}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",e.id),this instanceof ku||(l.tabIndex=hg);const{style:o}=l;if(o.zIndex=this.parent.zIndex++,e.alternativeText&&(l.title=e.alternativeText),e.noRotate&&l.classList.add("norotate"),!e.rect||this instanceof tA){const{rotation:y}=e;return!e.hasOwnCanvas&&y!==0&&this.setRotation(y,l),l}const{width:c,height:f}=No(e.rect);if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const y=e.borderStyle.horizontalCornerRadius,T=e.borderStyle.verticalCornerRadius;if(y>0||T>0){const R=`calc(${y}px * var(--scale-factor)) / calc(${T}px * var(--scale-factor))`;o.borderRadius=R}else if(this instanceof Uk){const R=`calc(${c}px * var(--scale-factor)) / calc(${f}px * var(--scale-factor))`;o.borderRadius=R}switch(e.borderStyle.style){case j0.SOLID:o.borderStyle="solid";break;case j0.DASHED:o.borderStyle="dashed";break;case j0.BEVELED:it("Unimplemented border style: beveled");break;case j0.INSET:it("Unimplemented border style: inset");break;case j0.UNDERLINE:o.borderBottomStyle="solid";break}const S=e.borderColor||null;S?(w(this,gh,!0),o.borderColor=Ve.makeHexColor(S[0]|0,S[1]|0,S[2]|0)):o.borderWidth=0}const d=Ve.normalizeRect([e.rect[0],a.view[3]-e.rect[1]+a.view[1],e.rect[2],a.view[3]-e.rect[3]+a.view[1]]),{pageWidth:g,pageHeight:m,pageX:v,pageY:_}=i.rawDims;o.left=`${100*(d[0]-v)/g}%`,o.top=`${100*(d[1]-_)/m}%`;const{rotation:A}=e;return e.hasOwnCanvas||A===0?(o.width=`${100*c/g}%`,o.height=`${100*f/m}%`):this.setRotation(A,l),l}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:a,pageHeight:i}=this.parent.viewport.rawDims,{width:l,height:o}=No(this.data.rect);let c,f;t%180===0?(c=100*l/a,f=100*o/i):(c=100*o/a,f=100*l/i),e.style.width=`${c}%`,e.style.height=`${f}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,a,i)=>{const l=i.detail[e],o=l[0],c=l.slice(1);i.target.style[a]=sC[`${o}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[a]:sC[`${o}_rgb`](c)})};return ut(this,"_commonActions",{display:e=>{const{display:a}=e.detail,i=a%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:a===1||a===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:a}=e.detail;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:a,noView:a})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const a=e.detail.rotation;this.setRotation(a),this.annotationStorage.setValue(this.data.id,{rotation:a})}})}_dispatchEventFromSandbox(t,e){const a=this._commonActions;for(const i of Object.keys(e.detail)){const l=t[i]||a[i];l==null||l(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const a=this._commonActions;for(const[i,l]of Object.entries(e)){const o=a[i];if(o){const c={detail:{[i]:l},target:t};o(c),delete e[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,a,i,l]=this.data.rect.map(y=>Math.fround(y));if(t.length===8){const[y,T,S,R]=t.subarray(2,6);if(i===y&&l===T&&e===S&&a===R)return}const{style:o}=this.container;let c;if(p(this,gh)){const{borderColor:y,borderWidth:T}=o;o.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${y}" stroke-width="${T}">`],this.container.classList.add("hasBorder")}const f=i-e,d=l-a,{svgFactory:g}=this,m=g.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0);const v=g.createElement("defs");m.append(v);const _=g.createElement("clipPath"),A=`clippath_${this.data.id}`;_.setAttribute("id",A),_.setAttribute("clipPathUnits","objectBoundingBox"),v.append(_);for(let y=2,T=t.length;y<T;y+=8){const S=t[y],R=t[y+1],C=t[y+2],F=t[y+3],U=g.createElement("rect"),B=(C-e)/f,k=(l-R)/d,J=(S-C)/f,j=(R-F)/d;U.setAttribute("x",B),U.setAttribute("y",k),U.setAttribute("width",J),U.setAttribute("height",j),_.append(U),c==null||c.push(`<rect vector-effect="non-scaling-stroke" x="${B}" y="${k}" width="${J}" height="${j}"/>`)}p(this,gh)&&(c.push("</g></svg>')"),o.backgroundImage=c.join("")),this.container.append(m),this.container.style.clipPath=`url(#${A})`}_createPopup(){const{data:t}=this,e=w(this,mh,new tA({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){Ut("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const a=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:l,id:o,exportValues:c}of i){if(l===-1||o===e)continue;const f=typeof c=="string"?c:null,d=document.querySelector(`[data-element-id="${o}"]`);if(d&&!Su.has(d)){it(`_getElementsByName - element not allowed: ${o}`);continue}a.push({id:o,exportValue:f,domElement:d})}return a}for(const i of document.getElementsByName(t)){const{exportValue:l}=i,o=i.getAttribute("data-element-id");o!==e&&Su.has(i)&&a.push({id:o,exportValue:l,domElement:i})}return a}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}};Kc=new WeakMap,gh=new WeakMap,mh=new WeakMap,kp=new WeakSet,eA=function(t){const{container:{style:e},data:{rect:a,rotation:i},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:o,pageX:c,pageY:f}}}}=this;a==null||a.splice(0,4,...t);const{width:d,height:g}=No(t);e.left=`${100*(t[0]-c)/l}%`,e.top=`${100*(o-t[3]+f)/o}%`,i===0?(e.width=`${100*d/l}%`,e.height=`${100*g/o}%`):this.setRotation(i)};let vr=Ny;var Dn,cc,Pk,Bk;class Lk extends vr{constructor(e,a=null){super(e,{isRenderable:!0,ignoreBorder:!!(a!=null&&a.ignoreBorder),createQuadrilaterals:!0});O(this,Dn);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:a}=this,i=document.createElement("a");i.setAttribute("data-element-id",e.id);let l=!1;return e.url?(a.addLinkAttributes(i,e.url,e.newWindow),l=!0):e.action?(this._bindNamedAction(i,e.action),l=!0):e.attachment?(D(this,Dn,Pk).call(this,i,e.attachment,e.attachmentDest),l=!0):e.setOCGState?(D(this,Dn,Bk).call(this,i,e.setOCGState),l=!0):e.dest?(this._bindLink(i,e.dest),l=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,e),l=!0),e.resetForm?(this._bindResetFormAction(i,e.resetForm),l=!0):this.isTooltipOnly&&!l&&(this._bindLink(i,""),l=!0)),this.container.classList.add("linkAnnotation"),l&&this.container.append(i),this.container}_bindLink(e,a){e.href=this.linkService.getDestinationHash(a),e.onclick=()=>(a&&this.linkService.goToDestination(a),!1),(a||a==="")&&D(this,Dn,cc).call(this)}_bindNamedAction(e,a){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(a),!1),D(this,Dn,cc).call(this)}_bindJSAction(e,a){e.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const l of Object.keys(a.actions)){const o=i.get(l);o&&(e[o]=()=>{var c;return(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a.id,name:l}}),!1})}e.onclick||(e.onclick=()=>!1),D(this,Dn,cc).call(this)}_bindResetFormAction(e,a){const i=e.onclick;if(i||(e.href=this.linkService.getAnchorUrl("")),D(this,Dn,cc).call(this),!this._fieldObjects){it('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(e.onclick=()=>!1);return}e.onclick=()=>{var m;i==null||i();const{fields:l,refs:o,include:c}=a,f=[];if(l.length!==0||o.length!==0){const v=new Set(o);for(const _ of l){const A=this._fieldObjects[_]||[];for(const{id:y}of A)v.add(y)}for(const _ of Object.values(this._fieldObjects))for(const A of _)v.has(A.id)===c&&f.push(A)}else for(const v of Object.values(this._fieldObjects))f.push(...v);const d=this.annotationStorage,g=[];for(const v of f){const{id:_}=v;switch(g.push(_),v.type){case"text":{const y=v.defaultValue||"";d.setValue(_,{value:y});break}case"checkbox":case"radiobutton":{const y=v.defaultValue===v.exportValues;d.setValue(_,{value:y});break}case"combobox":case"listbox":{const y=v.defaultValue||"";d.setValue(_,{value:y});break}default:continue}const A=document.querySelector(`[data-element-id="${_}"]`);if(A){if(!Su.has(A)){it(`_bindResetFormAction - element not allowed: ${_}`);continue}}else continue;A.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:g,name:"ResetForm"}})),!1}}}Dn=new WeakSet,cc=function(){this.container.setAttribute("data-internal-link","")},Pk=function(e,a,i=null){e.href=this.linkService.getAnchorUrl(""),a.description&&(e.title=a.description),e.onclick=()=>{var l;return(l=this.downloadManager)==null||l.openOrDownloadData(a.content,a.filename,i),!1},D(this,Dn,cc).call(this)},Bk=function(e,a){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(a),!1),D(this,Dn,cc).call(this)};class ZI extends vr{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class ku extends vr{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Ua.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,a,i,l){a.includes("mouse")?t.addEventListener(a,o=>{var c;(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:l(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(a,o=>{var c;if(a==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(a==="focus"){if(e.focused)return;e.focused=!0}l&&((c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:l(o)}}))})}_setEventListeners(t,e,a,i){var l,o,c;for(const[f,d]of a)(d==="Action"||(l=this.data.actions)!=null&&l[d])&&((d==="Focus"||d==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,f,d,i),d==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(t,e,"blur","Blur",null):d==="Blur"&&!((c=this.data.actions)!=null&&c.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Ve.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:a}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||$I,l=t.style;let o;const c=2,f=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c),g=Math.round(d/($_*i))||1,m=d/g;o=Math.min(i,f(m/$_))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c);o=Math.min(i,f(d/$_))}l.fontSize=`calc(${o}px * var(--scale-factor))`,l.color=Ve.makeHexColor(a[0],a[1],a[2]),this.data.textAlignment!==null&&(l.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class JI extends ku{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,a,i){const l=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=a),l.setValue(o.id,{[i]:a})}render(){var i,l;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let a=null;if(this.renderForms){const o=t.getValue(e,{value:this.data.fieldValue});let c=o.value||"";const f=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;f&&c.length>f&&(c=c.slice(0,f));let d=o.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;d&&this.data.comb&&(d=d.replaceAll(/\s+/g,""));const g={userValue:c,formattedValue:d,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(a=document.createElement("textarea"),a.textContent=d??c,this.data.doNotScroll&&(a.style.overflowY="hidden")):(a=document.createElement("input"),a.type="text",a.setAttribute("value",d??c),this.data.doNotScroll&&(a.style.overflowX="hidden")),this.data.hasOwnCanvas&&(a.hidden=!0),Su.add(a),a.setAttribute("data-element-id",e),a.disabled=this.data.readOnly,a.name=this.data.fieldName,a.tabIndex=hg,this._setRequired(a,this.data.required),f&&(a.maxLength=f),a.addEventListener("input",v=>{t.setValue(e,{value:v.target.value}),this.setPropertyOnSiblings(a,"value",v.target.value,"value"),g.formattedValue=null}),a.addEventListener("resetform",v=>{const _=this.data.defaultFieldValue??"";a.value=g.userValue=_,g.formattedValue=null});let m=v=>{const{formattedValue:_}=g;_!=null&&(v.target.value=_),v.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){a.addEventListener("focus",_=>{var y;if(g.focused)return;const{target:A}=_;g.userValue&&(A.value=g.userValue),g.lastCommittedValue=A.value,g.commitKey=1,(y=this.data.actions)!=null&&y.Focus||(g.focused=!0)}),a.addEventListener("updatefromsandbox",_=>{this.showElementAndHideCanvas(_.target);const A={value(y){g.userValue=y.detail.value??"",t.setValue(e,{value:g.userValue.toString()}),y.target.value=g.userValue},formattedValue(y){const{formattedValue:T}=y.detail;g.formattedValue=T,T!=null&&y.target!==document.activeElement&&(y.target.value=T),t.setValue(e,{formattedValue:T})},selRange(y){y.target.setSelectionRange(...y.detail.selRange)},charLimit:y=>{var C;const{charLimit:T}=y.detail,{target:S}=y;if(T===0){S.removeAttribute("maxLength");return}S.setAttribute("maxLength",T);let R=g.userValue;!R||R.length<=T||(R=R.slice(0,T),S.value=g.userValue=R,t.setValue(e,{value:R}),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:R,willCommit:!0,commitKey:1,selStart:S.selectionStart,selEnd:S.selectionEnd}}))}};this._dispatchEventFromSandbox(A,_)}),a.addEventListener("keydown",_=>{var T;g.commitKey=1;let A=-1;if(_.key==="Escape"?A=0:_.key==="Enter"&&!this.data.multiLine?A=2:_.key==="Tab"&&(g.commitKey=3),A===-1)return;const{value:y}=_.target;g.lastCommittedValue!==y&&(g.lastCommittedValue=y,g.userValue=y,(T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:y,willCommit:!0,commitKey:A,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}))});const v=m;m=null,a.addEventListener("blur",_=>{var y,T;if(!g.focused||!_.relatedTarget)return;(y=this.data.actions)!=null&&y.Blur||(g.focused=!1);const{value:A}=_.target;g.userValue=A,g.lastCommittedValue!==A&&((T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:A,willCommit:!0,commitKey:g.commitKey,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}})),v(_)}),(l=this.data.actions)!=null&&l.Keystroke&&a.addEventListener("beforeinput",_=>{var U;g.lastCommittedValue=null;const{data:A,target:y}=_,{value:T,selectionStart:S,selectionEnd:R}=y;let C=S,F=R;switch(_.inputType){case"deleteWordBackward":{const B=T.substring(0,S).match(/\w*[^\w]*$/);B&&(C-=B[0].length);break}case"deleteWordForward":{const B=T.substring(S).match(/^[^\w]*\w*/);B&&(F+=B[0].length);break}case"deleteContentBackward":S===R&&(C-=1);break;case"deleteContentForward":S===R&&(F+=1);break}_.preventDefault(),(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:T,change:A||"",willCommit:!1,selStart:C,selEnd:F}})}),this._setEventListeners(a,g,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_=>_.target.value)}if(m&&a.addEventListener("blur",m),this.data.comb){const _=(this.data.rect[2]-this.data.rect[0])/f;a.classList.add("comb"),a.style.letterSpacing=`calc(${_}px * var(--scale-factor) - 1ch)`}}else a=document.createElement("div"),a.textContent=this.data.fieldValue,a.style.verticalAlign="middle",a.style.display="table-cell",this.data.hasOwnCanvas&&(a.hidden=!0);return this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class eF extends ku{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class tF extends ku{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,a=e.id;let i=t.getValue(a,{value:e.exportValue===e.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",t.setValue(a,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return Su.add(l),l.setAttribute("data-element-id",a),l.disabled=e.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=e.fieldName,i&&l.setAttribute("checked",!0),l.setAttribute("exportValue",e.exportValue),l.tabIndex=hg,l.addEventListener("change",o=>{const{name:c,checked:f}=o.target;for(const d of this._getElementsByName(c,a)){const g=f&&d.exportValue===e.exportValue;d.domElement&&(d.domElement.checked=g),t.setValue(d.id,{value:g})}t.setValue(a,{value:f})}),l.addEventListener("resetform",o=>{const c=e.defaultFieldValue||"Off";o.target.checked=c===e.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",o=>{const c={value(f){f.target.checked=f.detail.value!=="Off",t.setValue(a,{value:f.target.checked})}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class Uk extends ku{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,a=e.id;let i=t.getValue(a,{value:e.fieldValue===e.buttonValue}).value;if(typeof i=="string"&&(i=i!==e.buttonValue,t.setValue(a,{value:i})),i)for(const o of this._getElementsByName(e.fieldName,a))t.setValue(o.id,{value:!1});const l=document.createElement("input");if(Su.add(l),l.setAttribute("data-element-id",a),l.disabled=e.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=e.fieldName,i&&l.setAttribute("checked",!0),l.tabIndex=hg,l.addEventListener("change",o=>{const{name:c,checked:f}=o.target;for(const d of this._getElementsByName(c,a))t.setValue(d.id,{value:!1});t.setValue(a,{value:f})}),l.addEventListener("resetform",o=>{const c=e.defaultFieldValue;o.target.checked=c!=null&&c===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;l.addEventListener("updatefromsandbox",c=>{const f={value:d=>{const g=o===d.detail.value;for(const m of this._getElementsByName(d.target.name)){const v=g&&m.id===a;m.domElement&&(m.domElement.checked=v),t.setValue(m.id,{value:v})}}};this._dispatchEventFromSandbox(f,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class rF extends Lk{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",a=>{this._dispatchEventFromSandbox({},a)})),t}}class aF extends ku{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,a=t.getValue(e,{value:this.data.fieldValue}),i=document.createElement("select");Su.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=hg;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",g=>{const m=this.data.defaultFieldValue;for(const v of i.options)v.selected=v.value===m});for(const g of this.data.options){const m=document.createElement("option");m.textContent=g.displayValue,m.value=g.exportValue,a.value.includes(g.exportValue)&&(m.setAttribute("selected",!0),l=!1),i.append(m)}let o=null;if(l){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),i.prepend(g),o=()=>{g.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const c=g=>{const m=g?"value":"textContent",{options:v,multiple:_}=i;return _?Array.prototype.filter.call(v,A=>A.selected).map(A=>A[m]):v.selectedIndex===-1?null:v[v.selectedIndex][m]};let f=c(!1);const d=g=>{const m=g.target.options;return Array.prototype.map.call(m,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",g=>{const m={value(v){o==null||o();const _=v.detail.value,A=new Set(Array.isArray(_)?_:[_]);for(const y of i.options)y.selected=A.has(y.value);t.setValue(e,{value:c(!0)}),f=c(!1)},multipleSelection(v){i.multiple=!0},remove(v){const _=i.options,A=v.detail.remove;_[A].selected=!1,i.remove(A),_.length>0&&Array.prototype.findIndex.call(_,T=>T.selected)===-1&&(_[0].selected=!0),t.setValue(e,{value:c(!0),items:d(v)}),f=c(!1)},clear(v){for(;i.length!==0;)i.remove(0);t.setValue(e,{value:null,items:[]}),f=c(!1)},insert(v){const{index:_,displayValue:A,exportValue:y}=v.detail.insert,T=i.children[_],S=document.createElement("option");S.textContent=A,S.value=y,T?T.before(S):i.append(S),t.setValue(e,{value:c(!0),items:d(v)}),f=c(!1)},items(v){const{items:_}=v.detail;for(;i.length!==0;)i.remove(0);for(const A of _){const{displayValue:y,exportValue:T}=A,S=document.createElement("option");S.textContent=y,S.value=T,i.append(S)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(e,{value:c(!0),items:d(v)}),f=c(!1)},indices(v){const _=new Set(v.detail.indices);for(const A of v.target.options)A.selected=_.has(A.index);t.setValue(e,{value:c(!0)}),f=c(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(m,g)}),i.addEventListener("input",g=>{var _;const m=c(!0),v=c(!1);t.setValue(e,{value:m}),g.preventDefault(),(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:f,change:v,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):i.addEventListener("input",function(g){t.setValue(e,{value:c(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class tA extends vr{constructor(t){const{data:e,elements:a}=t;super(t,{isRenderable:vr._hasPopupData(e)}),this.elements=a,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new nF({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const a of this.elements)a.popup=t,a.container.ariaHasPopup="dialog",e.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(a=>`${qA}${a}`).join(",")),this.container}}var xh,cx,ux,vh,$c,cr,al,_h,Op,Dp,Eh,nl,wi,il,Np,sl,Mp,Qc,Zc,Lt,gm,rA,Hk,zk,Gk,Vk,mm,xm,aA;class nF{constructor({container:t,color:e,elements:a,titleObj:i,modificationDate:l,contentsObj:o,richText:c,parent:f,rect:d,parentRect:g,open:m}){O(this,Lt);O(this,xh,D(this,Lt,Gk).bind(this));O(this,cx,D(this,Lt,aA).bind(this));O(this,ux,D(this,Lt,xm).bind(this));O(this,vh,D(this,Lt,mm).bind(this));O(this,$c,null);O(this,cr,null);O(this,al,null);O(this,_h,null);O(this,Op,null);O(this,Dp,null);O(this,Eh,null);O(this,nl,!1);O(this,wi,null);O(this,il,null);O(this,Np,null);O(this,sl,null);O(this,Mp,null);O(this,Qc,null);O(this,Zc,!1);var v;w(this,cr,t),w(this,Mp,i),w(this,al,o),w(this,sl,c),w(this,Dp,f),w(this,$c,e),w(this,Np,d),w(this,Eh,g),w(this,Op,a),w(this,_h,$A.toDateObject(l)),this.trigger=a.flatMap(_=>_.getElementsToTriggerPopup());for(const _ of this.trigger)_.addEventListener("click",p(this,vh)),_.addEventListener("mouseenter",p(this,ux)),_.addEventListener("mouseleave",p(this,cx)),_.classList.add("popupTriggerArea");for(const _ of a)(v=_.container)==null||v.addEventListener("keydown",p(this,xh));p(this,cr).hidden=!0,m&&D(this,Lt,mm).call(this)}render(){if(p(this,wi))return;const t=w(this,wi,document.createElement("div"));if(t.className="popup",p(this,$c)){const l=t.style.outlineColor=Ve.makeHexColor(...p(this,$c));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${l} 30%, white)`:t.style.backgroundColor=Ve.makeHexColor(...p(this,$c).map(c=>Math.floor(.7*(255-c)+c)))}const e=document.createElement("span");e.className="header";const a=document.createElement("h1");if(e.append(a),{dir:a.dir,str:a.textContent}=p(this,Mp),t.append(e),p(this,_h)){const l=document.createElement("span");l.classList.add("popupDate"),l.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),l.setAttribute("data-l10n-args",JSON.stringify({dateObj:p(this,_h).valueOf()})),e.append(l)}const i=p(this,Lt,gm);if(i)Fk.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const l=this._formatContents(p(this,al));t.append(l)}p(this,cr).append(t)}_formatContents({str:t,dir:e}){const a=document.createElement("p");a.classList.add("popupContent"),a.dir=e;const i=t.split(/(?:\r\n?|\n)/);for(let l=0,o=i.length;l<o;++l){const c=i[l];a.append(document.createTextNode(c)),l<o-1&&a.append(document.createElement("br"))}return a}updateEdited({rect:t,popupContent:e}){var a;p(this,Qc)||w(this,Qc,{contentsObj:p(this,al),richText:p(this,sl)}),t&&w(this,il,null),e&&(w(this,sl,D(this,Lt,zk).call(this,e)),w(this,al,null)),(a=p(this,wi))==null||a.remove(),w(this,wi,null)}resetEdited(){var t;p(this,Qc)&&({contentsObj:ka(this,al)._,richText:ka(this,sl)._}=p(this,Qc),w(this,Qc,null),(t=p(this,wi))==null||t.remove(),w(this,wi,null),w(this,il,null))}forceHide(){w(this,Zc,this.isVisible),p(this,Zc)&&(p(this,cr).hidden=!0)}maybeShow(){p(this,Zc)&&(p(this,wi)||D(this,Lt,xm).call(this),w(this,Zc,!1),p(this,cr).hidden=!1)}get isVisible(){return p(this,cr).hidden===!1}}xh=new WeakMap,cx=new WeakMap,ux=new WeakMap,vh=new WeakMap,$c=new WeakMap,cr=new WeakMap,al=new WeakMap,_h=new WeakMap,Op=new WeakMap,Dp=new WeakMap,Eh=new WeakMap,nl=new WeakMap,wi=new WeakMap,il=new WeakMap,Np=new WeakMap,sl=new WeakMap,Mp=new WeakMap,Qc=new WeakMap,Zc=new WeakMap,Lt=new WeakSet,gm=function(){const t=p(this,sl),e=p(this,al);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&p(this,sl).html||null},rA=function(){var t,e,a;return((a=(e=(t=p(this,Lt,gm))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:a.fontSize)||0},Hk=function(){var t,e,a;return((a=(e=(t=p(this,Lt,gm))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:a.color)||null},zk=function(t){const e=[],a={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},i={style:{color:p(this,Lt,Hk),fontSize:p(this,Lt,rA)?`calc(${p(this,Lt,rA)}px * var(--scale-factor))`:""}};for(const l of t.split(`
`))e.push({name:"span",value:l,attributes:i});return a},Gk=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&p(this,nl))&&D(this,Lt,mm).call(this)},Vk=function(){if(p(this,il)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:a,pageX:i,pageY:l}}}=p(this,Dp);let o=!!p(this,Eh),c=o?p(this,Eh):p(this,Np);for(const A of p(this,Op))if(!c||Ve.intersect(A.data.rect,c)!==null){c=A.data.rect,o=!0;break}const f=Ve.normalizeRect([c[0],t[3]-c[1]+t[1],c[2],t[3]-c[3]+t[1]]),g=o?c[2]-c[0]+5:0,m=f[0]+g,v=f[1];w(this,il,[100*(m-i)/e,100*(v-l)/a]);const{style:_}=p(this,cr);_.left=`${p(this,il)[0]}%`,_.top=`${p(this,il)[1]}%`},mm=function(){w(this,nl,!p(this,nl)),p(this,nl)?(D(this,Lt,xm).call(this),p(this,cr).addEventListener("click",p(this,vh)),p(this,cr).addEventListener("keydown",p(this,xh))):(D(this,Lt,aA).call(this),p(this,cr).removeEventListener("click",p(this,vh)),p(this,cr).removeEventListener("keydown",p(this,xh)))},xm=function(){p(this,wi)||this.render(),this.isVisible?p(this,nl)&&p(this,cr).classList.add("focused"):(D(this,Lt,Vk).call(this),p(this,cr).hidden=!1,p(this,cr).style.zIndex=parseInt(p(this,cr).style.zIndex)+1e3)},aA=function(){p(this,cr).classList.remove("focused"),!(p(this,nl)||!this.isVisible)&&(p(this,cr).hidden=!0,p(this,cr).style.zIndex=parseInt(p(this,cr).style.zIndex)-1e3)};class jk extends vr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=nt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const a=document.createElement("span");a.textContent=e,t.append(a)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Ip;class iF extends vr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});O(this,Ip,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:a,height:i}=No(e.rect),l=this.svgFactory.create(a,i,!0),o=w(this,Ip,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),l.append(o),this.container.append(l),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return p(this,Ip)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ip=new WeakMap;var Fp;class sF extends vr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});O(this,Fp,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:a,height:i}=No(e.rect),l=this.svgFactory.create(a,i,!0),o=e.borderStyle.width,c=w(this,Fp,this.svgFactory.createElement("svg:rect"));return c.setAttribute("x",o/2),c.setAttribute("y",o/2),c.setAttribute("width",a-o),c.setAttribute("height",i-o),c.setAttribute("stroke-width",o||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),l.append(c),this.container.append(l),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return p(this,Fp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Fp=new WeakMap;var Lp;class lF extends vr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});O(this,Lp,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:a,height:i}=No(e.rect),l=this.svgFactory.create(a,i,!0),o=e.borderStyle.width,c=w(this,Lp,this.svgFactory.createElement("svg:ellipse"));return c.setAttribute("cx",a/2),c.setAttribute("cy",i/2),c.setAttribute("rx",a/2-o/2),c.setAttribute("ry",i/2-o/2),c.setAttribute("stroke-width",o||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),l.append(c),this.container.append(l),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return p(this,Lp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Lp=new WeakMap;var Pp;class Yk extends vr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});O(this,Pp,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:a,borderStyle:i,popupRef:l}}=this;if(!a)return this.container;const{width:o,height:c}=No(e),f=this.svgFactory.create(o,c,!0);let d=[];for(let m=0,v=a.length;m<v;m+=2){const _=a[m]-e[0],A=e[3]-a[m+1];d.push(`${_},${A}`)}d=d.join(" ");const g=w(this,Pp,this.svgFactory.createElement(this.svgElementName));return g.setAttribute("points",d),g.setAttribute("stroke-width",i.width||1),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),f.append(g),this.container.append(f),!l&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return p(this,Pp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Pp=new WeakMap;class oF extends Yk{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class cF extends vr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Bp,Jc,Up,nA;class ty extends vr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});O(this,Up);O(this,Bp,null);O(this,Jc,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?nt.HIGHLIGHT:nt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:a,inkLists:i,borderStyle:l,popupRef:o}}=this,{transform:c,width:f,height:d}=D(this,Up,nA).call(this,a,e),g=this.svgFactory.create(f,d,!0),m=w(this,Bp,this.svgFactory.createElement("svg:g"));g.append(m),m.setAttribute("stroke-width",l.width||1),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.setAttribute("stroke-miterlimit",10),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),m.setAttribute("transform",c);for(let v=0,_=i.length;v<_;v++){const A=this.svgFactory.createElement(this.svgElementName);p(this,Jc).push(A),A.setAttribute("points",i[v].join(",")),m.append(A)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(g),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:a,points:i,rect:l}=e,o=p(this,Bp);if(a>=0&&o.setAttribute("stroke-width",a||1),i)for(let c=0,f=p(this,Jc).length;c<f;c++)p(this,Jc)[c].setAttribute("points",i[c].join(","));if(l){const{transform:c,width:f,height:d}=D(this,Up,nA).call(this,this.data.rotation,l);o.parentElement.setAttribute("viewBox",`0 0 ${f} ${d}`),o.setAttribute("transform",c)}}getElementsToTriggerPopup(){return p(this,Jc)}addHighlightArea(){this.container.classList.add("highlightArea")}}Bp=new WeakMap,Jc=new WeakMap,Up=new WeakSet,nA=function(e,a){switch(e){case 90:return{transform:`rotate(90) translate(${-a[0]},${a[1]}) scale(1,-1)`,width:a[3]-a[1],height:a[2]-a[0]};case 180:return{transform:`rotate(180) translate(${-a[2]},${a[1]}) scale(1,-1)`,width:a[2]-a[0],height:a[3]-a[1]};case 270:return{transform:`rotate(270) translate(${-a[2]},${a[3]}) scale(1,-1)`,width:a[3]-a[1],height:a[2]-a[0]};default:return{transform:`translate(${-a[0]},${a[3]}) scale(1,-1)`,width:a[2]-a[0],height:a[3]-a[1]}}};class Xk extends vr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=nt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class uF extends vr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class fF extends vr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class hF extends vr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class qk extends vr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=nt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Hp,zp,iA;class dF extends vr{constructor(e){var i;super(e,{isRenderable:!0});O(this,zp);O(this,Hp,null);const{file:a}=this.data;this.filename=a.filename,this.content=a.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...a})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:a}=this;let i;a.hasAppearance||a.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(a.name)?"paperclip":"pushpin"}.svg`,a.fillAlpha&&a.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(a.fillAlpha*100)}%);`)),i.addEventListener("dblclick",D(this,zp,iA).bind(this)),w(this,Hp,i);const{isMac:l}=Ua.platform;return e.addEventListener("keydown",o=>{o.key==="Enter"&&(l?o.metaKey:o.ctrlKey)&&D(this,zp,iA).call(this)}),!a.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),e.append(i),e}getElementsToTriggerPopup(){return p(this,Hp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Hp=new WeakMap,zp=new WeakSet,iA=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var Gp,eu,tu,Vp,Ru,Wk,sA;class pF{constructor({div:t,accessibilityManager:e,annotationCanvasMap:a,annotationEditorUIManager:i,page:l,viewport:o,structTreeLayer:c}){O(this,Ru);O(this,Gp,null);O(this,eu,null);O(this,tu,new Map);O(this,Vp,null);this.div=t,w(this,Gp,e),w(this,eu,a),w(this,Vp,c||null),this.page=l,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return p(this,tu).size>0}async render(t){var o;const{annotations:e}=t,a=this.div;yu(a,this.viewport);const i=new Map,l={data:null,layer:a,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new ey,annotationStorage:t.annotationStorage||new ZA,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const c of e){if(c.noHTML)continue;const f=c.annotationType===Dr.POPUP;if(f){const m=i.get(c.id);if(!m)continue;l.elements=m}else{const{width:m,height:v}=No(c.rect);if(m<=0||v<=0)continue}l.data=c;const d=QI.create(l);if(!d.isRenderable)continue;if(!f&&c.popupRef){const m=i.get(c.popupRef);m?m.push(d):i.set(c.popupRef,[d])}const g=d.render();c.hidden&&(g.style.visibility="hidden"),await D(this,Ru,Wk).call(this,g,c.id),d._isEditable&&(p(this,tu).set(d.data.id,d),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(d))}D(this,Ru,sA).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,yu(e,{rotation:t.rotation}),D(this,Ru,sA).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(p(this,tu).values())}getEditableAnnotation(t){return p(this,tu).get(t)}}Gp=new WeakMap,eu=new WeakMap,tu=new WeakMap,Vp=new WeakMap,Ru=new WeakSet,Wk=async function(t,e){var o,c;const a=t.firstChild||t,i=a.id=`${qA}${e}`,l=await((o=p(this,Vp))==null?void 0:o.getAriaAttributes(i));if(l)for(const[f,d]of l)a.setAttribute(f,d);this.div.append(t),(c=p(this,Gp))==null||c.moveElementInDOM(this.div,t,a,!1)},sA=function(){if(!p(this,eu))return;const t=this.div;for(const[e,a]of p(this,eu)){const i=t.querySelector(`[data-annotation-id="${e}"]`);if(!i)continue;a.className="annotationContent";const{firstChild:l}=i;l?l.nodeName==="CANVAS"?l.replaceWith(a):l.classList.contains("annotationContent")?l.after(a):l.before(a):i.append(a)}p(this,eu).clear()};const j1=/\r\n?|\n/g;var Ci,An,jp,ru,yn,kr,Kk,$k,Qk,vm,_l,_m,Em,Zk,oA,Jk;const Gt=class Gt extends sr{constructor(e){super({...e,name:"freeTextEditor"});O(this,kr);O(this,Ci);O(this,An,"");O(this,jp,`${this.id}-editor`);O(this,ru,null);O(this,yn);w(this,Ci,e.color||Gt._defaultColor||sr._defaultLineColor),w(this,yn,e.fontSize||Gt._defaultFontSize)}static get _keyboardManager(){const e=Gt.prototype,a=o=>o.isEmpty(),i=Tu.TRANSLATE_SMALL,l=Tu.TRANSLATE_BIG;return ut(this,"_keyboardManager",new fg([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:a}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-l,0],checker:a}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[i,0],checker:a}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[l,0],checker:a}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:a}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-l],checker:a}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,i],checker:a}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,l],checker:a}]]))}static initialize(e,a){sr.initialize(e,a);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,a){switch(e){case mt.FREETEXT_SIZE:Gt._defaultFontSize=a;break;case mt.FREETEXT_COLOR:Gt._defaultColor=a;break}}updateParams(e,a){switch(e){case mt.FREETEXT_SIZE:D(this,kr,Kk).call(this,a);break;case mt.FREETEXT_COLOR:D(this,kr,$k).call(this,a);break}}static get defaultPropertiesToUpdate(){return[[mt.FREETEXT_SIZE,Gt._defaultFontSize],[mt.FREETEXT_COLOR,Gt._defaultColor||sr._defaultLineColor]]}get propertiesToUpdate(){return[[mt.FREETEXT_SIZE,p(this,yn)],[mt.FREETEXT_COLOR,p(this,Ci)]]}_translateEmpty(e,a){this._uiManager.translateSelectedEditors(e,a,!0)}getInitialTranslation(){const e=this.parentScale;return[-Gt._internalPadding*e,-(Gt._internalPadding+p(this,yn))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(nt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),w(this,ru,new AbortController);const e=this._uiManager.combinedSignal(p(this,ru));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){var e;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",p(this,jp)),this._isDraggable=!0,(e=p(this,ru))==null||e.abort(),w(this,ru,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var a;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(a=this._initialOptions)!=null&&a.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=p(this,An),a=w(this,An,D(this,kr,Qk).call(this).trimEnd());if(e===a)return;const i=l=>{if(w(this,An,l),!l){this.remove();return}D(this,kr,Em).call(this),this._uiManager.rebuild(this),D(this,kr,vm).call(this)};this.addCommands({cmd:()=>{i(a)},undo:()=>{i(e)},mustExec:!1}),D(this,kr,vm).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Gt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,a;this.width&&(e=this.x,a=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",p(this,jp)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${p(this,yn)}px * var(--scale-factor))`,i.color=p(this,Ci),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Mm(this,this.div,["dblclick","keydown"]),this.width){const[l,o]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[f,d]=this.getInitialTranslation();[f,d]=this.pageTranslationToScreen(f,d);const[g,m]=this.pageDimensions,[v,_]=this.pageTranslation;let A,y;switch(this.rotation){case 0:A=e+(c[0]-v)/g,y=a+this.height-(c[1]-_)/m;break;case 90:A=e+(c[0]-v)/g,y=a-(c[1]-_)/m,[f,d]=[d,-f];break;case 180:A=e-this.width+(c[0]-v)/g,y=a-(c[1]-_)/m,[f,d]=[-f,-d];break;case 270:A=e+(c[0]-v-this.height*m)/g,y=a+(c[1]-_-this.width*g)/m,[f,d]=[-d,f];break}this.setAt(A*l,y*o,f,d)}else this.setAt(e*l,a*o,this.width*l,this.height*o);D(this,kr,Em).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var A,y,T;const a=e.clipboardData||window.clipboardData,{types:i}=a;if(i.length===1&&i[0]==="text/plain")return;e.preventDefault();const l=D(A=Gt,_l,oA).call(A,a.getData("text")||"").replaceAll(j1,`
`);if(!l)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const c=o.getRangeAt(0);if(!l.includes(`
`)){c.insertNode(document.createTextNode(l)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:f,startOffset:d}=c,g=[],m=[];if(f.nodeType===Node.TEXT_NODE){const S=f.parentElement;if(m.push(f.nodeValue.slice(d).replaceAll(j1,"")),S!==this.editorDiv){let R=g;for(const C of this.editorDiv.childNodes){if(C===S){R=m;continue}R.push(D(y=Gt,_l,_m).call(y,C))}}g.push(f.nodeValue.slice(0,d).replaceAll(j1,""))}else if(f===this.editorDiv){let S=g,R=0;for(const C of this.editorDiv.childNodes)R++===d&&(S=m),S.push(D(T=Gt,_l,_m).call(T,C))}w(this,An,`${g.join(`
`)}${l}${m.join(`
`)}`),D(this,kr,Em).call(this);const v=new Range;let _=g.reduce((S,R)=>S+R.length,0);for(const{firstChild:S}of this.editorDiv.childNodes)if(S.nodeType===Node.TEXT_NODE){const R=S.nodeValue.length;if(_<=R){v.setStart(S,_),v.setEnd(S,_);break}_-=R}o.removeAllRanges(),o.addRange(v)}get contentDiv(){return this.editorDiv}static async deserialize(e,a,i){var c;let l=null;if(e instanceof jk){const{data:{defaultAppearanceData:{fontSize:f,fontColor:d},rect:g,rotation:m,id:v,popupRef:_},textContent:A,textPosition:y,parent:{page:{pageNumber:T}}}=e;if(!A||A.length===0)return null;l=e={annotationType:nt.FREETEXT,color:Array.from(d),fontSize:f,value:A.join(`
`),position:y,pageIndex:T-1,rect:g.slice(0),rotation:m,id:v,deleted:!1,popupRef:_}}const o=await super.deserialize(e,a,i);return w(o,yn,e.fontSize),w(o,Ci,Ve.makeHexColor(...e.color)),w(o,An,D(c=Gt,_l,oA).call(c,e.value)),o.annotationElementId=e.id||null,o._initialData=l,o}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const a=Gt._internalPadding*this.parentScale,i=this.getRect(a,a),l=sr._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:p(this,Ci)),o={annotationType:nt.FREETEXT,color:l,fontSize:p(this,yn),value:D(this,kr,Zk).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?o:this.annotationElementId&&!D(this,kr,Jk).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(e){const a=super.renderAnnotationElement(e);if(this.deleted)return a;const{style:i}=a;i.fontSize=`calc(${p(this,yn)}px * var(--scale-factor))`,i.color=p(this,Ci),a.replaceChildren();for(const o of p(this,An).split(`
`)){const c=document.createElement("div");c.append(o?document.createTextNode(o):document.createElement("br")),a.append(c)}const l=Gt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(l,l),popupContent:p(this,An)}),a}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};Ci=new WeakMap,An=new WeakMap,jp=new WeakMap,ru=new WeakMap,yn=new WeakMap,kr=new WeakSet,Kk=function(e){const a=l=>{this.editorDiv.style.fontSize=`calc(${l}px * var(--scale-factor))`,this.translate(0,-(l-p(this,yn))*this.parentScale),w(this,yn,l),D(this,kr,vm).call(this)},i=p(this,yn);this.addCommands({cmd:a.bind(this,e),undo:a.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},$k=function(e){const a=l=>{w(this,Ci,this.editorDiv.style.color=l)},i=p(this,Ci);this.addCommands({cmd:a.bind(this,e),undo:a.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Qk=function(){var i;const e=[];this.editorDiv.normalize();let a=null;for(const l of this.editorDiv.childNodes)(a==null?void 0:a.nodeType)===Node.TEXT_NODE&&l.nodeName==="BR"||(e.push(D(i=Gt,_l,_m).call(i,l)),a=l);return e.join(`
`)},vm=function(){const[e,a]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:l,div:o}=this,c=o.style.display,f=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",l.div.append(this.div),i=o.getBoundingClientRect(),o.remove(),o.style.display=c,o.classList.toggle("hidden",f)}this.rotation%180===this.parentRotation%180?(this.width=i.width/e,this.height=i.height/a):(this.width=i.height/e,this.height=i.width/a),this.fixAndSetPosition()},_l=new WeakSet,_m=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(j1,"")},Em=function(){if(this.editorDiv.replaceChildren(),!!p(this,An))for(const e of p(this,An).split(`
`)){const a=document.createElement("div");a.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(a)}},Zk=function(){return p(this,An).replaceAll(""," ")},oA=function(e){return e.replaceAll(" ","")},Jk=function(e){const{value:a,fontSize:i,color:l,pageIndex:o}=this._initialData;return this._hasBeenMoved||e.value!==a||e.fontSize!==i||e.color.some((c,f)=>c!==l[f])||e.pageIndex!==o},O(Gt,_l),Xe(Gt,"_freeTextDefaultContent",""),Xe(Gt,"_internalPadding",0),Xe(Gt,"_defaultColor",null),Xe(Gt,"_defaultFontSize",10),Xe(Gt,"_type","freetext"),Xe(Gt,"_editorType",nt.FREETEXT);let lA=Gt;class Pe{toSVGPath(){Ut("Abstract method `toSVGPath` must be implemented.")}get box(){Ut("Abstract getter `box` must be implemented.")}serialize(t,e){Ut("Abstract method `serialize` must be implemented.")}static _rescale(t,e,a,i,l,o){o||(o=new Float32Array(t.length));for(let c=0,f=t.length;c<f;c+=2)o[c]=e+t[c]*i,o[c+1]=a+t[c+1]*l;return o}static _rescaleAndSwap(t,e,a,i,l,o){o||(o=new Float32Array(t.length));for(let c=0,f=t.length;c<f;c+=2)o[c]=e+t[c+1]*i,o[c+1]=a+t[c]*l;return o}static _translate(t,e,a,i){i||(i=new Float32Array(t.length));for(let l=0,o=t.length;l<o;l+=2)i[l]=e+t[l],i[l+1]=a+t[l+1];return i}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,a,i,l){switch(l){case 90:return[1-e/a,t/i];case 180:return[1-t/a,1-e/i];case 270:return[e/a,1-t/i];default:return[t/a,e/i]}}static _normalizePagePoint(t,e,a){switch(a){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,a,i,l,o){return[(t+5*a)/6,(e+5*i)/6,(5*a+l)/6,(5*i+o)/6,(a+l)/2,(i+o)/2]}}Xe(Pe,"PRECISION",1e-4);var Tn,Ri,Ah,yh,cs,ct,au,nu,Yp,Xp,Th,Sh,_o,qp,fx,hx,Br,id,e4,t4,r4,a4,n4,i4;const Gs=class Gs{constructor({x:t,y:e},a,i,l,o,c=0){O(this,Br);O(this,Tn);O(this,Ri,[]);O(this,Ah);O(this,yh);O(this,cs,[]);O(this,ct,new Float32Array(18));O(this,au);O(this,nu);O(this,Yp);O(this,Xp);O(this,Th);O(this,Sh);O(this,_o,[]);w(this,Tn,a),w(this,Sh,l*i),w(this,yh,o),p(this,ct).set([NaN,NaN,NaN,NaN,t,e],6),w(this,Ah,c),w(this,Xp,p(Gs,qp)*i),w(this,Yp,p(Gs,hx)*i),w(this,Th,i),p(this,_o).push(t,e)}isEmpty(){return isNaN(p(this,ct)[8])}add({x:t,y:e}){var j;w(this,au,t),w(this,nu,e);const[a,i,l,o]=p(this,Tn);let[c,f,d,g]=p(this,ct).subarray(8,12);const m=t-d,v=e-g,_=Math.hypot(m,v);if(_<p(this,Yp))return!1;const A=_-p(this,Xp),y=A/_,T=y*m,S=y*v;let R=c,C=f;c=d,f=g,d+=T,g+=S,(j=p(this,_o))==null||j.push(t,e);const F=-S/A,U=T/A,B=F*p(this,Sh),k=U*p(this,Sh);return p(this,ct).set(p(this,ct).subarray(2,8),0),p(this,ct).set([d+B,g+k],4),p(this,ct).set(p(this,ct).subarray(14,18),12),p(this,ct).set([d-B,g-k],16),isNaN(p(this,ct)[6])?(p(this,cs).length===0&&(p(this,ct).set([c+B,f+k],2),p(this,cs).push(NaN,NaN,NaN,NaN,(c+B-a)/l,(f+k-i)/o),p(this,ct).set([c-B,f-k],14),p(this,Ri).push(NaN,NaN,NaN,NaN,(c-B-a)/l,(f-k-i)/o)),p(this,ct).set([R,C,c,f,d,g],6),!this.isEmpty()):(p(this,ct).set([R,C,c,f,d,g],6),Math.abs(Math.atan2(C-f,R-c)-Math.atan2(S,T))<Math.PI/2?([c,f,d,g]=p(this,ct).subarray(2,6),p(this,cs).push(NaN,NaN,NaN,NaN,((c+d)/2-a)/l,((f+g)/2-i)/o),[c,f,R,C]=p(this,ct).subarray(14,18),p(this,Ri).push(NaN,NaN,NaN,NaN,((R+c)/2-a)/l,((C+f)/2-i)/o),!0):([R,C,c,f,d,g]=p(this,ct).subarray(0,6),p(this,cs).push(((R+5*c)/6-a)/l,((C+5*f)/6-i)/o,((5*c+d)/6-a)/l,((5*f+g)/6-i)/o,((c+d)/2-a)/l,((f+g)/2-i)/o),[d,g,c,f,R,C]=p(this,ct).subarray(12,18),p(this,Ri).push(((R+5*c)/6-a)/l,((C+5*f)/6-i)/o,((5*c+d)/6-a)/l,((5*f+g)/6-i)/o,((c+d)/2-a)/l,((f+g)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=p(this,cs),e=p(this,Ri);if(isNaN(p(this,ct)[6])&&!this.isEmpty())return D(this,Br,e4).call(this);const a=[];a.push(`M${t[4]} ${t[5]}`);for(let i=6;i<t.length;i+=6)isNaN(t[i])?a.push(`L${t[i+4]} ${t[i+5]}`):a.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);D(this,Br,r4).call(this,a);for(let i=e.length-6;i>=6;i-=6)isNaN(e[i])?a.push(`L${e[i+4]} ${e[i+5]}`):a.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);return D(this,Br,t4).call(this,a),a.join(" ")}newFreeDrawOutline(t,e,a,i,l,o){return new s4(t,e,a,i,l,o)}getOutlines(){var m;const t=p(this,cs),e=p(this,Ri),a=p(this,ct),[i,l,o,c]=p(this,Tn),f=new Float32Array((((m=p(this,_o))==null?void 0:m.length)??0)+2);for(let v=0,_=f.length-2;v<_;v+=2)f[v]=(p(this,_o)[v]-i)/o,f[v+1]=(p(this,_o)[v+1]-l)/c;if(f[f.length-2]=(p(this,au)-i)/o,f[f.length-1]=(p(this,nu)-l)/c,isNaN(a[6])&&!this.isEmpty())return D(this,Br,a4).call(this,f);const d=new Float32Array(p(this,cs).length+24+p(this,Ri).length);let g=t.length;for(let v=0;v<g;v+=2){if(isNaN(t[v])){d[v]=d[v+1]=NaN;continue}d[v]=t[v],d[v+1]=t[v+1]}g=D(this,Br,i4).call(this,d,g);for(let v=e.length-6;v>=6;v-=6)for(let _=0;_<6;_+=2){if(isNaN(e[v+_])){d[g]=d[g+1]=NaN,g+=2;continue}d[g]=e[v+_],d[g+1]=e[v+_+1],g+=2}return D(this,Br,n4).call(this,d,g),this.newFreeDrawOutline(d,f,p(this,Tn),p(this,Th),p(this,Ah),p(this,yh))}};Tn=new WeakMap,Ri=new WeakMap,Ah=new WeakMap,yh=new WeakMap,cs=new WeakMap,ct=new WeakMap,au=new WeakMap,nu=new WeakMap,Yp=new WeakMap,Xp=new WeakMap,Th=new WeakMap,Sh=new WeakMap,_o=new WeakMap,qp=new WeakMap,fx=new WeakMap,hx=new WeakMap,Br=new WeakSet,id=function(){const t=p(this,ct).subarray(4,6),e=p(this,ct).subarray(16,18),[a,i,l,o]=p(this,Tn);return[(p(this,au)+(t[0]-e[0])/2-a)/l,(p(this,nu)+(t[1]-e[1])/2-i)/o,(p(this,au)+(e[0]-t[0])/2-a)/l,(p(this,nu)+(e[1]-t[1])/2-i)/o]},e4=function(){const[t,e,a,i]=p(this,Tn),[l,o,c,f]=D(this,Br,id).call(this);return`M${(p(this,ct)[2]-t)/a} ${(p(this,ct)[3]-e)/i} L${(p(this,ct)[4]-t)/a} ${(p(this,ct)[5]-e)/i} L${l} ${o} L${c} ${f} L${(p(this,ct)[16]-t)/a} ${(p(this,ct)[17]-e)/i} L${(p(this,ct)[14]-t)/a} ${(p(this,ct)[15]-e)/i} Z`},t4=function(t){const e=p(this,Ri);t.push(`L${e[4]} ${e[5]} Z`)},r4=function(t){const[e,a,i,l]=p(this,Tn),o=p(this,ct).subarray(4,6),c=p(this,ct).subarray(16,18),[f,d,g,m]=D(this,Br,id).call(this);t.push(`L${(o[0]-e)/i} ${(o[1]-a)/l} L${f} ${d} L${g} ${m} L${(c[0]-e)/i} ${(c[1]-a)/l}`)},a4=function(t){const e=p(this,ct),[a,i,l,o]=p(this,Tn),[c,f,d,g]=D(this,Br,id).call(this),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(e[2]-a)/l,(e[3]-i)/o,NaN,NaN,NaN,NaN,(e[4]-a)/l,(e[5]-i)/o,NaN,NaN,NaN,NaN,c,f,NaN,NaN,NaN,NaN,d,g,NaN,NaN,NaN,NaN,(e[16]-a)/l,(e[17]-i)/o,NaN,NaN,NaN,NaN,(e[14]-a)/l,(e[15]-i)/o],0),this.newFreeDrawOutline(m,t,p(this,Tn),p(this,Th),p(this,Ah),p(this,yh))},n4=function(t,e){const a=p(this,Ri);return t.set([NaN,NaN,NaN,NaN,a[4],a[5]],e),e+=6},i4=function(t,e){const a=p(this,ct).subarray(4,6),i=p(this,ct).subarray(16,18),[l,o,c,f]=p(this,Tn),[d,g,m,v]=D(this,Br,id).call(this);return t.set([NaN,NaN,NaN,NaN,(a[0]-l)/c,(a[1]-o)/f,NaN,NaN,NaN,NaN,d,g,NaN,NaN,NaN,NaN,m,v,NaN,NaN,NaN,NaN,(i[0]-l)/c,(i[1]-o)/f],e),e+=24},O(Gs,qp,8),O(Gs,fx,2),O(Gs,hx,p(Gs,qp)+p(Gs,fx));let Lm=Gs;var bh,iu,ll,Wp,Sn,Kp,xr,dx,l4;class s4 extends Pe{constructor(e,a,i,l,o,c){super();O(this,dx);O(this,bh);O(this,iu,new Float32Array(4));O(this,ll);O(this,Wp);O(this,Sn);O(this,Kp);O(this,xr);w(this,xr,e),w(this,Sn,a),w(this,bh,i),w(this,Kp,l),w(this,ll,o),w(this,Wp,c),this.lastPoint=[NaN,NaN],D(this,dx,l4).call(this,c);const[f,d,g,m]=p(this,iu);for(let v=0,_=e.length;v<_;v+=2)e[v]=(e[v]-f)/g,e[v+1]=(e[v+1]-d)/m;for(let v=0,_=a.length;v<_;v+=2)a[v]=(a[v]-f)/g,a[v+1]=(a[v+1]-d)/m}toSVGPath(){const e=[`M${p(this,xr)[4]} ${p(this,xr)[5]}`];for(let a=6,i=p(this,xr).length;a<i;a+=6){if(isNaN(p(this,xr)[a])){e.push(`L${p(this,xr)[a+4]} ${p(this,xr)[a+5]}`);continue}e.push(`C${p(this,xr)[a]} ${p(this,xr)[a+1]} ${p(this,xr)[a+2]} ${p(this,xr)[a+3]} ${p(this,xr)[a+4]} ${p(this,xr)[a+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,a,i,l],o){const c=i-e,f=l-a;let d,g;switch(o){case 0:d=Pe._rescale(p(this,xr),e,l,c,-f),g=Pe._rescale(p(this,Sn),e,l,c,-f);break;case 90:d=Pe._rescaleAndSwap(p(this,xr),e,a,c,f),g=Pe._rescaleAndSwap(p(this,Sn),e,a,c,f);break;case 180:d=Pe._rescale(p(this,xr),i,a,-c,f),g=Pe._rescale(p(this,Sn),i,a,-c,f);break;case 270:d=Pe._rescaleAndSwap(p(this,xr),i,l,-c,-f),g=Pe._rescaleAndSwap(p(this,Sn),i,l,-c,-f);break}return{outline:Array.from(d),points:[Array.from(g)]}}get box(){return p(this,iu)}newOutliner(e,a,i,l,o,c=0){return new Lm(e,a,i,l,o,c)}getNewOutline(e,a){const[i,l,o,c]=p(this,iu),[f,d,g,m]=p(this,bh),v=o*g,_=c*m,A=i*g+f,y=l*m+d,T=this.newOutliner({x:p(this,Sn)[0]*v+A,y:p(this,Sn)[1]*_+y},p(this,bh),p(this,Kp),e,p(this,Wp),a??p(this,ll));for(let S=2;S<p(this,Sn).length;S+=2)T.add({x:p(this,Sn)[S]*v+A,y:p(this,Sn)[S+1]*_+y});return T.getOutlines()}}bh=new WeakMap,iu=new WeakMap,ll=new WeakMap,Wp=new WeakMap,Sn=new WeakMap,Kp=new WeakMap,xr=new WeakMap,dx=new WeakSet,l4=function(e){const a=p(this,xr);let i=a[4],l=a[5],o=i,c=l,f=i,d=l,g=i,m=l;const v=e?Math.max:Math.min;for(let A=6,y=a.length;A<y;A+=6){if(isNaN(a[A]))o=Math.min(o,a[A+4]),c=Math.min(c,a[A+5]),f=Math.max(f,a[A+4]),d=Math.max(d,a[A+5]),m<a[A+5]?(g=a[A+4],m=a[A+5]):m===a[A+5]&&(g=v(g,a[A+4]));else{const T=Ve.bezierBoundingBox(i,l,...a.slice(A,A+6));o=Math.min(o,T[0]),c=Math.min(c,T[1]),f=Math.max(f,T[2]),d=Math.max(d,T[3]),m<T[3]?(g=T[2],m=T[3]):m===T[3]&&(g=v(g,T[2]))}i=a[A+4],l=a[A+5]}const _=p(this,iu);_[0]=o-p(this,ll),_[1]=c-p(this,ll),_[2]=f-o+2*p(this,ll),_[3]=d-c+2*p(this,ll),this.lastPoint=[g,m]};var $p,Qp,Eo,ki,Ga,o4,Am,c4,u4,uA;class cA{constructor(t,e=0,a=0,i=!0){O(this,Ga);O(this,$p);O(this,Qp);O(this,Eo,[]);O(this,ki,[]);let l=1/0,o=-1/0,c=1/0,f=-1/0;const d=10**-4;for(const{x:T,y:S,width:R,height:C}of t){const F=Math.floor((T-e)/d)*d,U=Math.ceil((T+R+e)/d)*d,B=Math.floor((S-e)/d)*d,k=Math.ceil((S+C+e)/d)*d,J=[F,B,k,!0],j=[U,B,k,!1];p(this,Eo).push(J,j),l=Math.min(l,F),o=Math.max(o,U),c=Math.min(c,B),f=Math.max(f,k)}const g=o-l+2*a,m=f-c+2*a,v=l-a,_=c-a,A=p(this,Eo).at(i?-1:-2),y=[A[0],A[2]];for(const T of p(this,Eo)){const[S,R,C]=T;T[0]=(S-v)/g,T[1]=(R-_)/m,T[2]=(C-_)/m}w(this,$p,new Float32Array([v,_,g,m])),w(this,Qp,y)}getOutlines(){p(this,Eo).sort((e,a)=>e[0]-a[0]||e[1]-a[1]||e[2]-a[2]);const t=[];for(const e of p(this,Eo))e[3]?(t.push(...D(this,Ga,uA).call(this,e)),D(this,Ga,c4).call(this,e)):(D(this,Ga,u4).call(this,e),t.push(...D(this,Ga,uA).call(this,e)));return D(this,Ga,o4).call(this,t)}}$p=new WeakMap,Qp=new WeakMap,Eo=new WeakMap,ki=new WeakMap,Ga=new WeakSet,o4=function(t){const e=[],a=new Set;for(const o of t){const[c,f,d]=o;e.push([c,f,o],[c,d,o])}e.sort((o,c)=>o[1]-c[1]||o[0]-c[0]);for(let o=0,c=e.length;o<c;o+=2){const f=e[o][2],d=e[o+1][2];f.push(d),d.push(f),a.add(f),a.add(d)}const i=[];let l;for(;a.size>0;){const o=a.values().next().value;let[c,f,d,g,m]=o;a.delete(o);let v=c,_=f;for(l=[c,d],i.push(l);;){let A;if(a.has(g))A=g;else if(a.has(m))A=m;else break;a.delete(A),[c,f,d,g,m]=A,v!==c&&(l.push(v,_,c,_===f?f:d),v=c),_=_===f?d:f}l.push(v,_)}return new gF(i,p(this,$p),p(this,Qp))},Am=function(t){const e=p(this,ki);let a=0,i=e.length-1;for(;a<=i;){const l=a+i>>1,o=e[l][0];if(o===t)return l;o<t?a=l+1:i=l-1}return i+1},c4=function([,t,e]){const a=D(this,Ga,Am).call(this,t);p(this,ki).splice(a,0,[t,e])},u4=function([,t,e]){const a=D(this,Ga,Am).call(this,t);for(let i=a;i<p(this,ki).length;i++){const[l,o]=p(this,ki)[i];if(l!==t)break;if(l===t&&o===e){p(this,ki).splice(i,1);return}}for(let i=a-1;i>=0;i--){const[l,o]=p(this,ki)[i];if(l!==t)break;if(l===t&&o===e){p(this,ki).splice(i,1);return}}},uA=function(t){const[e,a,i]=t,l=[[e,a,i]],o=D(this,Ga,Am).call(this,i);for(let c=0;c<o;c++){const[f,d]=p(this,ki)[c];for(let g=0,m=l.length;g<m;g++){const[,v,_]=l[g];if(!(d<=v||_<=f)){if(v>=f){if(_>d)l[g][1]=d;else{if(m===1)return[];l.splice(g,1),g--,m--}continue}l[g][2]=f,_>d&&l.push([e,d,_])}}}return l};var Zp,wh;class gF extends Pe{constructor(e,a,i){super();O(this,Zp);O(this,wh);w(this,wh,e),w(this,Zp,a),this.lastPoint=i}toSVGPath(){const e=[];for(const a of p(this,wh)){let[i,l]=a;e.push(`M${i} ${l}`);for(let o=2;o<a.length;o+=2){const c=a[o],f=a[o+1];c===i?(e.push(`V${f}`),l=f):f===l&&(e.push(`H${c}`),i=c)}e.push("Z")}return e.join(" ")}serialize([e,a,i,l],o){const c=[],f=i-e,d=l-a;for(const g of p(this,wh)){const m=new Array(g.length);for(let v=0;v<g.length;v+=2)m[v]=e+g[v]*f,m[v+1]=l-g[v+1]*d;c.push(m)}return c}get box(){return p(this,Zp)}get classNamesForOutlining(){return["highlightOutline"]}}Zp=new WeakMap,wh=new WeakMap;class fA extends Lm{newFreeDrawOutline(t,e,a,i,l,o){return new mF(t,e,a,i,l,o)}}class mF extends s4{newOutliner(t,e,a,i,l,o=0){return new fA(t,e,a,i,l,o)}}var Oi,su,Ch,Ir,Jp,Rh,eg,tg,Ao,Di,kh,rg,Ft,hA,dA,pA,uc,f4,$l;const rn=class rn{constructor({editor:t=null,uiManager:e=null}){O(this,Ft);O(this,Oi,null);O(this,su,null);O(this,Ch);O(this,Ir,null);O(this,Jp,!1);O(this,Rh,!1);O(this,eg,null);O(this,tg);O(this,Ao,null);O(this,Di,null);O(this,kh);var a;t?(w(this,Rh,!1),w(this,kh,mt.HIGHLIGHT_COLOR),w(this,eg,t)):(w(this,Rh,!0),w(this,kh,mt.HIGHLIGHT_DEFAULT_COLOR)),w(this,Di,(t==null?void 0:t._uiManager)||e),w(this,tg,p(this,Di)._eventBus),w(this,Ch,(t==null?void 0:t.color)||((a=p(this,Di))==null?void 0:a.highlightColors.values().next().value)||"#FFFF98"),p(rn,rg)||w(rn,rg,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ut(this,"_keyboardManager",new fg([[["Escape","mac+Escape"],rn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],rn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],rn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],rn.prototype._moveToPrevious],[["Home","mac+Home"],rn.prototype._moveToBeginning],[["End","mac+End"],rn.prototype._moveToEnd]]))}renderButton(){const t=w(this,Oi,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=p(this,Di)._signal;t.addEventListener("click",D(this,Ft,uc).bind(this),{signal:e}),t.addEventListener("keydown",D(this,Ft,pA).bind(this),{signal:e});const a=w(this,su,document.createElement("span"));return a.className="swatch",a.setAttribute("aria-hidden",!0),a.style.backgroundColor=p(this,Ch),t.append(a),t}renderMainDropdown(){const t=w(this,Ir,D(this,Ft,hA).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===p(this,Oi)){D(this,Ft,uc).call(this,t);return}const e=t.target.getAttribute("data-color");e&&D(this,Ft,dA).call(this,e,t)}_moveToNext(t){var e,a;if(!p(this,Ft,$l)){D(this,Ft,uc).call(this,t);return}if(t.target===p(this,Oi)){(e=p(this,Ir).firstChild)==null||e.focus();return}(a=t.target.nextSibling)==null||a.focus()}_moveToPrevious(t){var e,a;if(t.target===((e=p(this,Ir))==null?void 0:e.firstChild)||t.target===p(this,Oi)){p(this,Ft,$l)&&this._hideDropdownFromKeyboard();return}p(this,Ft,$l)||D(this,Ft,uc).call(this,t),(a=t.target.previousSibling)==null||a.focus()}_moveToBeginning(t){var e;if(!p(this,Ft,$l)){D(this,Ft,uc).call(this,t);return}(e=p(this,Ir).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!p(this,Ft,$l)){D(this,Ft,uc).call(this,t);return}(e=p(this,Ir).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=p(this,Ir))==null||t.classList.add("hidden"),(e=p(this,Ao))==null||e.abort(),w(this,Ao,null)}_hideDropdownFromKeyboard(){var t;if(!p(this,Rh)){if(!p(this,Ft,$l)){(t=p(this,eg))==null||t.unselect();return}this.hideDropdown(),p(this,Oi).focus({preventScroll:!0,focusVisible:p(this,Jp)})}}updateColor(t){if(p(this,su)&&(p(this,su).style.backgroundColor=t),!p(this,Ir))return;const e=p(this,Di).highlightColors.values();for(const a of p(this,Ir).children)a.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=p(this,Oi))==null||t.remove(),w(this,Oi,null),w(this,su,null),(e=p(this,Ir))==null||e.remove(),w(this,Ir,null)}};Oi=new WeakMap,su=new WeakMap,Ch=new WeakMap,Ir=new WeakMap,Jp=new WeakMap,Rh=new WeakMap,eg=new WeakMap,tg=new WeakMap,Ao=new WeakMap,Di=new WeakMap,kh=new WeakMap,rg=new WeakMap,Ft=new WeakSet,hA=function(){const t=document.createElement("div"),e=p(this,Di)._signal;t.addEventListener("contextmenu",Ui,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[a,i]of p(this,Di).highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",i),l.title=a,l.setAttribute("data-l10n-id",p(rn,rg)[a]);const o=document.createElement("span");l.append(o),o.className="swatch",o.style.backgroundColor=i,l.setAttribute("aria-selected",i===p(this,Ch)),l.addEventListener("click",D(this,Ft,dA).bind(this,i),{signal:e}),t.append(l)}return t.addEventListener("keydown",D(this,Ft,pA).bind(this),{signal:e}),t},dA=function(t,e){e.stopPropagation(),p(this,tg).dispatch("switchannotationeditorparams",{source:this,type:p(this,kh),value:t})},pA=function(t){rn._keyboardManager.exec(this,t)},uc=function(t){if(p(this,Ft,$l)){this.hideDropdown();return}if(w(this,Jp,t.detail===0),p(this,Ao)||(w(this,Ao,new AbortController),window.addEventListener("pointerdown",D(this,Ft,f4).bind(this),{signal:p(this,Di).combinedSignal(p(this,Ao))})),p(this,Ir)){p(this,Ir).classList.remove("hidden");return}const e=w(this,Ir,D(this,Ft,hA).call(this));p(this,Oi).append(e)},f4=function(t){var e;(e=p(this,Ir))!=null&&e.contains(t.target)||this.hideDropdown()},$l=function(){return p(this,Ir)&&!p(this,Ir).classList.contains("hidden")},O(rn,rg,null);let Pm=rn;var Oh,ag,ol,lu,Dh,sn,ng,ig,ou,ri,bn,ta,Nh,cl,xa,Mh,ai,sg,et,gA,ym,h4,d4,p4,mA,fc,li,Cf,g4,Tm,sd,m4,x4,v4,_4,E4;const Ct=class Ct extends sr{constructor(e){super({...e,name:"highlightEditor"});O(this,et);O(this,Oh,null);O(this,ag,0);O(this,ol);O(this,lu,null);O(this,Dh,null);O(this,sn,null);O(this,ng,null);O(this,ig,0);O(this,ou,null);O(this,ri,null);O(this,bn,null);O(this,ta,!1);O(this,Nh,null);O(this,cl);O(this,xa,null);O(this,Mh,"");O(this,ai);O(this,sg,"");this.color=e.color||Ct._defaultColor,w(this,ai,e.thickness||Ct._defaultThickness),w(this,cl,e.opacity||Ct._defaultOpacity),w(this,ol,e.boxes||null),w(this,sg,e.methodOfCreation||""),w(this,Mh,e.text||""),this._isDraggable=!1,e.highlightId>-1?(w(this,ta,!0),D(this,et,ym).call(this,e),D(this,et,fc).call(this)):p(this,ol)&&(w(this,Oh,e.anchorNode),w(this,ag,e.anchorOffset),w(this,ng,e.focusNode),w(this,ig,e.focusOffset),D(this,et,gA).call(this),D(this,et,fc).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=Ct.prototype;return ut(this,"_keyboardManager",new fg([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:p(this,ta)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:p(this,ai),methodOfCreation:p(this,sg)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,a){var i;sr.initialize(e,a),Ct._defaultColor||(Ct._defaultColor=((i=a.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(e,a){switch(e){case mt.HIGHLIGHT_DEFAULT_COLOR:Ct._defaultColor=a;break;case mt.HIGHLIGHT_THICKNESS:Ct._defaultThickness=a;break}}translateInPage(e,a){}get toolbarPosition(){return p(this,Nh)}updateParams(e,a){switch(e){case mt.HIGHLIGHT_COLOR:D(this,et,h4).call(this,a);break;case mt.HIGHLIGHT_THICKNESS:D(this,et,d4).call(this,a);break}}static get defaultPropertiesToUpdate(){return[[mt.HIGHLIGHT_DEFAULT_COLOR,Ct._defaultColor],[mt.HIGHLIGHT_THICKNESS,Ct._defaultThickness]]}get propertiesToUpdate(){return[[mt.HIGHLIGHT_COLOR,this.color||Ct._defaultColor],[mt.HIGHLIGHT_THICKNESS,p(this,ai)||Ct._defaultThickness],[mt.HIGHLIGHT_FREE,p(this,ta)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(w(this,Dh,new Pm({editor:this})),e.addColorPicker(p(this,Dh))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(D(this,et,sd).call(this))}getBaseTranslation(){return[0,0]}getRect(e,a){return super.getRect(e,a,D(this,et,sd).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){D(this,et,mA).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(D(this,et,fc).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var i;let a=!1;this.parent&&!e?D(this,et,mA).call(this):e&&(D(this,et,fc).call(this,e),a=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),a&&this.select()}rotate(e){var l,o,c;const{drawLayer:a}=this.parent;let i;p(this,ta)?(e=(e-this.rotation+360)%360,i=D(l=Ct,li,Cf).call(l,p(this,ri).box,e)):i=D(o=Ct,li,Cf).call(o,[this.x,this.y,this.width,this.height],e),a.updateProperties(p(this,bn),{bbox:i,root:{"data-main-rotation":e}}),a.updateProperties(p(this,xa),{bbox:D(c=Ct,li,Cf).call(c,p(this,sn).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();p(this,Mh)&&(e.setAttribute("aria-label",p(this,Mh)),e.setAttribute("role","mark")),p(this,ta)?e.classList.add("free"):this.div.addEventListener("keydown",D(this,et,g4).bind(this),{signal:this._uiManager._signal});const a=w(this,ou,document.createElement("div"));e.append(a),a.setAttribute("aria-hidden","true"),a.className="internal",a.style.clipPath=p(this,lu);const[i,l]=this.parentDimensions;return this.setDims(this.width*i,this.height*l),Mm(this,p(this,ou),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(p(this,xa),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(p(this,xa),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:D(this,et,Tm).call(this,!0);break;case 1:case 3:D(this,et,Tm).call(this,!1);break}}select(){var e;super.select(),p(this,xa)&&((e=this.parent)==null||e.drawLayer.updateProperties(p(this,xa),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),p(this,xa)&&((e=this.parent)==null||e.drawLayer.updateProperties(p(this,xa),{rootClass:{selected:!1}}),p(this,ta)||D(this,et,Tm).call(this,!1))}get _mustFixPosition(){return!p(this,ta)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(p(this,bn),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(p(this,xa),{rootClass:{hidden:!e}}))}static startHighlighting(e,a,{target:i,x:l,y:o}){const{x:c,y:f,width:d,height:g}=i.getBoundingClientRect(),m=new AbortController,v=e.combinedSignal(m),_=A=>{m.abort(),D(this,li,_4).call(this,e,A)};window.addEventListener("blur",_,{signal:v}),window.addEventListener("pointerup",_,{signal:v}),window.addEventListener("pointerdown",Nn,{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",Ui,{signal:v}),i.addEventListener("pointermove",D(this,li,v4).bind(this,e),{signal:v}),this._freeHighlight=new fA({x:l,y:o},[c,f,d,g],e.scale,this._defaultThickness/2,a,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,a,i){var y,T,S,R;let l=null;if(e instanceof Xk){const{data:{quadPoints:C,rect:F,rotation:U,id:B,color:k,opacity:J,popupRef:j},parent:{page:{pageNumber:ie}}}=e;l=e={annotationType:nt.HIGHLIGHT,color:Array.from(k),opacity:J,quadPoints:C,boxes:null,pageIndex:ie-1,rect:F.slice(0),rotation:U,id:B,deleted:!1,popupRef:j}}else if(e instanceof ty){const{data:{inkLists:C,rect:F,rotation:U,id:B,color:k,borderStyle:{rawWidth:J},popupRef:j},parent:{page:{pageNumber:ie}}}=e;l=e={annotationType:nt.HIGHLIGHT,color:Array.from(k),thickness:J,inkLists:C,boxes:null,pageIndex:ie-1,rect:F.slice(0),rotation:U,id:B,deleted:!1,popupRef:j}}const{color:o,quadPoints:c,inkLists:f,opacity:d}=e,g=await super.deserialize(e,a,i);g.color=Ve.makeHexColor(...o),w(g,cl,d||1),f&&w(g,ai,e.thickness),g.annotationElementId=e.id||null,g._initialData=l;const[m,v]=g.pageDimensions,[_,A]=g.pageTranslation;if(c){const C=w(g,ol,[]);for(let F=0;F<c.length;F+=8)C.push({x:(c[F]-_)/m,y:1-(c[F+1]-A)/v,width:(c[F+2]-c[F])/m,height:(c[F+1]-c[F+5])/v});D(y=g,et,gA).call(y),D(T=g,et,fc).call(T),g.rotate(g.rotation)}else if(f){w(g,ta,!0);const C=f[0],F={x:C[0]-_,y:v-(C[1]-A)},U=new fA(F,[0,0,m,v],1,p(g,ai)/2,!0,.001);for(let J=0,j=C.length;J<j;J+=2)F.x=C[J]-_,F.y=v-(C[J+1]-A),U.add(F);const{id:B,clipPathId:k}=a.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:g.color,"fill-opacity":g._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:U.toSVGPath()}},!0,!0);D(S=g,et,ym).call(S,{highlightOutlines:U.getOutlines(),highlightId:B,clipPathId:k}),D(R=g,et,fc).call(R)}return g}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const a=this.getRect(0,0),i=sr._colorManager.convert(this.color),l={annotationType:nt.HIGHLIGHT,color:i,opacity:p(this,cl),thickness:p(this,ai),quadPoints:D(this,et,m4).call(this),outlines:D(this,et,x4).call(this,a),pageIndex:this.pageIndex,rect:a,rotation:D(this,et,sd).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!D(this,et,E4).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Oh=new WeakMap,ag=new WeakMap,ol=new WeakMap,lu=new WeakMap,Dh=new WeakMap,sn=new WeakMap,ng=new WeakMap,ig=new WeakMap,ou=new WeakMap,ri=new WeakMap,bn=new WeakMap,ta=new WeakMap,Nh=new WeakMap,cl=new WeakMap,xa=new WeakMap,Mh=new WeakMap,ai=new WeakMap,sg=new WeakMap,et=new WeakSet,gA=function(){const e=new cA(p(this,ol),.001);w(this,ri,e.getOutlines()),[this.x,this.y,this.width,this.height]=p(this,ri).box;const a=new cA(p(this,ol),.0025,.001,this._uiManager.direction==="ltr");w(this,sn,a.getOutlines());const{lastPoint:i}=p(this,sn);w(this,Nh,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},ym=function({highlightOutlines:e,highlightId:a,clipPathId:i}){var m,v;if(w(this,ri,e),w(this,sn,e.getNewOutline(p(this,ai)/2+1.5,.0025)),a>=0)w(this,bn,a),w(this,lu,i),this.parent.drawLayer.finalizeDraw(a,{bbox:e.box,path:{d:e.toSVGPath()}}),w(this,xa,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:p(this,sn).box,path:{d:p(this,sn).toSVGPath()}},!0));else if(this.parent){const _=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(p(this,bn),{bbox:D(m=Ct,li,Cf).call(m,p(this,ri).box,(_-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(p(this,xa),{bbox:D(v=Ct,li,Cf).call(v,p(this,sn).box,_),path:{d:p(this,sn).toSVGPath()}})}const[o,c,f,d]=e.box;switch(this.rotation){case 0:this.x=o,this.y=c,this.width=f,this.height=d;break;case 90:{const[_,A]=this.parentDimensions;this.x=c,this.y=1-o,this.width=f*A/_,this.height=d*_/A;break}case 180:this.x=1-o,this.y=1-c,this.width=f,this.height=d;break;case 270:{const[_,A]=this.parentDimensions;this.x=1-c,this.y=o,this.width=f*A/_,this.height=d*_/A;break}}const{lastPoint:g}=p(this,sn);w(this,Nh,[(g[0]-o)/f,(g[1]-c)/d])},h4=function(e){const a=(o,c)=>{var f,d;this.color=o,w(this,cl,c),(f=this.parent)==null||f.drawLayer.updateProperties(p(this,bn),{root:{fill:o,"fill-opacity":c}}),(d=p(this,Dh))==null||d.updateColor(o)},i=this.color,l=p(this,cl);this.addCommands({cmd:a.bind(this,e,Ct._defaultOpacity),undo:a.bind(this,i,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},d4=function(e){const a=p(this,ai),i=l=>{w(this,ai,l),D(this,et,p4).call(this,l)};this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},p4=function(e){if(!p(this,ta))return;D(this,et,ym).call(this,{highlightOutlines:p(this,ri).getNewOutline(e/2)}),this.fixAndSetPosition();const[a,i]=this.parentDimensions;this.setDims(this.width*a,this.height*i)},mA=function(){p(this,bn)===null||!this.parent||(this.parent.drawLayer.remove(p(this,bn)),w(this,bn,null),this.parent.drawLayer.remove(p(this,xa)),w(this,xa,null))},fc=function(e=this.parent){p(this,bn)===null&&({id:ka(this,bn)._,clipPathId:ka(this,lu)._}=e.drawLayer.draw({bbox:p(this,ri).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":p(this,cl)},rootClass:{highlight:!0,free:p(this,ta)},path:{d:p(this,ri).toSVGPath()}},!1,!0),w(this,xa,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:p(this,ta)},bbox:p(this,sn).box,path:{d:p(this,sn).toSVGPath()}},p(this,ta))),p(this,ou)&&(p(this,ou).style.clipPath=p(this,lu)))},li=new WeakSet,Cf=function([e,a,i,l],o){switch(o){case 90:return[1-a-l,e,l,i];case 180:return[1-e-i,1-a-l,i,l];case 270:return[a,1-e-i,l,i]}return[e,a,i,l]},g4=function(e){Ct._keyboardManager.exec(this,e)},Tm=function(e){if(!p(this,Oh))return;const a=window.getSelection();e?a.setPosition(p(this,Oh),p(this,ag)):a.setPosition(p(this,ng),p(this,ig))},sd=function(){return p(this,ta)?this.rotation:0},m4=function(){if(p(this,ta))return null;const[e,a]=this.pageDimensions,[i,l]=this.pageTranslation,o=p(this,ol),c=new Float32Array(o.length*8);let f=0;for(const{x:d,y:g,width:m,height:v}of o){const _=d*e+i,A=(1-g)*a+l;c[f]=c[f+4]=_,c[f+1]=c[f+3]=A,c[f+2]=c[f+6]=_+m*e,c[f+5]=c[f+7]=A-v*a,f+=8}return c},x4=function(e){return p(this,ri).serialize(e,D(this,et,sd).call(this))},v4=function(e,a){this._freeHighlight.add(a)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},_4=function(e,a){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(a,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},E4=function(e){const{color:a}=this._initialData;return e.color.some((i,l)=>i!==a[l])},O(Ct,li),Xe(Ct,"_defaultColor",null),Xe(Ct,"_defaultOpacity",1),Xe(Ct,"_defaultThickness",12),Xe(Ct,"_type","highlight"),Xe(Ct,"_editorType",nt.HIGHLIGHT),Xe(Ct,"_freeHighlightId",-1),Xe(Ct,"_freeHighlight",null),Xe(Ct,"_freeHighlightClipId","");let Bm=Ct;var cu;class xF{constructor(){O(this,cu,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,a]of Object.entries(t))this.updateProperty(e,a)}updateSVGProperty(t,e){p(this,cu)[t]=e}toSVGProperties(){const t=p(this,cu);return w(this,cu,Object.create(null)),{root:t}}reset(){w(this,cu,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){Ut("Not implemented")}}cu=new WeakMap;var wn,Ih,jr,uu,fu,yo,To,So,hu,At,vA,_A,EA,ld,A4,Sm,od,Rf;const Ue=class Ue extends sr{constructor(e){super(e);O(this,At);O(this,wn,null);O(this,Ih);Xe(this,"_drawId",null);w(this,Ih,e.mustBeCommitted||!1),e.drawOutlines&&(D(this,At,vA).call(this,e),D(this,At,ld).call(this))}static _mergeSVGProperties(e,a){const i=new Set(Object.keys(e));for(const[l,o]of Object.entries(a))i.has(l)?Object.assign(e[l],o):e[l]=o;return e}static getDefaultDrawingOptions(e){Ut("Not implemented")}static get typesMap(){Ut("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,a){const i=this.typesMap.get(e);i&&this._defaultDrawingOptions.updateProperty(i,a),this._currentParent&&(p(Ue,jr).updateProperty(i,a),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,a){const i=this.constructor.typesMap.get(e);i&&this._updateProperty(e,i,a)}static get defaultPropertiesToUpdate(){const e=[],a=this._defaultDrawingOptions;for(const[i,l]of this.typesMap)e.push([i,a[l]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:a}=this;for(const[i,l]of this.constructor.typesMap)e.push([i,a[l]]);return e}_updateProperty(e,a,i){const l=this._drawingOptions,o=l[a],c=f=>{var g;l.updateProperty(a,f);const d=p(this,wn).updateProperty(a,f);d&&D(this,At,od).call(this,d),(g=this.parent)==null||g.drawLayer.updateProperties(this._drawId,l.toSVGProperties())};this.addCommands({cmd:c.bind(this,i),undo:c.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Ue._mergeSVGProperties(p(this,wn).getPathResizingSVGProperties(D(this,At,Sm).call(this)),{bbox:D(this,At,Rf).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Ue._mergeSVGProperties(p(this,wn).getPathResizedSVGProperties(D(this,At,Sm).call(this)),{bbox:D(this,At,Rf).call(this)}))}_onTranslating(e,a){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:D(this,At,Rf).call(this,e,a)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Ue._mergeSVGProperties(p(this,wn).getPathTranslatedSVGProperties(D(this,At,Sm).call(this),this.parentDimensions),{bbox:D(this,At,Rf).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,p(this,Ih)&&(w(this,Ih,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){D(this,At,EA).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(D(this,At,ld).call(this),D(this,At,od).call(this,p(this,wn).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var i;let a=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),D(this,At,EA).call(this)):e&&(this._uiManager.addShouldRescale(this),D(this,At,ld).call(this,e),a=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(e),a&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Ue._mergeSVGProperties({bbox:D(this,At,Rf).call(this)},p(this,wn).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&D(this,At,od).call(this,p(this,wn).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const a=document.createElement("div");e.append(a),a.setAttribute("aria-hidden","true"),a.className="internal";const[i,l]=this.parentDimensions;return this.setDims(this.width*i,this.height*l),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,a,i,l,o){Ut("Not implemented")}static startDrawing(e,a,i,l){var T;const{target:o,offsetX:c,offsetY:f,pointerId:d,pointerType:g}=l;if(p(Ue,To)&&p(Ue,To)!==g)return;const{viewport:{rotation:m}}=e,{width:v,height:_}=o.getBoundingClientRect(),A=w(Ue,uu,new AbortController),y=e.combinedSignal(A);if(p(Ue,yo)||w(Ue,yo,d),p(Ue,To)??w(Ue,To,g),window.addEventListener("pointerup",S=>{var R;p(Ue,yo)===S.pointerId?this._endDraw(S):(R=p(Ue,So))==null||R.delete(S.pointerId)},{signal:y}),window.addEventListener("pointercancel",S=>{var R;p(Ue,yo)===S.pointerId?this._currentParent.endDrawingSession():(R=p(Ue,So))==null||R.delete(S.pointerId)},{signal:y}),window.addEventListener("pointerdown",S=>{p(Ue,To)===S.pointerType&&((p(Ue,So)||w(Ue,So,new Set)).add(S.pointerId),p(Ue,jr).isCancellable()&&(p(Ue,jr).removeLastElement(),p(Ue,jr).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",Ui,{signal:y}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:y}),o.addEventListener("touchmove",S=>{S.timeStamp===p(Ue,hu)&&Nn(S)},{signal:y}),e.toggleDrawing(),(T=a._editorUndoBar)==null||T.hide(),p(Ue,jr)){e.drawLayer.updateProperties(this._currentDrawId,p(Ue,jr).startNew(c,f,v,_,m));return}a.updateUIForDefaultProperties(this),w(Ue,jr,this.createDrawerInstance(c,f,v,_,m)),w(Ue,fu,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(p(Ue,fu).toSVGProperties(),p(Ue,jr).defaultSVGProperties),!0,!1)}static _drawMove(e){var o;if(w(Ue,hu,-1),!p(Ue,jr))return;const{offsetX:a,offsetY:i,pointerId:l}=e;if(p(Ue,yo)===l){if(((o=p(Ue,So))==null?void 0:o.size)>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,p(Ue,jr).add(a,i)),w(Ue,hu,e.timeStamp),Nn(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,w(Ue,jr,null),w(Ue,fu,null),w(Ue,To,null),w(Ue,hu,NaN)),p(Ue,uu)&&(p(Ue,uu).abort(),w(Ue,uu,null),w(Ue,yo,NaN),w(Ue,So,null))}static _endDraw(e){const a=this._currentParent;if(a){if(a.toggleDrawing(!0),this._cleanup(!1),e&&a.drawLayer.updateProperties(this._currentDrawId,p(Ue,jr).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const i=p(Ue,jr),l=this._currentDrawId,o=i.getLastElement();a.addCommands({cmd:()=>{a.drawLayer.updateProperties(l,i.setLastElement(o))},undo:()=>{a.drawLayer.updateProperties(l,i.removeLastElement())},mustExec:!1,type:mt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const a=this._currentParent;if(!a)return null;if(a.toggleDrawing(!0),a.cleanUndoStack(mt.DRAW_STEP),!p(Ue,jr).isEmpty()){const{pageDimensions:[i,l],scale:o}=a,c=a.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:p(Ue,jr).getOutlines(i*o,l*o,o,this._INNER_MARGIN),drawingOptions:p(Ue,fu),mustBeCommitted:!e});return this._cleanup(!0),c}return a.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,a,i,l,o,c){Ut("Not implemented")}static async deserialize(e,a,i){var m,v;const{rawDims:{pageWidth:l,pageHeight:o,pageX:c,pageY:f}}=a.viewport,d=this.deserializeDraw(c,f,l,o,this._INNER_MARGIN,e),g=await super.deserialize(e,a,i);return g.createDrawingOptions(e),D(m=g,At,vA).call(m,{drawOutlines:d}),D(v=g,At,ld).call(v),g.onScaleChanging(),g.rotate(),g}serializeDraw(e){const[a,i]=this.pageTranslation,[l,o]=this.pageDimensions;return p(this,wn).serialize([a,i,l,o],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};wn=new WeakMap,Ih=new WeakMap,jr=new WeakMap,uu=new WeakMap,fu=new WeakMap,yo=new WeakMap,To=new WeakMap,So=new WeakMap,hu=new WeakMap,At=new WeakSet,vA=function({drawOutlines:e,drawId:a,drawingOptions:i}){w(this,wn,e),this._drawingOptions||(this._drawingOptions=i),a>=0?(this._drawId=a,this.parent.drawLayer.finalizeDraw(a,e.defaultProperties)):this._drawId=D(this,At,_A).call(this,e,this.parent),D(this,At,od).call(this,e.box)},_A=function(e,a){const{id:i}=a.drawLayer.draw(Ue._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return i},EA=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},ld=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=D(this,At,_A).call(this,p(this,wn),e)}},A4=function([e,a,i,l]){const{parentDimensions:[o,c],rotation:f}=this;switch(f){case 90:return[a,1-e,i*(c/o),l*(o/c)];case 180:return[1-e,1-a,i,l];case 270:return[1-a,e,i*(c/o),l*(o/c)];default:return[e,a,i,l]}},Sm=function(){const{x:e,y:a,width:i,height:l,parentDimensions:[o,c],rotation:f}=this;switch(f){case 90:return[1-a,e,i*(o/c),l*(c/o)];case 180:return[1-e,1-a,i,l];case 270:return[a,1-e,i*(o/c),l*(c/o)];default:return[e,a,i,l]}},od=function(e){if([this.x,this.y,this.width,this.height]=D(this,At,A4).call(this,e),this.div){this.fixAndSetPosition();const[a,i]=this.parentDimensions;this.setDims(this.width*a,this.height*i)}this._onResized()},Rf=function(){const{x:e,y:a,width:i,height:l,rotation:o,parentRotation:c,parentDimensions:[f,d]}=this;switch((o*4+c)/90){case 1:return[1-a-l,e,l,i];case 2:return[1-e-i,1-a-l,i,l];case 3:return[a,1-e-i,l,i];case 4:return[e,a-i*(f/d),l*(d/f),i*(f/d)];case 5:return[1-a,e,i*(f/d),l*(d/f)];case 6:return[1-e-l*(d/f),1-a,l*(d/f),i*(f/d)];case 7:return[a-i*(f/d),1-e-l*(d/f),i*(f/d),l*(d/f)];case 8:return[e-i,a-l,i,l];case 9:return[1-a,e-i,l,i];case 10:return[1-e,1-a,i,l];case 11:return[a-l,1-e,l,i];case 12:return[e-l*(d/f),a,l*(d/f),i*(f/d)];case 13:return[1-a-i*(f/d),e-l*(d/f),i*(f/d),l*(d/f)];case 14:return[1-e,1-a-i*(f/d),l*(d/f),i*(f/d)];case 15:return[a,1-e,i*(f/d),l*(d/f)];default:return[e,a,i,l]}},Xe(Ue,"_currentDrawId",-1),Xe(Ue,"_currentParent",null),O(Ue,jr,null),O(Ue,uu,null),O(Ue,fu,null),O(Ue,yo,NaN),O(Ue,To,null),O(Ue,So,null),O(Ue,hu,NaN),Xe(Ue,"_INNER_MARGIN",3);let xA=Ue;var us,Yr,Xr,du,Fh,Na,ra,ni,pu,gu,mu,Lh,bm;class vF{constructor(t,e,a,i,l,o){O(this,Lh);O(this,us,new Float64Array(6));O(this,Yr);O(this,Xr);O(this,du);O(this,Fh);O(this,Na);O(this,ra,"");O(this,ni,0);O(this,pu,new Um);O(this,gu);O(this,mu);w(this,gu,a),w(this,mu,i),w(this,du,l),w(this,Fh,o),[t,e]=D(this,Lh,bm).call(this,t,e);const c=w(this,Yr,[NaN,NaN,NaN,NaN,t,e]);w(this,Na,[t,e]),w(this,Xr,[{line:c,points:p(this,Na)}]),p(this,us).set(c,0)}updateProperty(t,e){t==="stroke-width"&&w(this,Fh,e)}isEmpty(){return!p(this,Xr)||p(this,Xr).length===0}isCancellable(){return p(this,Na).length<=10}add(t,e){[t,e]=D(this,Lh,bm).call(this,t,e);const[a,i,l,o]=p(this,us).subarray(2,6),c=t-l,f=e-o;return Math.hypot(p(this,gu)*c,p(this,mu)*f)<=2?null:(p(this,Na).push(t,e),isNaN(a)?(p(this,us).set([l,o,t,e],2),p(this,Yr).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(p(this,us)[0])&&p(this,Yr).splice(6,6),p(this,us).set([a,i,l,o,t,e],0),p(this,Yr).push(...Pe.createBezierPoints(a,i,l,o,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const a=this.add(t,e);return a||(p(this,Na).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,a,i,l){w(this,gu,a),w(this,mu,i),w(this,du,l),[t,e]=D(this,Lh,bm).call(this,t,e);const o=w(this,Yr,[NaN,NaN,NaN,NaN,t,e]);w(this,Na,[t,e]);const c=p(this,Xr).at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),p(this,Xr).push({line:o,points:p(this,Na)}),p(this,us).set(o,0),w(this,ni,0),this.toSVGPath(),null}getLastElement(){return p(this,Xr).at(-1)}setLastElement(t){return p(this,Xr)?(p(this,Xr).push(t),w(this,Yr,t.line),w(this,Na,t.points),w(this,ni,0),{path:{d:this.toSVGPath()}}):p(this,pu).setLastElement(t)}removeLastElement(){if(!p(this,Xr))return p(this,pu).removeLastElement();p(this,Xr).pop(),w(this,ra,"");for(let t=0,e=p(this,Xr).length;t<e;t++){const{line:a,points:i}=p(this,Xr)[t];w(this,Yr,a),w(this,Na,i),w(this,ni,0),this.toSVGPath()}return{path:{d:p(this,ra)}}}toSVGPath(){const t=Pe.svgRound(p(this,Yr)[4]),e=Pe.svgRound(p(this,Yr)[5]);if(p(this,Na).length===2)return w(this,ra,`${p(this,ra)} M ${t} ${e} Z`),p(this,ra);if(p(this,Na).length<=6){const i=p(this,ra).lastIndexOf("M");w(this,ra,`${p(this,ra).slice(0,i)} M ${t} ${e}`),w(this,ni,6)}if(p(this,Na).length===4){const i=Pe.svgRound(p(this,Yr)[10]),l=Pe.svgRound(p(this,Yr)[11]);return w(this,ra,`${p(this,ra)} L ${i} ${l}`),w(this,ni,12),p(this,ra)}const a=[];p(this,ni)===0&&(a.push(`M ${t} ${e}`),w(this,ni,6));for(let i=p(this,ni),l=p(this,Yr).length;i<l;i+=6){const[o,c,f,d,g,m]=p(this,Yr).slice(i,i+6).map(Pe.svgRound);a.push(`C${o} ${c} ${f} ${d} ${g} ${m}`)}return w(this,ra,p(this,ra)+a.join(" ")),w(this,ni,p(this,Yr).length),p(this,ra)}getOutlines(t,e,a,i){const l=p(this,Xr).at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),p(this,pu).build(p(this,Xr),t,e,a,p(this,du),p(this,Fh),i),w(this,us,null),w(this,Yr,null),w(this,Xr,null),w(this,ra,null),p(this,pu)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}us=new WeakMap,Yr=new WeakMap,Xr=new WeakMap,du=new WeakMap,Fh=new WeakMap,Na=new WeakMap,ra=new WeakMap,ni=new WeakMap,pu=new WeakMap,gu=new WeakMap,mu=new WeakMap,Lh=new WeakSet,bm=function(t,e){return Pe._normalizePoint(t,e,p(this,gu),p(this,mu),p(this,du))};var Ma,lg,og,Cn,fs,hs,Ph,Bh,Uh,na,Hs,y4,T4,S4;const My=class My extends Pe{constructor(){super(...arguments);O(this,na);O(this,Ma);O(this,lg,0);O(this,og);O(this,Cn);O(this,fs);O(this,hs);O(this,Ph);O(this,Bh);O(this,Uh)}build(e,a,i,l,o,c,f){w(this,fs,a),w(this,hs,i),w(this,Ph,l),w(this,Bh,o),w(this,Uh,c),w(this,og,f??0),w(this,Cn,e),D(this,na,T4).call(this)}setLastElement(e){return p(this,Cn).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return p(this,Cn).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:a}of p(this,Cn)){if(e.push(`M${Pe.svgRound(a[4])} ${Pe.svgRound(a[5])}`),a.length===6){e.push("Z");continue}if(a.length===12){e.push(`L${Pe.svgRound(a[10])} ${Pe.svgRound(a[11])}`);continue}for(let i=6,l=a.length;i<l;i+=6){const[o,c,f,d,g,m]=a.subarray(i,i+6).map(Pe.svgRound);e.push(`C${o} ${c} ${f} ${d} ${g} ${m}`)}}return e.join("")}serialize([e,a,i,l],o){const c=[],f=[],[d,g,m,v]=D(this,na,y4).call(this);let _,A,y,T,S,R,C,F,U;switch(p(this,Bh)){case 0:U=Pe._rescale,_=e,A=a+l,y=i,T=-l,S=e+d*i,R=a+(1-g-v)*l,C=e+(d+m)*i,F=a+(1-g)*l;break;case 90:U=Pe._rescaleAndSwap,_=e,A=a,y=i,T=l,S=e+g*i,R=a+d*l,C=e+(g+v)*i,F=a+(d+m)*l;break;case 180:U=Pe._rescale,_=e+i,A=a,y=-i,T=l,S=e+(1-d-m)*i,R=a+g*l,C=e+(1-d)*i,F=a+(g+v)*l;break;case 270:U=Pe._rescaleAndSwap,_=e+i,A=a+l,y=-i,T=-l,S=e+(1-g-v)*i,R=a+(1-d-m)*l,C=e+(1-g)*i,F=a+(1-d)*l;break}for(const{line:B,points:k}of p(this,Cn))c.push(U(B,_,A,y,T,o?new Array(B.length):null)),f.push(U(k,_,A,y,T,o?new Array(k.length):null));return{lines:c,points:f,rect:[S,R,C,F]}}static deserialize(e,a,i,l,o,{paths:{lines:c,points:f},rotation:d,thickness:g}){const m=[];let v,_,A,y,T;switch(d){case 0:T=Pe._rescale,v=-e/i,_=a/l+1,A=1/i,y=-1/l;break;case 90:T=Pe._rescaleAndSwap,v=-a/l,_=-e/i,A=1/l,y=1/i;break;case 180:T=Pe._rescale,v=e/i+1,_=-a/l,A=-1/i,y=1/l;break;case 270:T=Pe._rescaleAndSwap,v=a/l+1,_=e/i+1,A=-1/l,y=-1/i;break}if(!c){c=[];for(const R of f){const C=R.length;if(C===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,R[0],R[1]]));continue}if(C===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,R[0],R[1],NaN,NaN,NaN,NaN,R[2],R[3]]));continue}const F=new Float32Array(3*(C-2));c.push(F);let[U,B,k,J]=R.subarray(0,4);F.set([NaN,NaN,NaN,NaN,U,B],0);for(let j=4;j<C;j+=2){const ie=R[j],Q=R[j+1];F.set(Pe.createBezierPoints(U,B,k,J,ie,Q),(j-2)*3),[U,B,k,J]=[k,J,ie,Q]}}}for(let R=0,C=c.length;R<C;R++)m.push({line:T(c[R].map(F=>F??NaN),v,_,A,y),points:T(f[R].map(F=>F??NaN),v,_,A,y)});const S=new My;return S.build(m,i,l,1,d,g,o),S}get box(){return p(this,Ma)}updateProperty(e,a){return e==="stroke-width"?D(this,na,S4).call(this,a):null}updateParentDimensions([e,a],i){const[l,o]=D(this,na,Hs).call(this);w(this,fs,e),w(this,hs,a),w(this,Ph,i);const[c,f]=D(this,na,Hs).call(this),d=c-l,g=f-o,m=p(this,Ma);return m[0]-=d,m[1]-=g,m[2]+=2*d,m[3]+=2*g,m}updateRotation(e){return w(this,lg,e),{path:{transform:this.rotationTransform}}}get viewBox(){return p(this,Ma).map(Pe.svgRound).join(" ")}get defaultProperties(){const[e,a]=p(this,Ma);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Pe.svgRound(e)} ${Pe.svgRound(a)}`}}}get rotationTransform(){const[,,e,a]=p(this,Ma);let i=0,l=0,o=0,c=0,f=0,d=0;switch(p(this,lg)){case 90:l=a/e,o=-e/a,f=e;break;case 180:i=-1,c=-1,f=e,d=a;break;case 270:l=-a/e,o=e/a,d=a;break;default:return""}return`matrix(${i} ${l} ${o} ${c} ${Pe.svgRound(f)} ${Pe.svgRound(d)})`}getPathResizingSVGProperties([e,a,i,l]){const[o,c]=D(this,na,Hs).call(this),[f,d,g,m]=p(this,Ma);if(Math.abs(g-o)<=Pe.PRECISION||Math.abs(m-c)<=Pe.PRECISION){const T=e+i/2-(f+g/2),S=a+l/2-(d+m/2);return{path:{"transform-origin":`${Pe.svgRound(e)} ${Pe.svgRound(a)}`,transform:`${this.rotationTransform} translate(${T} ${S})`}}}const v=(i-2*o)/(g-2*o),_=(l-2*c)/(m-2*c),A=g/i,y=m/l;return{path:{"transform-origin":`${Pe.svgRound(f)} ${Pe.svgRound(d)}`,transform:`${this.rotationTransform} scale(${A} ${y}) translate(${Pe.svgRound(o)} ${Pe.svgRound(c)}) scale(${v} ${_}) translate(${Pe.svgRound(-o)} ${Pe.svgRound(-c)})`}}}getPathResizedSVGProperties([e,a,i,l]){const[o,c]=D(this,na,Hs).call(this),f=p(this,Ma),[d,g,m,v]=f;if(f[0]=e,f[1]=a,f[2]=i,f[3]=l,Math.abs(m-o)<=Pe.PRECISION||Math.abs(v-c)<=Pe.PRECISION){const S=e+i/2-(d+m/2),R=a+l/2-(g+v/2);for(const{line:C,points:F}of p(this,Cn))Pe._translate(C,S,R,C),Pe._translate(F,S,R,F);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Pe.svgRound(e)} ${Pe.svgRound(a)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const _=(i-2*o)/(m-2*o),A=(l-2*c)/(v-2*c),y=-_*(d+o)+e+o,T=-A*(g+c)+a+c;if(_!==1||A!==1||y!==0||T!==0)for(const{line:S,points:R}of p(this,Cn))Pe._rescale(S,y,T,_,A,S),Pe._rescale(R,y,T,_,A,R);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Pe.svgRound(e)} ${Pe.svgRound(a)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,a],i){const[l,o]=i,c=p(this,Ma),f=e-c[0],d=a-c[1];if(p(this,fs)===l&&p(this,hs)===o)for(const{line:g,points:m}of p(this,Cn))Pe._translate(g,f,d,g),Pe._translate(m,f,d,m);else{const g=p(this,fs)/l,m=p(this,hs)/o;w(this,fs,l),w(this,hs,o);for(const{line:v,points:_}of p(this,Cn))Pe._rescale(v,f,d,g,m,v),Pe._rescale(_,f,d,g,m,_);c[2]*=g,c[3]*=m}return c[0]=e,c[1]=a,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Pe.svgRound(e)} ${Pe.svgRound(a)}`}}}get defaultSVGProperties(){const e=p(this,Ma);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Pe.svgRound(e[0])} ${Pe.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}};Ma=new WeakMap,lg=new WeakMap,og=new WeakMap,Cn=new WeakMap,fs=new WeakMap,hs=new WeakMap,Ph=new WeakMap,Bh=new WeakMap,Uh=new WeakMap,na=new WeakSet,Hs=function(e=p(this,Uh)){const a=p(this,og)+e/2*p(this,Ph);return p(this,Bh)%180===0?[a/p(this,fs),a/p(this,hs)]:[a/p(this,hs),a/p(this,fs)]},y4=function(){const[e,a,i,l]=p(this,Ma),[o,c]=D(this,na,Hs).call(this,0);return[e+o,a+c,i-2*o,l-2*c]},T4=function(){const e=w(this,Ma,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:l}of p(this,Cn)){if(l.length<=12){for(let f=4,d=l.length;f<d;f+=6){const[g,m]=l.subarray(f,f+2);e[0]=Math.min(e[0],g),e[1]=Math.min(e[1],m),e[2]=Math.max(e[2],g),e[3]=Math.max(e[3],m)}continue}let o=l[4],c=l[5];for(let f=6,d=l.length;f<d;f+=6){const[g,m,v,_,A,y]=l.subarray(f,f+6);Ve.bezierBoundingBox(o,c,g,m,v,_,A,y,e),o=A,c=y}}const[a,i]=D(this,na,Hs).call(this);e[0]=Math.min(1,Math.max(0,e[0]-a)),e[1]=Math.min(1,Math.max(0,e[1]-i)),e[2]=Math.min(1,Math.max(0,e[2]+a)),e[3]=Math.min(1,Math.max(0,e[3]+i)),e[2]-=e[0],e[3]-=e[1]},S4=function(e){const[a,i]=D(this,na,Hs).call(this);w(this,Uh,e);const[l,o]=D(this,na,Hs).call(this),[c,f]=[l-a,o-i],d=p(this,Ma);return d[0]-=c,d[1]-=f,d[2]+=2*c,d[3]+=2*f,d};let Um=My;var Hh;const Iy=class Iy extends xF{constructor(e){super();O(this,Hh);w(this,Hh,e),super.updateProperties({fill:"none",stroke:sr._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,a){e==="stroke-width"&&(a??(a=this["stroke-width"]),a*=p(this,Hh).realScale),super.updateSVGProperty(e,a)}clone(){const e=new Iy(p(this,Hh));return e.updateAll(this),e}};Hh=new WeakMap;let AA=Iy;var px,b4;const Mf=class Mf extends xA{constructor(e){super({...e,name:"inkEditor"});O(this,px);this._willKeepAspectRatio=!0}static initialize(e,a){sr.initialize(e,a),this._defaultDrawingOptions=new AA(a.viewParameters)}static getDefaultDrawingOptions(e){const a=this._defaultDrawingOptions.clone();return a.updateProperties(e),a}static get supportMultipleDrawings(){return!0}static get typesMap(){return ut(this,"typesMap",new Map([[mt.INK_THICKNESS,"stroke-width"],[mt.INK_COLOR,"stroke"],[mt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,a,i,l,o){return new vF(e,a,i,l,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,a,i,l,o,c){return Um.deserialize(e,a,i,l,o,c)}static async deserialize(e,a,i){let l=null;if(e instanceof ty){const{data:{inkLists:c,rect:f,rotation:d,id:g,color:m,opacity:v,borderStyle:{rawWidth:_},popupRef:A},parent:{page:{pageNumber:y}}}=e;l=e={annotationType:nt.INK,color:Array.from(m),thickness:_,opacity:v,paths:{points:c},boxes:null,pageIndex:y-1,rect:f.slice(0),rotation:d,id:g,deleted:!1,popupRef:A}}const o=await super.deserialize(e,a,i);return o.annotationElementId=e.id||null,o._initialData=l,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:a,parent:i}=this;a.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(e,a.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:a,opacity:i}){this._drawingOptions=Mf.getDefaultDrawingOptions({stroke:Ve.makeHexColor(...e),"stroke-width":a,"stroke-opacity":i})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:a,points:i,rect:l}=this.serializeDraw(e),{_drawingOptions:{stroke:o,"stroke-opacity":c,"stroke-width":f}}=this,d={annotationType:nt.INK,color:sr._colorManager.convert(o),opacity:c,thickness:f,paths:{lines:a,points:i},pageIndex:this.pageIndex,rect:l,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?d:this.annotationElementId&&!D(this,px,b4).call(this,d)?null:(d.id=this.annotationElementId,d)}renderAnnotationElement(e){const{points:a,rect:i}=this.serializeDraw(!1);return e.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:a}),null}};px=new WeakSet,b4=function(e){const{color:a,thickness:i,opacity:l,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((c,f)=>c!==a[f])||e.thickness!==i||e.opacity!==l||e.pageIndex!==o},Xe(Mf,"_type","ink"),Xe(Mf,"_editorType",nt.INK),Xe(Mf,"_defaultDrawingOptions",null);let yA=Mf;var nr,aa,bo,ul,wo,zh,ds,ps,Rn,Gh,St,cd,ud,wm,SA,Cm,bA,Rm,w4;const wd=class wd extends sr{constructor(e){super({...e,name:"stampEditor"});O(this,St);O(this,nr,null);O(this,aa,null);O(this,bo,null);O(this,ul,null);O(this,wo,null);O(this,zh,"");O(this,ds,null);O(this,ps,null);O(this,Rn,!1);O(this,Gh,!1);w(this,ul,e.bitmapUrl),w(this,wo,e.bitmapFile)}static initialize(e,a){sr.initialize(e,a)}static get supportedTypes(){return ut(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(a=>`image/${a}`))}static get supportedTypesStr(){return ut(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,a){a.pasteEditor(nt.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const a=e.get("hasAltText");return{hasAltText:a.get(!0)??0,hasNoAltText:a.get(!1)??0}}async mlGuessAltText(e=null,a=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:l,width:o,height:c}=e||this.copyCanvas(null,null,!0).imageData,f=await i.guess({name:"altText",request:{data:l,width:o,height:c,channels:l.length/(o*c)}});if(!f)throw new Error("No response from the AI service.");if(f.error)throw new Error("Error from the AI service.");if(f.cancel)return null;if(!f.output)throw new Error("No valid response from the AI service.");const d=f.output;return await this.setGuessedAltText(d),a&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}remove(){var e;p(this,aa)&&(w(this,nr,null),this._uiManager.imageManager.deleteId(p(this,aa)),(e=p(this,ds))==null||e.remove(),w(this,ds,null),p(this,ps)&&(clearTimeout(p(this,ps)),w(this,ps,null))),super.remove()}rebuild(){if(!this.parent){p(this,aa)&&D(this,St,wm).call(this);return}super.rebuild(),this.div!==null&&(p(this,aa)&&p(this,ds)===null&&D(this,St,wm).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(p(this,bo)||p(this,nr)||p(this,ul)||p(this,wo)||p(this,aa))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,a;if(this.width&&(e=this.x,a=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),p(this,nr)?D(this,St,SA).call(this):D(this,St,wm).call(this),this.width&&!this.annotationElementId){const[i,l]=this.parentDimensions;this.setAt(e*i,a*l,this.width*i,this.height*l)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;p(this,ps)!==null&&clearTimeout(p(this,ps)),w(this,ps,setTimeout(()=>{w(this,ps,null),D(this,St,bA).call(this)},200))}copyCanvas(e,a,i=!1){var _;e||(e=224);const{width:l,height:o}=p(this,nr),c=new AE;let f=p(this,nr),d=l,g=o,m=null;if(a){if(l>a||o>a){const J=Math.min(a/l,a/o);d=Math.floor(l*J),g=Math.floor(o*J)}m=document.createElement("canvas");const A=m.width=Math.ceil(d*c.sx),y=m.height=Math.ceil(g*c.sy);p(this,Rn)||(f=D(this,St,Cm).call(this,A,y));const T=m.getContext("2d");T.filter=this._uiManager.hcmFilter;let S="white",R="#cfcfd8";this._uiManager.hcmFilter!=="none"?R="black":(_=window.matchMedia)!=null&&_.call(window,"(prefers-color-scheme: dark)").matches&&(S="#8f8f9d",R="#42414d");const C=15,F=C*c.sx,U=C*c.sy,B=new OffscreenCanvas(F*2,U*2),k=B.getContext("2d");k.fillStyle=S,k.fillRect(0,0,F*2,U*2),k.fillStyle=R,k.fillRect(0,0,F,U),k.fillRect(F,U,F,U),T.fillStyle=T.createPattern(B,"repeat"),T.fillRect(0,0,A,y),T.drawImage(f,0,0,f.width,f.height,0,0,A,y)}let v=null;if(i){let A,y;if(c.symmetric&&f.width<e&&f.height<e)A=f.width,y=f.height;else if(f=p(this,nr),l>e||o>e){const R=Math.min(e/l,e/o);A=Math.floor(l*R),y=Math.floor(o*R),p(this,Rn)||(f=D(this,St,Cm).call(this,A,y))}const S=new OffscreenCanvas(A,y).getContext("2d",{willReadFrequently:!0});S.drawImage(f,0,0,f.width,f.height,0,0,A,y),v={width:A,height:y,data:S.getImageData(0,0,A,y).data}}return{canvas:m,width:d,height:g,imageData:v}}getImageForAltText(){return p(this,ds)}static async deserialize(e,a,i){var y;let l=null;if(e instanceof qk){const{data:{rect:T,rotation:S,id:R,structParent:C,popupRef:F},container:U,parent:{page:{pageNumber:B}}}=e,k=U.querySelector("canvas"),J=i.imageManager.getFromCanvas(U.id,k);k.remove();const j=((y=await a._structTree.getAriaAttributes(`${qA}${R}`))==null?void 0:y.get("aria-label"))||"";l=e={annotationType:nt.STAMP,bitmapId:J.id,bitmap:J.bitmap,pageIndex:B-1,rect:T.slice(0),rotation:S,id:R,deleted:!1,accessibilityData:{decorative:!1,altText:j},isSvg:!1,structParent:C,popupRef:F}}const o=await super.deserialize(e,a,i),{rect:c,bitmap:f,bitmapUrl:d,bitmapId:g,isSvg:m,accessibilityData:v}=e;g&&i.imageManager.isValidId(g)?(w(o,aa,g),f&&w(o,nr,f)):w(o,ul,d),w(o,Rn,m);const[_,A]=o.pageDimensions;return o.width=(c[2]-c[0])/_,o.height=(c[3]-c[1])/A,o.annotationElementId=e.id||null,v&&(o.altTextData=v),o._initialData=l,w(o,Gh,!!l),o}serialize(e=!1,a=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:nt.STAMP,bitmapId:p(this,aa),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:p(this,Rn),structTreeParentId:this._structTreeParentId};if(e)return i.bitmapUrl=D(this,St,Rm).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:l,altText:o}=this.serializeAltText(!1);if(!l&&o&&(i.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const f=D(this,St,w4).call(this,i);if(f.isSame)return null;f.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,a===null)return i;a.stamps||(a.stamps=new Map);const c=p(this,Rn)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!a.stamps.has(p(this,aa)))a.stamps.set(p(this,aa),{area:c,serialized:i}),i.bitmap=D(this,St,Rm).call(this,!1);else if(p(this,Rn)){const f=a.stamps.get(p(this,aa));c>f.area&&(f.area=c,f.serialized.bitmap.close(),f.serialized.bitmap=D(this,St,Rm).call(this,!1))}return i}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}};nr=new WeakMap,aa=new WeakMap,bo=new WeakMap,ul=new WeakMap,wo=new WeakMap,zh=new WeakMap,ds=new WeakMap,ps=new WeakMap,Rn=new WeakMap,Gh=new WeakMap,St=new WeakSet,cd=function(e,a=!1){if(!e){this.remove();return}w(this,nr,e.bitmap),a||(w(this,aa,e.id),w(this,Rn,e.isSvg)),e.file&&w(this,zh,e.file.name),D(this,St,SA).call(this)},ud=function(){if(w(this,bo,null),this._uiManager.enableWaiting(!1),!!p(this,ds)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&p(this,nr)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&p(this,nr)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},wm=function(){if(p(this,aa)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(p(this,aa)).then(i=>D(this,St,cd).call(this,i,!0)).finally(()=>D(this,St,ud).call(this));return}if(p(this,ul)){const i=p(this,ul);w(this,ul,null),this._uiManager.enableWaiting(!0),w(this,bo,this._uiManager.imageManager.getFromUrl(i).then(l=>D(this,St,cd).call(this,l)).finally(()=>D(this,St,ud).call(this)));return}if(p(this,wo)){const i=p(this,wo);w(this,wo,null),this._uiManager.enableWaiting(!0),w(this,bo,this._uiManager.imageManager.getFromFile(i).then(l=>D(this,St,cd).call(this,l)).finally(()=>D(this,St,ud).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=wd.supportedTypesStr;const a=this._uiManager._signal;w(this,bo,new Promise(i=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const l=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),D(this,St,cd).call(this,l)}i()},{signal:a}),e.addEventListener("cancel",()=>{this.remove(),i()},{signal:a})}).finally(()=>D(this,St,ud).call(this))),e.click()},SA=function(){var m;const{div:e}=this;let{width:a,height:i}=p(this,nr);const[l,o]=this.pageDimensions,c=.75;if(this.width)a=this.width*l,i=this.height*o;else if(a>c*l||i>c*o){const v=Math.min(c*l/a,c*o/i);a*=v,i*=v}const[f,d]=this.parentDimensions;this.setDims(a*f/l,i*d/o),this._uiManager.enableWaiting(!1);const g=w(this,ds,document.createElement("canvas"));g.setAttribute("role","img"),this.addContainer(g),this.width=a/l,this.height=i/o,(m=this._initialOptions)!=null&&m.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),D(this,St,bA).call(this),p(this,Gh)||(this.parent.addUndoableEditor(this),w(this,Gh,!0)),this._reportTelemetry({action:"inserted_image"}),p(this,zh)&&g.setAttribute("aria-label",p(this,zh))},Cm=function(e,a){const{width:i,height:l}=p(this,nr);let o=i,c=l,f=p(this,nr);for(;o>2*e||c>2*a;){const d=o,g=c;o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),c>2*a&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const m=new OffscreenCanvas(o,c);m.getContext("2d").drawImage(f,0,0,d,g,0,0,o,c),f=m.transferToImageBitmap()}return f},bA=function(){const[e,a]=this.parentDimensions,{width:i,height:l}=this,o=new AE,c=Math.ceil(i*e*o.sx),f=Math.ceil(l*a*o.sy),d=p(this,ds);if(!d||d.width===c&&d.height===f)return;d.width=c,d.height=f;const g=p(this,Rn)?p(this,nr):D(this,St,Cm).call(this,c,f),m=d.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(g,0,0,g.width,g.height,0,0,c,f)},Rm=function(e){if(e){if(p(this,Rn)){const l=this._uiManager.imageManager.getSvgUrl(p(this,aa));if(l)return l}const a=document.createElement("canvas");return{width:a.width,height:a.height}=p(this,nr),a.getContext("2d").drawImage(p(this,nr),0,0),a.toDataURL()}if(p(this,Rn)){const[a,i]=this.pageDimensions,l=Math.round(this.width*a*Fo.PDF_TO_CSS_UNITS),o=Math.round(this.height*i*Fo.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(l,o);return c.getContext("2d").drawImage(p(this,nr),0,0,p(this,nr).width,p(this,nr).height,0,0,l,o),c.transferToImageBitmap()}return structuredClone(p(this,nr))},w4=function(e){var c;const{pageIndex:a,accessibilityData:{altText:i}}=this._initialData,l=e.pageIndex===a,o=(((c=e.accessibilityData)==null?void 0:c.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&l&&o,isSameAltText:o}},Xe(wd,"_type","stamp"),Xe(wd,"_editorType",nt.STAMP);let TA=wd;var xu,Vh,gs,Co,fl,ii,Ro,jh,vu,Ni,hl,va,dl,Ge,ko,er,C4,Qi,CA,RA,km;const Ei=class Ei{constructor({uiManager:t,pageIndex:e,div:a,structTreeLayer:i,accessibilityManager:l,annotationLayer:o,drawLayer:c,textLayer:f,viewport:d,l10n:g}){O(this,er);O(this,xu);O(this,Vh,!1);O(this,gs,null);O(this,Co,null);O(this,fl,null);O(this,ii,new Map);O(this,Ro,!1);O(this,jh,!1);O(this,vu,!1);O(this,Ni,null);O(this,hl,null);O(this,va,null);O(this,dl,null);O(this,Ge);const m=[...p(Ei,ko).values()];if(!Ei._initialized){Ei._initialized=!0;for(const v of m)v.initialize(g,t)}t.registerEditorTypes(m),w(this,Ge,t),this.pageIndex=e,this.div=a,w(this,xu,l),w(this,gs,o),this.viewport=d,w(this,va,f),this.drawLayer=c,this._structTree=i,p(this,Ge).addLayer(this)}get isEmpty(){return p(this,ii).size===0}get isInvisible(){return this.isEmpty&&p(this,Ge).getMode()===nt.NONE}updateToolbar(t){p(this,Ge).updateToolbar(t)}updateMode(t=p(this,Ge).getMode()){switch(D(this,er,km).call(this),t){case nt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case nt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case nt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const a of p(Ei,ko).values())e.toggle(`${a._type}Editing`,t===a._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=p(this,va))==null?void 0:e.div)}setEditingState(t){p(this,Ge).setEditingState(t)}addCommands(t){p(this,Ge).addCommands(t)}cleanUndoStack(t){p(this,Ge).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=p(this,gs))==null||e.div.classList.toggle("disabled",!t)}async enable(){w(this,vu,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const a of p(this,ii).values())a.enableEditing(),a.show(!0),a.annotationElementId&&(p(this,Ge).removeChangedExistingAnnotation(a),t.add(a.annotationElementId));if(!p(this,gs)){w(this,vu,!1);return}const e=p(this,gs).getEditableAnnotations();for(const a of e){if(a.hide(),p(this,Ge).isDeletedAnnotationElement(a.data.id)||t.has(a.data.id))continue;const i=await this.deserialize(a);i&&(this.addOrRebuild(i),i.enableEditing())}w(this,vu,!1)}disable(){var i;w(this,jh,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const l of p(this,ii).values())if(l.disableEditing(),!!l.annotationElementId){if(l.serialize()!==null){t.set(l.annotationElementId,l);continue}else e.set(l.annotationElementId,l);(i=this.getEditableAnnotation(l.annotationElementId))==null||i.show(),l.remove()}if(p(this,gs)){const l=p(this,gs).getEditableAnnotations();for(const o of l){const{id:c}=o.data;if(p(this,Ge).isDeletedAnnotationElement(c))continue;let f=e.get(c);if(f){f.resetAnnotationElement(o),f.show(!1),o.show();continue}f=t.get(c),f&&(p(this,Ge).addChangedExistingAnnotation(f),f.renderAnnotationElement(o)&&f.show(!1)),o.show()}}D(this,er,km).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:a}=this.div;for(const l of p(Ei,ko).values())a.remove(`${l._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),w(this,jh,!1)}getEditableAnnotation(t){var e;return((e=p(this,gs))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){p(this,Ge).getActive()!==t&&p(this,Ge).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=p(this,va))!=null&&t.div&&!p(this,dl)){w(this,dl,new AbortController);const e=p(this,Ge).combinedSignal(p(this,dl));p(this,va).div.addEventListener("pointerdown",D(this,er,C4).bind(this),{signal:e}),p(this,va).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=p(this,va))!=null&&t.div&&p(this,dl)&&(p(this,dl).abort(),w(this,dl,null),p(this,va).div.classList.remove("highlighting"))}enableClick(){if(p(this,Co))return;w(this,Co,new AbortController);const t=p(this,Ge).combinedSignal(p(this,Co));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;(t=p(this,Co))==null||t.abort(),w(this,Co,null)}attach(t){p(this,ii).set(t.id,t);const{annotationElementId:e}=t;e&&p(this,Ge).isDeletedAnnotationElement(e)&&p(this,Ge).removeDeletedAnnotationElement(t)}detach(t){var e;p(this,ii).delete(t.id),(e=p(this,xu))==null||e.removePointerInTextLayer(t.contentDiv),!p(this,jh)&&t.annotationElementId&&p(this,Ge).addDeletedAnnotationElement(t)}remove(t){this.detach(t),p(this,Ge).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(p(this,Ge).addDeletedAnnotationElement(t.annotationElementId),sr.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),p(this,Ge).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!p(this,vu)),p(this,Ge).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var a;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!p(this,fl)&&(t._focusEventsAllowed=!1,w(this,fl,setTimeout(()=>{w(this,fl,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:p(this,Ge)._signal}),e.focus())},0))),t._structTreeParentId=(a=p(this,xu))==null?void 0:a.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),a=()=>{t.remove()};this.addCommands({cmd:e,undo:a,mustExec:!1})}getNextId(){return p(this,Ge).getId()}combinedSignal(t){return p(this,Ge).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=p(this,er,Qi))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,e){p(this,Ge).updateToolbar(t),p(this,Ge).updateMode(t);const{offsetX:a,offsetY:i}=D(this,er,RA).call(this),l=this.getNextId(),o=D(this,er,CA).call(this,{parent:this,id:l,x:a,y:i,uiManager:p(this,Ge),isCentered:!0,...e});o&&this.add(o)}async deserialize(t){var e;return await((e=p(Ei,ko).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,p(this,Ge)))||null}createAndAddNewEditor(t,e,a={}){const i=this.getNextId(),l=D(this,er,CA).call(this,{parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:p(this,Ge),isCentered:e,...a});return l&&this.add(l),l}addNewEditor(){this.createAndAddNewEditor(D(this,er,RA).call(this),!0)}setSelected(t){p(this,Ge).setSelected(t)}toggleSelected(t){p(this,Ge).toggleSelected(t)}unselect(t){p(this,Ge).unselect(t)}pointerup(t){var a;const{isMac:e}=Ua.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&p(this,Ro)&&(w(this,Ro,!1),!((a=p(this,er,Qi))!=null&&a.isDrawer&&p(this,er,Qi).supportMultipleDrawings))){if(!p(this,Vh)){w(this,Vh,!0);return}if(p(this,Ge).getMode()===nt.STAMP){p(this,Ge).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){var i;if(p(this,Ge).getMode()===nt.HIGHLIGHT&&this.enableTextSelection(),p(this,Ro)){w(this,Ro,!1);return}const{isMac:e}=Ua.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(w(this,Ro,!0),(i=p(this,er,Qi))!=null&&i.isDrawer){this.startDrawingSession(t);return}const a=p(this,Ge).getActive();w(this,Vh,!a||a.isEmpty())}startDrawingSession(t){if(this.div.focus(),p(this,Ni)){p(this,er,Qi).startDrawing(this,p(this,Ge),!1,t);return}p(this,Ge).setCurrentDrawingSession(this),w(this,Ni,new AbortController);const e=p(this,Ge).combinedSignal(p(this,Ni));this.div.addEventListener("blur",({relatedTarget:a})=>{a&&!this.div.contains(a)&&(w(this,hl,null),this.commitOrRemove())},{signal:e}),p(this,er,Qi).startDrawing(this,p(this,Ge),!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&w(this,hl,e);return}p(this,hl)&&setTimeout(()=>{var e;(e=p(this,hl))==null||e.focus(),w(this,hl,null)},0)}endDrawingSession(t=!1){return p(this,Ni)?(p(this,Ge).setCurrentDrawingSession(null),p(this,Ni).abort(),w(this,Ni,null),w(this,hl,null),p(this,er,Qi).endDrawing(t)):null}findNewParent(t,e,a){const i=p(this,Ge).findParent(e,a);return i===null||i===this?!1:(i.changeParent(t),!0)}commitOrRemove(){return p(this,Ni)?(this.endDrawingSession(),!0):!1}onScaleChanging(){p(this,Ni)&&p(this,er,Qi).onScaleChangingWhenDrawing(this)}destroy(){var t,e;this.commitOrRemove(),((t=p(this,Ge).getActive())==null?void 0:t.parent)===this&&(p(this,Ge).commitOrRemove(),p(this,Ge).setActiveEditor(null)),p(this,fl)&&(clearTimeout(p(this,fl)),w(this,fl,null));for(const a of p(this,ii).values())(e=p(this,xu))==null||e.removePointerInTextLayer(a.contentDiv),a.setParent(null),a.isAttachedToDOM=!1,a.div.remove();this.div=null,p(this,ii).clear(),p(this,Ge).removeLayer(this)}render({viewport:t}){this.viewport=t,yu(this.div,t);for(const e of p(this,Ge).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){p(this,Ge).commitOrRemove(),D(this,er,km).call(this);const e=this.viewport.rotation,a=t.rotation;if(this.viewport=t,yu(this.div,{rotation:a}),e!==a)for(const i of p(this,ii).values())i.rotate(a)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return p(this,Ge).viewParameters.realScale}};xu=new WeakMap,Vh=new WeakMap,gs=new WeakMap,Co=new WeakMap,fl=new WeakMap,ii=new WeakMap,Ro=new WeakMap,jh=new WeakMap,vu=new WeakMap,Ni=new WeakMap,hl=new WeakMap,va=new WeakMap,dl=new WeakMap,Ge=new WeakMap,ko=new WeakMap,er=new WeakSet,C4=function(t){p(this,Ge).unselectAll();const{target:e}=t;if(e===p(this,va).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&p(this,va).div.contains(e)){const{isMac:a}=Ua.platform;if(t.button!==0||t.ctrlKey&&a)return;p(this,Ge).showAllEditors("highlight",!0,!0),p(this,va).div.classList.add("free"),this.toggleDrawing(),Bm.startHighlighting(this,p(this,Ge).direction==="ltr",{target:p(this,va).div,x:t.x,y:t.y}),p(this,va).div.addEventListener("pointerup",()=>{p(this,va).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:p(this,Ge)._signal}),t.preventDefault()}},Qi=function(){return p(Ei,ko).get(p(this,Ge).getMode())},CA=function(t){const e=p(this,er,Qi);return e?new e.prototype.constructor(t):null},RA=function(){const{x:t,y:e,width:a,height:i}=this.div.getBoundingClientRect(),l=Math.max(0,t),o=Math.max(0,e),c=Math.min(window.innerWidth,t+a),f=Math.min(window.innerHeight,e+i),d=(l+c)/2-t,g=(o+f)/2-e,[m,v]=this.viewport.rotation%180===0?[d,g]:[g,d];return{offsetX:m,offsetY:v}},km=function(){for(const t of p(this,ii).values())t.isEmpty()&&t.remove()},Xe(Ei,"_initialized",!1),O(Ei,ko,new Map([lA,yA,TA,Bm].map(t=>[t._editorType,t])));let wA=Ei;var Mi,cg,Ia,_u,gx,R4,xs,OA,k4,DA;const pa=class pa{constructor({pageIndex:t}){O(this,xs);O(this,Mi,null);O(this,cg,0);O(this,Ia,new Map);O(this,_u,new Map);this.pageIndex=t}setParent(t){if(!p(this,Mi)){w(this,Mi,t);return}if(p(this,Mi)!==t){if(p(this,Ia).size>0)for(const e of p(this,Ia).values())e.remove(),t.append(e);w(this,Mi,t)}}static get _svgFactory(){return ut(this,"_svgFactory",new ey)}draw(t,e=!1,a=!1){const i=ka(this,cg)._++,l=D(this,xs,OA).call(this),o=pa._svgFactory.createElement("defs");l.append(o);const c=pa._svgFactory.createElement("path");o.append(c);const f=`path_p${this.pageIndex}_${i}`;c.setAttribute("id",f),c.setAttribute("vector-effect","non-scaling-stroke"),e&&p(this,_u).set(i,c);const d=a?D(this,xs,k4).call(this,o,f):null,g=pa._svgFactory.createElement("use");return l.append(g),g.setAttribute("href",`#${f}`),this.updateProperties(l,t),p(this,Ia).set(i,l),{id:i,clipPathId:`url(#${d})`}}drawOutline(t,e){const a=ka(this,cg)._++,i=D(this,xs,OA).call(this),l=pa._svgFactory.createElement("defs");i.append(l);const o=pa._svgFactory.createElement("path");l.append(o);const c=`path_p${this.pageIndex}_${a}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke");let f;if(e){const m=pa._svgFactory.createElement("mask");l.append(m),f=`mask_p${this.pageIndex}_${a}`,m.setAttribute("id",f),m.setAttribute("maskUnits","objectBoundingBox");const v=pa._svgFactory.createElement("rect");m.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const _=pa._svgFactory.createElement("use");m.append(_),_.setAttribute("href",`#${c}`),_.setAttribute("stroke","none"),_.setAttribute("fill","black"),_.setAttribute("fill-rule","nonzero"),_.classList.add("mask")}const d=pa._svgFactory.createElement("use");i.append(d),d.setAttribute("href",`#${c}`),f&&d.setAttribute("mask",`url(#${f})`);const g=d.cloneNode();return i.append(g),d.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(i,t),p(this,Ia).set(a,i),a}finalizeDraw(t,e){p(this,_u).delete(t),this.updateProperties(t,e)}updateProperties(t,e){var f;if(!e)return;const{root:a,bbox:i,rootClass:l,path:o}=e,c=typeof t=="number"?p(this,Ia).get(t):t;if(c){if(a&&D(this,xs,DA).call(this,c,a),i&&D(f=pa,gx,R4).call(f,c,i),l){const{classList:d}=c;for(const[g,m]of Object.entries(l))d.toggle(g,m)}if(o){const g=c.firstChild.firstChild;D(this,xs,DA).call(this,g,o)}}}updateParent(t,e){if(e===this)return;const a=p(this,Ia).get(t);a&&(p(e,Mi).append(a),p(this,Ia).delete(t),p(e,Ia).set(t,a))}remove(t){p(this,_u).delete(t),p(this,Mi)!==null&&(p(this,Ia).get(t).remove(),p(this,Ia).delete(t))}destroy(){w(this,Mi,null);for(const t of p(this,Ia).values())t.remove();p(this,Ia).clear(),p(this,_u).clear()}};Mi=new WeakMap,cg=new WeakMap,Ia=new WeakMap,_u=new WeakMap,gx=new WeakSet,R4=function(t,[e,a,i,l]){const{style:o}=t;o.top=`${100*a}%`,o.left=`${100*e}%`,o.width=`${100*i}%`,o.height=`${100*l}%`},xs=new WeakSet,OA=function(){const t=pa._svgFactory.create(1,1,!0);return p(this,Mi).append(t),t.setAttribute("aria-hidden",!0),t},k4=function(t,e){const a=pa._svgFactory.createElement("clipPath");t.append(a);const i=`clip_${e}`;a.setAttribute("id",i),a.setAttribute("clipPathUnits","objectBoundingBox");const l=pa._svgFactory.createElement("use");return a.append(l),l.setAttribute("href",`#${e}`),l.classList.add("clip"),i},DA=function(t,e){for(const[a,i]of Object.entries(e))i===null?t.removeAttribute(a):t.setAttribute(a,i)},O(pa,gx);let kA=pa;globalThis.pdfjsTestingUtils={HighlightOutliner:cA};Ke.AbortException;Ke.AnnotationEditorLayer;Ke.AnnotationEditorParamsType;Ke.AnnotationEditorType;Ke.AnnotationEditorUIManager;Ke.AnnotationLayer;Ke.AnnotationMode;Ke.ColorPicker;Ke.DOMSVGFactory;Ke.DrawLayer;Ke.FeatureTest;var _F=Ke.GlobalWorkerOptions;Ke.ImageKind;Ke.InvalidPDFException;Ke.MissingPDFException;Ke.OPS;Ke.OutputScale;Ke.PDFDataRangeTransport;Ke.PDFDateString;Ke.PDFWorker;Ke.PasswordResponses;Ke.PermissionFlag;Ke.PixelsPerInch;Ke.RenderingCancelledException;Ke.TextLayer;Ke.TouchManager;Ke.UnexpectedResponseException;Ke.Util;Ke.VerbosityLevel;Ke.XfaLayer;Ke.build;Ke.createValidAbsoluteUrl;Ke.fetchData;var EF=Ke.getDocument;Ke.getFilenameFromUrl;Ke.getPdfFilenameFromUrl;Ke.getXfaPageViewport;Ke.isDataScheme;Ke.isPdfFile;Ke.noContextMenu;Ke.normalizeUnicode;Ke.setLayerDimensions;Ke.shadow;Ke.stopEvent;Ke.version;_F.workerSrc="https://esm.sh/pdfjs-dist@4.10.38/build/pdf.worker.mjs";const AF=async r=>{const t=await r.arrayBuffer(),a=await EF({data:t}).promise;let i="";for(let l=1;l<=a.numPages;l++){const f=(await(await a.getPage(l)).getTextContent()).items.map(d=>d.str).join(" ");i+=f+`

`}return i.trim()};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var O4=1252,yF=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ry={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ay=function(r){yF.indexOf(r)!=-1&&(O4=ry[0]=r)};function TF(){ay(1252)}var Fi=function(r){ay(r)};function D4(){Fi(1200),TF()}function lC(r){for(var t=[],e=0,a=r.length;e<a;++e)t[e]=r.charCodeAt(e);return t}function SF(r){for(var t=[],e=0;e<r.length>>1;++e)t[e]=String.fromCharCode(r.charCodeAt(2*e)+(r.charCodeAt(2*e+1)<<8));return t.join("")}function N4(r){for(var t=[],e=0;e<r.length>>1;++e)t[e]=String.fromCharCode(r.charCodeAt(2*e+1)+(r.charCodeAt(2*e)<<8));return t.join("")}var fd=function(r){var t=r.charCodeAt(0),e=r.charCodeAt(1);return t==255&&e==254?SF(r.slice(2)):t==254&&e==255?N4(r.slice(2)):t==65279?r.slice(1):r},Y1=function(t){return String.fromCharCode(t)},oC=function(t){return String.fromCharCode(t)},Od,Oo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function cC(r){for(var t="",e=0,a=0,i=0,l=0,o=0,c=0,f=0,d=0;d<r.length;)e=r.charCodeAt(d++),l=e>>2,a=r.charCodeAt(d++),o=(e&3)<<4|a>>4,i=r.charCodeAt(d++),c=(a&15)<<2|i>>6,f=i&63,isNaN(a)?c=f=64:isNaN(i)&&(f=64),t+=Oo.charAt(l)+Oo.charAt(o)+Oo.charAt(c)+Oo.charAt(f);return t}function Fn(r){var t="",e=0,a=0,i=0,l=0,o=0,c=0,f=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<r.length;)l=Oo.indexOf(r.charAt(d++)),o=Oo.indexOf(r.charAt(d++)),e=l<<2|o>>4,t+=String.fromCharCode(e),c=Oo.indexOf(r.charAt(d++)),a=(o&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(a)),f=Oo.indexOf(r.charAt(d++)),i=(c&3)<<6|f,f!==64&&(t+=String.fromCharCode(i));return t}var xt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ou=(function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Lo(r){return xt?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function uC(r){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Ii=function(t){return xt?Ou(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function Du(r){if(Array.isArray(r))return r.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],e=0;e<r.length;++e)t[e]=String.fromCharCode(r[e]);return t.join("")}function ny(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return ny(new Uint8Array(r));for(var t=new Array(r.length),e=0;e<r.length;++e)t[e]=r[e];return t}var Zl=xt?function(r){return Buffer.concat(r.map(function(t){return Buffer.isBuffer(t)?t:Ou(t)}))}:function(r){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<r.length;++t)e+=r[t].length;var a=new Uint8Array(e),i=0;for(t=0,e=0;t<r.length;e+=i,++t)if(i=r[t].length,r[t]instanceof Uint8Array)a.set(r[t],e);else{if(typeof r[t]=="string")throw"wtf";a.set(new Uint8Array(r[t]),e)}return a}return[].concat.apply([],r.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function bF(r){for(var t=[],e=0,a=r.length+250,i=Lo(r.length+255),l=0;l<r.length;++l){var o=r.charCodeAt(l);if(o<128)i[e++]=o;else if(o<2048)i[e++]=192|o>>6&31,i[e++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=r.charCodeAt(++l)&1023;i[e++]=240|o>>8&7,i[e++]=128|o>>2&63,i[e++]=128|c>>6&15|(o&3)<<4,i[e++]=128|c&63}else i[e++]=224|o>>12&15,i[e++]=128|o>>6&63,i[e++]=128|o&63;e>a&&(t.push(i.slice(0,e)),e=0,i=Lo(65535),a=65530)}return t.push(i.slice(0,e)),Zl(t)}var Ha=/\u0000/g,hd=/[\u0001-\u0006]/g;function Pf(r){for(var t="",e=r.length-1;e>=0;)t+=r.charAt(e--);return t}function Li(r,t){var e=""+r;return e.length>=t?e:ur("0",t-e.length)+e}function iy(r,t){var e=""+r;return e.length>=t?e:ur(" ",t-e.length)+e}function Hm(r,t){var e=""+r;return e.length>=t?e:e+ur(" ",t-e.length)}function wF(r,t){var e=""+Math.round(r);return e.length>=t?e:ur("0",t-e.length)+e}function CF(r,t){var e=""+r;return e.length>=t?e:ur("0",t-e.length)+e}var fC=Math.pow(2,32);function Ef(r,t){if(r>fC||r<-fC)return wF(r,t);var e=Math.round(r);return CF(e,t)}function zm(r,t){return t=t||0,r.length>=7+t&&(r.charCodeAt(t)|32)===103&&(r.charCodeAt(t+1)|32)===101&&(r.charCodeAt(t+2)|32)===110&&(r.charCodeAt(t+3)|32)===101&&(r.charCodeAt(t+4)|32)===114&&(r.charCodeAt(t+5)|32)===97&&(r.charCodeAt(t+6)|32)===108}var hC=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],aE=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function RF(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var Je={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},dC={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},kF={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Gm(r,t,e){for(var a=r<0?-1:1,i=r*a,l=0,o=1,c=0,f=1,d=0,g=0,m=Math.floor(i);d<t&&(m=Math.floor(i),c=m*o+l,g=m*d+f,!(i-m<5e-8));)i=1/(i-m),l=o,o=c,f=d,d=g;if(g>t&&(d>t?(g=f,c=l):(g=d,c=o)),!e)return[0,a*c,g];var v=Math.floor(a*c/g);return[v,a*c-v*g,g]}function gc(r,t,e){if(r>2958465||r<0)return null;var a=r|0,i=Math.floor(86400*(r-a)),l=0,o=[],c={D:a,T:i,u:86400*(r-a)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++i==86400&&(c.T=i=0,++a,++c.D)),a===60)o=e?[1317,10,29]:[1900,2,29],l=3;else if(a===0)o=e?[1317,8,29]:[1900,1,0],l=6;else{a>60&&--a;var f=new Date(1900,0,1);f.setDate(f.getDate()+a-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],l=f.getDay(),a<60&&(l=(l+6)%7),e&&(l=FF(f,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=i%60,i=Math.floor(i/60),c.M=i%60,i=Math.floor(i/60),c.H=i,c.q=l,c}var M4=new Date(1899,11,31,0,0,0),OF=M4.getTime(),DF=new Date(1900,2,1,0,0,0);function I4(r,t){var e=r.getTime();return t?e-=1461*24*60*60*1e3:r>=DF&&(e+=1440*60*1e3),(e-(OF+(r.getTimezoneOffset()-M4.getTimezoneOffset())*6e4))/(1440*60*1e3)}function sy(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function NF(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function MF(r){var t=r<0?12:11,e=sy(r.toFixed(12));return e.length<=t||(e=r.toPrecision(10),e.length<=t)?e:r.toExponential(5)}function IF(r){var t=sy(r.toFixed(11));return t.length>(r<0?12:11)||t==="0"||t==="-0"?r.toPrecision(6):t}function Dd(r){var t=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),e;return t>=-4&&t<=-1?e=r.toPrecision(10+t):Math.abs(t)<=9?e=MF(r):t===10?e=r.toFixed(10).substr(0,12):e=IF(r),sy(NF(e.toUpperCase()))}function bu(r,t){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):Dd(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return ui(14,I4(r,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+r)}function FF(r,t){t[0]-=581;var e=r.getDay();return r<60&&(e=(e+6)%7),e}function LF(r,t,e,a){var i="",l=0,o=0,c=e.y,f,d=0;switch(r){case 98:c=e.y+543;case 121:switch(t.length){case 1:case 2:f=c%100,d=2;break;default:f=c%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:f=e.m,d=t.length;break;case 3:return aE[e.m-1][1];case 5:return aE[e.m-1][0];default:return aE[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=e.d,d=t.length;break;case 3:return hC[e.q][0];default:return hC[e.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(e.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=e.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=e.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?Li(e.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,l=Math.round(o*(e.S+e.u)),l>=60*o&&(l=0),t==="s"?l===0?"0":""+l/o:(i=Li(l,2+a),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":f=e.D*24+e.H;break;case"[m]":case"[mm]":f=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":f=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:f=c,d=1;break}var g=d>0?Li(f,d):"";return g}function Do(r){var t=3;if(r.length<=t)return r;for(var e=r.length%t,a=r.substr(0,e);e!=r.length;e+=t)a+=(a.length>0?",":"")+r.substr(e,t);return a}var F4=/%/g;function PF(r,t,e){var a=t.replace(F4,""),i=t.length-a.length;return ml(r,a,e*Math.pow(10,2*i))+ur("%",i)}function BF(r,t,e){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ml(r,t.substr(0,a),e/Math.pow(10,3*(t.length-a)))}function L4(r,t){var e,a=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+L4(r,-t);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%i;if(l<0&&(l+=i),e=(t/Math.pow(10,l)).toPrecision(a+1+(i+l)%i),e.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+l):e+="E+"+(o-l);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,i)+"."+e.substr(2+i),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,g){return f+d+g.substr(0,(i+l)%i)+"."+g.substr(l)+"E"})}else e=t.toExponential(a);return r.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),r.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var P4=/# (\?+)( ?)\/( ?)(\d+)/;function UF(r,t,e){var a=parseInt(r[4],10),i=Math.round(t*a),l=Math.floor(i/a),o=i-l*a,c=a;return e+(l===0?"":""+l)+" "+(o===0?ur(" ",r[1].length+1+r[4].length):iy(o,r[1].length)+r[2]+"/"+r[3]+Li(c,r[4].length))}function HF(r,t,e){return e+(t===0?"":""+t)+ur(" ",r[1].length+2+r[4].length)}var B4=/^#*0*\.([0#]+)/,U4=/\).*[0#]/,H4=/\(###\) ###\\?-####/;function La(r){for(var t="",e,a=0;a!=r.length;++a)switch(e=r.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function pC(r,t){var e=Math.pow(10,t);return""+Math.round(r*e)/e}function gC(r,t){var e=r-Math.floor(r),a=Math.pow(10,t);return t<(""+Math.round(e*a)).length?0:Math.round(e*a)}function zF(r,t){return t<(""+Math.round((r-Math.floor(r))*Math.pow(10,t))).length?1:0}function GF(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function Qn(r,t,e){if(r.charCodeAt(0)===40&&!t.match(U4)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Qn("n",a,e):"("+Qn("n",a,-e)+")"}if(t.charCodeAt(t.length-1)===44)return BF(r,t,e);if(t.indexOf("%")!==-1)return PF(r,t,e);if(t.indexOf("E")!==-1)return L4(t,e);if(t.charCodeAt(0)===36)return"$"+Qn(r,t.substr(t.charAt(1)==" "?2:1),e);var i,l,o,c,f=Math.abs(e),d=e<0?"-":"";if(t.match(/^00+$/))return d+Ef(f,t.length);if(t.match(/^[#?]+$/))return i=Ef(e,0),i==="0"&&(i=""),i.length>t.length?i:La(t.substr(0,t.length-i.length))+i;if(l=t.match(P4))return UF(l,f,d);if(t.match(/^#+0+$/))return d+Ef(f,t.length-t.indexOf("0"));if(l=t.match(B4))return i=pC(e,l[1].length).replace(/^([^\.]+)$/,"$1."+La(l[1])).replace(/\.$/,"."+La(l[1])).replace(/\.(\d*)$/,function(A,y){return"."+y+ur("0",La(l[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+pC(f,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+Do(Ef(f,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Qn(r,t,-e):Do(""+(Math.floor(e)+zF(e,l[1].length)))+"."+Li(gC(e,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return Qn(r,t.replace(/^#,#*,/,""),e);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Pf(Qn(r,t.replace(/[\\-]/g,""),e)),o=0,Pf(Pf(t.replace(/\\/g,"")).replace(/[0#]/g,function(A){return o<i.length?i.charAt(o++):A==="0"?"0":""}));if(t.match(H4))return i=Qn(r,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var g="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),c=Gm(f,Math.pow(10,o)-1,!1),i=""+d,g=ml("n",l[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),i+=g+l[2]+"/"+l[3],g=Hm(c[2],o),g.length<l[4].length&&(g=La(l[4].substr(l[4].length-g.length))+g),i+=g,i;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),c=Gm(f,Math.pow(10,o)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?iy(c[1],o)+l[2]+"/"+l[3]+Hm(c[2],o):ur(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return i=Ef(e,0),t.length<=i.length?i:La(t.substr(0,t.length-i.length))+i;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,v=t.length-i.length-m;return La(t.substr(0,m)+i+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return o=gC(e,l[1].length),e<0?"-"+Qn(r,t,-e):Do(GF(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(A){return"00,"+(A.length<3?Li(0,3-A.length):"")+A})+"."+Li(o,l[1].length);switch(t){case"###,##0.00":return Qn(r,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var _=Do(Ef(f,0));return _!=="0"?d+_:"";case"###,###.00":return Qn(r,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Qn(r,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function VF(r,t,e){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ml(r,t.substr(0,a),e/Math.pow(10,3*(t.length-a)))}function jF(r,t,e){var a=t.replace(F4,""),i=t.length-a.length;return ml(r,a,e*Math.pow(10,2*i))+ur("%",i)}function z4(r,t){var e,a=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+z4(r,-t);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%i;if(l<0&&(l+=i),e=(t/Math.pow(10,l)).toPrecision(a+1+(i+l)%i),!e.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+l):e+="E+"+(o-l),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,g){return f+d+g.substr(0,(i+l)%i)+"."+g.substr(l)+"E"})}else e=t.toExponential(a);return r.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),r.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Zi(r,t,e){if(r.charCodeAt(0)===40&&!t.match(U4)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Zi("n",a,e):"("+Zi("n",a,-e)+")"}if(t.charCodeAt(t.length-1)===44)return VF(r,t,e);if(t.indexOf("%")!==-1)return jF(r,t,e);if(t.indexOf("E")!==-1)return z4(t,e);if(t.charCodeAt(0)===36)return"$"+Zi(r,t.substr(t.charAt(1)==" "?2:1),e);var i,l,o,c,f=Math.abs(e),d=e<0?"-":"";if(t.match(/^00+$/))return d+Li(f,t.length);if(t.match(/^[#?]+$/))return i=""+e,e===0&&(i=""),i.length>t.length?i:La(t.substr(0,t.length-i.length))+i;if(l=t.match(P4))return HF(l,f,d);if(t.match(/^#+0+$/))return d+Li(f,t.length-t.indexOf("0"));if(l=t.match(B4))return i=(""+e).replace(/^([^\.]+)$/,"$1."+La(l[1])).replace(/\.$/,"."+La(l[1])),i=i.replace(/\.(\d*)$/,function(A,y){return"."+y+ur("0",La(l[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+Do(""+f);if(l=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Zi(r,t,-e):Do(""+e)+"."+ur("0",l[1].length);if(l=t.match(/^#,#*,#0/))return Zi(r,t.replace(/^#,#*,/,""),e);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Pf(Zi(r,t.replace(/[\\-]/g,""),e)),o=0,Pf(Pf(t.replace(/\\/g,"")).replace(/[0#]/g,function(A){return o<i.length?i.charAt(o++):A==="0"?"0":""}));if(t.match(H4))return i=Zi(r,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var g="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),c=Gm(f,Math.pow(10,o)-1,!1),i=""+d,g=ml("n",l[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),i+=g+l[2]+"/"+l[3],g=Hm(c[2],o),g.length<l[4].length&&(g=La(l[4].substr(l[4].length-g.length))+g),i+=g,i;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),c=Gm(f,Math.pow(10,o)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?iy(c[1],o)+l[2]+"/"+l[3]+Hm(c[2],o):ur(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return i=""+e,t.length<=i.length?i:La(t.substr(0,t.length-i.length))+i;if(l=t.match(/^([#0]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,v=t.length-i.length-m;return La(t.substr(0,m)+i+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Zi(r,t,-e):Do(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(A){return"00,"+(A.length<3?Li(0,3-A.length):"")+A})+"."+Li(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var _=Do(""+f);return _!=="0"?d+_:"";default:if(t.match(/\.[0#?]*$/))return Zi(r,t.slice(0,t.lastIndexOf(".")),e)+La(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ml(r,t,e){return(e|0)===e?Zi(r,t,e):Qn(r,t,e)}function YF(r){for(var t=[],e=!1,a=0,i=0;a<r.length;++a)switch(r.charCodeAt(a)){case 34:e=!e;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=r.substr(i,a-i),i=a+1}if(t[t.length]=r.substr(i),e===!0)throw new Error("Format |"+r+"| unterminated string ");return t}var G4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function qh(r){for(var t=0,e="",a="";t<r.length;)switch(e=r.charAt(t)){case"G":zm(r,t)&&(t+=6),t++;break;case'"':for(;r.charCodeAt(++t)!==34&&t<r.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(r.charAt(t+1)==="1"||r.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(t,3).toUpperCase()==="A/P"||r.substr(t,5).toUpperCase()==="AM/PM"||r.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=e;r.charAt(t++)!=="]"&&t<r.length;)a+=r.charAt(t);if(a.match(G4))return!0;break;case".":case"0":case"#":for(;t<r.length&&("0#?.,E+-%".indexOf(e=r.charAt(++t))>-1||e=="\\"&&r.charAt(t+1)=="-"&&"0#".indexOf(r.charAt(t+2))>-1););break;case"?":for(;r.charAt(++t)===e;);break;case"*":++t,(r.charAt(t)==" "||r.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<r.length&&"0123456789".indexOf(r.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function XF(r,t,e,a){for(var i=[],l="",o=0,c="",f="t",d,g,m,v="H";o<r.length;)switch(c=r.charAt(o)){case"G":if(!zm(r,o))throw new Error("unrecognized character "+c+" in "+r);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(m=r.charCodeAt(++o))!==34&&o<r.length;)l+=String.fromCharCode(m);i[i.length]={t:"t",v:l},++o;break;case"\\":var _=r.charAt(++o),A=_==="("||_===")"?_:"t";i[i.length]={t:A,v:_},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(r.charAt(o+1)==="1"||r.charAt(o+1)==="2"){if(d==null&&(d=gc(t,e,r.charAt(o+1)==="2"),d==null))return"";i[i.length]={t:"X",v:r.substr(o,2)},f=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=gc(t,e),d==null))return"";for(l=c;++o<r.length&&r.charAt(o).toLowerCase()===c;)l+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=v),i[i.length]={t:c,v:l},f=c;break;case"A":case"a":case"":var y={t:c,v:c};if(d==null&&(d=gc(t,e)),r.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(y.v=d.H>=12?"P":"A"),y.t="T",v="h",o+=3):r.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(y.v=d.H>=12?"PM":"AM"),y.t="T",o+=5,v="h"):r.substr(o,5).toUpperCase()==="/"?(d!=null&&(y.v=d.H>=12?"":""),y.t="T",o+=5,v="h"):(y.t="t",++o),d==null&&y.t==="T")return"";i[i.length]=y,f=c;break;case"[":for(l=c;r.charAt(o++)!=="]"&&o<r.length;)l+=r.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(G4)){if(d==null&&(d=gc(t,e),d==null))return"";i[i.length]={t:"Z",v:l.toLowerCase()},f=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",qh(r)||(i[i.length]={t:"t",v:l}));break;case".":if(d!=null){for(l=c;++o<r.length&&(c=r.charAt(o))==="0";)l+=c;i[i.length]={t:"s",v:l};break}case"0":case"#":for(l=c;++o<r.length&&"0#?.,E+-%".indexOf(c=r.charAt(o))>-1;)l+=c;i[i.length]={t:"n",v:l};break;case"?":for(l=c;r.charAt(++o)===c;)l+=c;i[i.length]={t:c,v:l},f=c;break;case"*":++o,(r.charAt(o)==" "||r.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:a===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=c;o<r.length&&"0123456789".indexOf(r.charAt(++o))>-1;)l+=r.charAt(o);i[i.length]={t:"D",v:l};break;case" ":i[i.length]={t:c,v:c},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+r);i[i.length]={t:"t",v:c},++o;break}var T=0,S=0,R;for(o=i.length-1,f="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=v,f="h",T<1&&(T=1);break;case"s":(R=i[o].v.match(/\.0+$/))&&(S=Math.max(S,R[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":f=i[o].t;break;case"m":f==="s"&&(i[o].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&i[o].v.match(/[Hh]/)&&(T=1),T<2&&i[o].v.match(/[Mm]/)&&(T=2),T<3&&i[o].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var C="",F;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=LF(i[o].t.charCodeAt(0),i[o].v,d,S),i[o].t="t";break;case"n":case"?":for(F=o+1;i[F]!=null&&((c=i[F].t)==="?"||c==="D"||(c===" "||c==="t")&&i[F+1]!=null&&(i[F+1].t==="?"||i[F+1].t==="t"&&i[F+1].v==="/")||i[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(i[F].v==="/"||i[F].v===" "&&i[F+1]!=null&&i[F+1].t=="?"));)i[o].v+=i[F].v,i[F]={v:"",t:";"},++F;C+=i[o].v,o=F-1;break;case"G":i[o].t="t",i[o].v=bu(t,e);break}var U="",B,k;if(C.length>0){C.charCodeAt(0)==40?(B=t<0&&C.charCodeAt(0)===45?-t:t,k=ml("n",C,B)):(B=t<0&&a>1?-t:t,k=ml("n",C,B),B<0&&i[0]&&i[0].t=="t"&&(k=k.substr(1),i[0].v="-"+i[0].v)),F=k.length-1;var J=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){J=o;break}var j=i.length;if(J===i.length&&k.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(F>=i[o].v.length-1?(F-=i[o].v.length,i[o].v=k.substr(F+1,i[o].v.length)):F<0?i[o].v="":(i[o].v=k.substr(0,F+1),F=-1),i[o].t="t",j=o);F>=0&&j<i.length&&(i[j].v=k.substr(0,F+1)+i[j].v)}else if(J!==i.length&&k.indexOf("E")===-1){for(F=k.indexOf(".")-1,o=J;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(g=i[o].v.indexOf(".")>-1&&o===J?i[o].v.indexOf(".")-1:i[o].v.length-1,U=i[o].v.substr(g+1);g>=0;--g)F>=0&&(i[o].v.charAt(g)==="0"||i[o].v.charAt(g)==="#")&&(U=k.charAt(F--)+U);i[o].v=U,i[o].t="t",j=o}for(F>=0&&j<i.length&&(i[j].v=k.substr(0,F+1)+i[j].v),F=k.indexOf(".")+1,o=J;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==J)){for(g=i[o].v.indexOf(".")>-1&&o===J?i[o].v.indexOf(".")+1:0,U=i[o].v.substr(0,g);g<i[o].v.length;++g)F<k.length&&(U+=k.charAt(F++));i[o].v=U,i[o].t="t",j=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(B=a>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=ml(i[o].t,i[o].v,B),i[o].t="t");var ie="";for(o=0;o!==i.length;++o)i[o]!=null&&(ie+=i[o].v);return ie}var mC=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function xC(r,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(r==e)return!0;break;case">":if(r>e)return!0;break;case"<":if(r<e)return!0;break;case"<>":if(r!=e)return!0;break;case">=":if(r>=e)return!0;break;case"<=":if(r<=e)return!0;break}return!1}function qF(r,t){var e=YF(r),a=e.length,i=e[a-1].indexOf("@");if(a<4&&i>-1&&--a,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||i>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=i>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=i>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=i>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var l=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[a,l];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var o=e[0].match(mC),c=e[1].match(mC);return xC(t,o)?[a,e[0]]:xC(t,c)?[a,e[1]]:[a,e[o!=null&&c!=null?2:1]]}return[a,l]}function ui(r,t,e){e==null&&(e={});var a="";switch(typeof r){case"string":r=="m/d/yy"&&e.dateNF?a=e.dateNF:a=r;break;case"number":r==14&&e.dateNF?a=e.dateNF:a=(e.table!=null?e.table:Je)[r],a==null&&(a=e.table&&e.table[dC[r]]||Je[dC[r]]),a==null&&(a=kF[r]||"General");break}if(zm(a,0))return bu(t,e);t instanceof Date&&(t=I4(t,e.date1904));var i=qF(a,t);if(zm(i[1]))return bu(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return XF(i[1],t,e,i[0])}function Eu(r,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(Je[e]==null){t<0&&(t=e);continue}if(Je[e]==r){t=e;break}}t<0&&(t=391)}return Je[t]=r,t}function V4(){Je=RF()}var WF={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},j4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function KF(r){var t=typeof r=="number"?Je[r]:r;return t=t.replace(j4,"(\\d+)"),new RegExp("^"+t+"$")}function $F(r,t,e){var a=-1,i=-1,l=-1,o=-1,c=-1,f=-1;(t.match(j4)||[]).forEach(function(m,v){var _=parseInt(e[v+1],10);switch(m.toLowerCase().charAt(0)){case"y":a=_;break;case"d":l=_;break;case"h":o=_;break;case"s":f=_;break;case"m":o>=0?c=_:i=_;break}}),f>=0&&c==-1&&i>=0&&(c=i,i=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var g=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&c==-1&&f==-1?d:a==-1&&i==-1&&l==-1?g:d+"T"+g}var QF=(function(){var r={};r.version="1.2.0";function t(){for(var k=0,J=new Array(256),j=0;j!=256;++j)k=j,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,J[j]=k;return typeof Int32Array<"u"?new Int32Array(J):J}var e=t();function a(k){var J=0,j=0,ie=0,Q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ie=0;ie!=256;++ie)Q[ie]=k[ie];for(ie=0;ie!=256;++ie)for(j=k[ie],J=256+ie;J<4096;J+=256)j=Q[J]=j>>>8^k[j&255];var ee=[];for(ie=1;ie!=16;++ie)ee[ie-1]=typeof Int32Array<"u"?Q.subarray(ie*256,ie*256+256):Q.slice(ie*256,ie*256+256);return ee}var i=a(e),l=i[0],o=i[1],c=i[2],f=i[3],d=i[4],g=i[5],m=i[6],v=i[7],_=i[8],A=i[9],y=i[10],T=i[11],S=i[12],R=i[13],C=i[14];function F(k,J){for(var j=J^-1,ie=0,Q=k.length;ie<Q;)j=j>>>8^e[(j^k.charCodeAt(ie++))&255];return~j}function U(k,J){for(var j=J^-1,ie=k.length-15,Q=0;Q<ie;)j=C[k[Q++]^j&255]^R[k[Q++]^j>>8&255]^S[k[Q++]^j>>16&255]^T[k[Q++]^j>>>24]^y[k[Q++]]^A[k[Q++]]^_[k[Q++]]^v[k[Q++]]^m[k[Q++]]^g[k[Q++]]^d[k[Q++]]^f[k[Q++]]^c[k[Q++]]^o[k[Q++]]^l[k[Q++]]^e[k[Q++]];for(ie+=15;Q<ie;)j=j>>>8^e[(j^k[Q++])&255];return~j}function B(k,J){for(var j=J^-1,ie=0,Q=k.length,ee=0,ge=0;ie<Q;)ee=k.charCodeAt(ie++),ee<128?j=j>>>8^e[(j^ee)&255]:ee<2048?(j=j>>>8^e[(j^(192|ee>>6&31))&255],j=j>>>8^e[(j^(128|ee&63))&255]):ee>=55296&&ee<57344?(ee=(ee&1023)+64,ge=k.charCodeAt(ie++)&1023,j=j>>>8^e[(j^(240|ee>>8&7))&255],j=j>>>8^e[(j^(128|ee>>2&63))&255],j=j>>>8^e[(j^(128|ge>>6&15|(ee&3)<<4))&255],j=j>>>8^e[(j^(128|ge&63))&255]):(j=j>>>8^e[(j^(224|ee>>12&15))&255],j=j>>>8^e[(j^(128|ee>>6&63))&255],j=j>>>8^e[(j^(128|ee&63))&255]);return~j}return r.table=e,r.bstr=F,r.buf=U,r.str=B,r})(),vt=(function(){var t={};t.version="1.2.1";function e(M,z){for(var L=M.split("/"),P=z.split("/"),H=0,V=0,ce=Math.min(L.length,P.length);H<ce;++H){if(V=L[H].length-P[H].length)return V;if(L[H]!=P[H])return L[H]<P[H]?-1:1}return L.length-P.length}function a(M){if(M.charAt(M.length-1)=="/")return M.slice(0,-1).indexOf("/")===-1?M:a(M.slice(0,-1));var z=M.lastIndexOf("/");return z===-1?M:M.slice(0,z+1)}function i(M){if(M.charAt(M.length-1)=="/")return i(M.slice(0,-1));var z=M.lastIndexOf("/");return z===-1?M:M.slice(z+1)}function l(M,z){typeof z=="string"&&(z=new Date(z));var L=z.getHours();L=L<<6|z.getMinutes(),L=L<<5|z.getSeconds()>>>1,M.write_shift(2,L);var P=z.getFullYear()-1980;P=P<<4|z.getMonth()+1,P=P<<5|z.getDate(),M.write_shift(2,P)}function o(M){var z=M.read_shift(2)&65535,L=M.read_shift(2)&65535,P=new Date,H=L&31;L>>>=5;var V=L&15;L>>>=4,P.setMilliseconds(0),P.setFullYear(L+1980),P.setMonth(V-1),P.setDate(H);var ce=z&31;z>>>=5;var _e=z&63;return z>>>=6,P.setHours(z),P.setMinutes(_e),P.setSeconds(ce<<1),P}function c(M){ia(M,0);for(var z={},L=0;M.l<=M.length-4;){var P=M.read_shift(2),H=M.read_shift(2),V=M.l+H,ce={};switch(P){case 21589:L=M.read_shift(1),L&1&&(ce.mtime=M.read_shift(4)),H>5&&(L&2&&(ce.atime=M.read_shift(4)),L&4&&(ce.ctime=M.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}M.l=V,z[P]=ce}return z}var f;function d(){return f||(f={})}function g(M,z){if(M[0]==80&&M[1]==75)return Go(M,z);if((M[0]|32)==109&&(M[1]|32)==105)return jo(M,z);if(M.length<512)throw new Error("CFB file size "+M.length+" < 512");var L=3,P=512,H=0,V=0,ce=0,_e=0,ue=0,fe=[],de=M.slice(0,512);ia(de,0);var Ce=m(de);switch(L=Ce[0],L){case 3:P=512;break;case 4:P=4096;break;case 0:if(Ce[1]==0)return Go(M,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}P!==512&&(de=M.slice(0,P),ia(de,28));var De=M.slice(0,P);v(de,L);var Fe=de.read_shift(4,"i");if(L===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);de.l+=4,ce=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),_e=de.read_shift(4,"i"),H=de.read_shift(4,"i"),ue=de.read_shift(4,"i"),V=de.read_shift(4,"i");for(var Re=-1,Ne=0;Ne<109&&(Re=de.read_shift(4,"i"),!(Re<0));++Ne)fe[Ne]=Re;var He=_(M,P);T(ue,V,He,P,fe);var Ht=R(He,ce,fe,P);Ht[ce].name="!Directory",H>0&&_e!==ge&&(Ht[_e].name="!MiniFAT"),Ht[fe[0]].name="!FAT",Ht.fat_addrs=fe,Ht.ssz=P;var zt={},$t=[],Bn=[],Yo=[];C(ce,Ht,He,$t,H,zt,Bn,_e),A(Bn,Yo,$t),$t.shift();var bl={FileIndex:Bn,FullPaths:Yo};return z&&z.raw&&(bl.raw={header:De,sectors:He}),bl}function m(M){if(M[M.l]==80&&M[M.l+1]==75)return[0,0];M.chk(ye,"Header Signature: "),M.l+=16;var z=M.read_shift(2,"u");return[M.read_shift(2,"u"),z]}function v(M,z){var L=9;switch(M.l+=2,L=M.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}M.chk("0600","Mini Sector Shift: "),M.chk("000000000000","Reserved: ")}function _(M,z){for(var L=Math.ceil(M.length/z)-1,P=[],H=1;H<L;++H)P[H-1]=M.slice(H*z,(H+1)*z);return P[L-1]=M.slice(L*z),P}function A(M,z,L){for(var P=0,H=0,V=0,ce=0,_e=0,ue=L.length,fe=[],de=[];P<ue;++P)fe[P]=de[P]=P,z[P]=L[P];for(;_e<de.length;++_e)P=de[_e],H=M[P].L,V=M[P].R,ce=M[P].C,fe[P]===P&&(H!==-1&&fe[H]!==H&&(fe[P]=fe[H]),V!==-1&&fe[V]!==V&&(fe[P]=fe[V])),ce!==-1&&(fe[ce]=P),H!==-1&&P!=fe[P]&&(fe[H]=fe[P],de.lastIndexOf(H)<_e&&de.push(H)),V!==-1&&P!=fe[P]&&(fe[V]=fe[P],de.lastIndexOf(V)<_e&&de.push(V));for(P=1;P<ue;++P)fe[P]===P&&(V!==-1&&fe[V]!==V?fe[P]=fe[V]:H!==-1&&fe[H]!==H&&(fe[P]=fe[H]));for(P=1;P<ue;++P)if(M[P].type!==0){if(_e=P,_e!=fe[_e])do _e=fe[_e],z[P]=z[_e]+"/"+z[P];while(_e!==0&&fe[_e]!==-1&&_e!=fe[_e]);fe[P]=-1}for(z[0]+="/",P=1;P<ue;++P)M[P].type!==2&&(z[P]+="/")}function y(M,z,L){for(var P=M.start,H=M.size,V=[],ce=P;L&&H>0&&ce>=0;)V.push(z.slice(ce*ee,ce*ee+ee)),H-=ee,ce=hc(L,ce*4);return V.length===0?Lr(0):Zl(V).slice(0,M.size)}function T(M,z,L,P,H){var V=ge;if(M===ge){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(M!==-1){var ce=L[M],_e=(P>>>2)-1;if(!ce)return;for(var ue=0;ue<_e&&(V=hc(ce,ue*4))!==ge;++ue)H.push(V);T(hc(ce,P-4),z-1,L,P,H)}}function S(M,z,L,P,H){var V=[],ce=[];H||(H=[]);var _e=P-1,ue=0,fe=0;for(ue=z;ue>=0;){H[ue]=!0,V[V.length]=ue,ce.push(M[ue]);var de=L[Math.floor(ue*4/P)];if(fe=ue*4&_e,P<4+fe)throw new Error("FAT boundary crossed: "+ue+" 4 "+P);if(!M[de])break;ue=hc(M[de],fe)}return{nodes:V,data:CC([ce])}}function R(M,z,L,P){var H=M.length,V=[],ce=[],_e=[],ue=[],fe=P-1,de=0,Ce=0,De=0,Fe=0;for(de=0;de<H;++de)if(_e=[],De=de+z,De>=H&&(De-=H),!ce[De]){ue=[];var Re=[];for(Ce=De;Ce>=0;){Re[Ce]=!0,ce[Ce]=!0,_e[_e.length]=Ce,ue.push(M[Ce]);var Ne=L[Math.floor(Ce*4/P)];if(Fe=Ce*4&fe,P<4+Fe)throw new Error("FAT boundary crossed: "+Ce+" 4 "+P);if(!M[Ne]||(Ce=hc(M[Ne],Fe),Re[Ce]))break}V[De]={nodes:_e,data:CC([ue])}}return V}function C(M,z,L,P,H,V,ce,_e){for(var ue=0,fe=P.length?2:0,de=z[M].data,Ce=0,De=0,Fe;Ce<de.length;Ce+=128){var Re=de.slice(Ce,Ce+128);ia(Re,64),De=Re.read_shift(2),Fe=fy(Re,0,De-fe),P.push(Fe);var Ne={name:Fe,type:Re.read_shift(1),color:Re.read_shift(1),L:Re.read_shift(4,"i"),R:Re.read_shift(4,"i"),C:Re.read_shift(4,"i"),clsid:Re.read_shift(16),state:Re.read_shift(4,"i"),start:0,size:0},He=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);He!==0&&(Ne.ct=F(Re,Re.l-8));var Ht=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);Ht!==0&&(Ne.mt=F(Re,Re.l-8)),Ne.start=Re.read_shift(4,"i"),Ne.size=Re.read_shift(4,"i"),Ne.size<0&&Ne.start<0&&(Ne.size=Ne.type=0,Ne.start=ge,Ne.name=""),Ne.type===5?(ue=Ne.start,H>0&&ue!==ge&&(z[ue].name="!StreamData")):Ne.size>=4096?(Ne.storage="fat",z[Ne.start]===void 0&&(z[Ne.start]=S(L,Ne.start,z.fat_addrs,z.ssz)),z[Ne.start].name=Ne.name,Ne.content=z[Ne.start].data.slice(0,Ne.size)):(Ne.storage="minifat",Ne.size<0?Ne.size=0:ue!==ge&&Ne.start!==ge&&z[ue]&&(Ne.content=y(Ne,z[ue].data,(z[_e]||{}).data))),Ne.content&&ia(Ne.content,0),V[Fe]=Ne,ce.push(Ne)}}function F(M,z){return new Date((On(M,z+4)/1e7*Math.pow(2,32)+On(M,z)/1e7-11644473600)*1e3)}function U(M,z){return d(),g(f.readFileSync(M),z)}function B(M,z){var L=z&&z.type;switch(L||xt&&Buffer.isBuffer(M)&&(L="buffer"),L||"base64"){case"file":return U(M,z);case"base64":return g(Ii(Fn(M)),z);case"binary":return g(Ii(M),z)}return g(M,z)}function k(M,z){var L=z||{},P=L.root||"Root Entry";if(M.FullPaths||(M.FullPaths=[]),M.FileIndex||(M.FileIndex=[]),M.FullPaths.length!==M.FileIndex.length)throw new Error("inconsistent CFB structure");M.FullPaths.length===0&&(M.FullPaths[0]=P+"/",M.FileIndex[0]={name:P,type:5}),L.CLSID&&(M.FileIndex[0].clsid=L.CLSID),J(M)}function J(M){var z="Sh33tJ5";if(!vt.find(M,"/"+z)){var L=Lr(4);L[0]=55,L[1]=L[3]=50,L[2]=54,M.FileIndex.push({name:z,type:2,content:L,size:4,L:69,R:69,C:69}),M.FullPaths.push(M.FullPaths[0]+z),j(M)}}function j(M,z){k(M);for(var L=!1,P=!1,H=M.FullPaths.length-1;H>=0;--H){var V=M.FileIndex[H];switch(V.type){case 0:P?L=!0:(M.FileIndex.pop(),M.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(V.R*V.L*V.C)&&(L=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!z)){var ce=new Date(1987,1,19),_e=0,ue=Object.create?Object.create(null):{},fe=[];for(H=0;H<M.FullPaths.length;++H)ue[M.FullPaths[H]]=!0,M.FileIndex[H].type!==0&&fe.push([M.FullPaths[H],M.FileIndex[H]]);for(H=0;H<fe.length;++H){var de=a(fe[H][0]);P=ue[de],P||(fe.push([de,{name:i(de).replace("/",""),type:1,clsid:G,ct:ce,mt:ce,content:null}]),ue[de]=!0)}for(fe.sort(function(Fe,Re){return e(Fe[0],Re[0])}),M.FullPaths=[],M.FileIndex=[],H=0;H<fe.length;++H)M.FullPaths[H]=fe[H][0],M.FileIndex[H]=fe[H][1];for(H=0;H<fe.length;++H){var Ce=M.FileIndex[H],De=M.FullPaths[H];if(Ce.name=i(De).replace("/",""),Ce.L=Ce.R=Ce.C=-(Ce.color=1),Ce.size=Ce.content?Ce.content.length:0,Ce.start=0,Ce.clsid=Ce.clsid||G,H===0)Ce.C=fe.length>1?1:-1,Ce.size=0,Ce.type=5;else if(De.slice(-1)=="/"){for(_e=H+1;_e<fe.length&&a(M.FullPaths[_e])!=De;++_e);for(Ce.C=_e>=fe.length?-1:_e,_e=H+1;_e<fe.length&&a(M.FullPaths[_e])!=a(De);++_e);Ce.R=_e>=fe.length?-1:_e,Ce.type=1}else a(M.FullPaths[H+1]||"")==a(De)&&(Ce.R=H+1),Ce.type=2}}}function ie(M,z){var L=z||{};if(L.fileType=="mad")return Mx(M,L);switch(j(M),L.fileType){case"zip":return Pu(M,L)}var P=(function(Fe){for(var Re=0,Ne=0,He=0;He<Fe.FileIndex.length;++He){var Ht=Fe.FileIndex[He];if(Ht.content){var zt=Ht.content.length;zt>0&&(zt<4096?Re+=zt+63>>6:Ne+=zt+511>>9)}}for(var $t=Fe.FullPaths.length+3>>2,Bn=Re+7>>3,Yo=Re+127>>7,bl=Bn+Ne+$t+Yo,Gi=bl+127>>7,Jh=Gi<=109?0:Math.ceil((Gi-109)/127);bl+Gi+Jh+127>>7>Gi;)Jh=++Gi<=109?0:Math.ceil((Gi-109)/127);var qa=[1,Jh,Gi,Yo,$t,Ne,Re,0];return Fe.FileIndex[0].size=Re<<6,qa[7]=(Fe.FileIndex[0].start=qa[0]+qa[1]+qa[2]+qa[3]+qa[4]+qa[5])+(qa[6]+7>>3),qa})(M),H=Lr(P[7]<<9),V=0,ce=0;{for(V=0;V<8;++V)H.write_shift(1,me[V]);for(V=0;V<8;++V)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),V=0;V<3;++V)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,P[2]),H.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:ge),H.write_shift(4,P[3]),H.write_shift(-4,P[1]?P[0]-1:ge),H.write_shift(4,P[1]),V=0;V<109;++V)H.write_shift(-4,V<P[2]?P[1]+V:-1)}if(P[1])for(ce=0;ce<P[1];++ce){for(;V<236+ce*127;++V)H.write_shift(-4,V<P[2]?P[1]+V:-1);H.write_shift(-4,ce===P[1]-1?ge:ce+1)}var _e=function(Fe){for(ce+=Fe;V<ce-1;++V)H.write_shift(-4,V+1);Fe&&(++V,H.write_shift(-4,ge))};for(ce=V=0,ce+=P[1];V<ce;++V)H.write_shift(-4,te.DIFSECT);for(ce+=P[2];V<ce;++V)H.write_shift(-4,te.FATSECT);_e(P[3]),_e(P[4]);for(var ue=0,fe=0,de=M.FileIndex[0];ue<M.FileIndex.length;++ue)de=M.FileIndex[ue],de.content&&(fe=de.content.length,!(fe<4096)&&(de.start=ce,_e(fe+511>>9)));for(_e(P[6]+7>>3);H.l&511;)H.write_shift(-4,te.ENDOFCHAIN);for(ce=V=0,ue=0;ue<M.FileIndex.length;++ue)de=M.FileIndex[ue],de.content&&(fe=de.content.length,!(!fe||fe>=4096)&&(de.start=ce,_e(fe+63>>6)));for(;H.l&511;)H.write_shift(-4,te.ENDOFCHAIN);for(V=0;V<P[4]<<2;++V){var Ce=M.FullPaths[V];if(!Ce||Ce.length===0){for(ue=0;ue<17;++ue)H.write_shift(4,0);for(ue=0;ue<3;++ue)H.write_shift(4,-1);for(ue=0;ue<12;++ue)H.write_shift(4,0);continue}de=M.FileIndex[V],V===0&&(de.start=de.size?de.start-1:ge);var De=V===0&&L.root||de.name;if(fe=2*(De.length+1),H.write_shift(64,De,"utf16le"),H.write_shift(2,fe),H.write_shift(1,de.type),H.write_shift(1,de.color),H.write_shift(-4,de.L),H.write_shift(-4,de.R),H.write_shift(-4,de.C),de.clsid)H.write_shift(16,de.clsid,"hex");else for(ue=0;ue<4;++ue)H.write_shift(4,0);H.write_shift(4,de.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,de.start),H.write_shift(4,de.size),H.write_shift(4,0)}for(V=1;V<M.FileIndex.length;++V)if(de=M.FileIndex[V],de.size>=4096)if(H.l=de.start+1<<9,xt&&Buffer.isBuffer(de.content))de.content.copy(H,H.l,0,de.size),H.l+=de.size+511&-512;else{for(ue=0;ue<de.size;++ue)H.write_shift(1,de.content[ue]);for(;ue&511;++ue)H.write_shift(1,0)}for(V=1;V<M.FileIndex.length;++V)if(de=M.FileIndex[V],de.size>0&&de.size<4096)if(xt&&Buffer.isBuffer(de.content))de.content.copy(H,H.l,0,de.size),H.l+=de.size+63&-64;else{for(ue=0;ue<de.size;++ue)H.write_shift(1,de.content[ue]);for(;ue&63;++ue)H.write_shift(1,0)}if(xt)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function Q(M,z){var L=M.FullPaths.map(function(ue){return ue.toUpperCase()}),P=L.map(function(ue){var fe=ue.split("/");return fe[fe.length-(ue.slice(-1)=="/"?2:1)]}),H=!1;z.charCodeAt(0)===47?(H=!0,z=L[0].slice(0,-1)+z):H=z.indexOf("/")!==-1;var V=z.toUpperCase(),ce=H===!0?L.indexOf(V):P.indexOf(V);if(ce!==-1)return M.FileIndex[ce];var _e=!V.match(hd);for(V=V.replace(Ha,""),_e&&(V=V.replace(hd,"!")),ce=0;ce<L.length;++ce)if((_e?L[ce].replace(hd,"!"):L[ce]).replace(Ha,"")==V||(_e?P[ce].replace(hd,"!"):P[ce]).replace(Ha,"")==V)return M.FileIndex[ce];return null}var ee=64,ge=-2,ye="d0cf11e0a1b11ae1",me=[208,207,17,224,161,177,26,225],G="00000000000000000000000000000000",te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ge,FREESECT:-1,HEADER_SIGNATURE:ye,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:G,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function we(M,z,L){d();var P=ie(M,L);f.writeFileSync(z,P)}function ae(M){for(var z=new Array(M.length),L=0;L<M.length;++L)z[L]=String.fromCharCode(M[L]);return z.join("")}function Oe(M,z){var L=ie(M,z);switch(z&&z.type||"buffer"){case"file":return d(),f.writeFileSync(z.filename,L),L;case"binary":return typeof L=="string"?L:ae(L);case"base64":return cC(typeof L=="string"?L:ae(L));case"buffer":if(xt)return Buffer.isBuffer(L)?L:Ou(L);case"array":return typeof L=="string"?Ii(L):L}return L}var Y;function N(M){try{var z=M.InflateRaw,L=new z;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)Y=M;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function q(M,z){if(!Y)return _g(M,z);var L=Y.InflateRaw,P=new L,H=P._processChunk(M.slice(M.l),P._finishFlushFlag);return M.l+=P.bytesRead,H}function X(M){return Y?Y.deflateRawSync(M):rt(M)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ke(M){var z=(M<<1|M<<11)&139536|(M<<5|M<<15)&558144;return(z>>16|z>>8|z)&255}for(var Se=typeof Uint8Array<"u",be=Se?new Uint8Array(256):[],ot=0;ot<256;++ot)be[ot]=ke(ot);function W(M,z){var L=be[M&255];return z<=8?L>>>8-z:(L=L<<8|be[M>>8&255],z<=16?L>>>16-z:(L=L<<8|be[M>>16&255],L>>>24-z))}function Wt(M,z){var L=z&7,P=z>>>3;return(M[P]|(L<=6?0:M[P+1]<<8))>>>L&3}function st(M,z){var L=z&7,P=z>>>3;return(M[P]|(L<=5?0:M[P+1]<<8))>>>L&7}function bt(M,z){var L=z&7,P=z>>>3;return(M[P]|(L<=4?0:M[P+1]<<8))>>>L&15}function tt(M,z){var L=z&7,P=z>>>3;return(M[P]|(L<=3?0:M[P+1]<<8))>>>L&31}function Ie(M,z){var L=z&7,P=z>>>3;return(M[P]|(L<=1?0:M[P+1]<<8))>>>L&127}function Kt(M,z,L){var P=z&7,H=z>>>3,V=(1<<L)-1,ce=M[H]>>>P;return L<8-P||(ce|=M[H+1]<<8-P,L<16-P)||(ce|=M[H+2]<<16-P,L<24-P)||(ce|=M[H+3]<<24-P),ce&V}function ca(M,z,L){var P=z&7,H=z>>>3;return P<=5?M[H]|=(L&7)<<P:(M[H]|=L<<P&255,M[H+1]=(L&7)>>8-P),z+3}function Ya(M,z,L){var P=z&7,H=z>>>3;return L=(L&1)<<P,M[H]|=L,z+1}function cn(M,z,L){var P=z&7,H=z>>>3;return L<<=P,M[H]|=L&255,L>>>=8,M[H+1]=L,z+8}function zo(M,z,L){var P=z&7,H=z>>>3;return L<<=P,M[H]|=L&255,L>>>=8,M[H+1]=L&255,M[H+2]=L>>>8,z+16}function zi(M,z){var L=M.length,P=2*L>z?2*L:z+5,H=0;if(L>=z)return M;if(xt){var V=uC(P);if(M.copy)M.copy(V);else for(;H<M.length;++H)V[H]=M[H];return V}else if(Se){var ce=new Uint8Array(P);if(ce.set)ce.set(M);else for(;H<L;++H)ce[H]=M[H];return ce}return M.length=P,M}function Pt(M){for(var z=new Array(M),L=0;L<M;++L)z[L]=0;return z}function hi(M,z,L){var P=1,H=0,V=0,ce=0,_e=0,ue=M.length,fe=Se?new Uint16Array(32):Pt(32);for(V=0;V<32;++V)fe[V]=0;for(V=ue;V<L;++V)M[V]=0;ue=M.length;var de=Se?new Uint16Array(ue):Pt(ue);for(V=0;V<ue;++V)fe[H=M[V]]++,P<H&&(P=H),de[V]=0;for(fe[0]=0,V=1;V<=P;++V)fe[V+16]=_e=_e+fe[V-1]<<1;for(V=0;V<ue;++V)_e=M[V],_e!=0&&(de[V]=fe[_e+16]++);var Ce=0;for(V=0;V<ue;++V)if(Ce=M[V],Ce!=0)for(_e=W(de[V],P)>>P-Ce,ce=(1<<P+4-Ce)-1;ce>=0;--ce)z[_e|ce<<Ce]=Ce&15|V<<4;return P}var di=Se?new Uint16Array(512):Pt(512),Sl=Se?new Uint16Array(32):Pt(32);if(!Se){for(var _r=0;_r<512;++_r)di[_r]=0;for(_r=0;_r<32;++_r)Sl[_r]=0}(function(){for(var M=[],z=0;z<32;z++)M.push(5);hi(M,Sl,32);var L=[];for(z=0;z<=143;z++)L.push(8);for(;z<=255;z++)L.push(9);for(;z<=279;z++)L.push(7);for(;z<=287;z++)L.push(8);hi(L,di,288)})();var Ln=(function(){for(var z=Se?new Uint8Array(32768):[],L=0,P=0;L<xe.length-1;++L)for(;P<xe[L+1];++P)z[P]=L;for(;P<32768;++P)z[P]=29;var H=Se?new Uint8Array(259):[];for(L=0,P=0;L<se.length-1;++L)for(;P<se[L+1];++P)H[P]=L;function V(_e,ue){for(var fe=0;fe<_e.length;){var de=Math.min(65535,_e.length-fe),Ce=fe+de==_e.length;for(ue.write_shift(1,+Ce),ue.write_shift(2,de),ue.write_shift(2,~de&65535);de-- >0;)ue[ue.l++]=_e[fe++]}return ue.l}function ce(_e,ue){for(var fe=0,de=0,Ce=Se?new Uint16Array(32768):[];de<_e.length;){var De=Math.min(65535,_e.length-de);if(De<10){for(fe=ca(ue,fe,+(de+De==_e.length)),fe&7&&(fe+=8-(fe&7)),ue.l=fe/8|0,ue.write_shift(2,De),ue.write_shift(2,~De&65535);De-- >0;)ue[ue.l++]=_e[de++];fe=ue.l*8;continue}fe=ca(ue,fe,+(de+De==_e.length)+2);for(var Fe=0;De-- >0;){var Re=_e[de];Fe=(Fe<<5^Re)&32767;var Ne=-1,He=0;if((Ne=Ce[Fe])&&(Ne|=de&-32768,Ne>de&&(Ne-=32768),Ne<de))for(;_e[Ne+He]==_e[de+He]&&He<250;)++He;if(He>2){Re=H[He],Re<=22?fe=cn(ue,fe,be[Re+1]>>1)-1:(cn(ue,fe,3),fe+=5,cn(ue,fe,be[Re-23]>>5),fe+=3);var Ht=Re<8?0:Re-4>>2;Ht>0&&(zo(ue,fe,He-se[Re]),fe+=Ht),Re=z[de-Ne],fe=cn(ue,fe,be[Re]>>3),fe-=3;var zt=Re<4?0:Re-2>>1;zt>0&&(zo(ue,fe,de-Ne-xe[Re]),fe+=zt);for(var $t=0;$t<He;++$t)Ce[Fe]=de&32767,Fe=(Fe<<5^_e[de])&32767,++de;De-=He-1}else Re<=143?Re=Re+48:fe=Ya(ue,fe,1),fe=cn(ue,fe,be[Re]),Ce[Fe]=de&32767,++de}fe=cn(ue,fe,0)-1}return ue.l=(fe+7)/8|0,ue.l}return function(ue,fe){return ue.length<8?V(ue,fe):ce(ue,fe)}})();function rt(M){var z=Lr(50+Math.floor(M.length*1.1)),L=Ln(M,z);return z.slice(0,L)}var rr=Se?new Uint16Array(32768):Pt(32768),Xa=Se?new Uint16Array(32768):Pt(32768),jt=Se?new Uint16Array(128):Pt(128),hr=1,pi=1;function Ca(M,z){var L=tt(M,z)+257;z+=5;var P=tt(M,z)+1;z+=5;var H=bt(M,z)+4;z+=4;for(var V=0,ce=Se?new Uint8Array(19):Pt(19),_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ue=1,fe=Se?new Uint8Array(8):Pt(8),de=Se?new Uint8Array(8):Pt(8),Ce=ce.length,De=0;De<H;++De)ce[K[De]]=V=st(M,z),ue<V&&(ue=V),fe[V]++,z+=3;var Fe=0;for(fe[0]=0,De=1;De<=ue;++De)de[De]=Fe=Fe+fe[De-1]<<1;for(De=0;De<Ce;++De)(Fe=ce[De])!=0&&(_e[De]=de[Fe]++);var Re=0;for(De=0;De<Ce;++De)if(Re=ce[De],Re!=0){Fe=be[_e[De]]>>8-Re;for(var Ne=(1<<7-Re)-1;Ne>=0;--Ne)jt[Fe|Ne<<Re]=Re&7|De<<3}var He=[];for(ue=1;He.length<L+P;)switch(Fe=jt[Ie(M,z)],z+=Fe&7,Fe>>>=3){case 16:for(V=3+Wt(M,z),z+=2,Fe=He[He.length-1];V-- >0;)He.push(Fe);break;case 17:for(V=3+st(M,z),z+=3;V-- >0;)He.push(0);break;case 18:for(V=11+Ie(M,z),z+=7;V-- >0;)He.push(0);break;default:He.push(Fe),ue<Fe&&(ue=Fe);break}var Ht=He.slice(0,L),zt=He.slice(L);for(De=L;De<286;++De)Ht[De]=0;for(De=P;De<30;++De)zt[De]=0;return hr=hi(Ht,rr,286),pi=hi(zt,Xa,30),z}function Dx(M,z){if(M[0]==3&&!(M[1]&3))return[Lo(z),2];for(var L=0,P=0,H=uC(z||1<<18),V=0,ce=H.length>>>0,_e=0,ue=0;(P&1)==0;){if(P=st(M,L),L+=3,P>>>1)P>>1==1?(_e=9,ue=5):(L=Ca(M,L),_e=hr,ue=pi);else{L&7&&(L+=8-(L&7));var fe=M[L>>>3]|M[(L>>>3)+1]<<8;if(L+=32,fe>0)for(!z&&ce<V+fe&&(H=zi(H,V+fe),ce=H.length);fe-- >0;)H[V++]=M[L>>>3],L+=8;continue}for(;;){!z&&ce<V+32767&&(H=zi(H,V+32767),ce=H.length);var de=Kt(M,L,_e),Ce=P>>>1==1?di[de]:rr[de];if(L+=Ce&15,Ce>>>=4,(Ce>>>8&255)===0)H[V++]=Ce;else{if(Ce==256)break;Ce-=257;var De=Ce<8?0:Ce-4>>2;De>5&&(De=0);var Fe=V+se[Ce];De>0&&(Fe+=Kt(M,L,De),L+=De),de=Kt(M,L,ue),Ce=P>>>1==1?Sl[de]:Xa[de],L+=Ce&15,Ce>>>=4;var Re=Ce<4?0:Ce-2>>1,Ne=xe[Ce];for(Re>0&&(Ne+=Kt(M,L,Re),L+=Re),!z&&ce<Fe&&(H=zi(H,Fe+100),ce=H.length);V<Fe;)H[V]=H[V-Ne],++V}}}return z?[H,L+7>>>3]:[H.slice(0,V),L+7>>>3]}function _g(M,z){var L=M.slice(M.l||0),P=Dx(L,z);return M.l+=P[1],P[0]}function Eg(M,z){if(M)typeof console<"u"&&console.error(z);else throw new Error(z)}function Go(M,z){var L=M;ia(L,0);var P=[],H=[],V={FileIndex:P,FullPaths:H};k(V,{root:z.root});for(var ce=L.length-4;(L[ce]!=80||L[ce+1]!=75||L[ce+2]!=5||L[ce+3]!=6)&&ce>=0;)--ce;L.l=ce+4,L.l+=4;var _e=L.read_shift(2);L.l+=6;var ue=L.read_shift(4);for(L.l=ue,ce=0;ce<_e;++ce){L.l+=20;var fe=L.read_shift(4),de=L.read_shift(4),Ce=L.read_shift(2),De=L.read_shift(2),Fe=L.read_shift(2);L.l+=8;var Re=L.read_shift(4),Ne=c(L.slice(L.l+Ce,L.l+Ce+De));L.l+=Ce+De+Fe;var He=L.l;L.l=Re+4,Lu(L,fe,de,V,Ne),L.l=He}return V}function Lu(M,z,L,P,H){M.l+=2;var V=M.read_shift(2),ce=M.read_shift(2),_e=o(M);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var ue=M.read_shift(4),fe=M.read_shift(4),de=M.read_shift(4),Ce=M.read_shift(2),De=M.read_shift(2),Fe="",Re=0;Re<Ce;++Re)Fe+=String.fromCharCode(M[M.l++]);if(De){var Ne=c(M.slice(M.l,M.l+De));(Ne[21589]||{}).mt&&(_e=Ne[21589].mt),((H||{})[21589]||{}).mt&&(_e=H[21589].mt)}M.l+=De;var He=M.slice(M.l,M.l+fe);switch(ce){case 8:He=q(M,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var Ht=!1;V&8&&(ue=M.read_shift(4),ue==134695760&&(ue=M.read_shift(4),Ht=!0),fe=M.read_shift(4),de=M.read_shift(4)),fe!=z&&Eg(Ht,"Bad compressed size: "+z+" != "+fe),de!=L&&Eg(Ht,"Bad uncompressed size: "+L+" != "+de),Uu(P,Fe,He,{unsafe:!0,mt:_e})}function Pu(M,z){var L=z||{},P=[],H=[],V=Lr(1),ce=L.compression?8:0,_e=0,ue=0,fe=0,de=0,Ce=0,De=M.FullPaths[0],Fe=De,Re=M.FileIndex[0],Ne=[],He=0;for(ue=1;ue<M.FullPaths.length;++ue)if(Fe=M.FullPaths[ue].slice(De.length),Re=M.FileIndex[ue],!(!Re.size||!Re.content||Fe=="Sh33tJ5")){var Ht=de,zt=Lr(Fe.length);for(fe=0;fe<Fe.length;++fe)zt.write_shift(1,Fe.charCodeAt(fe)&127);zt=zt.slice(0,zt.l),Ne[Ce]=QF.buf(Re.content,0);var $t=Re.content;ce==8&&($t=X($t)),V=Lr(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,_e),V.write_shift(2,ce),Re.mt?l(V,Re.mt):V.write_shift(4,0),V.write_shift(-4,Ne[Ce]),V.write_shift(4,$t.length),V.write_shift(4,Re.content.length),V.write_shift(2,zt.length),V.write_shift(2,0),de+=V.length,P.push(V),de+=zt.length,P.push(zt),de+=$t.length,P.push($t),V=Lr(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,_e),V.write_shift(2,ce),V.write_shift(4,0),V.write_shift(-4,Ne[Ce]),V.write_shift(4,$t.length),V.write_shift(4,Re.content.length),V.write_shift(2,zt.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,Ht),He+=V.l,H.push(V),He+=zt.length,H.push(zt),++Ce}return V=Lr(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,Ce),V.write_shift(2,Ce),V.write_shift(4,He),V.write_shift(4,de),V.write_shift(2,0),Zl([Zl(P),Zl(H),V])}var Pn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Bu(M,z){if(M.ctype)return M.ctype;var L=M.name||"",P=L.match(/\.([^\.]+)$/);return P&&Pn[P[1]]||z&&(P=(L=z).match(/[\.\\]([^\.\\])+$/),P&&Pn[P[1]])?Pn[P[1]]:"application/octet-stream"}function Vo(M){for(var z=cC(M),L=[],P=0;P<z.length;P+=76)L.push(z.slice(P,P+76));return L.join(`\r
`)+`\r
`}function Nx(M){var z=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(fe){var de=fe.charCodeAt(0).toString(16).toUpperCase();return"="+(de.length==1?"0"+de:de)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],P=z.split(`\r
`),H=0;H<P.length;++H){var V=P[H];if(V.length==0){L.push("");continue}for(var ce=0;ce<V.length;){var _e=76,ue=V.slice(ce,ce+_e);ue.charAt(_e-1)=="="?_e--:ue.charAt(_e-2)=="="?_e-=2:ue.charAt(_e-3)=="="&&(_e-=3),ue=V.slice(ce,ce+_e),ce+=_e,ce<V.length&&(ue+="="),L.push(ue)}}return L.join(`\r
`)}function Ag(M){for(var z=[],L=0;L<M.length;++L){for(var P=M[L];L<=M.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+M[++L];z.push(P)}for(var H=0;H<z.length;++H)z[H]=z[H].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return Ii(z.join(`\r
`))}function $h(M,z,L){for(var P="",H="",V="",ce,_e=0;_e<10;++_e){var ue=z[_e];if(!ue||ue.match(/^\s*$/))break;var fe=ue.match(/^(.*?):\s*([^\s].*)$/);if(fe)switch(fe[1].toLowerCase()){case"content-location":P=fe[2].trim();break;case"content-type":V=fe[2].trim();break;case"content-transfer-encoding":H=fe[2].trim();break}}switch(++_e,H.toLowerCase()){case"base64":ce=Ii(Fn(z.slice(_e).join("")));break;case"quoted-printable":ce=Ag(z.slice(_e));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var de=Uu(M,P.slice(L.length),ce,{unsafe:!0});V&&(de.ctype=V)}function jo(M,z){if(ae(M.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=z&&z.root||"",P=(xt&&Buffer.isBuffer(M)?M.toString("binary"):ae(M)).split(`\r
`),H=0,V="";for(H=0;H<P.length;++H)if(V=P[H],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),L||(L=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),V.slice(0,L.length)!=L););var ce=(P[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var _e="--"+(ce[1]||""),ue=[],fe=[],de={FileIndex:ue,FullPaths:fe};k(de);var Ce,De=0;for(H=0;H<P.length;++H){var Fe=P[H];Fe!==_e&&Fe!==_e+"--"||(De++&&$h(de,P.slice(Ce,H),L),Ce=H)}return de}function Mx(M,z){var L=z||{},P=L.boundary||"SheetJS";P="------="+P;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],V=M.FullPaths[0],ce=V,_e=M.FileIndex[0],ue=1;ue<M.FullPaths.length;++ue)if(ce=M.FullPaths[ue].slice(V.length),_e=M.FileIndex[ue],!(!_e.size||!_e.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(He){return"_x"+He.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(He){return"_u"+He.charCodeAt(0).toString(16)+"_"});for(var fe=_e.content,de=xt&&Buffer.isBuffer(fe)?fe.toString("binary"):ae(fe),Ce=0,De=Math.min(1024,de.length),Fe=0,Re=0;Re<=De;++Re)(Fe=de.charCodeAt(Re))>=32&&Fe<128&&++Ce;var Ne=Ce>=De*4/5;H.push(P),H.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+ce),H.push("Content-Transfer-Encoding: "+(Ne?"quoted-printable":"base64")),H.push("Content-Type: "+Bu(_e,ce)),H.push(""),H.push(Ne?Nx(de):Vo(de))}return H.push(P+`--\r
`),H.join(`\r
`)}function yg(M){var z={};return k(z,M),z}function Uu(M,z,L,P){var H=P&&P.unsafe;H||k(M);var V=!H&&vt.find(M,z);if(!V){var ce=M.FullPaths[0];z.slice(0,ce.length)==ce?ce=z:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+z).replace("//","/")),V={name:i(z),type:2},M.FileIndex.push(V),M.FullPaths.push(ce),H||vt.utils.cfb_gc(M)}return V.content=L,V.size=L?L.length:0,P&&(P.CLSID&&(V.clsid=P.CLSID),P.mt&&(V.mt=P.mt),P.ct&&(V.ct=P.ct)),V}function Tg(M,z){k(M);var L=vt.find(M,z);if(L){for(var P=0;P<M.FileIndex.length;++P)if(M.FileIndex[P]==L)return M.FileIndex.splice(P,1),M.FullPaths.splice(P,1),!0}return!1}function Qh(M,z,L){k(M);var P=vt.find(M,z);if(P){for(var H=0;H<M.FileIndex.length;++H)if(M.FileIndex[H]==P)return M.FileIndex[H].name=i(L),M.FullPaths[H]=L,!0}return!1}function Zh(M){j(M,!0)}return t.find=Q,t.read=B,t.parse=g,t.write=Oe,t.writeFile=we,t.utils={cfb_new:yg,cfb_add:Uu,cfb_del:Tg,cfb_mov:Qh,cfb_gc:Zh,ReadShift:xd,CheckField:hO,prep_blob:ia,bconcat:Zl,use_zlib:N,_deflateRaw:rt,_inflateRaw:_g,consts:te},t})();function ZF(r){if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(r);t.open("r"),t.encoding="binary";var e=t.read();return t.close(),e}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+r)}function ms(r){for(var t=Object.keys(r),e=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(r,t[a])&&e.push(t[a]);return e}function ly(r){for(var t=[],e=ms(r),a=0;a!==e.length;++a)t[r[e[a]]]=e[a];return t}var Vm=new Date(1899,11,30,0,0,0);function ja(r,t){var e=r.getTime(),a=Vm.getTime()+(r.getTimezoneOffset()-Vm.getTimezoneOffset())*6e4;return(e-a)/(1440*60*1e3)}var Y4=new Date,JF=Vm.getTime()+(Y4.getTimezoneOffset()-Vm.getTimezoneOffset())*6e4,vC=Y4.getTimezoneOffset();function Cx(r){var t=new Date;return t.setTime(r*24*60*60*1e3+JF),t.getTimezoneOffset()!==vC&&t.setTime(t.getTime()+(t.getTimezoneOffset()-vC)*6e4),t}function eL(r){var t=0,e=0,a=!1,i=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var l=1;l!=i.length;++l)if(i[l]){switch(e=1,l>3&&(a=!0),i[l].slice(i[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[l].slice(i[l].length-1));case"D":e*=24;case"H":e*=60;case"M":if(a)e*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=e*parseInt(i[l],10)}return t}var _C=new Date("2017-02-19T19:06:09.000Z"),X4=isNaN(_C.getFullYear())?new Date("2/19/17"):_C,tL=X4.getFullYear()==2017;function Wr(r,t){var e=new Date(r);if(tL)return t>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):t<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(r instanceof Date)return r;if(X4.getFullYear()==1917&&!isNaN(e.getFullYear())){var a=e.getFullYear();return r.indexOf(""+a)>-1||e.setFullYear(e.getFullYear()+100),e}var i=r.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return r.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function wu(r,t){if(xt&&Buffer.isBuffer(r)){if(t){if(r[0]==255&&r[1]==254)return pd(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return pd(N4(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(r[0]==255&&r[1]==254)return pd(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return pd(new TextDecoder("utf-16be").decode(r.slice(2)))}var e={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(l){return e[l]||l})}catch{}for(var a=[],i=0;i!=r.length;++i)a.push(String.fromCharCode(r[i]));return a.join("")}function sa(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var t={};for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=sa(r[e]));return t}function ur(r,t){for(var e="";e.length<t;)e+=r;return e}function Bi(r){var t=Number(r);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(r))return t;var e=1,a=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(i,l){return e=-e,l}),!isNaN(t=Number(a)))?t/e:t}var rL=["january","february","march","april","may","june","july","august","september","october","november","december"];function Yh(r){var t=new Date(r),e=new Date(NaN),a=t.getYear(),i=t.getMonth(),l=t.getDate();if(isNaN(l))return e;var o=r.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&rL.indexOf(o)==-1)return e}else if(o.match(/[a-z]/))return e;return a<0||a>8099?e:(i>0||l>1)&&a!=101?t:r.match(/[^-0-9:,\/\\]/)?e:t}var aL=(function(){var r="abacaba".split(/(:?b)/i).length==5;return function(e,a,i){if(r||typeof a=="string")return e.split(a);for(var l=e.split(a),o=[l[0]],c=1;c<l.length;++c)o.push(i),o.push(l[c]);return o}})();function q4(r){return r?r.content&&r.type?wu(r.content,!0):r.data?fd(r.data):r.asNodeBuffer&&xt?fd(r.asNodeBuffer().toString("binary")):r.asBinary?fd(r.asBinary()):r._data&&r._data.getContent?fd(wu(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function W4(r){if(!r)return null;if(r.data)return lC(r.data);if(r.asNodeBuffer&&xt)return r.asNodeBuffer();if(r._data&&r._data.getContent){var t=r._data.getContent();return typeof t=="string"?lC(t):Array.prototype.slice.call(t)}return r.content&&r.type?r.content:null}function nL(r){return r&&r.name.slice(-4)===".bin"?W4(r):q4(r)}function Zn(r,t){for(var e=r.FullPaths||ms(r.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),i=a.replace(/\\/g,"/"),l=0;l<e.length;++l){var o=e[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||i==o)return r.files?r.files[e[l]]:r.FileIndex[l]}return null}function oy(r,t){var e=Zn(r,t);if(e==null)throw new Error("Cannot find file "+t+" in zip");return e}function wr(r,t,e){if(!e)return nL(oy(r,t));if(!t)return null;try{return wr(r,t)}catch{return null}}function Mn(r,t,e){if(!e)return q4(oy(r,t));if(!t)return null;try{return Mn(r,t)}catch{return null}}function iL(r,t,e){return W4(oy(r,t))}function EC(r){for(var t=r.FullPaths||ms(r.files),e=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&e.push(t[a].replace(/^Root Entry[\/]/,""));return e.sort()}function sL(r,t,e){if(r.FullPaths){if(typeof e=="string"){var a;return xt?a=Ou(e):a=bF(e),vt.utils.cfb_add(r,t,a)}vt.utils.cfb_add(r,t,e)}else r.file(t,e)}function K4(r,t){switch(t.type){case"base64":return vt.read(r,{type:"base64"});case"binary":return vt.read(r,{type:"binary"});case"buffer":case"array":return vt.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function dd(r,t){if(r.charAt(0)=="/")return r.slice(1);var e=t.split("/");t.slice(-1)!="/"&&e.pop();for(var a=r.split("/");a.length!==0;){var i=a.shift();i===".."?e.pop():i!=="."&&e.push(i)}return e.join("/")}var $4=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,lL=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,AC=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,oL=/<[^>]*>/g,wa=$4.match(AC)?AC:oL,cL=/<\w*:/,uL=/<(\/?)\w+:/;function We(r,t,e){for(var a={},i=0,l=0;i!==r.length&&!((l=r.charCodeAt(i))===32||l===10||l===13);++i);if(t||(a[0]=r.slice(0,i)),i===r.length)return a;var o=r.match(lL),c=0,f="",d=0,g="",m="",v=1;if(o)for(d=0;d!=o.length;++d){for(m=o[d],l=0;l!=m.length&&m.charCodeAt(l)!==61;++l);for(g=m.slice(0,l).trim();m.charCodeAt(l+1)==32;)++l;for(v=(i=m.charCodeAt(l+1))==34||i==39?1:0,f=m.slice(l+1+v,m.length-v),c=0;c!=g.length&&g.charCodeAt(c)!==58;++c);if(c===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),a[g]=f,a[g.toLowerCase()]=f;else{var _=(c===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(c+1);if(a[_]&&g.slice(c-3,c)=="ext")continue;a[_]=f,a[_.toLowerCase()]=f}}return a}function vs(r){return r.replace(uL,"<$1")}var Q4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},fL=ly(Q4),Et=(function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function e(a){var i=a+"",l=i.indexOf("<![CDATA[");if(l==-1)return i.replace(r,function(c,f){return Q4[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,f){return String.fromCharCode(parseInt(f,16))});var o=i.indexOf("]]>");return e(i.slice(0,l))+i.slice(l+9,o)+e(i.slice(o+3))}})(),hL=/[&<>'"]/g,dL=/[\u0000-\u001f]/g;function cy(r){var t=r+"";return t.replace(hL,function(e){return fL[e]}).replace(/\n/g,"<br/>").replace(dL,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var yC=(function(){var r=/&#(\d+);/g;function t(e,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(r,t)}})();function tr(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function nE(r){for(var t="",e=0,a=0,i=0,l=0,o=0,c=0;e<r.length;){if(a=r.charCodeAt(e++),a<128){t+=String.fromCharCode(a);continue}if(i=r.charCodeAt(e++),a>191&&a<224){o=(a&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(l=r.charCodeAt(e++),a<240){t+=String.fromCharCode((a&15)<<12|(i&63)<<6|l&63);continue}o=r.charCodeAt(e++),c=((a&7)<<18|(i&63)<<12|(l&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function TC(r){var t=Lo(2*r.length),e,a,i=1,l=0,o=0,c;for(a=0;a<r.length;a+=i)i=1,(c=r.charCodeAt(a))<128?e=c:c<224?(e=(c&31)*64+(r.charCodeAt(a+1)&63),i=2):c<240?(e=(c&15)*4096+(r.charCodeAt(a+1)&63)*64+(r.charCodeAt(a+2)&63),i=3):(i=4,e=(c&7)*262144+(r.charCodeAt(a+1)&63)*4096+(r.charCodeAt(a+2)&63)*64+(r.charCodeAt(a+3)&63),e-=65536,o=55296+(e>>>10&1023),e=56320+(e&1023)),o!==0&&(t[l++]=o&255,t[l++]=o>>>8,o=0),t[l++]=e%256,t[l++]=e>>>8;return t.slice(0,l).toString("ucs2")}function SC(r){return Ou(r,"binary").toString("utf8")}var X1="foo bar baz",Vt=xt&&(SC(X1)==nE(X1)&&SC||TC(X1)==nE(X1)&&TC)||nE,pd=xt?function(r){return Ou(r,"utf8").toString("binary")}:function(r){for(var t=[],e=0,a=0,i=0;e<r.length;)switch(a=r.charCodeAt(e++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,i=r.charCodeAt(e++)-56320+(a<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Nd=(function(){var r={};return function(e,a){var i=e+"|"+(a||"");return r[i]?r[i]:r[i]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",a||"")}})(),Z4=(function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var a=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<r.length;++i)a=a.replace(r[i][0],r[i][1]);return a}})(),pL=(function(){var r={};return function(e){return r[e]!==void 0?r[e]:r[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}})(),gL=/<\/?(?:vt:)?variant>/g,mL=/<(?:vt:)([^>]*)>([\s\S]*)</;function bC(r,t){var e=We(r),a=r.match(pL(e.baseType))||[],i=[];if(a.length!=e.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+e.size);return i}return a.forEach(function(l){var o=l.replace(gL,"").match(mL);o&&i.push({v:Vt(o[2]),t:o[1]})}),i}var xL=/(^\s|\s$|\n)/;function vL(r){return ms(r).map(function(t){return" "+t+'="'+r[t]+'"'}).join("")}function _L(r,t,e){return"<"+r+(e!=null?vL(e):"")+(t!=null?(t.match(xL)?' xml:space="preserve"':"")+">"+t+"</"+r:"/")+">"}function uy(r){if(xt&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return Vt(Du(ny(r)));throw new Error("Bad input format: expected Buffer or string")}var Md=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,EL={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},AL=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function yL(r,t){for(var e=1-2*(r[t+7]>>>7),a=((r[t+7]&127)<<4)+(r[t+6]>>>4&15),i=r[t+6]&15,l=5;l>=0;--l)i=i*256+r[t+l];return a==2047?i==0?e*(1/0):NaN:(a==0?a=-1022:(a-=1023,i+=Math.pow(2,52)),e*Math.pow(2,a-52)*i)}function TL(r,t,e){var a=(t<0||1/t==-1/0?1:0)<<7,i=0,l=0,o=a?-t:t;isFinite(o)?o==0?i=l=0:(i=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?i=-1022:(l-=Math.pow(2,52),i+=1023)):(i=2047,l=isNaN(t)?26985:0);for(var c=0;c<=5;++c,l/=256)r[e+c]=l&255;r[e+6]=(i&15)<<4|l&15,r[e+7]=i>>4|a}var wC=function(r){for(var t=[],e=10240,a=0;a<r[0].length;++a)if(r[0][a])for(var i=0,l=r[0][a].length;i<l;i+=e)t.push.apply(t,r[0][a].slice(i,i+e));return t},CC=xt?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(t){return Buffer.isBuffer(t)?t:Ou(t)})):wC(r)}:wC,RC=function(r,t,e){for(var a=[],i=t;i<e;i+=2)a.push(String.fromCharCode(gl(r,i)));return a.join("").replace(Ha,"")},fy=xt?function(r,t,e){return Buffer.isBuffer(r)?r.toString("utf16le",t,e).replace(Ha,""):RC(r,t,e)}:RC,kC=function(r,t,e){for(var a=[],i=t;i<t+e;++i)a.push(("0"+r[i].toString(16)).slice(-2));return a.join("")},J4=xt?function(r,t,e){return Buffer.isBuffer(r)?r.toString("hex",t,t+e):kC(r,t,e)}:kC,OC=function(r,t,e){for(var a=[],i=t;i<e;i++)a.push(String.fromCharCode(kf(r,i)));return a.join("")},dg=xt?function(t,e,a){return Buffer.isBuffer(t)?t.toString("utf8",e,a):OC(t,e,a)}:OC,eO=function(r,t){var e=On(r,t);return e>0?dg(r,t+4,t+4+e-1):""},tO=eO,rO=function(r,t){var e=On(r,t);return e>0?dg(r,t+4,t+4+e-1):""},aO=rO,nO=function(r,t){var e=2*On(r,t);return e>0?dg(r,t+4,t+4+e-1):""},iO=nO,sO=function(t,e){var a=On(t,e);return a>0?fy(t,e+4,e+4+a):""},lO=sO,oO=function(r,t){var e=On(r,t);return e>0?dg(r,t+4,t+4+e):""},cO=oO,uO=function(r,t){return yL(r,t)},jm=uO,fO=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};xt&&(tO=function(t,e){if(!Buffer.isBuffer(t))return eO(t,e);var a=t.readUInt32LE(e);return a>0?t.toString("utf8",e+4,e+4+a-1):""},aO=function(t,e){if(!Buffer.isBuffer(t))return rO(t,e);var a=t.readUInt32LE(e);return a>0?t.toString("utf8",e+4,e+4+a-1):""},iO=function(t,e){if(!Buffer.isBuffer(t))return nO(t,e);var a=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+a-1)},lO=function(t,e){if(!Buffer.isBuffer(t))return sO(t,e);var a=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+a)},cO=function(t,e){if(!Buffer.isBuffer(t))return oO(t,e);var a=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+a)},jm=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):uO(t,e)},fO=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var kf=function(r,t){return r[t]},gl=function(r,t){return r[t+1]*256+r[t]},SL=function(r,t){var e=r[t+1]*256+r[t];return e<32768?e:(65535-e+1)*-1},On=function(r,t){return r[t+3]*(1<<24)+(r[t+2]<<16)+(r[t+1]<<8)+r[t]},hc=function(r,t){return r[t+3]<<24|r[t+2]<<16|r[t+1]<<8|r[t]},bL=function(r,t){return r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3]};function xd(r,t){var e="",a,i,l=[],o,c,f,d;switch(t){case"dbcs":if(d=this.l,xt&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*r).toString("utf16le");else for(f=0;f<r;++f)e+=String.fromCharCode(gl(this,d)),d+=2;r*=2;break;case"utf8":e=dg(this,this.l,this.l+r);break;case"utf16le":r*=2,e=fy(this,this.l,this.l+r);break;case"wstr":return xd.call(this,r,"dbcs");case"lpstr-ansi":e=tO(this,this.l),r=4+On(this,this.l);break;case"lpstr-cp":e=aO(this,this.l),r=4+On(this,this.l);break;case"lpwstr":e=iO(this,this.l),r=4+2*On(this,this.l);break;case"lpp4":r=4+On(this,this.l),e=lO(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+On(this,this.l),e=cO(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,e="";(o=kf(this,this.l+r++))!==0;)l.push(Y1(o));e=l.join("");break;case"_wstr":for(r=0,e="";(o=gl(this,this.l+r))!==0;)l.push(Y1(o)),r+=2;r+=2,e=l.join("");break;case"dbcs-cont":for(e="",d=this.l,f=0;f<r;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=kf(this,d),this.l=d+1,c=xd.call(this,r-f,o?"dbcs-cont":"sbcs-cont"),l.join("")+c;l.push(Y1(gl(this,d))),d+=2}e=l.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(e="",d=this.l,f=0;f!=r;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=kf(this,d),this.l=d+1,c=xd.call(this,r-f,o?"dbcs-cont":"sbcs-cont"),l.join("")+c;l.push(Y1(kf(this,d))),d+=1}e=l.join("");break;default:switch(r){case 1:return a=kf(this,this.l),this.l++,a;case 2:return a=(t==="i"?SL:gl)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(r>0?hc:bL)(this,this.l),this.l+=4,a):(i=On(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return r==8?i=jm(this,this.l):i=jm([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;r=8;case 16:e=J4(this,this.l,r);break}}return this.l+=r,e}var wL=function(r,t,e){r[e]=t&255,r[e+1]=t>>>8&255,r[e+2]=t>>>16&255,r[e+3]=t>>>24&255},CL=function(r,t,e){r[e]=t&255,r[e+1]=t>>8&255,r[e+2]=t>>16&255,r[e+3]=t>>24&255},RL=function(r,t,e){r[e]=t&255,r[e+1]=t>>>8&255};function kL(r,t,e){var a=0,i=0;if(e==="dbcs"){for(i=0;i!=t.length;++i)RL(this,t.charCodeAt(i),this.l+2*i);a=2*t.length}else if(e==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;a=t.length}else if(e==="hex"){for(;i<r;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(e==="utf16le"){var l=Math.min(this.l+r,this.length);for(i=0;i<Math.min(t.length,r);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(r){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,wL(this,t,this.l);break;case 8:if(a=8,e==="f"){TL(this,t,this.l);break}case 16:break;case-4:a=4,CL(this,t,this.l);break}return this.l+=a,this}function hO(r,t){var e=J4(this,this.l,r.length>>1);if(e!==r)throw new Error(t+"Expected "+r+" saw "+e);this.l+=r.length>>1}function ia(r,t){r.l=t,r.read_shift=xd,r.chk=hO,r.write_shift=kL}function ba(r,t){r.l+=t}function Lr(r){var t=Lo(r);return ia(t,0),t}function Tl(r,t,e){if(r){var a,i,l;ia(r,r.l||0);for(var o=r.length,c=0,f=0;r.l<o;){c=r.read_shift(1),c&128&&(c=(c&127)+((r.read_shift(1)&127)<<7));var d=$m[c]||$m[65535];for(a=r.read_shift(1),l=a&127,i=1;i<4&&a&128;++i)l+=((a=r.read_shift(1))&127)<<7*i;f=r.l+l;var g=d.f&&d.f(r,l,e);if(r.l=f,t(g,d,c))return}}}function NA(){var r=[],t=xt?256:2048,e=function(d){var g=Lr(d);return ia(g,0),g},a=e(t),i=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&r.push(a),a=null)},l=function(d){return a&&d<a.length-a.l?a:(i(),a=e(Math.max(d+1,t)))},o=function(){return i(),Zl(r)},c=function(d){i(),a=d,a.l==null&&(a.l=a.length),l(t)};return{next:l,push:c,end:o,_bufs:r}}function vd(r,t,e){var a=sa(r);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!e||e.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function DC(r,t,e){var a=sa(r);return a.s=vd(a.s,t.s,e),a.e=vd(a.e,t.s,e),a}function _d(r,t){if(r.cRel&&r.c<0)for(r=sa(r);r.c<0;)r.c+=t>8?16384:256;if(r.rRel&&r.r<0)for(r=sa(r);r.r<0;)r.r+=t>8?1048576:t>5?65536:16384;var e=Qe(r);return!r.cRel&&r.cRel!=null&&(e=NL(e)),!r.rRel&&r.rRel!=null&&(e=OL(e)),e}function iE(r,t){return r.s.r==0&&!r.s.rRel&&r.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+Pr(r.s.c)+":"+(r.e.cRel?"":"$")+Pr(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(t.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+la(r.s.r)+":"+(r.e.rRel?"":"$")+la(r.e.r):_d(r.s,t.biff)+":"+_d(r.e,t.biff)}function hy(r){return parseInt(DL(r),10)-1}function la(r){return""+(r+1)}function OL(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function DL(r){return r.replace(/\$(\d+)$/,"$1")}function dy(r){for(var t=ML(r),e=0,a=0;a!==t.length;++a)e=26*e+t.charCodeAt(a)-64;return e-1}function Pr(r){if(r<0)throw new Error("invalid column "+r);var t="";for(++r;r;r=Math.floor((r-1)/26))t=String.fromCharCode((r-1)%26+65)+t;return t}function NL(r){return r.replace(/^([A-Z])/,"$$$1")}function ML(r){return r.replace(/^\$([A-Z])/,"$1")}function IL(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ba(r){for(var t=0,e=0,a=0;a<r.length;++a){var i=r.charCodeAt(a);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(e=26*e+(i-64))}return{c:e-1,r:t-1}}function Qe(r){for(var t=r.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(r.r+1)}function Wh(r){var t=r.indexOf(":");return t==-1?{s:Ba(r),e:Ba(r)}:{s:Ba(r.slice(0,t)),e:Ba(r.slice(t+1))}}function _t(r,t){return typeof t>"u"||typeof t=="number"?_t(r.s,r.e):(typeof r!="string"&&(r=Qe(r)),typeof t!="string"&&(t=Qe(t)),r==t?r:r+":"+t)}function fr(r){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,a=0,i=0,l=r.length;for(e=0;a<l&&!((i=r.charCodeAt(a)-64)<1||i>26);++a)e=26*e+i;for(t.s.c=--e,e=0;a<l&&!((i=r.charCodeAt(a)-48)<0||i>9);++a)e=10*e+i;if(t.s.r=--e,a===l||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,e=0;a!=l&&!((i=r.charCodeAt(a)-64)<1||i>26);++a)e=26*e+i;for(t.e.c=--e,e=0;a!=l&&!((i=r.charCodeAt(a)-48)<0||i>9);++a)e=10*e+i;return t.e.r=--e,t}function NC(r,t){var e=r.t=="d"&&t instanceof Date;if(r.z!=null)try{return r.w=ui(r.z,e?ja(t):t)}catch{}try{return r.w=ui((r.XF||{}).numFmtId||(e?14:0),e?ja(t):t)}catch{return""+t}}function El(r,t,e){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&e&&e.dateNF&&(r.z=e.dateNF),r.t=="e"?Iu[r.v]||r.v:t==null?NC(r,r.v):NC(r,t))}function Ho(r,t){var e=t&&t.sheet?t.sheet:"Sheet1",a={};return a[e]=r,{SheetNames:[e],Sheets:a}}function dO(r,t,e){var a=e||{},i=r?Array.isArray(r):a.dense,l=r||(i?[]:{}),o=0,c=0;if(l&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var f=typeof a.origin=="string"?Ba(a.origin):a.origin;o=f.r,c=f.c}l["!ref"]||(l["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var g=fr(l["!ref"]);d.s.c=g.s.c,d.s.r=g.s.r,d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),o==-1&&(d.e.r=o=g.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[m].length;++v)if(!(typeof t[m][v]>"u")){var _={v:t[m][v]},A=o+m,y=c+v;if(d.s.r>A&&(d.s.r=A),d.s.c>y&&(d.s.c=y),d.e.r<A&&(d.e.r=A),d.e.c<y&&(d.e.c=y),t[m][v]&&typeof t[m][v]=="object"&&!Array.isArray(t[m][v])&&!(t[m][v]instanceof Date))_=t[m][v];else if(Array.isArray(_.v)&&(_.f=t[m][v][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(a.nullError)_.t="e",_.v=0;else if(a.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=a.dateNF||Je[14],a.cellDates?(_.t="d",_.w=ui(_.z,ja(_.v))):(_.t="n",_.v=ja(_.v),_.w=ui(_.z,_.v))):_.t="s";if(i)l[A]||(l[A]=[]),l[A][y]&&l[A][y].z&&(_.z=l[A][y].z),l[A][y]=_;else{var T=Qe({c:y,r:A});l[T]&&l[T].z&&(_.z=l[T].z),l[T]=_}}}return d.s.c<1e7&&(l["!ref"]=_t(d)),l}function Kh(r,t){return dO(null,r,t)}function FL(r){return r.read_shift(4,"i")}function Sa(r){var t=r.read_shift(4);return t===0?"":r.read_shift(t,"dbcs")}function LL(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function py(r,t){var e=r.l,a=r.read_shift(1),i=Sa(r),l=[],o={t:i,h:i};if((a&1)!==0){for(var c=r.read_shift(4),f=0;f!=c;++f)l.push(LL(r));o.r=l}else o.r=[{ich:0,ifnt:0}];return r.l=e+t,o}var PL=py;function fi(r){var t=r.read_shift(4),e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:t,iStyleRef:e}}function Nu(r){var t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:t}}var BL=Sa;function gy(r){var t=r.read_shift(4);return t===0||t===4294967295?"":r.read_shift(t,"dbcs")}var UL=Sa,MA=gy;function my(r){var t=r.slice(r.l,r.l+4),e=t[0]&1,a=t[0]&2;r.l+=4;var i=a===0?jm([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):hc(t,0)>>2;return e?i/100:i}function pO(r){var t={s:{},e:{}};return t.s.r=r.read_shift(4),t.e.r=r.read_shift(4),t.s.c=r.read_shift(4),t.e.c=r.read_shift(4),t}var Mu=pO;function ya(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function HL(r){var t={},e=r.read_shift(1),a=e>>>1,i=r.read_shift(1),l=r.read_shift(2,"i"),o=r.read_shift(1),c=r.read_shift(1),f=r.read_shift(1);switch(r.l++,a){case 0:t.auto=1;break;case 1:t.index=i;var d=Au[i];d&&(t.rgb=Fd(d));break;case 2:t.rgb=Fd([o,c,f]);break;case 3:t.theme=i;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function zL(r){var t=r.read_shift(1);r.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function gO(r,t){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=r.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return e[r.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return r.l-=4,r.read_shift(0,t==1?"lpstr":"lpwstr")}function GL(r){return gO(r,1)}function VL(r){return gO(r,2)}var xy=2,on=3,q1=11,MC=12,Ym=19,W1=64,jL=65,YL=71,XL=4108,qL=4126,qr=80,mO=81,WL=[qr,mO],KL={1:{n:"CodePage",t:xy},2:{n:"Category",t:qr},3:{n:"PresentationFormat",t:qr},4:{n:"ByteCount",t:on},5:{n:"LineCount",t:on},6:{n:"ParagraphCount",t:on},7:{n:"SlideCount",t:on},8:{n:"NoteCount",t:on},9:{n:"HiddenCount",t:on},10:{n:"MultimediaClipCount",t:on},11:{n:"ScaleCrop",t:q1},12:{n:"HeadingPairs",t:XL},13:{n:"TitlesOfParts",t:qL},14:{n:"Manager",t:qr},15:{n:"Company",t:qr},16:{n:"LinksUpToDate",t:q1},17:{n:"CharacterCount",t:on},19:{n:"SharedDoc",t:q1},22:{n:"HyperlinksChanged",t:q1},23:{n:"AppVersion",t:on,p:"version"},24:{n:"DigSig",t:jL},26:{n:"ContentType",t:qr},27:{n:"ContentStatus",t:qr},28:{n:"Language",t:qr},29:{n:"Version",t:qr},255:{},2147483648:{n:"Locale",t:Ym},2147483651:{n:"Behavior",t:Ym},1919054434:{}},$L={1:{n:"CodePage",t:xy},2:{n:"Title",t:qr},3:{n:"Subject",t:qr},4:{n:"Author",t:qr},5:{n:"Keywords",t:qr},6:{n:"Comments",t:qr},7:{n:"Template",t:qr},8:{n:"LastAuthor",t:qr},9:{n:"RevNumber",t:qr},10:{n:"EditTime",t:W1},11:{n:"LastPrinted",t:W1},12:{n:"CreatedDate",t:W1},13:{n:"ModifiedDate",t:W1},14:{n:"PageCount",t:on},15:{n:"WordCount",t:on},16:{n:"CharCount",t:on},17:{n:"Thumbnail",t:YL},18:{n:"Application",t:qr},19:{n:"DocSecurity",t:on},255:{},2147483648:{n:"Locale",t:Ym},2147483651:{n:"Behavior",t:Ym},1919054434:{}},IC={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},QL=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ZL(r){return r.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var JL=ZL([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Au=sa(JL),Iu={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},xO={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},FC={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function e6(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function t6(r){var t=e6();if(!r||!r.match)return t;var e={};if((r.match(wa)||[]).forEach(function(a){var i=We(a);switch(i[0].replace(cL,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[i.Extension]=i.ContentType;break;case"<Override":t[FC[i.ContentType]]!==void 0&&t[FC[i.ContentType]].push(i.PartName);break}}),t.xmlns!==EL.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=e,delete t.calcchains,t}var Df={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function IA(r){var t=r.lastIndexOf("/");return r.slice(0,t+1)+"_rels/"+r.slice(t+1)+".rels"}function Ed(r,t){var e={"!id":{}};if(!r)return e;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(r.match(wa)||[]).forEach(function(i){var l=We(i);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var c=l.TargetMode==="External"?l.Target:dd(l.Target,t);e[c]=o,a[l.Id]=o}}),e["!id"]=a,e}var r6="application/vnd.oasis.opendocument.spreadsheet";function a6(r,t){for(var e=uy(r),a,i;a=Md.exec(e);)switch(a[3]){case"manifest":break;case"file-entry":if(i=We(a[0],!1),i.path=="/"&&i.type!==r6)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}var Ad=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],n6=(function(){for(var r=new Array(Ad.length),t=0;t<Ad.length;++t){var e=Ad[t],a="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);r[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return r})();function vO(r){var t={};r=Vt(r);for(var e=0;e<Ad.length;++e){var a=Ad[e],i=r.match(n6[e]);i!=null&&i.length>0&&(t[a[1]]=Et(i[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Wr(t[a[1]]))}return t}var i6=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function _O(r,t,e,a){var i=[];if(typeof r=="string")i=bC(r,a);else for(var l=0;l<r.length;++l)i=i.concat(r[l].map(function(g){return{v:g}}));var o=typeof t=="string"?bC(t,a).map(function(g){return g.v}):t,c=0,f=0;if(o.length>0)for(var d=0;d!==i.length;d+=2){switch(f=+i[d+1].v,i[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":e.Worksheets=f,e.SheetNames=o.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":e.NamedRanges=f,e.DefinedNames=o.slice(c,c+f);break;case"Charts":case"Diagramme":e.Chartsheets=f,e.ChartNames=o.slice(c,c+f);break}c+=f}}function s6(r,t,e){var a={};return t||(t={}),r=Vt(r),i6.forEach(function(i){var l=(r.match(Nd(i[0]))||[])[1];switch(i[2]){case"string":l&&(t[i[1]]=Et(l));break;case"bool":t[i[1]]=l==="true";break;case"raw":var o=r.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(a[i[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&_O(a.HeadingPairs,a.TitlesOfParts,t,e),t}var l6=/<[^>]+>[^<]*/g;function o6(r,t){var e={},a="",i=r.match(l6);if(i)for(var l=0;l!=i.length;++l){var o=i[l],c=We(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Et(c.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var f=o.split(">"),d=f[0].slice(4),g=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":e[a]=Et(g);break;case"bool":e[a]=tr(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[a]=parseInt(g,10);break;case"r4":case"r8":case"decimal":e[a]=parseFloat(g);break;case"filetime":case"date":e[a]=Wr(g);break;case"cy":case"error":e[a]=Et(g);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,f)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return e}var c6={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},sE;function u6(r,t,e){sE||(sE=ly(c6)),t=sE[t]||t,r[t]=e}function vy(r){var t=r.read_shift(4),e=r.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function EO(r,t,e){var a=r.l,i=r.read_shift(0,"lpstr-cp");if(e)for(;r.l-a&3;)++r.l;return i}function AO(r,t,e){var a=r.read_shift(0,"lpwstr");return a}function yO(r,t,e){return t===31?AO(r):EO(r,t,e)}function FA(r,t,e){return yO(r,t,e===!1?0:4)}function f6(r,t){if(!t)throw new Error("VtUnalignedString must have positive length");return yO(r,t,0)}function h6(r){for(var t=r.read_shift(4),e=[],a=0;a!=t;++a){var i=r.l;e[a]=r.read_shift(0,"lpwstr").replace(Ha,""),r.l-i&2&&(r.l+=2)}return e}function d6(r){for(var t=r.read_shift(4),e=[],a=0;a!=t;++a)e[a]=r.read_shift(0,"lpstr-cp").replace(Ha,"");return e}function p6(r){var t=r.l,e=Xm(r,mO);r[r.l]==0&&r[r.l+1]==0&&r.l-t&2&&(r.l+=2);var a=Xm(r,on);return[e,a]}function g6(r){for(var t=r.read_shift(4),e=[],a=0;a<t/2;++a)e.push(p6(r));return e}function LC(r,t){for(var e=r.read_shift(4),a={},i=0;i!=e;++i){var l=r.read_shift(4),o=r.read_shift(4);a[l]=r.read_shift(o,t===1200?"utf16le":"utf8").replace(Ha,"").replace(hd,"!"),t===1200&&o%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),a}function TO(r){var t=r.read_shift(4),e=r.slice(r.l,r.l+t);return r.l+=t,(t&3)>0&&(r.l+=4-(t&3)&3),e}function m6(r){var t={};return t.Size=r.read_shift(4),r.l+=t.Size+3-(t.Size-1)%4,t}function Xm(r,t,e){var a=r.read_shift(2),i,l=e||{};if(r.l+=2,t!==MC&&a!==t&&WL.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===MC?a:t){case 2:return i=r.read_shift(2,"i"),l.raw||(r.l+=2),i;case 3:return i=r.read_shift(4,"i"),i;case 11:return r.read_shift(4)!==0;case 19:return i=r.read_shift(4),i;case 30:return EO(r,a,4).replace(Ha,"");case 31:return AO(r);case 64:return vy(r);case 65:return TO(r);case 71:return m6(r);case 80:return FA(r,a,!l.raw).replace(Ha,"");case 81:return f6(r,a).replace(Ha,"");case 4108:return g6(r);case 4126:case 4127:return a==4127?h6(r):d6(r);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function PC(r,t){var e=r.l,a=r.read_shift(4),i=r.read_shift(4),l=[],o=0,c=0,f=-1,d={};for(o=0;o!=i;++o){var g=r.read_shift(4),m=r.read_shift(4);l[o]=[g,m+e]}l.sort(function(R,C){return R[1]-C[1]});var v={};for(o=0;o!=i;++o){if(r.l!==l[o][1]){var _=!0;if(o>0&&t)switch(t[l[o-1][0]].t){case 2:r.l+2===l[o][1]&&(r.l+=2,_=!1);break;case 80:r.l<=l[o][1]&&(r.l=l[o][1],_=!1);break;case 4108:r.l<=l[o][1]&&(r.l=l[o][1],_=!1);break}if((!t||o==0)&&r.l<=l[o][1]&&(_=!1,r.l=l[o][1]),_)throw new Error("Read Error: Expected address "+l[o][1]+" at "+r.l+" :"+o)}if(t){var A=t[l[o][0]];if(v[A.n]=Xm(r,A.t,{raw:!0}),A.p==="version"&&(v[A.n]=String(v[A.n]>>16)+"."+("0000"+String(v[A.n]&65535)).slice(-4)),A.n=="CodePage")switch(v[A.n]){case 0:v[A.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Fi(c=v[A.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[A.n])}}else if(l[o][0]===1){if(c=v.CodePage=Xm(r,xy),Fi(c),f!==-1){var y=r.l;r.l=l[f][1],d=LC(r,c),r.l=y}}else if(l[o][0]===0){if(c===0){f=o,r.l=l[o+1][1];continue}d=LC(r,c)}else{var T=d[l[o][0]],S;switch(r[r.l]){case 65:r.l+=4,S=TO(r);break;case 30:r.l+=4,S=FA(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,S=FA(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,S=r.read_shift(4,"i");break;case 19:r.l+=4,S=r.read_shift(4);break;case 5:r.l+=4,S=r.read_shift(8,"f");break;case 11:r.l+=4,S=gr(r,4);break;case 64:r.l+=4,S=Wr(vy(r));break;default:throw new Error("unparsed value: "+r[r.l])}v[T]=S}}return r.l=e+a,v}function BC(r,t,e){var a=r.content;if(!a)return{};ia(a,0);var i,l,o,c,f=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),g=a.read_shift(16);if(g!==vt.utils.consts.HEADER_CLSID&&g!==e)throw new Error("Bad PropertySet CLSID "+g);if(i=a.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(l=a.read_shift(16),c=a.read_shift(4),i===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);i===2&&(o=a.read_shift(16),f=a.read_shift(4));var m=PC(a,t),v={SystemIdentifier:d};for(var _ in m)v[_]=m[_];if(v.FMTID=l,i===1)return v;if(f-a.l==2&&(a.l+=2),a.l!==f)throw new Error("Length mismatch 2: "+a.l+" !== "+f);var A;try{A=PC(a,null)}catch{}for(_ in A)v[_]=A[_];return v.FMTID=[l,o],v}function Kl(r,t){return r.read_shift(t),null}function x6(r,t,e){for(var a=[],i=r.l+t;r.l<i;)a.push(e(r,i-r.l));if(i!==r.l)throw new Error("Slurp error");return a}function gr(r,t){return r.read_shift(t)===1}function Cr(r){return r.read_shift(2,"u")}function SO(r,t){return x6(r,t,Cr)}function v6(r){var t=r.read_shift(1),e=r.read_shift(1);return e===1?t:t===1}function pg(r,t,e){var a=r.read_shift(e&&e.biff>=12?2:1),i="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var l=r.read_shift(1);l&&(i="dbcs-cont")}else e.biff==12&&(i="wstr");e.biff>=2&&e.biff<=5&&(i="cpstr");var o=a?r.read_shift(a,i):"";return o}function _6(r){var t=r.read_shift(2),e=r.read_shift(1),a=e&4,i=e&8,l=1+(e&1),o=0,c,f={};i&&(o=r.read_shift(2)),a&&(c=r.read_shift(4));var d=l==2?"dbcs-cont":"sbcs-cont",g=t===0?"":r.read_shift(t,d);return i&&(r.l+=4*o),a&&(r.l+=c),f.t=g,i||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function Cu(r,t,e){var a;if(e){if(e.biff>=2&&e.biff<=5)return r.read_shift(t,"cpstr");if(e.biff>=12)return r.read_shift(t,"dbcs-cont")}var i=r.read_shift(1);return i===0?a=r.read_shift(t,"sbcs-cont"):a=r.read_shift(t,"dbcs-cont"),a}function gg(r,t,e){var a=r.read_shift(e&&e.biff==2?1:2);return a===0?(r.l++,""):Cu(r,a,e)}function Fu(r,t,e){if(e.biff>5)return gg(r,t,e);var a=r.read_shift(1);return a===0?(r.l++,""):r.read_shift(a,e.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function E6(r){var t=r.read_shift(1);r.l++;var e=r.read_shift(2);return r.l+=2,[t,e]}function A6(r){var t=r.read_shift(4),e=r.l,a=!1;t>24&&(r.l+=t-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),r.l=e);var i=r.read_shift((a?t-24:t)>>1,"utf16le").replace(Ha,"");return a&&(r.l+=24),i}function y6(r){for(var t=r.read_shift(2),e="";t-- >0;)e+="../";var a=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=r.read_shift(4);if(i===0)return e+a.replace(/\\/g,"/");var l=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=r.read_shift(l>>1,"utf16le").replace(Ha,"");return e+o}function T6(r,t){var e=r.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return A6(r);case"0303000000000000c000000000000046":return y6(r);default:throw new Error("Unsupported Moniker "+e)}}function K1(r){var t=r.read_shift(4),e=t>0?r.read_shift(t,"utf16le").replace(Ha,""):"";return e}function S6(r,t){var e=r.l+t,a=r.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var i=r.read_shift(2);r.l+=2;var l,o,c,f,d="",g,m;i&16&&(l=K1(r,e-r.l)),i&128&&(o=K1(r,e-r.l)),(i&257)===257&&(c=K1(r,e-r.l)),(i&257)===1&&(f=T6(r,e-r.l)),i&8&&(d=K1(r,e-r.l)),i&32&&(g=r.read_shift(16)),i&64&&(m=vy(r)),r.l=e;var v=o||c||f||"";v&&d&&(v+="#"+d),v||(v="#"+d),i&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var _={Target:v};return g&&(_.guid=g),m&&(_.time=m),l&&(_.Tooltip=l),_}function bO(r){var t=r.read_shift(1),e=r.read_shift(1),a=r.read_shift(1),i=r.read_shift(1);return[t,e,a,i]}function wO(r,t){var e=bO(r);return e[3]=0,e}function _s(r){var t=r.read_shift(2),e=r.read_shift(2),a=r.read_shift(2);return{r:t,c:e,ixfe:a}}function b6(r){var t=r.read_shift(2),e=r.read_shift(2);return r.l+=8,{type:t,flags:e}}function w6(r,t,e){return t===0?"":Fu(r,t,e)}function C6(r,t,e){var a=e.biff>8?4:2,i=r.read_shift(a),l=r.read_shift(a,"i"),o=r.read_shift(a,"i");return[i,l,o]}function CO(r){var t=r.read_shift(2),e=my(r);return[t,e]}function R6(r,t,e){r.l+=4,t-=4;var a=r.l+t,i=pg(r,t,e),l=r.read_shift(2);if(a-=r.l,l!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+l);return r.l+=l,i}function Rx(r){var t=r.read_shift(2),e=r.read_shift(2),a=r.read_shift(2),i=r.read_shift(2);return{s:{c:a,r:t},e:{c:i,r:e}}}function RO(r){var t=r.read_shift(2),e=r.read_shift(2),a=r.read_shift(1),i=r.read_shift(1);return{s:{c:a,r:t},e:{c:i,r:e}}}var k6=RO;function kO(r){r.l+=4;var t=r.read_shift(2),e=r.read_shift(2),a=r.read_shift(2);return r.l+=12,[e,t,a]}function O6(r){var t={};return r.l+=4,r.l+=16,t.fSharedNote=r.read_shift(2),r.l+=4,t}function D6(r){var t={};return r.l+=4,r.cf=r.read_shift(2),t}function fa(r){r.l+=2,r.l+=r.read_shift(2)}var N6={0:fa,4:fa,5:fa,6:fa,7:D6,8:fa,9:fa,10:fa,11:fa,12:fa,13:O6,14:fa,15:fa,16:fa,17:fa,18:fa,19:fa,20:fa,21:kO};function M6(r,t){for(var e=r.l+t,a=[];r.l<e;){var i=r.read_shift(2);r.l-=2;try{a.push(N6[i](r,e-r.l))}catch{return r.l=e,a}}return r.l!=e&&(r.l=e),a}function $1(r,t){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=r.read_shift(2),t-=2,t>=2&&(e.dt=r.read_shift(2),r.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return r.read_shift(t),e}function I6(r,t){return t===0||r.read_shift(2),1200}function F6(r,t,e){if(e.enc)return r.l+=t,"";var a=r.l,i=Fu(r,0,e);return r.read_shift(t+a-r.l),i}function L6(r,t,e){var a=e&&e.biff==8||t==2?r.read_shift(2):(r.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function P6(r,t,e){var a=r.read_shift(4),i=r.read_shift(1)&3,l=r.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=pg(r,0,e);return o.length===0&&(o="Sheet1"),{pos:a,hs:i,dt:l,name:o}}function B6(r,t){for(var e=r.l+t,a=r.read_shift(4),i=r.read_shift(4),l=[],o=0;o!=i&&r.l<e;++o)l.push(_6(r));return l.Count=a,l.Unique=i,l}function U6(r,t){var e={};return e.dsst=r.read_shift(2),r.l+=t-2,e}function H6(r){var t={};t.r=r.read_shift(2),t.c=r.read_shift(2),t.cnt=r.read_shift(2)-t.c;var e=r.read_shift(2);r.l+=4;var a=r.read_shift(1);return r.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=e/20),t}function z6(r){var t=b6(r);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var e=r.read_shift(4);return e!==0}function G6(r){return r.read_shift(2),r.read_shift(4)}function UC(r,t,e){var a=0;e&&e.biff==2||(a=r.read_shift(2));var i=r.read_shift(2);e&&e.biff==2&&(a=1-(i>>15),i&=32767);var l={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[l,i]}function V6(r){var t=r.read_shift(2),e=r.read_shift(2),a=r.read_shift(2),i=r.read_shift(2),l=r.read_shift(2),o=r.read_shift(2),c=r.read_shift(2),f=r.read_shift(2),d=r.read_shift(2);return{Pos:[t,e],Dim:[a,i],Flags:l,CurTab:o,FirstTab:c,Selected:f,TabRatio:d}}function j6(r,t,e){if(e&&e.biff>=2&&e.biff<5)return{};var a=r.read_shift(2);return{RTL:a&64}}function Y6(){}function X6(r,t,e){var a={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return a.name=pg(r,0,e),a}function q6(r){var t=_s(r);return t.isst=r.read_shift(4),t}function W6(r,t,e){e.biffguess&&e.biff==2&&(e.biff=5);var a=r.l+t,i=_s(r);e.biff==2&&r.l++;var l=gg(r,a-r.l,e);return i.val=l,i}function K6(r,t,e){var a=r.read_shift(2),i=Fu(r,0,e);return[a,i]}var $6=Fu;function HC(r,t,e){var a=r.l+t,i=e.biff==8||!e.biff?4:2,l=r.read_shift(i),o=r.read_shift(i),c=r.read_shift(2),f=r.read_shift(2);return r.l=a,{s:{r:l,c},e:{r:o,c:f}}}function Q6(r){var t=r.read_shift(2),e=r.read_shift(2),a=CO(r);return{r:t,c:e,ixfe:a[0],rknum:a[1]}}function Z6(r,t){for(var e=r.l+t-2,a=r.read_shift(2),i=r.read_shift(2),l=[];r.l<e;)l.push(CO(r));if(r.l!==e)throw new Error("MulRK read error");var o=r.read_shift(2);if(l.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:a,c:i,C:o,rkrec:l}}function J6(r,t){for(var e=r.l+t-2,a=r.read_shift(2),i=r.read_shift(2),l=[];r.l<e;)l.push(r.read_shift(2));if(r.l!==e)throw new Error("MulBlank read error");var o=r.read_shift(2);if(l.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:a,c:i,C:o,ixfe:l}}function e8(r,t,e,a){var i={},l=r.read_shift(4),o=r.read_shift(4),c=r.read_shift(4),f=r.read_shift(2);return i.patternType=QL[c>>26],a.cellStyles&&(i.alc=l&7,i.fWrap=l>>3&1,i.alcV=l>>4&7,i.fJustLast=l>>7&1,i.trot=l>>8&255,i.cIndent=l>>16&15,i.fShrinkToFit=l>>20&1,i.iReadOrder=l>>22&2,i.fAtrNum=l>>26&1,i.fAtrFnt=l>>27&1,i.fAtrAlc=l>>28&1,i.fAtrBdr=l>>29&1,i.fAtrPat=l>>30&1,i.fAtrProt=l>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=c&127,i.icvBottom=c>>7&127,i.icvDiag=c>>14&127,i.dgDiag=c>>21&15,i.icvFore=f&127,i.icvBack=f>>7&127,i.fsxButton=f>>14&1),i}function t8(r,t,e){var a={};return a.ifnt=r.read_shift(2),a.numFmtId=r.read_shift(2),a.flags=r.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=e8(r,t,a.fStyle,e),a}function r8(r){r.l+=4;var t=[r.read_shift(2),r.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function zC(r,t,e){var a=_s(r);(e.biff==2||t==9)&&++r.l;var i=v6(r);return a.val=i,a.t=i===!0||i===!1?"b":"e",a}function a8(r,t,e){e.biffguess&&e.biff==2&&(e.biff=5);var a=_s(r),i=ya(r);return a.val=i,a}var GC=w6;function n8(r,t,e){var a=r.l+t,i=r.read_shift(2),l=r.read_shift(2);if(e.sbcch=l,l==1025||l==14849)return[l,i];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=Cu(r,l),c=[];a>r.l;)c.push(gg(r));return[l,i,o,c]}function VC(r,t,e){var a=r.read_shift(2),i,l={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return e.sbcch===14849&&(i=R6(r,t-2,e)),l.body=i||r.read_shift(t-2),typeof i=="string"&&(l.Name=i),l}var i8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function jC(r,t,e){var a=r.l+t,i=r.read_shift(2),l=r.read_shift(1),o=r.read_shift(1),c=r.read_shift(e&&e.biff==2?1:2),f=0;(!e||e.biff>=5)&&(e.biff!=5&&(r.l+=2),f=r.read_shift(2),e.biff==5&&(r.l+=2),r.l+=4);var d=Cu(r,o,e);i&32&&(d=i8[d.charCodeAt(0)]);var g=a-r.l;e&&e.biff==2&&--g;var m=a==r.l||c===0||!(g>0)?[]:HB(r,g,e,c);return{chKey:l,Name:d,itab:f,rgce:m}}function OO(r,t,e){if(e.biff<8)return s8(r,t,e);for(var a=[],i=r.l+t,l=r.read_shift(e.biff>8?4:2);l--!==0;)a.push(C6(r,e.biff>8?12:6,e));if(r.l!=i)throw new Error("Bad ExternSheet: "+r.l+" != "+i);return a}function s8(r,t,e){r[r.l+1]==3&&r[r.l]++;var a=pg(r,t,e);return a.charCodeAt(0)==3?a.slice(1):a}function l8(r,t,e){if(e.biff<8){r.l+=t;return}var a=r.read_shift(2),i=r.read_shift(2),l=Cu(r,a,e),o=Cu(r,i,e);return[l,o]}function o8(r,t,e){var a=RO(r);r.l++;var i=r.read_shift(1);return t-=8,[zB(r,t,e),i,a]}function YC(r,t,e){var a=k6(r);switch(e.biff){case 2:r.l++,t-=7;break;case 3:case 4:r.l+=2,t-=8;break;default:r.l+=6,t-=12}return[a,BB(r,t,e)]}function c8(r){var t=r.read_shift(4)!==0,e=r.read_shift(4)!==0,a=r.read_shift(4);return[t,e,a]}function u8(r,t,e){if(!(e.biff<8)){var a=r.read_shift(2),i=r.read_shift(2),l=r.read_shift(2),o=r.read_shift(2),c=Fu(r,0,e);return e.biff<8&&r.read_shift(1),[{r:a,c:i},c,o,l]}}function f8(r,t,e){return u8(r,t,e)}function h8(r,t){for(var e=[],a=r.read_shift(2);a--;)e.push(Rx(r));return e}function d8(r,t,e){if(e&&e.biff<8)return g8(r,t,e);var a=kO(r),i=M6(r,t-22,a[1]);return{cmo:a,ft:i}}var p8={8:function(r,t){var e=r.l+t;r.l+=10;var a=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var i=r.read_shift(1);return r.l+=i,r.l=e,{fmt:a}}};function g8(r,t,e){r.l+=4;var a=r.read_shift(2),i=r.read_shift(2),l=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,t-=36;var o=[];return o.push((p8[a]||ba)(r,t,e)),{cmo:[i,a,l],ft:o}}function m8(r,t,e){var a=r.l,i="";try{r.l+=4;var l=(e.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?r.l+=6:o=E6(r,6,e);var c=r.read_shift(2);r.read_shift(2),Cr(r,2);var f=r.read_shift(2);r.l+=f;for(var d=1;d<r.lens.length-1;++d){if(r.l-a!=r.lens[d])throw new Error("TxO: bad continue record");var g=r[r.l],m=Cu(r,r.lens[d+1]-r.lens[d]-1);if(i+=m,i.length>=(g?c:2*c))break}if(i.length!==c&&i.length!==c*2)throw new Error("cchText: "+c+" != "+i.length);return r.l=a+t,{t:i}}catch{return r.l=a+t,{t:i}}}function x8(r,t){var e=Rx(r);r.l+=16;var a=S6(r,t-24);return[e,a]}function v8(r,t){r.read_shift(2);var e=Rx(r),a=r.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Ha,""),[e,a]}function _8(r){var t=[0,0],e;return e=r.read_shift(2),t[0]=IC[e]||e,e=r.read_shift(2),t[1]=IC[e]||e,t}function E8(r){for(var t=r.read_shift(2),e=[];t-- >0;)e.push(wO(r));return e}function A8(r){for(var t=r.read_shift(2),e=[];t-- >0;)e.push(wO(r));return e}function y8(r){r.l+=2;var t={cxfs:0,crc:0};return t.cxfs=r.read_shift(2),t.crc=r.read_shift(4),t}function DO(r,t,e){if(!e.cellStyles)return ba(r,t);var a=e&&e.biff>=12?4:2,i=r.read_shift(a),l=r.read_shift(a),o=r.read_shift(a),c=r.read_shift(a),f=r.read_shift(2);a==2&&(r.l+=2);var d={s:i,e:l,w:o,ixfe:c,flags:f};return(e.biff>=5||!e.biff)&&(d.level=f>>8&7),d}function T8(r,t){var e={};return t<32||(r.l+=16,e.header=ya(r),e.footer=ya(r),r.l+=2),e}function S8(r,t,e){var a={area:!1};if(e.biff!=5)return r.l+=t,a;var i=r.read_shift(1);return r.l+=3,i&16&&(a.area=!0),a}var b8=_s,w8=SO,C8=gg;function R8(r){var t=r.read_shift(2),e=r.read_shift(2),a=r.read_shift(4),i={fmt:t,env:e,len:a,data:r.slice(r.l,r.l+a)};return r.l+=a,i}function k8(r,t,e){e.biffguess&&e.biff==5&&(e.biff=2);var a=_s(r);++r.l;var i=Fu(r,t-7,e);return a.t="str",a.val=i,a}function O8(r){var t=_s(r);++r.l;var e=ya(r);return t.t="n",t.val=e,t}function D8(r){var t=_s(r);++r.l;var e=r.read_shift(2);return t.t="n",t.val=e,t}function N8(r){var t=r.read_shift(1);return t===0?(r.l++,""):r.read_shift(t,"sbcs-cont")}function M8(r,t){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=t-13}function I8(r,t,e){var a=r.l+t,i=_s(r),l=r.read_shift(2),o=Cu(r,l,e);return r.l=a,i.t="str",i.val=o,i}var F8=[2,3,48,49,131,139,140,245],XC=(function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ly({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(c,f){var d=[],g=Lo(1);switch(f.type){case"base64":g=Ii(Fn(c));break;case"binary":g=Ii(c);break;case"buffer":case"array":g=c;break}ia(g,0);var m=g.read_shift(1),v=!!(m&136),_=!1,A=!1;switch(m){case 2:break;case 3:break;case 48:_=!0,v=!0;break;case 49:_=!0,v=!0;break;case 131:break;case 139:break;case 140:A=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var y=0,T=521;m==2&&(y=g.read_shift(2)),g.l+=3,m!=2&&(y=g.read_shift(4)),y>1048576&&(y=1e6),m!=2&&(T=g.read_shift(2));var S=g.read_shift(2),R=f.codepage||1252;m!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(R=r[g[g.l]]),g.l+=1,g.l+=2),A&&(g.l+=36);for(var C=[],F={},U=Math.min(g.length,m==2?521:T-10-(_?264:0)),B=A?32:11;g.l<U&&g[g.l]!=13;)switch(F={},F.name=Od.utils.decode(R,g.slice(g.l,g.l+B)).replace(/[\u0000\r\n].*$/g,""),g.l+=B,F.type=String.fromCharCode(g.read_shift(1)),m!=2&&!A&&(F.offset=g.read_shift(4)),F.len=g.read_shift(1),m==2&&(F.offset=g.read_shift(2)),F.dec=g.read_shift(1),F.name.length&&C.push(F),m!=2&&(g.l+=A?13:14),F.type){case"B":(!_||F.len!=8)&&f.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(g[g.l]!==13&&(g.l=T-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=T;var k=0,J=0;for(d[0]=[],J=0;J!=C.length;++J)d[0][J]=C[J].name;for(;y-- >0;){if(g[g.l]===42){g.l+=S;continue}for(++g.l,d[++k]=[],J=0,J=0;J!=C.length;++J){var j=g.slice(g.l,g.l+C[J].len);g.l+=C[J].len,ia(j,0);var ie=Od.utils.decode(R,j);switch(C[J].type){case"C":ie.trim().length&&(d[k][J]=ie.replace(/\s+$/,""));break;case"D":ie.length===8?d[k][J]=new Date(+ie.slice(0,4),+ie.slice(4,6)-1,+ie.slice(6,8)):d[k][J]=ie;break;case"F":d[k][J]=parseFloat(ie.trim());break;case"+":case"I":d[k][J]=A?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(ie.trim().toUpperCase()){case"Y":case"T":d[k][J]=!0;break;case"N":case"F":d[k][J]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ie+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));d[k][J]="##MEMO##"+(A?parseInt(ie.trim(),10):j.read_shift(4));break;case"N":ie=ie.replace(/\u0000/g,"").trim(),ie&&ie!="."&&(d[k][J]=+ie||0);break;case"@":d[k][J]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":d[k][J]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":d[k][J]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[k][J]=-j.read_shift(-8,"f");break;case"B":if(_&&C[J].len==8){d[k][J]=j.read_shift(8,"f");break}case"G":case"P":j.l+=C[J].len;break;case"0":if(C[J].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[J].type)}}}if(m!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=C,d}function a(c,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var g=Kh(e(c,d),d);return g["!cols"]=d.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete d.DBF,g}function i(c,f){try{return Ho(a(c,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,f){var d=f||{};if(+d.codepage>=0&&Fi(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var g=NA(),m=GA(c,{header:1,raw:!0,cellDates:!0}),v=m[0],_=m.slice(1),A=c["!cols"]||[],y=0,T=0,S=0,R=1;for(y=0;y<v.length;++y){if(((A[y]||{}).DBF||{}).name){v[y]=A[y].DBF.name,++S;continue}if(v[y]!=null){if(++S,typeof v[y]=="number"&&(v[y]=v[y].toString(10)),typeof v[y]!="string")throw new Error("DBF Invalid column name "+v[y]+" |"+typeof v[y]+"|");if(v.indexOf(v[y])!==y){for(T=0;T<1024;++T)if(v.indexOf(v[y]+"_"+T)==-1){v[y]+="_"+T;break}}}}var C=fr(c["!ref"]),F=[],U=[],B=[];for(y=0;y<=C.e.c-C.s.c;++y){var k="",J="",j=0,ie=[];for(T=0;T<_.length;++T)_[T][y]!=null&&ie.push(_[T][y]);if(ie.length==0||v[y]==null){F[y]="?";continue}for(T=0;T<ie.length;++T){switch(typeof ie[T]){case"number":J="B";break;case"string":J="C";break;case"boolean":J="L";break;case"object":J=ie[T]instanceof Date?"D":"C";break;default:J="C"}j=Math.max(j,String(ie[T]).length),k=k&&k!=J?"C":J}j>250&&(j=250),J=((A[y]||{}).DBF||{}).type,J=="C"&&A[y].DBF.len>j&&(j=A[y].DBF.len),k=="B"&&J=="N"&&(k="N",B[y]=A[y].DBF.dec,j=A[y].DBF.len),U[y]=k=="C"||J=="N"?j:l[k]||0,R+=U[y],F[y]=k}var Q=g.next(32);for(Q.write_shift(4,318902576),Q.write_shift(4,_.length),Q.write_shift(2,296+32*S),Q.write_shift(2,R),y=0;y<4;++y)Q.write_shift(4,0);for(Q.write_shift(4,0|(+t[O4]||3)<<8),y=0,T=0;y<v.length;++y)if(v[y]!=null){var ee=g.next(32),ge=(v[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ee.write_shift(1,ge,"sbcs"),ee.write_shift(1,F[y]=="?"?"C":F[y],"sbcs"),ee.write_shift(4,T),ee.write_shift(1,U[y]||l[F[y]]||0),ee.write_shift(1,B[y]||0),ee.write_shift(1,2),ee.write_shift(4,0),ee.write_shift(1,0),ee.write_shift(4,0),ee.write_shift(4,0),T+=U[y]||l[F[y]]||0}var ye=g.next(264);for(ye.write_shift(4,13),y=0;y<65;++y)ye.write_shift(4,0);for(y=0;y<_.length;++y){var me=g.next(R);for(me.write_shift(1,0),T=0;T<v.length;++T)if(v[T]!=null)switch(F[T]){case"L":me.write_shift(1,_[y][T]==null?63:_[y][T]?84:70);break;case"B":me.write_shift(8,_[y][T]||0,"f");break;case"N":var G="0";for(typeof _[y][T]=="number"&&(G=_[y][T].toFixed(B[T]||0)),S=0;S<U[T]-G.length;++S)me.write_shift(1,32);me.write_shift(1,G,"sbcs");break;case"D":_[y][T]?(me.write_shift(4,("0000"+_[y][T].getFullYear()).slice(-4),"sbcs"),me.write_shift(2,("00"+(_[y][T].getMonth()+1)).slice(-2),"sbcs"),me.write_shift(2,("00"+_[y][T].getDate()).slice(-2),"sbcs")):me.write_shift(8,"00000000","sbcs");break;case"C":var te=String(_[y][T]!=null?_[y][T]:"").slice(0,U[T]);for(me.write_shift(1,te,"sbcs"),S=0;S<U[T]-te.length;++S)me.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:i,to_sheet:a,from_sheet:o}})(),L8=(function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ms(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(v,_){var A=r[_];return typeof A=="number"?oC(A):A},a=function(v,_,A){var y=_.charCodeAt(0)-32<<4|A.charCodeAt(0)-48;return y==59?v:oC(y)};r["|"]=254;function i(v,_){switch(_.type){case"base64":return l(Fn(v),_);case"binary":return l(v,_);case"buffer":return l(xt&&Buffer.isBuffer(v)?v.toString("binary"):Du(v),_);case"array":return l(wu(v),_)}throw new Error("Unrecognized type "+_.type)}function l(v,_){var A=v.split(/[\n\r]+/),y=-1,T=-1,S=0,R=0,C=[],F=[],U=null,B={},k=[],J=[],j=[],ie=0,Q;for(+_.codepage>=0&&Fi(+_.codepage);S!==A.length;++S){ie=0;var ee=A[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,e),ge=ee.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),ye=ge[0],me;if(ee.length>0)switch(ye){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ge[1].charAt(0)=="P"&&F.push(ee.slice(3).replace(/;;/g,";"));break;case"C":var G=!1,te=!1,we=!1,ae=!1,Oe=-1,Y=-1;for(R=1;R<ge.length;++R)switch(ge[R].charAt(0)){case"A":break;case"X":T=parseInt(ge[R].slice(1))-1,te=!0;break;case"Y":for(y=parseInt(ge[R].slice(1))-1,te||(T=0),Q=C.length;Q<=y;++Q)C[Q]=[];break;case"K":me=ge[R].slice(1),me.charAt(0)==='"'?me=me.slice(1,me.length-1):me==="TRUE"?me=!0:me==="FALSE"?me=!1:isNaN(Bi(me))?isNaN(Yh(me).getDate())||(me=Wr(me)):(me=Bi(me),U!==null&&qh(U)&&(me=Cx(me))),G=!0;break;case"E":ae=!0;var N=Bf(ge[R].slice(1),{r:y,c:T});C[y][T]=[C[y][T],N];break;case"S":we=!0,C[y][T]=[C[y][T],"S5S"];break;case"G":break;case"R":Oe=parseInt(ge[R].slice(1))-1;break;case"C":Y=parseInt(ge[R].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+ee)}if(G&&(C[y][T]&&C[y][T].length==2?C[y][T][0]=me:C[y][T]=me,U=null),we){if(ae)throw new Error("SYLK shared formula cannot have own formula");var q=Oe>-1&&C[Oe][Y];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");C[y][T][1]=zO(q[1],{r:y-Oe,c:T-Y})}break;case"F":var X=0;for(R=1;R<ge.length;++R)switch(ge[R].charAt(0)){case"X":T=parseInt(ge[R].slice(1))-1,++X;break;case"Y":for(y=parseInt(ge[R].slice(1))-1,Q=C.length;Q<=y;++Q)C[Q]=[];break;case"M":ie=parseInt(ge[R].slice(1))/20;break;case"F":break;case"G":break;case"P":U=F[parseInt(ge[R].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=ge[R].slice(1).split(" "),Q=parseInt(j[0],10);Q<=parseInt(j[1],10);++Q)ie=parseInt(j[2],10),J[Q-1]=ie===0?{hidden:!0}:{wch:ie},Xh(J[Q-1]);break;case"C":T=parseInt(ge[R].slice(1))-1,J[T]||(J[T]={});break;case"R":y=parseInt(ge[R].slice(1))-1,k[y]||(k[y]={}),ie>0?(k[y].hpt=ie,k[y].hpx=Ld(ie)):ie===0&&(k[y].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+ee)}X<1&&(U=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+ee)}}return k.length>0&&(B["!rows"]=k),J.length>0&&(B["!cols"]=J),_&&_.sheetRows&&(C=C.slice(0,_.sheetRows)),[C,B]}function o(v,_){var A=i(v,_),y=A[0],T=A[1],S=Kh(y,_);return ms(T).forEach(function(R){S[R]=T[R]}),S}function c(v,_){return Ho(o(v,_),_)}function f(v,_,A,y){var T="C;Y"+(A+1)+";X"+(y+1)+";K";switch(v.t){case"n":T+=v.v||0,v.f&&!v.F&&(T+=";E"+yP(v.f,{r:A,c:y}));break;case"b":T+=v.v?"TRUE":"FALSE";break;case"e":T+=v.w||v.v;break;case"d":T+='"'+(v.w||v.v)+'"';break;case"s":T+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function d(v,_){_.forEach(function(A,y){var T="F;W"+(y+1)+" "+(y+1)+" ";A.hidden?T+="0":(typeof A.width=="number"&&!A.wpx&&(A.wpx=Wm(A.width)),typeof A.wpx=="number"&&!A.wch&&(A.wch=Km(A.wpx)),typeof A.wch=="number"&&(T+=Math.round(A.wch))),T.charAt(T.length-1)!=" "&&v.push(T)})}function g(v,_){_.forEach(function(A,y){var T="F;";A.hidden?T+="M0;":A.hpt?T+="M"+20*A.hpt+";":A.hpx&&(T+="M"+20*BO(A.hpx)+";"),T.length>2&&v.push(T+"R"+(y+1))})}function m(v,_){var A=["ID;PWXL;N;E"],y=[],T=fr(v["!ref"]),S,R=Array.isArray(v),C=`\r
`;A.push("P;PGeneral"),A.push("F;P0;DG0G8;M255"),v["!cols"]&&d(A,v["!cols"]),v["!rows"]&&g(A,v["!rows"]),A.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var F=T.s.r;F<=T.e.r;++F)for(var U=T.s.c;U<=T.e.c;++U){var B=Qe({r:F,c:U});S=R?(v[F]||[])[U]:v[B],!(!S||S.v==null&&(!S.f||S.F))&&y.push(f(S,v,F,U))}return A.join(C)+C+y.join(C)+C+"E"+C}return{to_workbook:c,to_sheet:o,from_sheet:m}})(),P8=(function(){function r(l,o){switch(o.type){case"base64":return t(Fn(l),o);case"binary":return t(l,o);case"buffer":return t(xt&&Buffer.isBuffer(l)?l.toString("binary"):Du(l),o);case"array":return t(wu(l),o)}throw new Error("Unrecognized type "+o.type)}function t(l,o){for(var c=l.split(`
`),f=-1,d=-1,g=0,m=[];g!==c.length;++g){if(c[g].trim()==="BOT"){m[++f]=[],d=0;continue}if(!(f<0)){var v=c[g].trim().split(","),_=v[0],A=v[1];++g;for(var y=c[g]||"";(y.match(/["]/g)||[]).length&1&&g<c.length-1;)y+=`
`+c[++g];switch(y=y.trim(),+_){case-1:if(y==="BOT"){m[++f]=[],d=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?m[f][d]=!0:y==="FALSE"?m[f][d]=!1:isNaN(Bi(A))?isNaN(Yh(A).getDate())?m[f][d]=A:m[f][d]=Wr(A):m[f][d]=Bi(A),++d;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),m[f][d++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function e(l,o){return Kh(r(l,o),o)}function a(l,o){return Ho(e(l,o),o)}var i=(function(){var l=function(f,d,g,m,v){f.push(d),f.push(g+","+m),f.push('"'+v.replace(/"/g,'""')+'"')},o=function(f,d,g,m){f.push(d+","+g),f.push(d==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(f){var d=[],g=fr(f["!ref"]),m,v=Array.isArray(f);l(d,"TABLE",0,1,"sheetjs"),l(d,"VECTORS",0,g.e.r-g.s.r+1,""),l(d,"TUPLES",0,g.e.c-g.s.c+1,""),l(d,"DATA",0,0,"");for(var _=g.s.r;_<=g.e.r;++_){o(d,-1,0,"BOT");for(var A=g.s.c;A<=g.e.c;++A){var y=Qe({r:_,c:A});if(m=v?(f[_]||[])[A]:f[y],!m){o(d,1,0,"");continue}switch(m.t){case"n":var T=m.w;!T&&m.v!=null&&(T=m.v),T==null?m.f&&!m.F?o(d,1,0,"="+m.f):o(d,1,0,""):o(d,0,T,"V");break;case"b":o(d,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=ui(m.z||Je[14],ja(Wr(m.v)))),o(d,0,m.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var S=`\r
`,R=d.join(S);return R}})();return{to_workbook:a,to_sheet:e,from_sheet:i}})(),B8=(function(){function r(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(m,v){for(var _=m.split(`
`),A=-1,y=-1,T=0,S=[];T!==_.length;++T){var R=_[T].trim().split(":");if(R[0]==="cell"){var C=Ba(R[1]);if(S.length<=C.r)for(A=S.length;A<=C.r;++A)S[A]||(S[A]=[]);switch(A=C.r,y=C.c,R[2]){case"t":S[A][y]=r(R[3]);break;case"v":S[A][y]=+R[3];break;case"vtf":var F=R[R.length-1];case"vtc":switch(R[3]){case"nl":S[A][y]=!!+R[4];break;default:S[A][y]=+R[4];break}R[2]=="vtf"&&(S[A][y]=[S[A][y],F])}}}return v&&v.sheetRows&&(S=S.slice(0,v.sheetRows)),S}function a(m,v){return Kh(e(m,v),v)}function i(m,v){return Ho(a(m,v),v)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(m){if(!m||!m["!ref"])return"";for(var v=[],_=[],A,y="",T=Wh(m["!ref"]),S=Array.isArray(m),R=T.s.r;R<=T.e.r;++R)for(var C=T.s.c;C<=T.e.c;++C)if(y=Qe({r:R,c:C}),A=S?(m[R]||[])[C]:m[y],!(!A||A.v==null||A.t==="z")){switch(_=["cell",y,"t"],A.t){case"s":case"str":_.push(t(A.v));break;case"n":A.f?(_[2]="vtf",_[3]="n",_[4]=A.v,_[5]=t(A.f)):(_[2]="v",_[3]=A.v);break;case"b":_[2]="vt"+(A.f?"f":"c"),_[3]="nl",_[4]=A.v?"1":"0",_[5]=t(A.f||(A.v?"TRUE":"FALSE"));break;case"d":var F=ja(Wr(A.v));_[2]="vtc",_[3]="nd",_[4]=""+F,_[5]=A.w||ui(A.z||Je[14],F);break;case"e":continue}v.push(_.join(":"))}return v.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function g(m){return[l,o,c,o,d(m),f].join(`
`)}return{to_workbook:i,to_sheet:a,from_sheet:g}})(),Id=(function(){function r(g,m,v,_,A){A.raw?m[v][_]=g:g===""||(g==="TRUE"?m[v][_]=!0:g==="FALSE"?m[v][_]=!1:isNaN(Bi(g))?isNaN(Yh(g).getDate())?m[v][_]=g:m[v][_]=Wr(g):m[v][_]=Bi(g))}function t(g,m){var v=m||{},_=[];if(!g||g.length===0)return _;for(var A=g.split(/[\r\n]/),y=A.length-1;y>=0&&A[y].length===0;)--y;for(var T=10,S=0,R=0;R<=y;++R)S=A[R].indexOf(" "),S==-1?S=A[R].length:S++,T=Math.max(T,S);for(R=0;R<=y;++R){_[R]=[];var C=0;for(r(A[R].slice(0,T).trim(),_,R,C,v),C=1;C<=(A[R].length-T)/10+1;++C)r(A[R].slice(T+(C-1)*10,T+C*10).trim(),_,R,C,v)}return v.sheetRows&&(_=_.slice(0,v.sheetRows)),_}var e={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function i(g){for(var m={},v=!1,_=0,A=0;_<g.length;++_)(A=g.charCodeAt(_))==34?v=!v:!v&&A in e&&(m[A]=(m[A]||0)+1);A=[];for(_ in m)Object.prototype.hasOwnProperty.call(m,_)&&A.push([m[_],_]);if(!A.length){m=a;for(_ in m)Object.prototype.hasOwnProperty.call(m,_)&&A.push([m[_],_])}return A.sort(function(y,T){return y[0]-T[0]||a[y[1]]-a[T[1]]}),e[A.pop()[1]]||44}function l(g,m){var v=m||{},_="",A=v.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(_=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(_=g.charAt(4),g=g.slice(6)):_=i(g.slice(0,1024)):v&&v.FS?_=v.FS:_=i(g.slice(0,1024));var T=0,S=0,R=0,C=0,F=0,U=_.charCodeAt(0),B=!1,k=0,J=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var j=v.dateNF!=null?KF(v.dateNF):null;function ie(){var Q=g.slice(C,F),ee={};if(Q.charAt(0)=='"'&&Q.charAt(Q.length-1)=='"'&&(Q=Q.slice(1,-1).replace(/""/g,'"')),Q.length===0)ee.t="z";else if(v.raw)ee.t="s",ee.v=Q;else if(Q.trim().length===0)ee.t="s",ee.v=Q;else if(Q.charCodeAt(0)==61)Q.charCodeAt(1)==34&&Q.charCodeAt(Q.length-1)==34?(ee.t="s",ee.v=Q.slice(2,-1).replace(/""/g,'"')):SP(Q)?(ee.t="n",ee.f=Q.slice(1)):(ee.t="s",ee.v=Q);else if(Q=="TRUE")ee.t="b",ee.v=!0;else if(Q=="FALSE")ee.t="b",ee.v=!1;else if(!isNaN(R=Bi(Q)))ee.t="n",v.cellText!==!1&&(ee.w=Q),ee.v=R;else if(!isNaN(Yh(Q).getDate())||j&&Q.match(j)){ee.z=v.dateNF||Je[14];var ge=0;j&&Q.match(j)&&(Q=$F(Q,v.dateNF,Q.match(j)||[]),ge=1),v.cellDates?(ee.t="d",ee.v=Wr(Q,ge)):(ee.t="n",ee.v=ja(Wr(Q,ge))),v.cellText!==!1&&(ee.w=ui(ee.z,ee.v instanceof Date?ja(ee.v):ee.v)),v.cellNF||delete ee.z}else ee.t="s",ee.v=Q;if(ee.t=="z"||(v.dense?(A[T]||(A[T]=[]),A[T][S]=ee):A[Qe({c:S,r:T})]=ee),C=F+1,J=g.charCodeAt(C),y.e.c<S&&(y.e.c=S),y.e.r<T&&(y.e.r=T),k==U)++S;else if(S=0,++T,v.sheetRows&&v.sheetRows<=T)return!0}e:for(;F<g.length;++F)switch(k=g.charCodeAt(F)){case 34:J===34&&(B=!B);break;case U:case 10:case 13:if(!B&&ie())break e;break}return F-C>0&&ie(),A["!ref"]=_t(y),A}function o(g,m){return!(m&&m.PRN)||m.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?l(g,m):Kh(t(g,m),m)}function c(g,m){var v="",_=m.type=="string"?[0,0,0,0]:wy(g,m);switch(m.type){case"base64":v=Fn(g);break;case"binary":v=g;break;case"buffer":m.codepage==65001?v=g.toString("utf8"):m.codepage&&typeof Od<"u"||(v=xt&&Buffer.isBuffer(g)?g.toString("binary"):Du(g));break;case"array":v=wu(g);break;case"string":v=g;break;default:throw new Error("Unrecognized type "+m.type)}return _[0]==239&&_[1]==187&&_[2]==191?v=Vt(v.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?v=Vt(v):m.type=="binary"&&typeof Od<"u",v.slice(0,19)=="socialcalc:version:"?B8.to_sheet(m.type=="string"?v:Vt(v),m):o(v,m)}function f(g,m){return Ho(c(g,m),m)}function d(g){for(var m=[],v=fr(g["!ref"]),_,A=Array.isArray(g),y=v.s.r;y<=v.e.r;++y){for(var T=[],S=v.s.c;S<=v.e.c;++S){var R=Qe({r:y,c:S});if(_=A?(g[y]||[])[S]:g[R],!_||_.v==null){T.push("          ");continue}for(var C=(_.w||(El(_),_.w)||"").slice(0,10);C.length<10;)C+=" ";T.push(C+(S===0?" ":""))}m.push(T.join(""))}return m.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:d}})();function U8(r,t){var e=t||{},a=!!e.WTF;e.WTF=!0;try{var i=L8.to_workbook(r,e);return e.WTF=a,i}catch(l){if(e.WTF=a,!l.message.match(/SYLK bad record ID/)&&a)throw l;return Id.to_workbook(r,t)}}var yd=(function(){function r(N,q,X){if(N){ia(N,N.l||0);for(var K=X.Enum||Oe;N.l<N.length;){var se=N.read_shift(2),xe=K[se]||K[65535],ke=N.read_shift(2),Se=N.l+ke,be=xe.f&&xe.f(N,ke,X);if(N.l=Se,q(be,xe,se))return}}}function t(N,q){switch(q.type){case"base64":return e(Ii(Fn(N)),q);case"binary":return e(Ii(N),q);case"buffer":case"array":return e(N,q)}throw"Unsupported type "+q.type}function e(N,q){if(!N)return N;var X=q||{},K=X.dense?[]:{},se="Sheet1",xe="",ke=0,Se={},be=[],ot=[],W={s:{r:0,c:0},e:{r:0,c:0}},Wt=X.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)X.Enum=Oe,r(N,function(Ie,Kt,ca){switch(ca){case 0:X.vers=Ie,Ie>=4096&&(X.qpro=!0);break;case 6:W=Ie;break;case 204:Ie&&(xe=Ie);break;case 222:xe=Ie;break;case 15:case 51:X.qpro||(Ie[1].v=Ie[1].v.slice(1));case 13:case 14:case 16:ca==14&&(Ie[2]&112)==112&&(Ie[2]&15)>1&&(Ie[2]&15)<15&&(Ie[1].z=X.dateNF||Je[14],X.cellDates&&(Ie[1].t="d",Ie[1].v=Cx(Ie[1].v))),X.qpro&&Ie[3]>ke&&(K["!ref"]=_t(W),Se[se]=K,be.push(se),K=X.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},ke=Ie[3],se=xe||"Sheet"+(ke+1),xe="");var Ya=X.dense?(K[Ie[0].r]||[])[Ie[0].c]:K[Qe(Ie[0])];if(Ya){Ya.t=Ie[1].t,Ya.v=Ie[1].v,Ie[1].z!=null&&(Ya.z=Ie[1].z),Ie[1].f!=null&&(Ya.f=Ie[1].f);break}X.dense?(K[Ie[0].r]||(K[Ie[0].r]=[]),K[Ie[0].r][Ie[0].c]=Ie[1]):K[Qe(Ie[0])]=Ie[1];break}},X);else if(N[2]==26||N[2]==14)X.Enum=Y,N[2]==14&&(X.qpro=!0,N.l=0),r(N,function(Ie,Kt,ca){switch(ca){case 204:se=Ie;break;case 22:Ie[1].v=Ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ie[3]>ke&&(K["!ref"]=_t(W),Se[se]=K,be.push(se),K=X.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},ke=Ie[3],se="Sheet"+(ke+1)),Wt>0&&Ie[0].r>=Wt)break;X.dense?(K[Ie[0].r]||(K[Ie[0].r]=[]),K[Ie[0].r][Ie[0].c]=Ie[1]):K[Qe(Ie[0])]=Ie[1],W.e.c<Ie[0].c&&(W.e.c=Ie[0].c),W.e.r<Ie[0].r&&(W.e.r=Ie[0].r);break;case 27:Ie[14e3]&&(ot[Ie[14e3][0]]=Ie[14e3][1]);break;case 1537:ot[Ie[0]]=Ie[1],Ie[0]==ke&&(se=Ie[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(K["!ref"]=_t(W),Se[xe||se]=K,be.push(xe||se),!ot.length)return{SheetNames:be,Sheets:Se};for(var st={},bt=[],tt=0;tt<ot.length;++tt)Se[be[tt]]?(bt.push(ot[tt]||be[tt]),st[ot[tt]]=Se[ot[tt]]||Se[be[tt]]):(bt.push(ot[tt]),st[ot[tt]]={"!ref":"A1"});return{SheetNames:bt,Sheets:st}}function a(N,q){var X=q||{};if(+X.codepage>=0&&Fi(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var K=NA(),se=fr(N["!ref"]),xe=Array.isArray(N),ke=[];_i(K,0,l(1030)),_i(K,6,f(se));for(var Se=Math.min(se.e.r,8191),be=se.s.r;be<=Se;++be)for(var ot=la(be),W=se.s.c;W<=se.e.c;++W){be===se.s.r&&(ke[W]=Pr(W));var Wt=ke[W]+ot,st=xe?(N[be]||[])[W]:N[Wt];if(!(!st||st.t=="z"))if(st.t=="n")(st.v|0)==st.v&&st.v>=-32768&&st.v<=32767?_i(K,13,_(be,W,st.v)):_i(K,14,y(be,W,st.v));else{var bt=El(st);_i(K,15,m(be,W,bt.slice(0,239)))}}return _i(K,1),K.end()}function i(N,q){var X=q||{};if(+X.codepage>=0&&Fi(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var K=NA();_i(K,0,o(N));for(var se=0,xe=0;se<N.SheetNames.length;++se)(N.Sheets[N.SheetNames[se]]||{})["!ref"]&&_i(K,27,ae(N.SheetNames[se],xe++));var ke=0;for(se=0;se<N.SheetNames.length;++se){var Se=N.Sheets[N.SheetNames[se]];if(!(!Se||!Se["!ref"])){for(var be=fr(Se["!ref"]),ot=Array.isArray(Se),W=[],Wt=Math.min(be.e.r,8191),st=be.s.r;st<=Wt;++st)for(var bt=la(st),tt=be.s.c;tt<=be.e.c;++tt){st===be.s.r&&(W[tt]=Pr(tt));var Ie=W[tt]+bt,Kt=ot?(Se[st]||[])[tt]:Se[Ie];if(!(!Kt||Kt.t=="z"))if(Kt.t=="n")_i(K,23,ie(st,tt,ke,Kt.v));else{var ca=El(Kt);_i(K,22,k(st,tt,ke,ca.slice(0,239)))}}++ke}}return _i(K,1),K.end()}function l(N){var q=Lr(2);return q.write_shift(2,N),q}function o(N){var q=Lr(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var X=0,K=0,se=0,xe=0;xe<N.SheetNames.length;++xe){var ke=N.SheetNames[xe],Se=N.Sheets[ke];if(!(!Se||!Se["!ref"])){++se;var be=Wh(Se["!ref"]);X<be.e.r&&(X=be.e.r),K<be.e.c&&(K=be.e.c)}}return X>8191&&(X=8191),q.write_shift(2,X),q.write_shift(1,se),q.write_shift(1,K),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function c(N,q,X){var K={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&X.qpro?(K.s.c=N.read_shift(1),N.l++,K.s.r=N.read_shift(2),K.e.c=N.read_shift(1),N.l++,K.e.r=N.read_shift(2),K):(K.s.c=N.read_shift(2),K.s.r=N.read_shift(2),q==12&&X.qpro&&(N.l+=2),K.e.c=N.read_shift(2),K.e.r=N.read_shift(2),q==12&&X.qpro&&(N.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function f(N){var q=Lr(8);return q.write_shift(2,N.s.c),q.write_shift(2,N.s.r),q.write_shift(2,N.e.c),q.write_shift(2,N.e.r),q}function d(N,q,X){var K=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(K[0].c=N.read_shift(1),K[3]=N.read_shift(1),K[0].r=N.read_shift(2),N.l+=2):(K[2]=N.read_shift(1),K[0].c=N.read_shift(2),K[0].r=N.read_shift(2)),K}function g(N,q,X){var K=N.l+q,se=d(N,q,X);if(se[1].t="s",X.vers==20768){N.l++;var xe=N.read_shift(1);return se[1].v=N.read_shift(xe,"utf8"),se}return X.qpro&&N.l++,se[1].v=N.read_shift(K-N.l,"cstr"),se}function m(N,q,X){var K=Lr(7+X.length);K.write_shift(1,255),K.write_shift(2,q),K.write_shift(2,N),K.write_shift(1,39);for(var se=0;se<K.length;++se){var xe=X.charCodeAt(se);K.write_shift(1,xe>=128?95:xe)}return K.write_shift(1,0),K}function v(N,q,X){var K=d(N,q,X);return K[1].v=N.read_shift(2,"i"),K}function _(N,q,X){var K=Lr(7);return K.write_shift(1,255),K.write_shift(2,q),K.write_shift(2,N),K.write_shift(2,X,"i"),K}function A(N,q,X){var K=d(N,q,X);return K[1].v=N.read_shift(8,"f"),K}function y(N,q,X){var K=Lr(13);return K.write_shift(1,255),K.write_shift(2,q),K.write_shift(2,N),K.write_shift(8,X,"f"),K}function T(N,q,X){var K=N.l+q,se=d(N,q,X);if(se[1].v=N.read_shift(8,"f"),X.qpro)N.l=K;else{var xe=N.read_shift(2);F(N.slice(N.l,N.l+xe),se),N.l+=xe}return se}function S(N,q,X){var K=q&32768;return q&=-32769,q=(K?N:0)+(q>=8192?q-16384:q),(K?"":"$")+(X?Pr(q):la(q))}var R={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(N,q){ia(N,0);for(var X=[],K=0,se="",xe="",ke="",Se="";N.l<N.length;){var be=N[N.l++];switch(be){case 0:X.push(N.read_shift(8,"f"));break;case 1:xe=S(q[0].c,N.read_shift(2),!0),se=S(q[0].r,N.read_shift(2),!1),X.push(xe+se);break;case 2:{var ot=S(q[0].c,N.read_shift(2),!0),W=S(q[0].r,N.read_shift(2),!1);xe=S(q[0].c,N.read_shift(2),!0),se=S(q[0].r,N.read_shift(2),!1),X.push(ot+W+":"+xe+se)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(N.read_shift(2));break;case 6:{for(var Wt="";be=N[N.l++];)Wt+=String.fromCharCode(be);X.push('"'+Wt.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:Se=X.pop(),ke=X.pop(),X.push(["AND","OR"][be-20]+"("+ke+","+Se+")");break;default:if(be<32&&C[be])Se=X.pop(),ke=X.pop(),X.push(ke+C[be]+Se);else if(R[be]){if(K=R[be][1],K==69&&(K=N[N.l++]),K>X.length){console.error("WK1 bad formula parse 0x"+be.toString(16)+":|"+X.join("|")+"|");return}var st=X.slice(-K);X.length-=K,X.push(R[be][0]+"("+st.join(",")+")")}else return be<=7?console.error("WK1 invalid opcode "+be.toString(16)):be<=24?console.error("WK1 unsupported op "+be.toString(16)):be<=30?console.error("WK1 invalid opcode "+be.toString(16)):be<=115?console.error("WK1 unsupported function opcode "+be.toString(16)):console.error("WK1 unrecognized opcode "+be.toString(16))}}X.length==1?q[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function U(N){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=N.read_shift(2),q[3]=N[N.l++],q[0].c=N[N.l++],q}function B(N,q){var X=U(N);return X[1].t="s",X[1].v=N.read_shift(q-4,"cstr"),X}function k(N,q,X,K){var se=Lr(6+K.length);se.write_shift(2,N),se.write_shift(1,X),se.write_shift(1,q),se.write_shift(1,39);for(var xe=0;xe<K.length;++xe){var ke=K.charCodeAt(xe);se.write_shift(1,ke>=128?95:ke)}return se.write_shift(1,0),se}function J(N,q){var X=U(N);X[1].v=N.read_shift(2);var K=X[1].v>>1;if(X[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return X[1].v=K,X}function j(N,q){var X=U(N),K=N.read_shift(4),se=N.read_shift(4),xe=N.read_shift(2);if(xe==65535)return K===0&&se===3221225472?(X[1].t="e",X[1].v=15):K===0&&se===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var ke=xe&32768;return xe=(xe&32767)-16446,X[1].v=(1-ke*2)*(se*Math.pow(2,xe+32)+K*Math.pow(2,xe)),X}function ie(N,q,X,K){var se=Lr(14);if(se.write_shift(2,N),se.write_shift(1,X),se.write_shift(1,q),K==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var xe=0,ke=0,Se=0,be=0;return K<0&&(xe=1,K=-K),ke=Math.log2(K)|0,K/=Math.pow(2,ke-31),be=K>>>0,(be&2147483648)==0&&(K/=2,++ke,be=K>>>0),K-=be,be|=2147483648,be>>>=0,K*=Math.pow(2,32),Se=K>>>0,se.write_shift(4,Se),se.write_shift(4,be),ke+=16383+(xe?32768:0),se.write_shift(2,ke),se}function Q(N,q){var X=j(N);return N.l+=q-14,X}function ee(N,q){var X=U(N),K=N.read_shift(4);return X[1].v=K>>6,X}function ge(N,q){var X=U(N),K=N.read_shift(8,"f");return X[1].v=K,X}function ye(N,q){var X=ge(N);return N.l+=q-10,X}function me(N,q){return N[N.l+q-1]==0?N.read_shift(q,"cstr"):""}function G(N,q){var X=N[N.l++];X>q-1&&(X=q-1);for(var K="";K.length<X;)K+=String.fromCharCode(N[N.l++]);return K}function te(N,q,X){if(!(!X.qpro||q<21)){var K=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var se=N.read_shift(q-21,"cstr");return[K,se]}}function we(N,q){for(var X={},K=N.l+q;N.l<K;){var se=N.read_shift(2);if(se==14e3){for(X[se]=[0,""],X[se][0]=N.read_shift(2);N[N.l];)X[se][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return X}function ae(N,q){var X=Lr(5+N.length);X.write_shift(2,14e3),X.write_shift(2,q);for(var K=0;K<N.length;++K){var se=N.charCodeAt(K);X[X.l++]=se>127?95:se}return X[X.l++]=0,X}var Oe={0:{n:"BOF",f:Cr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:A},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:me},222:{n:"SHEETNAMELP",f:G},65535:{n:""}},Y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:J},25:{n:"FORMULA19",f:Q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:we},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ee},38:{n:"??"},39:{n:"NUMBER27",f:ge},40:{n:"FORMULA28",f:ye},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:me},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:i,to_workbook:t}})();function H8(r){var t={},e=r.match(wa),a=0,i=!1;if(e)for(;a!=e.length;++a){var l=We(e[a]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=ry[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(l[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+l[0])}}return t}var z8=(function(){var r=Nd("t"),t=Nd("rPr");function e(l){var o=l.match(r);if(!o)return{t:"s",v:""};var c={t:"s",v:Et(o[1])},f=l.match(t);return f&&(c.s=H8(f[1])),c}var a=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(i).map(e).filter(function(c){return c.v})}})(),G8=(function(){var t=/(\r\n|\n)/g;function e(i,l,o){var c=[];i.u&&c.push("text-decoration: underline;"),i.uval&&c.push("text-underline-style:"+i.uval+";"),i.sz&&c.push("font-size:"+i.sz+"pt;"),i.outline&&c.push("text-effect: outline;"),i.shadow&&c.push("text-shadow: auto;"),l.push('<span style="'+c.join("")+'">'),i.b&&(l.push("<b>"),o.push("</b>")),i.i&&(l.push("<i>"),o.push("</i>")),i.strike&&(l.push("<s>"),o.push("</s>"));var f=i.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(l.push("<"+f+">"),o.push("</"+f+">")),o.push("</span>"),i}function a(i){var l=[[],i.v,[]];return i.v?(i.s&&e(i.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(a).join("")}})(),V8=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,j8=/<(?:\w+:)?r>/,Y8=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function _y(r,t){var e=t?t.cellHTML:!0,a={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Et(Vt(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Vt(r),e&&(a.h=cy(a.t))):r.match(j8)&&(a.r=Vt(r),a.t=Et(Vt((r.replace(Y8,"").match(V8)||[]).join("").replace(wa,""))),e&&(a.h=G8(z8(a.r)))),a):{t:""}}var X8=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,q8=/<(?:\w+:)?(?:si|sstItem)>/g,W8=/<\/(?:\w+:)?(?:si|sstItem)>/;function K8(r,t){var e=[],a="";if(!r)return e;var i=r.match(X8);if(i){a=i[2].replace(q8,"").split(W8);for(var l=0;l!=a.length;++l){var o=_y(a[l].trim(),t);o!=null&&(e[e.length]=o)}i=We(i[1]),e.Count=i.count,e.Unique=i.uniqueCount}return e}function $8(r){return[r.read_shift(4),r.read_shift(4)]}function Q8(r,t){var e=[],a=!1;return Tl(r,function(l,o,c){switch(c){case 159:e.Count=l[0],e.Unique=l[1];break;case 19:e.push(l);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),e}function NO(r){for(var t=[],e=r.split(""),a=0;a<e.length;++a)t[a]=e[a].charCodeAt(0);return t}function xl(r,t){var e={};return e.Major=r.read_shift(2),e.Minor=r.read_shift(2),t>=4&&(r.l+=t-4),e}function Z8(r){var t={};return t.id=r.read_shift(0,"lpp4"),t.R=xl(r,4),t.U=xl(r,4),t.W=xl(r,4),t}function J8(r){for(var t=r.read_shift(4),e=r.l+t-4,a={},i=r.read_shift(4),l=[];i-- >0;)l.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(a.name=r.read_shift(0,"lpp4"),a.comps=l,r.l!=e)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+e);return a}function e5(r){var t=[];r.l+=4;for(var e=r.read_shift(4);e-- >0;)t.push(J8(r));return t}function t5(r){var t=[];r.l+=4;for(var e=r.read_shift(4);e-- >0;)t.push(r.read_shift(0,"lpp4"));return t}function r5(r){var t={};return r.read_shift(4),r.l+=4,t.id=r.read_shift(0,"lpp4"),t.name=r.read_shift(0,"lpp4"),t.R=xl(r,4),t.U=xl(r,4),t.W=xl(r,4),t}function a5(r){var t=r5(r);if(t.ename=r.read_shift(0,"8lpp4"),t.blksz=r.read_shift(4),t.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function MO(r,t){var e=r.l+t,a={};a.Flags=r.read_shift(4)&63,r.l+=4,a.AlgID=r.read_shift(4);var i=!1;switch(a.AlgID){case 26126:case 26127:case 26128:i=a.Flags==36;break;case 26625:i=a.Flags==4;break;case 0:i=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=r.read_shift(4),a.KeySize=r.read_shift(4),a.ProviderType=r.read_shift(4),r.l+=8,a.CSPName=r.read_shift(e-r.l>>1,"utf16le"),r.l=e,a}function IO(r,t){var e={},a=r.l+t;return r.l+=4,e.Salt=r.slice(r.l,r.l+16),r.l+=16,e.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),e.VerifierHash=r.slice(r.l,a),r.l=a,e}function n5(r){var t=xl(r);switch(t.Minor){case 2:return[t.Minor,i5(r)];case 3:return[t.Minor,s5()];case 4:return[t.Minor,l5(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function i5(r){var t=r.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var e=r.read_shift(4),a=MO(r,e),i=IO(r,r.length-r.l);return{t:"Std",h:a,v:i}}function s5(){throw new Error("File is password-protected: ECMA-376 Extensible")}function l5(r){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var e=r.read_shift(r.length-r.l,"utf8"),a={};return e.replace(wa,function(l){var o=We(l);switch(vs(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){a[c]=o[c]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function o5(r,t){var e={},a=e.EncryptionVersionInfo=xl(r,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);e.Flags=r.read_shift(4),t-=4;var i=r.read_shift(4);return t-=4,e.EncryptionHeader=MO(r,i),t-=i,e.EncryptionVerifier=IO(r,t),e}function c5(r){var t={},e=t.EncryptionVersionInfo=xl(r,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return t.Salt=r.read_shift(16),t.EncryptedVerifier=r.read_shift(16),t.EncryptedVerifierHash=r.read_shift(16),t}function u5(r){var t=0,e,a=NO(r),i=a.length+1,l,o,c,f,d;for(e=Lo(i),e[0]=a.length,l=1;l!=i;++l)e[l]=a[l-1];for(l=i-1;l>=0;--l)o=e[l],c=(t&16384)===0?0:1,f=t<<1&32767,d=c|f,t=d^o;return t^52811}var FO=(function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},i=function(o,c){return a(o^c)},l=function(o){for(var c=t[o.length-1],f=104,d=o.length-1;d>=0;--d)for(var g=o[d],m=0;m!=7;++m)g&64&&(c^=e[f]),g*=2,--f;return c};return function(o){for(var c=NO(o),f=l(c),d=c.length,g=Lo(16),m=0;m!=16;++m)g[m]=0;var v,_,A;for((d&1)===1&&(v=f>>8,g[d]=i(r[0],v),--d,v=f&255,_=c[c.length-1],g[d]=i(_,v));d>0;)--d,v=f>>8,g[d]=i(c[d],v),--d,v=f&255,g[d]=i(c[d],v);for(d=15,A=15-c.length;A>0;)v=f>>8,g[d]=i(r[A],v),--d,--A,v=f&255,g[d]=i(c[d],v),--d,--A;return g}})(),f5=function(r,t,e,a,i){i||(i=t),a||(a=FO(r));var l,o;for(l=0;l!=t.length;++l)o=t[l],o^=a[e],o=(o>>5|o<<3)&255,i[l]=o,++e;return[i,e,a]},h5=function(r){var t=0,e=FO(r);return function(a){var i=f5("",a,t,e);return t=i[1],i[0]}};function d5(r,t,e,a){var i={key:Cr(r),verificationBytes:Cr(r)};return e.password&&(i.verifier=u5(e.password)),a.valid=i.verificationBytes===i.verifier,a.valid&&(a.insitu=h5(e.password)),i}function p5(r,t,e){var a=e||{};return a.Info=r.read_shift(2),r.l-=2,a.Info===1?a.Data=c5(r):a.Data=o5(r,t),a}function g5(r,t,e){var a={Type:e.biff>=8?r.read_shift(2):0};return a.Type?p5(r,t-2,a):d5(r,e.biff>=8?t:t-2,e,a),a}var m5=(function(){function r(i,l){switch(l.type){case"base64":return t(Fn(i),l);case"binary":return t(i,l);case"buffer":return t(xt&&Buffer.isBuffer(i)?i.toString("binary"):Du(i),l);case"array":return t(wu(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){var o=l||{},c=o.dense?[]:{},f=i.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(g,m){Array.isArray(c)&&(c[m]=[]);for(var v=/\\\w+\b/g,_=0,A,y=-1;A=v.exec(g);){switch(A[0]){case"\\cell":var T=g.slice(_,v.lastIndex-A[0].length);if(T[0]==" "&&(T=T.slice(1)),++y,T.length){var S={v:T,t:"s"};Array.isArray(c)?c[m][y]=S:c[Qe({r:m,c:y})]=S}break}_=v.lastIndex}y>d.e.c&&(d.e.c=y)}),c["!ref"]=_t(d),c}function e(i,l){return Ho(r(i,l),l)}function a(i){for(var l=["{\\rtf1\\ansi"],o=fr(i["!ref"]),c,f=Array.isArray(i),d=o.s.r;d<=o.e.r;++d){l.push("\\trowd\\trautofit1");for(var g=o.s.c;g<=o.e.c;++g)l.push("\\cellx"+(g+1));for(l.push("\\pard\\intbl"),g=o.s.c;g<=o.e.c;++g){var m=Qe({r:d,c:g});c=f?(i[d]||[])[g]:i[m],!(!c||c.v==null&&(!c.f||c.F))&&(l.push(" "+(c.w||(El(c),c.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:e,to_sheet:r,from_sheet:a}})();function x5(r){var t=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Fd(r){for(var t=0,e=1;t!=3;++t)e=e*256+(r[t]>255?255:r[t]<0?0:r[t]);return e.toString(16).toUpperCase().slice(1)}function v5(r){var t=r[0]/255,e=r[1]/255,a=r[2]/255,i=Math.max(t,e,a),l=Math.min(t,e,a),o=i-l;if(o===0)return[0,0,t];var c=0,f=0,d=i+l;switch(f=o/(d>1?2-d:d),i){case t:c=((e-a)/o+6)%6;break;case e:c=(a-t)/o+2;break;case a:c=(t-e)/o+4;break}return[c/6,f,d/2]}function _5(r){var t=r[0],e=r[1],a=r[2],i=e*2*(a<.5?a:1-a),l=a-i/2,o=[l,l,l],c=6*t,f;if(e!==0)switch(c|0){case 0:case 6:f=i*c,o[0]+=i,o[1]+=f;break;case 1:f=i*(2-c),o[0]+=f,o[1]+=i;break;case 2:f=i*(c-2),o[1]+=i,o[2]+=f;break;case 3:f=i*(4-c),o[1]+=f,o[2]+=i;break;case 4:f=i*(c-4),o[2]+=i,o[0]+=f;break;case 5:f=i*(6-c),o[2]+=f,o[0]+=i;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function qm(r,t){if(t===0)return r;var e=v5(x5(r));return t<0?e[2]=e[2]*(1+t):e[2]=1-(1-e[2])*(1-t),Fd(_5(e))}var LO=6,E5=15,A5=1,Pa=LO;function Wm(r){return Math.floor((r+Math.round(128/Pa)/256)*Pa)}function Km(r){return Math.floor((r-5)/Pa*100+.5)/100}function LA(r){return Math.round((r*Pa+5)/Pa*256)/256}function lE(r){return LA(Km(Wm(r)))}function Ey(r){var t=Math.abs(r-lE(r)),e=Pa;if(t>.005)for(Pa=A5;Pa<E5;++Pa)Math.abs(r-lE(r))<=t&&(t=Math.abs(r-lE(r)),e=Pa);Pa=e}function Xh(r){r.width?(r.wpx=Wm(r.width),r.wch=Km(r.wpx),r.MDW=Pa):r.wpx?(r.wch=Km(r.wpx),r.width=LA(r.wch),r.MDW=Pa):typeof r.wch=="number"&&(r.width=LA(r.wch),r.wpx=Wm(r.width),r.MDW=Pa),r.customWidth&&delete r.customWidth}var y5=96,PO=y5;function BO(r){return r*96/PO}function Ld(r){return r*PO/96}var T5={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function S5(r,t,e,a){t.Borders=[];var i={},l=!1;(r[0].match(wa)||[]).forEach(function(o){var c=We(o);switch(vs(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},c.diagonalUp&&(i.diagonalUp=tr(c.diagonalUp)),c.diagonalDown&&(i.diagonalDown=tr(c.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+c[0]+" in borders")}})}function b5(r,t,e,a){t.Fills=[];var i={},l=!1;(r[0].match(wa)||[]).forEach(function(o){var c=We(o);switch(vs(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":c.patternType&&(i.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),c.indexed&&(i.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(i.bgColor.theme=parseInt(c.theme,10)),c.tint&&(i.bgColor.tint=parseFloat(c.tint)),c.rgb&&(i.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),c.theme&&(i.fgColor.theme=parseInt(c.theme,10)),c.tint&&(i.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(i.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+c[0]+" in fills")}})}function w5(r,t,e,a){t.Fonts=[];var i={},l=!1;(r[0].match(wa)||[]).forEach(function(o){var c=We(o);switch(vs(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":c.val&&(i.name=Vt(c.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=c.val?tr(c.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=c.val?tr(c.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(c.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=c.val?tr(c.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=c.val?tr(c.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=c.val?tr(c.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=c.val?tr(c.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=c.val?tr(c.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":c.val&&(i.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(i.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(i.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(i.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=ry[parseInt(c.val,10)];break;case"<color":if(i.color||(i.color={}),c.auto&&(i.color.auto=tr(c.auto)),c.rgb)i.color.rgb=c.rgb.slice(-6);else if(c.indexed){i.color.index=parseInt(c.indexed,10);var f=Au[i.color.index];i.color.index==81&&(f=Au[1]),f||(f=Au[1]),i.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(i.color.theme=parseInt(c.theme,10),c.tint&&(i.color.tint=parseFloat(c.tint)),c.theme&&e.themeElements&&e.themeElements.clrScheme&&(i.color.rgb=qm(e.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+c[0]+" in fonts")}})}function C5(r,t,e){t.NumberFmt=[];for(var a=ms(Je),i=0;i<a.length;++i)t.NumberFmt[a[i]]=Je[a[i]];var l=r[0].match(wa);if(l)for(i=0;i<l.length;++i){var o=We(l[i]);switch(vs(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Et(Vt(o.formatCode)),f=parseInt(o.numFmtId,10);if(t.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&t.NumberFmt[f]!=null;--f);t.NumberFmt[f]=c}Eu(c,f)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var Q1=["numFmtId","fillId","fontId","borderId","xfId"],Z1=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function R5(r,t,e){t.CellXf=[];var a,i=!1;(r[0].match(wa)||[]).forEach(function(l){var o=We(l),c=0;switch(vs(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],c=0;c<Q1.length;++c)a[Q1[c]]&&(a[Q1[c]]=parseInt(a[Q1[c]],10));for(c=0;c<Z1.length;++c)a[Z1[c]]&&(a[Z1[c]]=tr(a[Z1[c]]));if(t.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[c]){a.numFmtId=c;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};o.vertical&&(f.vertical=o.vertical),o.horizontal&&(f.horizontal=o.horizontal),o.textRotation!=null&&(f.textRotation=o.textRotation),o.indent&&(f.indent=o.indent),o.wrapText&&(f.wrapText=tr(o.wrapText)),a.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(e&&e.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var k5=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,d){var g={};if(!c)return g;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=c.match(t))&&C5(m,g,d),(m=c.match(i))&&w5(m,g,f,d),(m=c.match(a))&&b5(m,g,f,d),(m=c.match(l))&&S5(m,g,f,d),(m=c.match(e))&&R5(m,g,d),g}})();function O5(r,t){var e=r.read_shift(2),a=Sa(r);return[e,a]}function D5(r,t,e){var a={};a.sz=r.read_shift(2)/20;var i=zL(r);i.fItalic&&(a.italic=1),i.fCondense&&(a.condense=1),i.fExtend&&(a.extend=1),i.fShadow&&(a.shadow=1),i.fOutline&&(a.outline=1),i.fStrikeout&&(a.strike=1);var l=r.read_shift(2);switch(l===700&&(a.bold=1),r.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=r.read_shift(1);o!=0&&(a.underline=o);var c=r.read_shift(1);c>0&&(a.family=c);var f=r.read_shift(1);switch(f>0&&(a.charset=f),r.l++,a.color=HL(r),r.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Sa(r),a}var N5=ba;function M5(r,t){var e=r.l+t,a=r.read_shift(2),i=r.read_shift(2);return r.l=e,{ixfe:a,numFmtId:i}}var I5=ba;function F5(r,t,e){var a={};a.NumberFmt=[];for(var i in Je)a.NumberFmt[i]=Je[i];a.CellXf=[],a.Fonts=[];var l=[],o=!1;return Tl(r,function(f,d,g){switch(g){case 44:a.NumberFmt[f[0]]=f[1],Eu(f[1],f[0]);break;case 43:a.Fonts.push(f),f.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(f.color.rgb=qm(t.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&a.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(g),o=!0;break;case 38:l.pop(),o=!1;break;default:if(d.T>0)l.push(g);else if(d.T<0)l.pop();else if(!o||e.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),a}var L5=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function P5(r,t,e){t.themeElements.clrScheme=[];var a={};(r[0].match(wa)||[]).forEach(function(i){var l=We(i);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=l.val;break;case"<a:sysClr":a.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[L5.indexOf(l[0])]=a,a={}):a.name=l[0].slice(3,l[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function B5(){}function U5(){}var H5=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,z5=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,G5=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function V5(r,t,e){t.themeElements={};var a;[["clrScheme",H5,P5],["fontScheme",z5,B5],["fmtScheme",G5,U5]].forEach(function(i){if(!(a=r.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](a,t,e)})}var j5=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function UO(r,t){(!r||r.length===0)&&(r=Y5());var e,a={};if(!(e=r.match(j5)))throw new Error("themeElements not found in theme");return V5(e[0],a,t),a.raw=r,a}function Y5(r,t){var e=[$4];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function X5(r,t,e){var a=r.l+t,i=r.read_shift(4);if(i!==124226){if(!e.cellStyles){r.l=a;return}var l=r.slice(r.l);r.l=a;var o;try{o=K4(l,{type:"array"})}catch{return}var c=Mn(o,"theme/theme/theme1.xml",!0);if(c)return UO(c,e)}}function q5(r){return r.read_shift(4)}function W5(r){var t={};switch(t.xclrType=r.read_shift(2),t.nTintShade=r.read_shift(2),t.xclrType){case 0:r.l+=4;break;case 1:t.xclrValue=K5(r,4);break;case 2:t.xclrValue=bO(r);break;case 3:t.xclrValue=q5(r);break;case 4:r.l+=4;break}return r.l+=8,t}function K5(r,t){return ba(r,t)}function $5(r,t){return ba(r,t)}function Q5(r){var t=r.read_shift(2),e=r.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=W5(r);break;case 6:a[1]=$5(r,e);break;case 14:case 15:a[1]=r.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+e)}return a}function Z5(r,t){var e=r.l+t;r.l+=2;var a=r.read_shift(2);r.l+=2;for(var i=r.read_shift(2),l=[];i-- >0;)l.push(Q5(r,e-r.l));return{ixfe:a,ext:l}}function J5(r,t){t.forEach(function(e){e[0]})}function eP(r,t){return{flags:r.read_shift(4),version:r.read_shift(4),name:Sa(r)}}function tP(r){for(var t=[],e=r.read_shift(4);e-- >0;)t.push([r.read_shift(4),r.read_shift(4)]);return t}function rP(r){return r.l+=4,r.read_shift(4)!=0}function aP(r,t,e){var a={Types:[],Cell:[],Value:[]},i=e||{},l=[],o=!1,c=2;return Tl(r,function(f,d,g){switch(g){case 335:a.Types.push({name:f.name});break;case 51:f.forEach(function(m){c==1?a.Cell.push({type:a.Types[m[0]-1].name,index:m[1]}):c==0&&a.Value.push({type:a.Types[m[0]-1].name,index:m[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:l.push(g),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!d.T){if(!o||i.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),a}function nP(r,t,e){var a={Types:[],Cell:[],Value:[]};if(!r)return a;var i=!1,l=2,o;return r.replace(wa,function(c){var f=We(c);switch(vs(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==f.name&&(o=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?a.Cell.push({type:a.Types[f.t-1].name,index:+f.v}):l==0&&a.Value.push({type:a.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+f.i);break;default:if(!i&&e.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),a}function iP(r){var t=[];if(!r)return t;var e=1;return(r.match(wa)||[]).forEach(function(a){var i=We(a);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?e=i.i:i.i=e,t.push(i);break}}),t}function sP(r){var t={};t.i=r.read_shift(4);var e={};e.r=r.read_shift(4),e.c=r.read_shift(4),t.r=Qe(e);var a=r.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function lP(r,t,e){var a=[];return Tl(r,function(l,o,c){switch(c){case 63:a.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function oP(r,t,e,a){if(!r)return r;var i=a||{},l=!1;Tl(r,function(c,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!f.T){if(!l||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},i)}function cP(r,t){if(!r)return"??";var e=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][e].Target}function qC(r,t,e,a){var i=Array.isArray(r),l;t.forEach(function(o){var c=Ba(o.ref);if(i?(r[c.r]||(r[c.r]=[]),l=r[c.r][c.c]):l=r[o.ref],!l){l={t:"z"},i?r[c.r][c.c]=l:r[o.ref]=l;var f=fr(r["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var d=_t(f);d!==r["!ref"]&&(r["!ref"]=d)}l.c||(l.c=[]);var g={a:o.author,t:o.t,r:o.r,T:e};o.h&&(g.h=o.h);for(var m=l.c.length-1;m>=0;--m){if(!e&&l.c[m].T)return;e&&!l.c[m].T&&l.c.splice(m,1)}if(e&&a){for(m=0;m<a.length;++m)if(g.a==a[m].id){g.a=a[m].name||g.a;break}}l.c.push(g)})}function uP(r,t){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],a=[],i=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&e.push(c[1])}});var l=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=We(c[0]),d={author:f.authorId&&e[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},g=Ba(f.ref);if(!(t.sheetRows&&t.sheetRows<=g.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!m&&!!m[1]&&_y(m[1])||{r:"",t:"",h:""};d.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),d.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=v.h),a.push(d)}}}}),a}function fP(r,t){var e=[],a=!1,i={},l=0;return r.replace(wa,function(c,f){var d=We(c);switch(vs(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&e.push(i);break;case"<text>":case"<text":l=f+c.length;break;case"</text>":i.t=r.slice(l,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),e}function hP(r,t){var e=[],a=!1;return r.replace(wa,function(l){var o=We(l);switch(vs(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),e}function dP(r){var t={};t.iauthor=r.read_shift(4);var e=Mu(r);return t.rfx=e.s,t.ref=Qe(e.s),r.l+=16,t}var pP=Sa;function gP(r,t){var e=[],a=[],i={},l=!1;return Tl(r,function(c,f,d){switch(d){case 632:a.push(c);break;case 635:i=c;break;case 637:i.t=c.t,i.h=c.h,i.r=c.r;break;case 636:if(i.author=a[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,e.push(i);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),e}var mP="application/vnd.ms-office.vbaProject";function xP(r){var t=vt.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(e,a){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var i=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");vt.utils.cfb_add(t,i,r.FileIndex[a].content)}}),vt.write(t)}function vP(){return{"!type":"dialog"}}function _P(){return{"!type":"dialog"}}function EP(){return{"!type":"macro"}}function AP(){return{"!type":"macro"}}var Bf=(function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(a,i,l,o){var c=!1,f=!1;l.length==0?f=!0:l.charAt(0)=="["&&(f=!0,l=l.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var d=l.length>0?parseInt(l,10)|0:0,g=o.length>0?parseInt(o,10)|0:0;return c?g+=t.c:--g,f?d+=t.r:--d,i+(c?"":"$")+Pr(g)+(f?"":"$")+la(d)}return function(i,l){return t=l,i.replace(r,e)}})(),HO=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,yP=(function(){return function(t,e){return t.replace(HO,function(a,i,l,o,c,f){var d=dy(o)-(l?0:e.c),g=hy(f)-(c?0:e.r),m=g==0?"":c?g+1:"["+g+"]",v=d==0?"":l?d+1:"["+d+"]";return i+"R"+m+"C"+v})}})();function zO(r,t){return r.replace(HO,function(e,a,i,l,o,c){return a+(i=="$"?i+l:Pr(dy(l)+t.c))+(o=="$"?o+c:la(hy(c)+t.r))})}function TP(r,t,e){var a=Wh(t),i=a.s,l=Ba(e),o={r:l.r-i.r,c:l.c-i.c};return zO(r,o)}function SP(r){return r.length!=1}function WC(r){return r.replace(/_xlfn\./g,"")}function br(r){r.l+=1}function Po(r,t){var e=r.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function GO(r,t,e){var a=2;if(e){if(e.biff>=2&&e.biff<=5)return VO(r);e.biff==12&&(a=4)}var i=r.read_shift(a),l=r.read_shift(a),o=Po(r),c=Po(r);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:c[0],cRel:c[1],rRel:c[2]}}}function VO(r){var t=Po(r),e=Po(r),a=r.read_shift(1),i=r.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:e[0],c:i,cRel:e[1],rRel:e[2]}}}function bP(r,t,e){if(e.biff<8)return VO(r);var a=r.read_shift(e.biff==12?4:2),i=r.read_shift(e.biff==12?4:2),l=Po(r),o=Po(r);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function jO(r,t,e){if(e&&e.biff>=2&&e.biff<=5)return wP(r);var a=r.read_shift(e&&e.biff==12?4:2),i=Po(r);return{r:a,c:i[0],cRel:i[1],rRel:i[2]}}function wP(r){var t=Po(r),e=r.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function CP(r){var t=r.read_shift(2),e=r.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function RP(r,t,e){var a=e&&e.biff?e.biff:8;if(a>=2&&a<=5)return kP(r);var i=r.read_shift(a>=12?4:2),l=r.read_shift(2),o=(l&16384)>>14,c=(l&32768)>>15;if(l&=16383,c==1)for(;i>524287;)i-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:i,c:l,cRel:o,rRel:c}}function kP(r){var t=r.read_shift(2),e=r.read_shift(1),a=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),i==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:i,rRel:a}}function OP(r,t,e){var a=(r[r.l++]&96)>>5,i=GO(r,e.biff>=2&&e.biff<=5?6:8,e);return[a,i]}function DP(r,t,e){var a=(r[r.l++]&96)>>5,i=r.read_shift(2,"i"),l=8;if(e)switch(e.biff){case 5:r.l+=12,l=6;break;case 12:l=12;break}var o=GO(r,l,e);return[a,i,o]}function NP(r,t,e){var a=(r[r.l++]&96)>>5;return r.l+=e&&e.biff>8?12:e.biff<8?6:8,[a]}function MP(r,t,e){var a=(r[r.l++]&96)>>5,i=r.read_shift(2),l=8;if(e)switch(e.biff){case 5:r.l+=12,l=6;break;case 12:l=12;break}return r.l+=l,[a,i]}function IP(r,t,e){var a=(r[r.l++]&96)>>5,i=bP(r,t-1,e);return[a,i]}function FP(r,t,e){var a=(r[r.l++]&96)>>5;return r.l+=e.biff==2?6:e.biff==12?14:7,[a]}function KC(r){var t=r[r.l+1]&1,e=1;return r.l+=4,[t,e]}function LP(r,t,e){r.l+=2;for(var a=r.read_shift(e&&e.biff==2?1:2),i=[],l=0;l<=a;++l)i.push(r.read_shift(e&&e.biff==2?1:2));return i}function PP(r,t,e){var a=r[r.l+1]&255?1:0;return r.l+=2,[a,r.read_shift(e&&e.biff==2?1:2)]}function BP(r,t,e){var a=r[r.l+1]&255?1:0;return r.l+=2,[a,r.read_shift(e&&e.biff==2?1:2)]}function UP(r){var t=r[r.l+1]&255?1:0;return r.l+=2,[t,r.read_shift(2)]}function HP(r,t,e){var a=r[r.l+1]&255?1:0;return r.l+=e&&e.biff==2?3:4,[a]}function YO(r){var t=r.read_shift(1),e=r.read_shift(1);return[t,e]}function zP(r){return r.read_shift(2),YO(r)}function GP(r){return r.read_shift(2),YO(r)}function VP(r,t,e){var a=(r[r.l]&96)>>5;r.l+=1;var i=jO(r,0,e);return[a,i]}function jP(r,t,e){var a=(r[r.l]&96)>>5;r.l+=1;var i=RP(r,0,e);return[a,i]}function YP(r,t,e){var a=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(2);e&&e.biff==5&&(r.l+=12);var l=jO(r,0,e);return[a,i,l]}function XP(r,t,e){var a=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(e&&e.biff<=3?1:2);return[qB[i],WO[i],a]}function qP(r,t,e){var a=r[r.l++],i=r.read_shift(1),l=e&&e.biff<=3?[a==88?-1:0,r.read_shift(1)]:WP(r);return[i,(l[0]===0?WO:XB)[l[1]]]}function WP(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function KP(r,t,e){r.l+=e&&e.biff==2?3:4}function $P(r,t,e){if(r.l++,e&&e.biff==12)return[r.read_shift(4,"i"),0];var a=r.read_shift(2),i=r.read_shift(e&&e.biff==2?1:2);return[a,i]}function QP(r){return r.l++,Iu[r.read_shift(1)]}function ZP(r){return r.l++,r.read_shift(2)}function JP(r){return r.l++,r.read_shift(1)!==0}function eB(r){return r.l++,ya(r)}function tB(r,t,e){return r.l++,pg(r,t-1,e)}function rB(r,t){var e=[r.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=gr(r,1)?"TRUE":"FALSE",t!=12&&(r.l+=7);break;case 37:case 16:e[1]=Iu[r[r.l]],r.l+=t==12?4:8;break;case 0:r.l+=8;break;case 1:e[1]=ya(r);break;case 2:e[1]=Fu(r,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function aB(r,t,e){for(var a=r.read_shift(e.biff==12?4:2),i=[],l=0;l!=a;++l)i.push((e.biff==12?Mu:Rx)(r));return i}function nB(r,t,e){var a=0,i=0;e.biff==12?(a=r.read_shift(4),i=r.read_shift(4)):(i=1+r.read_shift(1),a=1+r.read_shift(2)),e.biff>=2&&e.biff<8&&(--a,--i==0&&(i=256));for(var l=0,o=[];l!=a&&(o[l]=[]);++l)for(var c=0;c!=i;++c)o[l][c]=rB(r,e.biff);return o}function iB(r,t,e){var a=r.read_shift(1)>>>5&3,i=!e||e.biff>=8?4:2,l=r.read_shift(i);switch(e.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[a,0,l]}function sB(r,t,e){if(e.biff==5)return lB(r);var a=r.read_shift(1)>>>5&3,i=r.read_shift(2),l=r.read_shift(4);return[a,i,l]}function lB(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2,"i");r.l+=8;var a=r.read_shift(2);return r.l+=12,[t,e,a]}function oB(r,t,e){var a=r.read_shift(1)>>>5&3;r.l+=e&&e.biff==2?3:4;var i=r.read_shift(e&&e.biff==2?1:2);return[a,i]}function cB(r,t,e){var a=r.read_shift(1)>>>5&3,i=r.read_shift(e&&e.biff==2?1:2);return[a,i]}function uB(r,t,e){var a=r.read_shift(1)>>>5&3;return r.l+=4,e.biff<8&&r.l--,e.biff==12&&(r.l+=2),[a]}function fB(r,t,e){var a=(r[r.l++]&96)>>5,i=r.read_shift(2),l=4;if(e)switch(e.biff){case 5:l=15;break;case 12:l=6;break}return r.l+=l,[a,i]}var hB=ba,dB=ba,pB=ba;function mg(r,t,e){return r.l+=2,[CP(r)]}function Ay(r){return r.l+=6,[]}var gB=mg,mB=Ay,xB=Ay,vB=mg;function XO(r){return r.l+=2,[Cr(r),r.read_shift(2)&1]}var _B=mg,EB=XO,AB=Ay,yB=mg,TB=mg,SB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function bB(r){r.l+=2;var t=r.read_shift(2),e=r.read_shift(2),a=r.read_shift(4),i=r.read_shift(2),l=r.read_shift(2),o=SB[e>>2&31];return{ixti:t,coltype:e&3,rt:o,idx:a,c:i,C:l}}function wB(r){return r.l+=2,[r.read_shift(4)]}function CB(r,t,e){return r.l+=5,r.l+=2,r.l+=e.biff==2?1:4,["PTGSHEET"]}function RB(r,t,e){return r.l+=e.biff==2?4:5,["PTGENDSHEET"]}function kB(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2);return[t,e]}function OB(r){var t=r.read_shift(1)>>>5&3,e=r.read_shift(2);return[t,e]}function DB(r){return r.l+=4,[0,0]}var $C={1:{n:"PtgExp",f:$P},2:{n:"PtgTbl",f:pB},3:{n:"PtgAdd",f:br},4:{n:"PtgSub",f:br},5:{n:"PtgMul",f:br},6:{n:"PtgDiv",f:br},7:{n:"PtgPower",f:br},8:{n:"PtgConcat",f:br},9:{n:"PtgLt",f:br},10:{n:"PtgLe",f:br},11:{n:"PtgEq",f:br},12:{n:"PtgGe",f:br},13:{n:"PtgGt",f:br},14:{n:"PtgNe",f:br},15:{n:"PtgIsect",f:br},16:{n:"PtgUnion",f:br},17:{n:"PtgRange",f:br},18:{n:"PtgUplus",f:br},19:{n:"PtgUminus",f:br},20:{n:"PtgPercent",f:br},21:{n:"PtgParen",f:br},22:{n:"PtgMissArg",f:br},23:{n:"PtgStr",f:tB},26:{n:"PtgSheet",f:CB},27:{n:"PtgEndSheet",f:RB},28:{n:"PtgErr",f:QP},29:{n:"PtgBool",f:JP},30:{n:"PtgInt",f:ZP},31:{n:"PtgNum",f:eB},32:{n:"PtgArray",f:FP},33:{n:"PtgFunc",f:XP},34:{n:"PtgFuncVar",f:qP},35:{n:"PtgName",f:iB},36:{n:"PtgRef",f:VP},37:{n:"PtgArea",f:OP},38:{n:"PtgMemArea",f:oB},39:{n:"PtgMemErr",f:hB},40:{n:"PtgMemNoMem",f:dB},41:{n:"PtgMemFunc",f:cB},42:{n:"PtgRefErr",f:uB},43:{n:"PtgAreaErr",f:NP},44:{n:"PtgRefN",f:jP},45:{n:"PtgAreaN",f:IP},46:{n:"PtgMemAreaN",f:kB},47:{n:"PtgMemNoMemN",f:OB},57:{n:"PtgNameX",f:sB},58:{n:"PtgRef3d",f:YP},59:{n:"PtgArea3d",f:DP},60:{n:"PtgRefErr3d",f:fB},61:{n:"PtgAreaErr3d",f:MP},255:{}},NB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},MB={1:{n:"PtgElfLel",f:XO},2:{n:"PtgElfRw",f:yB},3:{n:"PtgElfCol",f:gB},6:{n:"PtgElfRwV",f:TB},7:{n:"PtgElfColV",f:vB},10:{n:"PtgElfRadical",f:_B},11:{n:"PtgElfRadicalS",f:AB},13:{n:"PtgElfColS",f:mB},15:{n:"PtgElfColSV",f:xB},16:{n:"PtgElfRadicalLel",f:EB},25:{n:"PtgList",f:bB},29:{n:"PtgSxName",f:wB},255:{}},IB={0:{n:"PtgAttrNoop",f:DB},1:{n:"PtgAttrSemi",f:HP},2:{n:"PtgAttrIf",f:BP},4:{n:"PtgAttrChoose",f:LP},8:{n:"PtgAttrGoto",f:PP},16:{n:"PtgAttrSum",f:KP},32:{n:"PtgAttrBaxcel",f:KC},33:{n:"PtgAttrBaxcel",f:KC},64:{n:"PtgAttrSpace",f:zP},65:{n:"PtgAttrSpaceSemi",f:GP},128:{n:"PtgAttrIfError",f:UP},255:{}};function xg(r,t,e,a){if(a.biff<8)return ba(r,t);for(var i=r.l+t,l=[],o=0;o!==e.length;++o)switch(e[o][0]){case"PtgArray":e[o][1]=nB(r,0,a),l.push(e[o][1]);break;case"PtgMemArea":e[o][2]=aB(r,e[o][1],a),l.push(e[o][2]);break;case"PtgExp":a&&a.biff==12&&(e[o][1][1]=r.read_shift(4),l.push(e[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[o][0]}return t=i-r.l,t!==0&&l.push(ba(r,t)),l}function vg(r,t,e){for(var a=r.l+t,i,l,o=[];a!=r.l;)t=a-r.l,l=r[r.l],i=$C[l]||$C[NB[l]],(l===24||l===25)&&(i=(l===24?MB:IB)[r[r.l+1]]),!i||!i.f?ba(r,t):o.push([i.n,i.f(r,t,e)]);return o}function FB(r){for(var t=[],e=0;e<r.length;++e){for(var a=r[e],i=[],l=0;l<a.length;++l){var o=a[l];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var LB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function PB(r,t){if(!r&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function qO(r,t,e){if(!r)return"SH33TJSERR0";if(e.biff>8&&(!r.XTI||!r.XTI[t]))return r.SheetNames[t];if(!r.XTI)return"SH33TJSERR6";var a=r.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":r.XTI[t-1];if(!a)return"SH33TJSERR1";var i="";if(e.biff>8)switch(r[a[0]][0]){case 357:return i=a[1]==-1?"#REF":r.SheetNames[a[1]],a[1]==a[2]?i:i+":"+r.SheetNames[a[2]];case 358:return e.SID!=null?r.SheetNames[e.SID]:"SH33TJSSAME"+r[a[0]][0];case 355:default:return"SH33TJSSRC"+r[a[0]][0]}switch(r[a[0]][0][0]){case 1025:return i=a[1]==-1?"#REF":r.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?i:i+":"+r.SheetNames[a[2]];case 14849:return r[a[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return r[a[0]][0][3]?(i=a[1]==-1?"#REF":r[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?i:i+":"+r[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function QC(r,t,e){var a=qO(r,t,e);return a=="#REF"?a:PB(a,e)}function Ea(r,t,e,a,i){var l=i&&i.biff||8,o={s:{c:0,r:0}},c=[],f,d,g,m=0,v=0,_,A="";if(!r[0]||!r[0][0])return"";for(var y=-1,T="",S=0,R=r[0].length;S<R;++S){var C=r[0][S];switch(C[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),d=c.pop(),y>=0){switch(r[0][y][1][0]){case 0:T=ur(" ",r[0][y][1][1]);break;case 1:T=ur("\r",r[0][y][1][1]);break;default:if(T="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][y][1][0])}d=d+T,y=-1}c.push(d+LB[C[0]]+f);break;case"PtgIsect":f=c.pop(),d=c.pop(),c.push(d+" "+f);break;case"PtgUnion":f=c.pop(),d=c.pop(),c.push(d+","+f);break;case"PtgRange":f=c.pop(),d=c.pop(),c.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=vd(C[1][1],o,i),c.push(_d(g,l));break;case"PtgRefN":g=e?vd(C[1][1],e,i):C[1][1],c.push(_d(g,l));break;case"PtgRef3d":m=C[1][1],g=vd(C[1][2],o,i),A=QC(a,m,i),c.push(A+"!"+_d(g,l));break;case"PtgFunc":case"PtgFuncVar":var F=C[1][0],U=C[1][1];F||(F=0),F&=127;var B=F==0?[]:c.slice(-F);c.length-=F,U==="User"&&(U=B.shift()),c.push(U+"("+B.join(",")+")");break;case"PtgBool":c.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(C[1]);break;case"PtgNum":c.push(String(C[1]));break;case"PtgStr":c.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(C[1]);break;case"PtgAreaN":_=DC(C[1][1],e?{s:e}:o,i),c.push(iE(_,i));break;case"PtgArea":_=DC(C[1][1],o,i),c.push(iE(_,i));break;case"PtgArea3d":m=C[1][1],_=C[1][2],A=QC(a,m,i),c.push(A+"!"+iE(_,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=C[1][2];var k=(a.names||[])[v-1]||(a[0]||[])[v],J=k?k.Name:"SH33TJSNAME"+String(v);J&&J.slice(0,6)=="_xlfn."&&!i.xlfn&&(J=J.slice(6)),c.push(J);break;case"PtgNameX":var j=C[1][1];v=C[1][2];var ie;if(i.biff<=5)j<0&&(j=-j),a[j]&&(ie=a[j][v]);else{var Q="";if(((a[j]||[])[0]||[])[0]==14849||(((a[j]||[])[0]||[])[0]==1025?a[j][v]&&a[j][v].itab>0&&(Q=a.SheetNames[a[j][v].itab-1]+"!"):Q=a.SheetNames[v-1]+"!"),a[j]&&a[j][v])Q+=a[j][v].Name;else if(a[0]&&a[0][v])Q+=a[0][v].Name;else{var ee=(qO(a,j,i)||"").split(";;");ee[v-1]?Q=ee[v-1]:Q+="SH33TJSERRX"}c.push(Q);break}ie||(ie={Name:"SH33TJSERRY"}),c.push(ie.Name);break;case"PtgParen":var ge="(",ye=")";if(y>=0){switch(T="",r[0][y][1][0]){case 2:ge=ur(" ",r[0][y][1][1])+ge;break;case 3:ge=ur("\r",r[0][y][1][1])+ge;break;case 4:ye=ur(" ",r[0][y][1][1])+ye;break;case 5:ye=ur("\r",r[0][y][1][1])+ye;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][y][1][0])}y=-1}c.push(ge+c.pop()+ye);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":g={c:C[1][1],r:C[1][0]};var me={c:e.c,r:e.r};if(a.sharedf[Qe(g)]){var G=a.sharedf[Qe(g)];c.push(Ea(G,o,me,a,i))}else{var te=!1;for(f=0;f!=a.arrayf.length;++f)if(d=a.arrayf[f],!(g.c<d[0].s.c||g.c>d[0].e.c)&&!(g.r<d[0].s.r||g.r>d[0].e.r)){c.push(Ea(d[1],o,me,a,i)),te=!0;break}te||c.push(C[1])}break;case"PtgArray":c.push("{"+FB(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var we=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&y>=0&&we.indexOf(r[0][S][0])==-1){C=r[0][y];var ae=!0;switch(C[1][0]){case 4:ae=!1;case 0:T=ur(" ",C[1][1]);break;case 5:ae=!1;case 1:T=ur("\r",C[1][1]);break;default:if(T="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}c.push((ae?T:"")+c.pop()+(ae?"":T)),y=-1}}if(c.length>1&&i.WTF)throw new Error("bad formula stack");return c[0]}function BB(r,t,e){var a=r.l+t,i=e.biff==2?1:2,l,o=r.read_shift(i);if(o==65535)return[[],ba(r,t-2)];var c=vg(r,o,e);return t!==o+i&&(l=xg(r,t-o-i,c,e)),r.l=a,[c,l]}function UB(r,t,e){var a=r.l+t,i=e.biff==2?1:2,l,o=r.read_shift(i);if(o==65535)return[[],ba(r,t-2)];var c=vg(r,o,e);return t!==o+i&&(l=xg(r,t-o-i,c,e)),r.l=a,[c,l]}function HB(r,t,e,a){var i=r.l+t,l=vg(r,a,e),o;return i!==r.l&&(o=xg(r,i-r.l,l,e)),[l,o]}function zB(r,t,e){var a=r.l+t,i,l=r.read_shift(2),o=vg(r,l,e);return l==65535?[[],ba(r,t-2)]:(t!==l+2&&(i=xg(r,a-l-2,o,e)),[o,i])}function GB(r){var t;if(gl(r,r.l+6)!==65535)return[ya(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return t=r[r.l+2]===1,r.l+=8,[t,"b"];case 2:return t=r[r.l+2],r.l+=8,[t,"e"];case 3:return r.l+=8,["","s"]}return[]}function oE(r,t,e){var a=r.l+t,i=_s(r);e.biff==2&&++r.l;var l=GB(r),o=r.read_shift(1);e.biff!=2&&(r.read_shift(1),e.biff>=5&&r.read_shift(4));var c=UB(r,a-r.l,e);return{cell:i,val:l[0],formula:c,shared:o>>3&1,tt:l[1]}}function kx(r,t,e){var a=r.read_shift(4),i=vg(r,a,e),l=r.read_shift(4),o=l>0?xg(r,l,i,e):null;return[i,o]}var VB=kx,Ox=kx,jB=kx,YB=kx,XB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},WO={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},qB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ZC(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,e){return e.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function cE(r){var t=r.split(":"),e=t[0].split(".")[0];return[e,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Td={},Uf={};function Sd(r,t){if(r){var e=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(e=[1,1,1,1,.5,.5]),r.left==null&&(r.left=e[0]),r.right==null&&(r.right=e[1]),r.top==null&&(r.top=e[2]),r.bottom==null&&(r.bottom=e[3]),r.header==null&&(r.header=e[4]),r.footer==null&&(r.footer=e[5])}}function KO(r,t,e,a,i,l){try{a.cellNF&&(r.z=Je[t])}catch(c){if(a.WTF)throw c}if(!(r.t==="z"&&!a.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=Wr(r.v)),(!a||a.cellText!==!1)&&r.t!=="z")try{if(Je[t]==null&&Eu(WF[t]||"General",t),r.t==="e")r.w=r.w||Iu[r.v];else if(t===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Dd(r.v);else if(r.t==="d"){var o=ja(r.v);(o|0)===o?r.w=o.toString(10):r.w=Dd(o)}else{if(r.v===void 0)return"";r.w=bu(r.v,Uf)}else r.t==="d"?r.w=ui(t,ja(r.v),Uf):r.w=ui(t,r.v,Uf)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&e!=null)try{r.s=l.Fills[e],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=qm(i.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),a.WTF&&(r.s.fgColor.raw_rgb=i.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=qm(i.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),a.WTF&&(r.s.bgColor.raw_rgb=i.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&l.Fills)throw c}}}function WB(r,t){var e=fr(t);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(r["!ref"]=_t(e))}var KB=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,$B=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,QB=/<(?:\w:)?hyperlink [^>]*>/mg,ZB=/"(\w*:\w*)"/,JB=/<(?:\w:)?col\b[^>]*[\/]?>/g,eU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,tU=/<(?:\w:)?pageMargins[^>]*\/>/g,$O=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,rU=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,aU=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function nU(r,t,e,a,i,l,o){if(!r)return r;a||(a={"!id":{}});var c=t.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",g="",m=r.match($B);m?(d=r.slice(0,m.index),g=r.slice(m.index+m[0].length)):d=g=r;var v=d.match($O);v?yy(v[0],c,i,e):(v=d.match(rU))&&iU(v[0],v[1]||"",c,i,e);var _=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var A=d.slice(_,_+50).match(ZB);A&&WB(c,A[1])}var y=d.match(aU);y&&y[1]&&fU(y[1],i);var T=[];if(t.cellStyles){var S=d.match(JB);S&&oU(T,S)}m&&hU(m[1],c,t,f,l,o);var R=g.match(eU);R&&(c["!autofilter"]=cU(R[0]));var C=[],F=g.match(KB);if(F)for(_=0;_!=F.length;++_)C[_]=fr(F[_].slice(F[_].indexOf('"')+1));var U=g.match(QB);U&&sU(c,U,a);var B=g.match(tU);if(B&&(c["!margins"]=lU(We(B[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=_t(f)),t.sheetRows>0&&c["!ref"]){var k=fr(c["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>f.e.r&&(k.e.r=f.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>f.e.c&&(k.e.c=f.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),c["!fullref"]=c["!ref"],c["!ref"]=_t(k))}return T.length>0&&(c["!cols"]=T),C.length>0&&(c["!merges"]=C),c}function yy(r,t,e,a){var i=We(r);e.Sheets[a]||(e.Sheets[a]={}),i.codeName&&(e.Sheets[a].CodeName=Et(Vt(i.codeName)))}function iU(r,t,e,a,i){yy(r.slice(0,r.indexOf(">")),e,a,i)}function sU(r,t,e){for(var a=Array.isArray(r),i=0;i!=t.length;++i){var l=We(Vt(t[i]),!0);if(!l.ref)return;var o=((e||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+Et(l.location))):(l.Target="#"+Et(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var c=fr(l.ref),f=c.s.r;f<=c.e.r;++f)for(var d=c.s.c;d<=c.e.c;++d){var g=Qe({c:d,r:f});a?(r[f]||(r[f]=[]),r[f][d]||(r[f][d]={t:"z",v:void 0}),r[f][d].l=l):(r[g]||(r[g]={t:"z",v:void 0}),r[g].l=l)}}}function lU(r){var t={};return["left","right","top","bottom","header","footer"].forEach(function(e){r[e]&&(t[e]=parseFloat(r[e]))}),t}function oU(r,t){for(var e=!1,a=0;a!=t.length;++a){var i=We(t[a],!0);i.hidden&&(i.hidden=tr(i.hidden));var l=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!e&&i.width&&(e=!0,Ey(i.width)),Xh(i);l<=o;)r[l++]=sa(i)}}function cU(r){var t={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return t}var uU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function fU(r,t){t.Views||(t.Views=[{}]),(r.match(uU)||[]).forEach(function(e,a){var i=We(e);t.Views[a]||(t.Views[a]={}),+i.zoomScale&&(t.Views[a].zoom=+i.zoomScale),tr(i.rightToLeft)&&(t.Views[a].RTL=!0)})}var hU=(function(){var r=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,l=Nd("v"),o=Nd("f");return function(f,d,g,m,v,_){for(var A=0,y="",T=[],S=[],R=0,C=0,F=0,U="",B,k,J=0,j=0,ie,Q,ee=0,ge=0,ye=Array.isArray(_.CellXf),me,G=[],te=[],we=Array.isArray(d),ae=[],Oe={},Y=!1,N=!!g.sheetStubs,q=f.split(t),X=0,K=q.length;X!=K;++X){y=q[X].trim();var se=y.length;if(se!==0){var xe=0;e:for(A=0;A<se;++A)switch(y[A]){case">":if(y[A-1]!="/"){++A;break e}if(g&&g.cellStyles){if(k=We(y.slice(xe,A),!0),J=k.r!=null?parseInt(k.r,10):J+1,j=-1,g.sheetRows&&g.sheetRows<J)continue;Oe={},Y=!1,k.ht&&(Y=!0,Oe.hpt=parseFloat(k.ht),Oe.hpx=Ld(Oe.hpt)),k.hidden=="1"&&(Y=!0,Oe.hidden=!0),k.outlineLevel!=null&&(Y=!0,Oe.level=+k.outlineLevel),Y&&(ae[J-1]=Oe)}break;case"<":xe=A;break}if(xe>=A)break;if(k=We(y.slice(xe,A),!0),J=k.r!=null?parseInt(k.r,10):J+1,j=-1,!(g.sheetRows&&g.sheetRows<J)){m.s.r>J-1&&(m.s.r=J-1),m.e.r<J-1&&(m.e.r=J-1),g&&g.cellStyles&&(Oe={},Y=!1,k.ht&&(Y=!0,Oe.hpt=parseFloat(k.ht),Oe.hpx=Ld(Oe.hpt)),k.hidden=="1"&&(Y=!0,Oe.hidden=!0),k.outlineLevel!=null&&(Y=!0,Oe.level=+k.outlineLevel),Y&&(ae[J-1]=Oe)),T=y.slice(A).split(r);for(var ke=0;ke!=T.length&&T[ke].trim().charAt(0)=="<";++ke);for(T=T.slice(ke),A=0;A!=T.length;++A)if(y=T[A].trim(),y.length!==0){if(S=y.match(e),R=A,C=0,F=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,S!=null&&S.length===2){for(R=0,U=S[1],C=0;C!=U.length&&!((F=U.charCodeAt(C)-64)<1||F>26);++C)R=26*R+F;--R,j=R}else++j;for(C=0;C!=y.length&&y.charCodeAt(C)!==62;++C);if(++C,k=We(y.slice(0,C),!0),k.r||(k.r=Qe({r:J-1,c:j})),U=y.slice(C),B={t:""},(S=U.match(l))!=null&&S[1]!==""&&(B.v=Et(S[1])),g.cellFormula){if((S=U.match(o))!=null&&S[1]!==""){if(B.f=Et(Vt(S[1])).replace(/\r\n/g,`
`),g.xlfn||(B.f=WC(B.f)),S[0].indexOf('t="array"')>-1)B.F=(U.match(i)||[])[1],B.F.indexOf(":")>-1&&G.push([fr(B.F),B.F]);else if(S[0].indexOf('t="shared"')>-1){Q=We(S[0]);var Se=Et(Vt(S[1]));g.xlfn||(Se=WC(Se)),te[parseInt(Q.si,10)]=[Q,Se,k.r]}}else(S=U.match(/<f[^>]*\/>/))&&(Q=We(S[0]),te[Q.si]&&(B.f=TP(te[Q.si][1],te[Q.si][2],k.r)));var be=Ba(k.r);for(C=0;C<G.length;++C)be.r>=G[C][0].s.r&&be.r<=G[C][0].e.r&&be.c>=G[C][0].s.c&&be.c<=G[C][0].e.c&&(B.F=G[C][1])}if(k.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(N)B.t="z";else continue;else B.t=k.t||"n";switch(m.s.c>j&&(m.s.c=j),m.e.c<j&&(m.e.c=j),B.t){case"n":if(B.v==""||B.v==null){if(!N)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!N)continue;B.t="z"}else ie=Td[parseInt(B.v,10)],B.v=ie.t,B.r=ie.r,g.cellHTML&&(B.h=ie.h);break;case"str":B.t="s",B.v=B.v!=null?Vt(B.v):"",g.cellHTML&&(B.h=cy(B.v));break;case"inlineStr":S=U.match(a),B.t="s",S!=null&&(ie=_y(S[1]))?(B.v=ie.t,g.cellHTML&&(B.h=ie.h)):B.v="";break;case"b":B.v=tr(B.v);break;case"d":g.cellDates?B.v=Wr(B.v,1):(B.v=ja(Wr(B.v,1)),B.t="n");break;case"e":(!g||g.cellText!==!1)&&(B.w=B.v),B.v=xO[B.v];break}if(ee=ge=0,me=null,ye&&k.s!==void 0&&(me=_.CellXf[k.s],me!=null&&(me.numFmtId!=null&&(ee=me.numFmtId),g.cellStyles&&me.fillId!=null&&(ge=me.fillId))),KO(B,ee,ge,g,v,_),g.cellDates&&ye&&B.t=="n"&&qh(Je[ee])&&(B.t="d",B.v=Cx(B.v)),k.cm&&g.xlmeta){var ot=(g.xlmeta.Cell||[])[+k.cm-1];ot&&ot.type=="XLDAPR"&&(B.D=!0)}if(we){var W=Ba(k.r);d[W.r]||(d[W.r]=[]),d[W.r][W.c]=B}else d[k.r]=B}}}}ae.length>0&&(d["!rows"]=ae)}})();function dU(r,t){var e={},a=r.l+t;e.r=r.read_shift(4),r.l+=4;var i=r.read_shift(2);r.l+=1;var l=r.read_shift(1);return r.l=a,l&7&&(e.level=l&7),l&16&&(e.hidden=!0),l&32&&(e.hpt=i/20),e}var pU=Mu;function gU(){}function mU(r,t){var e={},a=r[r.l];return++r.l,e.above=!(a&64),e.left=!(a&128),r.l+=18,e.name=BL(r),e}function xU(r){var t=fi(r);return[t]}function vU(r){var t=Nu(r);return[t]}function _U(r){var t=fi(r),e=r.read_shift(1);return[t,e,"b"]}function EU(r){var t=Nu(r),e=r.read_shift(1);return[t,e,"b"]}function AU(r){var t=fi(r),e=r.read_shift(1);return[t,e,"e"]}function yU(r){var t=Nu(r),e=r.read_shift(1);return[t,e,"e"]}function TU(r){var t=fi(r),e=r.read_shift(4);return[t,e,"s"]}function SU(r){var t=Nu(r),e=r.read_shift(4);return[t,e,"s"]}function bU(r){var t=fi(r),e=ya(r);return[t,e,"n"]}function QO(r){var t=Nu(r),e=ya(r);return[t,e,"n"]}function wU(r){var t=fi(r),e=my(r);return[t,e,"n"]}function CU(r){var t=Nu(r),e=my(r);return[t,e,"n"]}function RU(r){var t=fi(r),e=py(r);return[t,e,"is"]}function kU(r){var t=fi(r),e=Sa(r);return[t,e,"str"]}function OU(r){var t=Nu(r),e=Sa(r);return[t,e,"str"]}function DU(r,t,e){var a=r.l+t,i=fi(r);i.r=e["!row"];var l=r.read_shift(1),o=[i,l,"b"];if(e.cellFormula){r.l+=2;var c=Ox(r,a-r.l,e);o[3]=Ea(c,null,i,e.supbooks,e)}else r.l=a;return o}function NU(r,t,e){var a=r.l+t,i=fi(r);i.r=e["!row"];var l=r.read_shift(1),o=[i,l,"e"];if(e.cellFormula){r.l+=2;var c=Ox(r,a-r.l,e);o[3]=Ea(c,null,i,e.supbooks,e)}else r.l=a;return o}function MU(r,t,e){var a=r.l+t,i=fi(r);i.r=e["!row"];var l=ya(r),o=[i,l,"n"];if(e.cellFormula){r.l+=2;var c=Ox(r,a-r.l,e);o[3]=Ea(c,null,i,e.supbooks,e)}else r.l=a;return o}function IU(r,t,e){var a=r.l+t,i=fi(r);i.r=e["!row"];var l=Sa(r),o=[i,l,"str"];if(e.cellFormula){r.l+=2;var c=Ox(r,a-r.l,e);o[3]=Ea(c,null,i,e.supbooks,e)}else r.l=a;return o}var FU=Mu;function LU(r,t){var e=r.l+t,a=Mu(r),i=gy(r),l=Sa(r),o=Sa(r),c=Sa(r);r.l=e;var f={rfx:a,relId:i,loc:l,display:c};return o&&(f.Tooltip=o),f}function PU(){}function BU(r,t,e){var a=r.l+t,i=pO(r),l=r.read_shift(1),o=[i];if(o[2]=l,e.cellFormula){var c=VB(r,a-r.l,e);o[1]=c}else r.l=a;return o}function UU(r,t,e){var a=r.l+t,i=Mu(r),l=[i];if(e.cellFormula){var o=YB(r,a-r.l,e);l[1]=o,r.l=a}else r.l=a;return l}var HU=["left","right","top","bottom","header","footer"];function zU(r){var t={};return HU.forEach(function(e){t[e]=ya(r)}),t}function GU(r){var t=r.read_shift(2);return r.l+=28,{RTL:t&32}}function VU(){}function jU(){}function YU(r,t,e,a,i,l,o){if(!r)return r;var c=t||{};a||(a={"!id":{}});var f=c.dense?[]:{},d,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,v=!1,_,A,y,T,S,R,C,F,U,B=[];c.biff=12,c["!row"]=0;var k=0,J=!1,j=[],ie={},Q=c.supbooks||i.supbooks||[[]];if(Q.sharedf=ie,Q.arrayf=j,Q.SheetNames=i.SheetNames||i.Sheets.map(function(we){return we.name}),!c.supbooks&&(c.supbooks=Q,i.Names))for(var ee=0;ee<i.Names.length;++ee)Q[0][ee+1]=i.Names[ee];var ge=[],ye=[],me=!1;$m[16]={n:"BrtShortReal",f:QO};var G;if(Tl(r,function(ae,Oe,Y){if(!v)switch(Y){case 148:d=ae;break;case 0:_=ae,c.sheetRows&&c.sheetRows<=_.r&&(v=!0),F=la(T=_.r),c["!row"]=_.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=Ld(ae.hpt)),ye[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(A={t:ae[2]},ae[2]){case"n":A.v=ae[1];break;case"s":C=Td[ae[1]],A.v=C.t,A.r=C.r;break;case"b":A.v=!!ae[1];break;case"e":A.v=ae[1],c.cellText!==!1&&(A.w=Iu[A.v]);break;case"str":A.t="s",A.v=ae[1];break;case"is":A.t="s",A.v=ae[1].t;break}if((y=o.CellXf[ae[0].iStyleRef])&&KO(A,y.numFmtId,null,c,l,o),S=ae[0].c==-1?S+1:ae[0].c,c.dense?(f[T]||(f[T]=[]),f[T][S]=A):f[Pr(S)+F]=A,c.cellFormula){for(J=!1,k=0;k<j.length;++k){var N=j[k];_.r>=N[0].s.r&&_.r<=N[0].e.r&&S>=N[0].s.c&&S<=N[0].e.c&&(A.F=_t(N[0]),J=!0)}!J&&ae.length>3&&(A.f=ae[3])}if(g.s.r>_.r&&(g.s.r=_.r),g.s.c>S&&(g.s.c=S),g.e.r<_.r&&(g.e.r=_.r),g.e.c<S&&(g.e.c=S),c.cellDates&&y&&A.t=="n"&&qh(Je[y.numFmtId])){var q=gc(A.v);q&&(A.t="d",A.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}G&&(G.type=="XLDAPR"&&(A.D=!0),G=void 0);break;case 1:case 12:if(!c.sheetStubs||m)break;A={t:"z",v:void 0},S=ae[0].c==-1?S+1:ae[0].c,c.dense?(f[T]||(f[T]=[]),f[T][S]=A):f[Pr(S)+F]=A,g.s.r>_.r&&(g.s.r=_.r),g.s.c>S&&(g.s.c=S),g.e.r<_.r&&(g.e.r=_.r),g.e.c<S&&(g.e.c=S),G&&(G.type=="XLDAPR"&&(A.D=!0),G=void 0);break;case 176:B.push(ae);break;case 49:G=((c.xlmeta||{}).Cell||[])[ae-1];break;case 494:var X=a["!id"][ae.relId];for(X?(ae.Target=X.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=X):ae.relId==""&&(ae.Target="#"+ae.loc),T=ae.rfx.s.r;T<=ae.rfx.e.r;++T)for(S=ae.rfx.s.c;S<=ae.rfx.e.c;++S)c.dense?(f[T]||(f[T]=[]),f[T][S]||(f[T][S]={t:"z",v:void 0}),f[T][S].l=ae):(R=Qe({c:S,r:T}),f[R]||(f[R]={t:"z",v:void 0}),f[R].l=ae);break;case 426:if(!c.cellFormula)break;j.push(ae),U=c.dense?f[T][S]:f[Pr(S)+F],U.f=Ea(ae[1],g,{r:_.r,c:S},Q,c),U.F=_t(ae[0]);break;case 427:if(!c.cellFormula)break;ie[Qe(ae[0].s)]=ae[1],U=c.dense?f[T][S]:f[Pr(S)+F],U.f=Ea(ae[1],g,{r:_.r,c:S},Q,c);break;case 60:if(!c.cellStyles)break;for(;ae.e>=ae.s;)ge[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},me||(me=!0,Ey(ae.w/256)),Xh(ge[ae.e+1]);break;case 161:f["!autofilter"]={ref:_t(ae)};break;case 476:f["!margins"]=ae;break;case 147:i.Sheets[e]||(i.Sheets[e]={}),ae.name&&(i.Sheets[e].CodeName=ae.name),(ae.above||ae.left)&&(f["!outline"]={above:ae.above,left:ae.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ae.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!Oe.T){if(!m||c.WTF)throw new Error("Unexpected record 0x"+Y.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(g.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=_t(d||g)),c.sheetRows&&f["!ref"]){var te=fr(f["!ref"]);c.sheetRows<=+te.e.r&&(te.e.r=c.sheetRows-1,te.e.r>g.e.r&&(te.e.r=g.e.r),te.e.r<te.s.r&&(te.s.r=te.e.r),te.e.c>g.e.c&&(te.e.c=g.e.c),te.e.c<te.s.c&&(te.s.c=te.e.c),f["!fullref"]=f["!ref"],f["!ref"]=_t(te))}return B.length>0&&(f["!merges"]=B),ge.length>0&&(f["!cols"]=ge),ye.length>0&&(f["!rows"]=ye),f}function XU(r){var t=[],e=r.match(/^<c:numCache>/),a;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=e?+o[2]:o[2])});var i=Et((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){a=l.replace(/<.*?>/g,"")}),[t,i,a]}function qU(r,t,e,a,i,l){var o=l||{"!type":"chart"};if(!r)return l;var c=0,f=0,d="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var v=XU(m);g.s.r=g.s.c=0,g.e.c=c,d=Pr(c),v[0].forEach(function(_,A){o[d+la(A)]={t:"n",v:_,z:v[1]},f=A}),g.e.r<f&&(g.e.r=f),++c}),c>0&&(o["!ref"]=_t(g)),o}function WU(r,t,e,a,i){if(!r)return r;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,c=r.match($O);return c&&yy(c[0],l,i,e),(o=r.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}function KU(r,t){r.l+=10;var e=Sa(r);return{name:e}}function $U(r,t,e,a,i){if(!r)return r;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Tl(r,function(f,d,g){switch(g){case 550:l["!rel"]=f;break;case 651:i.Sheets[e]||(i.Sheets[e]={}),f.name&&(i.Sheets[e].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},t),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}var ZO=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],QU=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ZU=[],JU=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function JC(r,t){for(var e=0;e!=r.length;++e)for(var a=r[e],i=0;i!=t.length;++i){var l=t[i];if(a[l[0]]==null)a[l[0]]=l[1];else switch(l[2]){case"bool":typeof a[l[0]]=="string"&&(a[l[0]]=tr(a[l[0]]));break;case"int":typeof a[l[0]]=="string"&&(a[l[0]]=parseInt(a[l[0]],10));break}}}function eR(r,t){for(var e=0;e!=t.length;++e){var a=t[e];if(r[a[0]]==null)r[a[0]]=a[1];else switch(a[2]){case"bool":typeof r[a[0]]=="string"&&(r[a[0]]=tr(r[a[0]]));break;case"int":typeof r[a[0]]=="string"&&(r[a[0]]=parseInt(r[a[0]],10));break}}}function JO(r){eR(r.WBProps,ZO),eR(r.CalcPr,JU),JC(r.WBView,QU),JC(r.Sheets,ZU),Uf.date1904=tr(r.WBProps.date1904)}var e7="][*?/\\".split("");function t7(r,t){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return e7.forEach(function(a){if(r.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}var r7=/<\w+:workbook/;function a7(r,t){if(!r)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,i="xmlns",l={},o=0;if(r.replace(wa,function(f,d){var g=We(f);switch(vs(g[0])){case"<?xml":break;case"<workbook":f.match(r7)&&(i="xmlns"+f.match(/<(\w+):/)[1]),e.xmlns=g[i];break;case"</workbook>":break;case"<fileVersion":delete g[0],e.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ZO.forEach(function(m){if(g[m[0]]!=null)switch(m[2]){case"bool":e.WBProps[m[0]]=tr(g[m[0]]);break;case"int":e.WBProps[m[0]]=parseInt(g[m[0]],10);break;default:e.WBProps[m[0]]=g[m[0]]}}),g.codeName&&(e.WBProps.CodeName=Vt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],e.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=Et(Vt(g.name)),delete g[0],e.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":l={},l.Name=Vt(g.name),g.comment&&(l.Comment=g.comment),g.localSheetId&&(l.Sheet=+g.localSheetId),tr(g.hidden||"0")&&(l.Hidden=!0),o=d+f.length;break;case"</definedName>":l.Ref=Et(Vt(r.slice(o,d))),e.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete g[0],e.CalcPr=g;break;case"<calcPr/>":delete g[0],e.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return f}),AL.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return JO(e),e}function n7(r,t){var e={};return e.Hidden=r.read_shift(4),e.iTabID=r.read_shift(4),e.strRelID=MA(r),e.name=Sa(r),e}function i7(r,t){var e={},a=r.read_shift(4);e.defaultThemeVersion=r.read_shift(4);var i=t>8?Sa(r):"";return i.length>0&&(e.CodeName=i),e.autoCompressPictures=!!(a&65536),e.backupFile=!!(a&64),e.checkCompatibility=!!(a&4096),e.date1904=!!(a&1),e.filterPrivacy=!!(a&8),e.hidePivotFieldList=!!(a&1024),e.promptedSolutions=!!(a&16),e.publishItems=!!(a&2048),e.refreshAllConnections=!!(a&262144),e.saveExternalLinkValues=!!(a&128),e.showBorderUnselectedTables=!!(a&4),e.showInkAnnotation=!!(a&32),e.showObjects=["all","placeholders","none"][a>>13&3],e.showPivotChartFilter=!!(a&32768),e.updateLinks=["userSet","never","always"][a>>8&3],e}function s7(r,t){var e={};return r.read_shift(4),e.ArchID=r.read_shift(4),r.l+=t-8,e}function l7(r,t,e){var a=r.l+t;r.l+=4,r.l+=1;var i=r.read_shift(4),l=UL(r),o=jB(r,0,e),c=gy(r);r.l=a;var f={Name:l,Ptg:o};return i<268435455&&(f.Sheet=i),c&&(f.Comment=c),f}function o7(r,t){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],i=!1;t||(t={}),t.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],$m[16]={n:"BrtFRTArchID$",f:s7},Tl(r,function(f,d,g){switch(g){case 156:o.SheetNames.push(f.name),e.Sheets.push(f);break;case 153:e.WBProps=f;break;case 39:f.Sheet!=null&&(t.SID=f.Sheet),f.Ref=Ea(f.Ptg,null,null,o,t),delete t.SID,delete f.Ptg,l.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([g,f]):o[0]=[g,f],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(f),o.XTI=o.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(g),i=!0;break;case 36:a.pop(),i=!1;break;case 37:a.push(g),i=!0;break;case 38:a.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},t),JO(e),e.Names=l,e.supbooks=o,e}function c7(r,t,e){return t.slice(-4)===".bin"?o7(r,e):a7(r,e)}function u7(r,t,e,a,i,l,o,c){return t.slice(-4)===".bin"?YU(r,a,e,i,l,o,c):nU(r,a,e,i,l,o,c)}function f7(r,t,e,a,i,l,o,c){return t.slice(-4)===".bin"?$U(r,a,e,i,l):WU(r,a,e,i,l)}function h7(r,t,e,a,i,l,o,c){return t.slice(-4)===".bin"?EP():AP()}function d7(r,t,e,a,i,l,o,c){return t.slice(-4)===".bin"?vP():_P()}function p7(r,t,e,a){return t.slice(-4)===".bin"?F5(r,e,a):k5(r,e,a)}function g7(r,t,e){return UO(r,e)}function m7(r,t,e){return t.slice(-4)===".bin"?Q8(r,e):K8(r,e)}function x7(r,t,e){return t.slice(-4)===".bin"?gP(r,e):uP(r,e)}function v7(r,t,e){return t.slice(-4)===".bin"?lP(r):iP(r)}function _7(r,t,e,a){return e.slice(-4)===".bin"?oP(r,t,e,a):void 0}function E7(r,t,e){return t.slice(-4)===".bin"?aP(r,t,e):nP(r,t,e)}var eD=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,tD=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function vi(r,t){var e=r.split(/\s+/),a=[];if(a[0]=e[0],e.length===1)return a;var i=r.match(eD),l,o,c,f;if(i)for(f=0;f!=i.length;++f)l=i[f].match(tD),(o=l[1].indexOf(":"))===-1?a[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?c="xmlns"+l[1].slice(6):c=l[1].slice(o+1),a[c]=l[2].slice(1,l[2].length-1));return a}function A7(r){var t=r.split(/\s+/),e={};if(t.length===1)return e;var a=r.match(eD),i,l,o,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(tD),(l=i[1].indexOf(":"))===-1?e[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(l+1),e[o]=i[2].slice(1,i[2].length-1));return e}var bd;function y7(r,t){var e=bd[r]||Et(r);return e==="General"?bu(t):ui(e,t)}function T7(r,t,e,a){var i=a;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=tr(a);break;case"i2":case"int":i=parseInt(a,10);break;case"r4":case"float":i=parseFloat(a);break;case"date":case"dateTime.tz":i=Wr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}r[Et(t)]=i}function S7(r,t,e){if(r.t!=="z"){if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||Iu[r.v]:t==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Dd(r.v):r.w=bu(r.v):r.w=y7(t||"General",r.v)}catch(l){if(e.WTF)throw l}try{var a=bd[t]||t||"General";if(e.cellNF&&(r.z=a),e.cellDates&&r.t=="n"&&qh(a)){var i=gc(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(l){if(e.WTF)throw l}}}function b7(r,t,e){if(e.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=T5[a.Pattern]||a.Pattern)}r[t.ID]=t}function w7(r,t,e,a,i,l,o,c,f,d){var g="General",m=a.StyleID,v={};d=d||{};var _=[],A=0;for(m===void 0&&c&&(m=c.StyleID),m===void 0&&o&&(m=o.StyleID);l[m]!==void 0&&(l[m].nf&&(g=l[m].nf),l[m].Interior&&_.push(l[m].Interior),!!l[m].Parent);)m=l[m].Parent;switch(e.Type){case"Boolean":a.t="b",a.v=tr(r);break;case"String":a.t="s",a.r=yC(Et(r)),a.v=r.indexOf("<")>-1?Et(t||r).replace(/<.*?>/g,""):a.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),a.v=(Wr(r)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Et(r):a.v<60&&(a.v=a.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+r),a.t||(a.t="n");break;case"Error":a.t="e",a.v=xO[r],d.cellText!==!1&&(a.w=r);break;default:r==""&&t==""?a.t="z":(a.t="s",a.v=yC(t||r));break}if(S7(a,g,d),d.cellFormula!==!1)if(a.Formula){var y=Et(a.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),a.f=Bf(y,i),delete a.Formula,a.ArrayRange=="RC"?a.F=Bf("RC:RC",i):a.ArrayRange&&(a.F=Bf(a.ArrayRange,i),f.push([fr(a.F),a.F]))}else for(A=0;A<f.length;++A)i.r>=f[A][0].s.r&&i.r<=f[A][0].e.r&&i.c>=f[A][0].s.c&&i.c<=f[A][0].e.c&&(a.F=f[A][1]);d.cellStyles&&(_.forEach(function(T){!v.patternType&&T.patternType&&(v.patternType=T.patternType)}),a.s=v),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function C7(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function uE(r,t){var e=t||{};V4();var a=fd(uy(r));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(a=Vt(a));var i=a.slice(0,1024).toLowerCase(),l=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=sa(e);return o.type="string",Id.to_workbook(a,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Kt){i.indexOf("<"+Kt)>=0&&(l=!0)}),l)return L7(a,e);bd={"General Number":"General","General Date":Je[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Je[15],"Short Date":Je[14],"Long Time":Je[19],"Medium Time":Je[18],"Short Time":Je[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Je[2],Standard:Je[4],Percent:Je[10],Scientific:Je[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],d,g={},m=[],v=e.dense?[]:{},_="",A={},y={},T=vi('<Data ss:Type="String">'),S=0,R=0,C=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},U={},B={},k="",J=0,j=[],ie={},Q={},ee=0,ge=[],ye=[],me={},G=[],te,we=!1,ae=[],Oe=[],Y={},N=0,q=0,X={Sheets:[],WBProps:{date1904:!1}},K={};Md.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var se="";c=Md.exec(a);)switch(c[3]=(se=c[3]).toLowerCase()){case"data":if(se=="data"){if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?w7(a.slice(S,c.index),k,T,f[f.length-1][0]=="comment"?me:A,{c:R,r:C},U,G[R],y,ae,e):(k="",T=vi(c[0]),S=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(ye.length>0&&(A.c=ye),(!e.sheetRows||e.sheetRows>C)&&A.v!==void 0&&(e.dense?(v[C]||(v[C]=[]),v[C][R]=A):v[Pr(R)+la(C)]=A),A.HRef&&(A.l={Target:Et(A.HRef)},A.HRefScreenTip&&(A.l.Tooltip=A.HRefScreenTip),delete A.HRef,delete A.HRefScreenTip),(A.MergeAcross||A.MergeDown)&&(N=R+(parseInt(A.MergeAcross,10)|0),q=C+(parseInt(A.MergeDown,10)|0),j.push({s:{c:R,r:C},e:{c:N,r:q}})),!e.sheetStubs)A.MergeAcross?R=N+1:++R;else if(A.MergeAcross||A.MergeDown){for(var xe=R;xe<=N;++xe)for(var ke=C;ke<=q;++ke)(xe>R||ke>C)&&(e.dense?(v[ke]||(v[ke]=[]),v[ke][xe]={t:"z"}):v[Pr(xe)+la(ke)]={t:"z"});R=N+1}else++R;else A=A7(c[0]),A.Index&&(R=+A.Index-1),R<F.s.c&&(F.s.c=R),R>F.e.c&&(F.e.c=R),c[0].slice(-2)==="/>"&&++R,ye=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(C<F.s.r&&(F.s.r=C),C>F.e.r&&(F.e.r=C),c[0].slice(-2)==="/>"&&(y=vi(c[0]),y.Index&&(C=+y.Index-1)),R=0,++C):(y=vi(c[0]),y.Index&&(C=+y.Index-1),Y={},(y.AutoFitHeight=="0"||y.Height)&&(Y.hpx=parseInt(y.Height,10),Y.hpt=BO(Y.hpx),Oe[C]=Y),y.Hidden=="1"&&(Y.hidden=!0,Oe[C]=Y));break;case"worksheet":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));m.push(_),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(v["!ref"]=_t(F),e.sheetRows&&e.sheetRows<=F.e.r&&(v["!fullref"]=v["!ref"],F.e.r=e.sheetRows-1,v["!ref"]=_t(F))),j.length&&(v["!merges"]=j),G.length>0&&(v["!cols"]=G),Oe.length>0&&(v["!rows"]=Oe),g[_]=v}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=R=0,f.push([c[3],!1]),d=vi(c[0]),_=Et(d.Name),v=e.dense?[]:{},j=[],ae=[],Oe=[],K={name:_,Hidden:0},X.Sheets.push(K);break;case"table":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),G=[],we=!1}break;case"style":c[1]==="/"?b7(U,B,e):B=vi(c[0]);break;case"numberformat":B.nf=Et(vi(c[0]).Format||"General"),bd[B.nf]&&(B.nf=bd[B.nf]);for(var Se=0;Se!=392&&Je[Se]!=B.nf;++Se);if(Se==392){for(Se=57;Se!=392;++Se)if(Je[Se]==null){Eu(B.nf,Se);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(te=vi(c[0]),te.Hidden&&(te.hidden=!0,delete te.Hidden),te.Width&&(te.wpx=parseInt(te.Width,10)),!we&&te.wpx>10){we=!0,Pa=LO;for(var be=0;be<G.length;++be)G[be]&&Xh(G[be])}we&&Xh(te),G[te.Index-1||G.length]=te;for(var ot=0;ot<+te.Span;++ot)G[G.length]=sa(te);break;case"namedrange":if(c[1]==="/")break;X.Names||(X.Names=[]);var W=We(c[0]),Wt={Name:W.Name,Ref:Bf(W.RefersTo.slice(1),{r:0,c:0})};X.Sheets.length>0&&(Wt.Sheet=X.Sheets.length-1),X.Names.push(Wt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?k+=a.slice(J,c.index):J=c.index+c[0].length;break;case"interior":if(!e.cellStyles)break;B.Interior=vi(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?u6(ie,se,a.slice(ee,c.index)):ee=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));C7(me),ye.push(me)}else f.push([c[3],!1]),d=vi(c[0]),me={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var st=vi(c[0]);v["!autofilter"]={ref:Bf(st.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return sR(a,e);var bt=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:bt=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:bt=!1}break;case"excelworkbook":switch(c[3]){case"date1904":X.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:bt=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:bt=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(ee,c.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else ee=c.index+c[0].length;break;case"header":v["!margins"]||Sd(v["!margins"]={},"xlml"),isNaN(+We(c[0]).Margin)||(v["!margins"].header=+We(c[0]).Margin);break;case"footer":v["!margins"]||Sd(v["!margins"]={},"xlml"),isNaN(+We(c[0]).Margin)||(v["!margins"].footer=+We(c[0]).Margin);break;case"pagemargins":var tt=We(c[0]);v["!margins"]||Sd(v["!margins"]={},"xlml"),isNaN(+tt.Top)||(v["!margins"].top=+tt.Top),isNaN(+tt.Left)||(v["!margins"].left=+tt.Left),isNaN(+tt.Right)||(v["!margins"].right=+tt.Right),isNaN(+tt.Bottom)||(v["!margins"].bottom=+tt.Bottom);break;case"displayrighttoleft":X.Views||(X.Views=[]),X.Views[0]||(X.Views[0]={}),X.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:bt=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:bt=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:bt=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:bt=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:bt=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:bt=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:bt=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:bt=!1}break;case"smarttags":break;default:bt=!1;break}if(bt||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?T7(Q,se,ge,a.slice(ee,c.index)):(ge=c,ee=c.index+c[0].length);break}if(e.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var Ie={};return!e.bookSheets&&!e.bookProps&&(Ie.Sheets=g),Ie.SheetNames=m,Ie.Workbook=X,Ie.SSF=sa(Je),Ie.Props=ie,Ie.Custprops=Q,Ie}function PA(r,t){switch(by(t=t||{}),t.type||"base64"){case"base64":return uE(Fn(r),t);case"binary":case"buffer":case"file":return uE(r,t);case"array":return uE(Du(r),t)}}function R7(r){var t={},e=r.content;if(e.l=28,t.AnsiUserType=e.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=GL(e),e.length-e.l<=4)return t;var a=e.read_shift(4);if(a==0||a>40||(e.l-=4,t.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(a=e.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=VL(e),a=e.read_shift(4),a==0||a>40))return t;e.l-=4,t.Reserved2=e.read_shift(0,"lpwstr")}var k7=[60,1084,2066,2165,2175];function O7(r,t,e,a,i){var l=a,o=[],c=e.slice(e.l,e.l+l);if(i&&i.enc&&i.enc.insitu&&c.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(c)}o.push(c),e.l+=l;for(var f=gl(e,e.l),d=BA[f],g=0;d!=null&&k7.indexOf(f)>-1;)l=gl(e,e.l+2),g=e.l+4,f==2066?g+=4:(f==2165||f==2175)&&(g+=12),c=e.slice(g,e.l+4+l),o.push(c),e.l+=4+l,d=BA[f=gl(e,e.l)];var m=Zl(o);ia(m,0);var v=0;m.lens=[];for(var _=0;_<o.length;++_)m.lens.push(v),v+=o[_].length;if(m.length<a)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+m.length+" < "+a;return t.f(m,m.length,i)}function $i(r,t,e){if(r.t!=="z"&&r.XF){var a=0;try{a=r.z||r.XF.numFmtId||0,t.cellNF&&(r.z=Je[a])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||Iu[r.v]:a===0||a=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=Dd(r.v):r.w=bu(r.v):r.w=ui(a,r.v,{date1904:!!e,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&a&&r.t=="n"&&qh(Je[a]||String(a))){var i=gc(r.v);i&&(r.t="d",r.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function J1(r,t,e){return{v:r,ixfe:t,t:e}}function D7(r,t){var e={opts:{}},a={},i=t.dense?[]:{},l={},o={},c=null,f=[],d="",g={},m,v="",_,A,y,T,S={},R=[],C,F,U=[],B=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},J={},j=function(rt){return rt<8?Au[rt]:rt<64&&B[rt-8]||Au[rt]},ie=function(rt,rr,Xa){var jt=rr.XF.data;if(!(!jt||!jt.patternType||!Xa||!Xa.cellStyles)){rr.s={},rr.s.patternType=jt.patternType;var hr;(hr=Fd(j(jt.icvFore)))&&(rr.s.fgColor={rgb:hr}),(hr=Fd(j(jt.icvBack)))&&(rr.s.bgColor={rgb:hr})}},Q=function(rt,rr,Xa){if(!(Y>1)&&!(Xa.sheetRows&&rt.r>=Xa.sheetRows)){if(Xa.cellStyles&&rr.XF&&rr.XF.data&&ie(rt,rr,Xa),delete rr.ixfe,delete rr.XF,m=rt,v=Qe(rt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),rt.r<o.s.r&&(o.s.r=rt.r),rt.c<o.s.c&&(o.s.c=rt.c),rt.r+1>o.e.r&&(o.e.r=rt.r+1),rt.c+1>o.e.c&&(o.e.c=rt.c+1),Xa.cellFormula&&rr.f){for(var jt=0;jt<R.length;++jt)if(!(R[jt][0].s.c>rt.c||R[jt][0].s.r>rt.r)&&!(R[jt][0].e.c<rt.c||R[jt][0].e.r<rt.r)){rr.F=_t(R[jt][0]),(R[jt][0].s.c!=rt.c||R[jt][0].s.r!=rt.r)&&delete rr.f,rr.f&&(rr.f=""+Ea(R[jt][1],o,rt,ae,ee));break}}Xa.dense?(i[rt.r]||(i[rt.r]=[]),i[rt.r][rt.c]=rr):i[v]=rr}},ee={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:R,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(ee.password=t.password);var ge,ye=[],me=[],G=[],te=[],we=!1,ae=[];ae.SheetNames=ee.snames,ae.sharedf=ee.sharedf,ae.arrayf=ee.arrayf,ae.names=[],ae.XTI=[];var Oe=0,Y=0,N=0,q=[],X=[],K;ee.codepage=1200,Fi(1200);for(var se=!1;r.l<r.length-1;){var xe=r.l,ke=r.read_shift(2);if(ke===0&&Oe===10)break;var Se=r.l===r.length?0:r.read_shift(2),be=BA[ke];if(be&&be.f){if(t.bookSheets&&Oe===133&&ke!==133)break;if(Oe=ke,be.r===2||be.r==12){var ot=r.read_shift(2);if(Se-=2,!ee.enc&&ot!==ke&&((ot&255)<<8|ot>>8)!==ke)throw new Error("rt mismatch: "+ot+"!="+ke);be.r==12&&(r.l+=10,Se-=10)}var W={};if(ke===10?W=be.f(r,Se,ee):W=O7(ke,be,r,Se,ee),Y==0&&[9,521,1033,2057].indexOf(Oe)===-1)continue;switch(ke){case 34:e.opts.Date1904=k.WBProps.date1904=W;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(ee.enc||(r.l=0),ee.enc=W,!t.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:ee.lastuser=W;break;case 66:var Wt=Number(W);switch(Wt){case 21010:Wt=1200;break;case 32768:Wt=1e4;break;case 32769:Wt=1252;break}Fi(ee.codepage=Wt),se=!0;break;case 317:ee.rrtabid=W;break;case 25:ee.winlocked=W;break;case 439:e.opts.RefreshAll=W;break;case 12:e.opts.CalcCount=W;break;case 16:e.opts.CalcDelta=W;break;case 17:e.opts.CalcIter=W;break;case 13:e.opts.CalcMode=W;break;case 14:e.opts.CalcPrecision=W;break;case 95:e.opts.CalcSaveRecalc=W;break;case 15:ee.CalcRefMode=W;break;case 2211:e.opts.FullCalc=W;break;case 129:W.fDialog&&(i["!type"]="dialog"),W.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),W.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:U.push(W);break;case 430:ae.push([W]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(W);break;case 24:case 536:K={Name:W.Name,Ref:Ea(W.rgce,o,null,ae,ee)},W.itab>0&&(K.Sheet=W.itab-1),ae.names.push(K),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(X[W.itab-1]={ref:_t(W.rgce[0][0][1][2])});break;case 22:ee.ExternCount=W;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(W),ae.XTI=ae.XTI.concat(W);break;case 2196:if(ee.biff<8)break;K!=null&&(K.Comment=W[1]);break;case 18:i["!protect"]=W;break;case 19:W!==0&&ee.WTF&&console.error("Password verifier: "+W);break;case 133:l[W.pos]=W,ee.snames.push(W.name);break;case 10:{if(--Y)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=_t(o),t.sheetRows&&t.sheetRows<=o.e.r){var st=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=_t(o),o.e.r=st}o.e.r++,o.e.c++}ye.length>0&&(i["!merges"]=ye),me.length>0&&(i["!objects"]=me),G.length>0&&(i["!cols"]=G),te.length>0&&(i["!rows"]=te),k.Sheets.push(J)}d===""?g=i:a[d]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ee.biff===8&&(ee.biff={9:2,521:3,1033:4}[ke]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),ee.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(ee.biff=5,se=!0,Fi(ee.codepage=28591)),ee.biff==8&&W.BIFFVer==0&&W.dt==16&&(ee.biff=2),Y++)break;if(i=t.dense?[]:{},ee.biff<8&&!se&&(se=!0,Fi(ee.codepage=t.codepage||1252)),ee.biff<5||W.BIFFVer==0&&W.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var bt={pos:r.l-Se,name:d};l[bt.pos]=bt,ee.snames.push(d)}else d=(l[xe]||{name:""}).name;W.dt==32&&(i["!type"]="chart"),W.dt==64&&(i["!type"]="macro"),ye=[],me=[],ee.arrayf=R=[],G=[],te=[],we=!1,J={Hidden:(l[xe]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[W.r]||[])[W.c]:i[Qe({c:W.c,r:W.r})])&&++W.c,C={ixfe:W.ixfe,XF:U[W.ixfe]||{},v:W.val,t:"n"},N>0&&(C.z=q[C.ixfe>>8&63]),$i(C,t,e.opts.Date1904),Q({c:W.c,r:W.r},C,t);break;case 5:case 517:C={ixfe:W.ixfe,XF:U[W.ixfe],v:W.val,t:W.t},N>0&&(C.z=q[C.ixfe>>8&63]),$i(C,t,e.opts.Date1904),Q({c:W.c,r:W.r},C,t);break;case 638:C={ixfe:W.ixfe,XF:U[W.ixfe],v:W.rknum,t:"n"},N>0&&(C.z=q[C.ixfe>>8&63]),$i(C,t,e.opts.Date1904),Q({c:W.c,r:W.r},C,t);break;case 189:for(var tt=W.c;tt<=W.C;++tt){var Ie=W.rkrec[tt-W.c][0];C={ixfe:Ie,XF:U[Ie],v:W.rkrec[tt-W.c][1],t:"n"},N>0&&(C.z=q[C.ixfe>>8&63]),$i(C,t,e.opts.Date1904),Q({c:tt,r:W.r},C,t)}break;case 6:case 518:case 1030:{if(W.val=="String"){c=W;break}if(C=J1(W.val,W.cell.ixfe,W.tt),C.XF=U[C.ixfe],t.cellFormula){var Kt=W.formula;if(Kt&&Kt[0]&&Kt[0][0]&&Kt[0][0][0]=="PtgExp"){var ca=Kt[0][0][1][0],Ya=Kt[0][0][1][1],cn=Qe({r:ca,c:Ya});S[cn]?C.f=""+Ea(W.formula,o,W.cell,ae,ee):C.F=((t.dense?(i[ca]||[])[Ya]:i[cn])||{}).F}else C.f=""+Ea(W.formula,o,W.cell,ae,ee)}N>0&&(C.z=q[C.ixfe>>8&63]),$i(C,t,e.opts.Date1904),Q(W.cell,C,t),c=W}break;case 7:case 519:if(c)c.val=W,C=J1(W,c.cell.ixfe,"s"),C.XF=U[C.ixfe],t.cellFormula&&(C.f=""+Ea(c.formula,o,c.cell,ae,ee)),N>0&&(C.z=q[C.ixfe>>8&63]),$i(C,t,e.opts.Date1904),Q(c.cell,C,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{R.push(W);var zo=Qe(W[0].s);if(_=t.dense?(i[W[0].s.r]||[])[W[0].s.c]:i[zo],t.cellFormula&&_){if(!c||!zo||!_)break;_.f=""+Ea(W[1],o,W[0],ae,ee),_.F=_t(W[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!c)break;S[Qe(c.cell)]=W[0],_=t.dense?(i[c.cell.r]||[])[c.cell.c]:i[Qe(c.cell)],(_||{}).f=""+Ea(W[0],o,m,ae,ee)}}break;case 253:C=J1(f[W.isst].t,W.ixfe,"s"),f[W.isst].h&&(C.h=f[W.isst].h),C.XF=U[C.ixfe],N>0&&(C.z=q[C.ixfe>>8&63]),$i(C,t,e.opts.Date1904),Q({c:W.c,r:W.r},C,t);break;case 513:t.sheetStubs&&(C={ixfe:W.ixfe,XF:U[W.ixfe],t:"z"},N>0&&(C.z=q[C.ixfe>>8&63]),$i(C,t,e.opts.Date1904),Q({c:W.c,r:W.r},C,t));break;case 190:if(t.sheetStubs)for(var zi=W.c;zi<=W.C;++zi){var Pt=W.ixfe[zi-W.c];C={ixfe:Pt,XF:U[Pt],t:"z"},N>0&&(C.z=q[C.ixfe>>8&63]),$i(C,t,e.opts.Date1904),Q({c:zi,r:W.r},C,t)}break;case 214:case 516:case 4:C=J1(W.val,W.ixfe,"s"),C.XF=U[C.ixfe],N>0&&(C.z=q[C.ixfe>>8&63]),$i(C,t,e.opts.Date1904),Q({c:W.c,r:W.r},C,t);break;case 0:case 512:Y===1&&(o=W);break;case 252:f=W;break;case 1054:if(ee.biff==4){q[N++]=W[1];for(var hi=0;hi<N+163&&Je[hi]!=W[1];++hi);hi>=163&&Eu(W[1],N+163)}else Eu(W[1],W[0]);break;case 30:{q[N++]=W;for(var di=0;di<N+163&&Je[di]!=W;++di);di>=163&&Eu(W,N+163)}break;case 229:ye=ye.concat(W);break;case 93:me[W.cmo[0]]=ee.lastobj=W;break;case 438:ee.lastobj.TxO=W;break;case 127:ee.lastobj.ImData=W;break;case 440:for(T=W[0].s.r;T<=W[0].e.r;++T)for(y=W[0].s.c;y<=W[0].e.c;++y)_=t.dense?(i[T]||[])[y]:i[Qe({c:y,r:T})],_&&(_.l=W[1]);break;case 2048:for(T=W[0].s.r;T<=W[0].e.r;++T)for(y=W[0].s.c;y<=W[0].e.c;++y)_=t.dense?(i[T]||[])[y]:i[Qe({c:y,r:T})],_&&_.l&&(_.l.Tooltip=W[1]);break;case 28:{if(ee.biff<=5&&ee.biff>=2)break;_=t.dense?(i[W[0].r]||[])[W[0].c]:i[Qe(W[0])];var Sl=me[W[2]];_||(t.dense?(i[W[0].r]||(i[W[0].r]=[]),_=i[W[0].r][W[0].c]={t:"z"}):_=i[Qe(W[0])]={t:"z"},o.e.r=Math.max(o.e.r,W[0].r),o.s.r=Math.min(o.s.r,W[0].r),o.e.c=Math.max(o.e.c,W[0].c),o.s.c=Math.min(o.s.c,W[0].c)),_.c||(_.c=[]),A={a:W[1],t:Sl.TxO.t},_.c.push(A)}break;case 2173:J5(U[W.ixfe],W.ext);break;case 125:{if(!ee.cellStyles)break;for(;W.e>=W.s;)G[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},we||(we=!0,Ey(W.w/256)),Xh(G[W.e+1])}break;case 520:{var _r={};W.level!=null&&(te[W.r]=_r,_r.level=W.level),W.hidden&&(te[W.r]=_r,_r.hidden=!0),W.hpt&&(te[W.r]=_r,_r.hpt=W.hpt,_r.hpx=Ld(W.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Sd(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ke]]=W;break;case 161:i["!margins"]||Sd(i["!margins"]={}),i["!margins"].header=W.header,i["!margins"].footer=W.footer;break;case 574:W.RTL&&(k.Views[0].RTL=!0);break;case 146:B=W;break;case 2198:ge=W;break;case 140:F=W;break;case 442:d?J.CodeName=W||J.name:k.WBProps.CodeName=W||"ThisWorkbook";break}}else be||console.error("Missing Info for XLS Record 0x"+ke.toString(16)),r.l+=Se}return e.SheetNames=ms(l).sort(function(Ln,rt){return Number(Ln)-Number(rt)}).map(function(Ln){return l[Ln].name}),t.bookSheets||(e.Sheets=a),!e.SheetNames.length&&g["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=g)):e.Preamble=g,e.Sheets&&X.forEach(function(Ln,rt){e.Sheets[e.SheetNames[rt]]["!autofilter"]=Ln}),e.Strings=f,e.SSF=sa(Je),ee.enc&&(e.Encryption=ee.enc),ge&&(e.Themes=ge),e.Metadata={},F!==void 0&&(e.Metadata.Country=F),ae.names.length>0&&(k.Names=ae.names),e.Workbook=k,e}var tR={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function N7(r,t,e){var a=vt.find(r,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var i=BC(a,KL,tR.DSI);for(var l in i)t[l]=i[l]}catch(d){if(e.WTF)throw d}var o=vt.find(r,"/!SummaryInformation");if(o&&o.size>0)try{var c=BC(o,$L,tR.SI);for(var f in c)t[f]==null&&(t[f]=c[f])}catch(d){if(e.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(_O(t.HeadingPairs,t.TitlesOfParts,t,e),delete t.HeadingPairs,delete t.TitlesOfParts)}function rD(r,t){t||(t={}),by(t),D4(),t.codepage&&ay(t.codepage);var e,a;if(r.FullPaths){if(vt.find(r,"/encryption"))throw new Error("File is password-protected");e=vt.find(r,"!CompObj"),a=vt.find(r,"/Workbook")||vt.find(r,"/Book")}else{switch(t.type){case"base64":r=Ii(Fn(r));break;case"binary":r=Ii(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}ia(r,0),a={content:r}}var i,l;if(e&&R7(e),t.bookProps&&!t.bookSheets)i={};else{var o=xt?"buffer":"array";if(a&&a.content)i=D7(a.content,t);else if((l=vt.find(r,"PerfectOffice_MAIN"))&&l.content)i=yd.to_workbook(l.content,(t.type=o,t));else if((l=vt.find(r,"NativeContent_MAIN"))&&l.content)i=yd.to_workbook(l.content,(t.type=o,t));else throw(l=vt.find(r,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&r.FullPaths&&vt.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=xP(r))}var c={};return r.FullPaths&&N7(r,c,t),i.Props=i.Custprops=c,t.bookFiles&&(i.cfb=r),i}var $m={0:{f:dU},1:{f:xU},2:{f:wU},3:{f:AU},4:{f:_U},5:{f:bU},6:{f:kU},7:{f:TU},8:{f:IU},9:{f:MU},10:{f:DU},11:{f:NU},12:{f:vU},13:{f:CU},14:{f:yU},15:{f:EU},16:{f:QO},17:{f:OU},18:{f:SU},19:{f:py},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:l7},40:{},42:{},43:{f:D5},44:{f:O5},45:{f:N5},46:{f:I5},47:{f:M5},48:{},49:{f:FL},50:{},51:{f:tP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:DO},62:{f:RU},63:{f:sP},64:{f:VU},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ba,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:GU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:mU},148:{f:pU,p:16},151:{f:PU},152:{},153:{f:i7},154:{},155:{},156:{f:n7},157:{},158:{},159:{T:1,f:$8},160:{T:-1},161:{T:1,f:Mu},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:FU},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:eP},336:{T:-1},337:{f:rP,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:MA},357:{},358:{},359:{},360:{T:1},361:{},362:{f:OO},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:BU},427:{f:UU},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:zU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:gU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:LU},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:MA},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:pP},633:{T:1},634:{T:-1},635:{T:1,f:dP},636:{T:-1},637:{f:PL},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:KU},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:jU},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},BA={6:{f:oE},10:{f:Kl},12:{f:Cr},13:{f:Cr},14:{f:gr},15:{f:gr},16:{f:ya},17:{f:gr},18:{f:gr},19:{f:Cr},20:{f:GC},21:{f:GC},23:{f:OO},24:{f:jC},25:{f:gr},26:{},27:{},28:{f:f8},29:{},34:{f:gr},35:{f:VC},38:{f:ya},39:{f:ya},40:{f:ya},41:{f:ya},42:{f:gr},43:{f:gr},47:{f:g5},49:{f:X6},51:{f:Cr},60:{},61:{f:V6},64:{f:gr},65:{f:Y6},66:{f:Cr},77:{},80:{},81:{},82:{},85:{f:Cr},89:{},90:{},91:{},92:{f:F6},93:{f:d8},94:{},95:{f:gr},96:{},97:{},99:{f:gr},125:{f:DO},128:{f:r8},129:{f:L6},130:{f:Cr},131:{f:gr},132:{f:gr},133:{f:P6},134:{},140:{f:_8},141:{f:Cr},144:{},146:{f:A8},151:{},152:{},153:{},154:{},155:{},156:{f:Cr},157:{},158:{},160:{f:w8},161:{f:T8},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Z6},190:{f:J6},193:{f:Kl},197:{},198:{},199:{},200:{},201:{},202:{f:gr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Cr},220:{},221:{f:gr},222:{},224:{f:t8},225:{f:I6},226:{f:Kl},227:{},229:{f:h8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:B6},253:{f:q6},255:{f:U6},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:SO},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:gr},353:{f:Kl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:n8},431:{f:gr},432:{},433:{},434:{},437:{},438:{f:m8},439:{f:gr},440:{f:x8},441:{},442:{f:gg},443:{},444:{f:Cr},445:{},446:{},448:{f:Kl},449:{f:G6,r:2},450:{f:Kl},512:{f:HC},513:{f:b8},515:{f:a8},516:{f:W6},517:{f:zC},519:{f:C8},520:{f:H6},523:{},545:{f:YC},549:{f:UC},566:{},574:{f:j6},638:{f:Q6},659:{},1048:{},1054:{f:K6},1084:{},1212:{f:o8},2048:{f:v8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:$1},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Kl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:y8,r:12},2173:{f:Z5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:gr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:l8,r:12},2197:{},2198:{f:X5,r:12},2199:{},2200:{},2201:{},2202:{f:c8,r:12},2203:{f:Kl},2204:{},2205:{},2206:{},2207:{},2211:{f:z6},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Cr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:S8},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:E8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:HC},1:{},2:{f:D8},3:{f:O8},4:{f:k8},5:{f:zC},7:{f:N8},8:{},9:{f:$1},11:{},22:{f:Cr},30:{f:$6},31:{},32:{},33:{f:YC},36:{},37:{f:UC},50:{f:M8},62:{},52:{},67:{},68:{f:Cr},69:{},86:{},126:{},127:{f:R8},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:I8},223:{},234:{},354:{},421:{},518:{f:oE},521:{f:$1},536:{f:jC},547:{f:VC},561:{},579:{},1030:{f:oE},1033:{f:$1},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function _i(r,t,e,a){var i=t;if(!isNaN(i)){var l=(e||[]).length||0,o=r.next(4);o.write_shift(2,i),o.write_shift(2,l),l>0&&fO(e)&&r.push(e)}}function rR(r,t){var e=t||{},a=e.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var i=r.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var l=r.match(/<\/table/i),o=i.index,c=l&&l.index||r.length,f=aL(r.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,g=0,m=0,v=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},A=[];for(o=0;o<f.length;++o){var y=f[o].trim(),T=y.slice(0,3).toLowerCase();if(T=="<tr"){if(++d,e.sheetRows&&e.sheetRows<=d){--d;break}g=0;continue}if(!(T!="<td"&&T!="<th")){var S=y.split(/<\/t[dh]>/i);for(c=0;c<S.length;++c){var R=S[c].trim();if(R.match(/<t[dh]/i)){for(var C=R,F=0;C.charAt(0)=="<"&&(F=C.indexOf(">"))>-1;)C=C.slice(F+1);for(var U=0;U<A.length;++U){var B=A[U];B.s.c==g&&B.s.r<d&&d<=B.e.r&&(g=B.e.c+1,U=-1)}var k=We(R.slice(0,R.indexOf(">")));v=k.colspan?+k.colspan:1,((m=+k.rowspan)>1||v>1)&&A.push({s:{r:d,c:g},e:{r:d+(m||1)-1,c:g+v-1}});var J=k.t||k["data-t"]||"";if(!C.length){g+=v;continue}if(C=Z4(C),_.s.r>d&&(_.s.r=d),_.e.r<d&&(_.e.r=d),_.s.c>g&&(_.s.c=g),_.e.c<g&&(_.e.c=g),!C.length){g+=v;continue}var j={t:"s",v:C};e.raw||!C.trim().length||J=="s"||(C==="TRUE"?j={t:"b",v:!0}:C==="FALSE"?j={t:"b",v:!1}:isNaN(Bi(C))?isNaN(Yh(C).getDate())||(j={t:"d",v:Wr(C)},e.cellDates||(j={t:"n",v:ja(j.v)}),j.z=e.dateNF||Je[14]):j={t:"n",v:Bi(C)}),e.dense?(a[d]||(a[d]=[]),a[d][g]=j):a[Qe({r:d,c:g})]=j,g+=v}}}}return a["!ref"]=_t(_),A.length&&(a["!merges"]=A),a}function M7(r,t,e,a){for(var i=r["!merges"]||[],l=[],o=t.s.c;o<=t.e.c;++o){for(var c=0,f=0,d=0;d<i.length;++d)if(!(i[d].s.r>e||i[d].s.c>o)&&!(i[d].e.r<e||i[d].e.c<o)){if(i[d].s.r<e||i[d].s.c<o){c=-1;break}c=i[d].e.r-i[d].s.r+1,f=i[d].e.c-i[d].s.c+1;break}if(!(c<0)){var g=Qe({r:e,c:o}),m=a.dense?(r[e]||[])[o]:r[g],v=m&&m.v!=null&&(m.h||cy(m.w||(El(m),m.w)||""))||"",_={};c>1&&(_.rowspan=c),f>1&&(_.colspan=f),a.editable?v='<span contenteditable="true">'+v+"</span>":m&&(_["data-t"]=m&&m.t||"z",m.v!=null&&(_["data-v"]=m.v),m.z!=null&&(_["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+m.l.Target+'">'+v+"</a>")),_.id=(a.id||"sjs")+"-"+g,l.push(_L("td",v,_))}}var A="<tr>";return A+l.join("")+"</tr>"}var I7='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',F7="</body></html>";function L7(r,t){var e=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return Ho(rR(e[0],t),t);var a=Cy();return e.forEach(function(i,l){Ry(a,rR(i,t),"Sheet"+(l+1))}),a}function P7(r,t,e){var a=[];return a.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function B7(r,t){var e=t||{},a=e.header!=null?e.header:I7,i=e.footer!=null?e.footer:F7,l=[a],o=Wh(r["!ref"]);e.dense=Array.isArray(r),l.push(P7(r,o,e));for(var c=o.s.r;c<=o.e.r;++c)l.push(M7(r,o,c,e));return l.push("</table>"+i),l.join("")}function aD(r,t,e){var a=e||{},i=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")i=a.origin;else{var o=typeof a.origin=="string"?Ba(a.origin):a.origin;i=o.r,l=o.c}var c=t.getElementsByTagName("tr"),f=Math.min(a.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r:i,c:l}};if(r["!ref"]){var g=Wh(r["!ref"]);d.s.r=Math.min(d.s.r,g.s.r),d.s.c=Math.min(d.s.c,g.s.c),d.e.r=Math.max(d.e.r,g.e.r),d.e.c=Math.max(d.e.c,g.e.c),i==-1&&(d.e.r=i=g.e.r+1)}var m=[],v=0,_=r["!rows"]||(r["!rows"]=[]),A=0,y=0,T=0,S=0,R=0,C=0;for(r["!cols"]||(r["!cols"]=[]);A<c.length&&y<f;++A){var F=c[A];if(aR(F)){if(a.display)continue;_[y]={hidden:!0}}var U=F.children;for(T=S=0;T<U.length;++T){var B=U[T];if(!(a.display&&aR(B))){var k=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):Z4(B.innerHTML),J=B.getAttribute("data-z")||B.getAttribute("z");for(v=0;v<m.length;++v){var j=m[v];j.s.c==S+l&&j.s.r<y+i&&y+i<=j.e.r&&(S=j.e.c+1-l,v=-1)}C=+B.getAttribute("colspan")||1,((R=+B.getAttribute("rowspan")||1)>1||C>1)&&m.push({s:{r:y+i,c:S+l},e:{r:y+i+(R||1)-1,c:S+l+(C||1)-1}});var ie={t:"s",v:k},Q=B.getAttribute("data-t")||B.getAttribute("t")||"";k!=null&&(k.length==0?ie.t=Q||"z":a.raw||k.trim().length==0||Q=="s"||(k==="TRUE"?ie={t:"b",v:!0}:k==="FALSE"?ie={t:"b",v:!1}:isNaN(Bi(k))?isNaN(Yh(k).getDate())||(ie={t:"d",v:Wr(k)},a.cellDates||(ie={t:"n",v:ja(ie.v)}),ie.z=a.dateNF||Je[14]):ie={t:"n",v:Bi(k)})),ie.z===void 0&&J!=null&&(ie.z=J);var ee="",ge=B.getElementsByTagName("A");if(ge&&ge.length)for(var ye=0;ye<ge.length&&!(ge[ye].hasAttribute("href")&&(ee=ge[ye].getAttribute("href"),ee.charAt(0)!="#"));++ye);ee&&ee.charAt(0)!="#"&&(ie.l={Target:ee}),a.dense?(r[y+i]||(r[y+i]=[]),r[y+i][S+l]=ie):r[Qe({c:S+l,r:y+i})]=ie,d.e.c<S+l&&(d.e.c=S+l),S+=C}}++y}return m.length&&(r["!merges"]=(r["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,y-1+i),r["!ref"]=_t(d),y>=f&&(r["!fullref"]=_t((d.e.r=c.length-A+y-1+i,d))),r}function nD(r,t){var e=t||{},a=e.dense?[]:{};return aD(a,r,t)}function U7(r,t){return Ho(nD(r,t),t)}function aR(r){var t="",e=H7(r);return e&&(t=e(r).getPropertyValue("display")),t||(t=r.style&&r.style.display),t==="none"}function H7(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function z7(r){var t=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=Et(t.replace(/<[^>]*>/g,""));return[e]}var nR={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function iD(r,t){var e=t||{},a=uy(r),i=[],l,o,c={name:""},f="",d=0,g,m,v={},_=[],A=e.dense?[]:{},y,T,S={value:""},R="",C=0,F=[],U=-1,B=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},J=0,j={},ie=[],Q={},ee=0,ge=0,ye=[],me=1,G=1,te=[],we={Names:[]},ae={},Oe=["",""],Y=[],N={},q="",X=0,K=!1,se=!1,xe=0;for(Md.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=Md.exec(a);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?A["!ref"]=_t(k):A["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=k.e.r&&(A["!fullref"]=A["!ref"],k.e.r=e.sheetRows-1,A["!ref"]=_t(k)),ie.length&&(A["!merges"]=ie),ye.length&&(A["!rows"]=ye),g.name=g.||g.name,typeof JSON<"u"&&JSON.stringify(g),_.push(g.name),v[g.name]=A,se=!1):y[0].charAt(y[0].length-2)!=="/"&&(g=We(y[0],!1),U=B=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,A=e.dense?[]:{},ie=[],ye=[],se=!0);break;case"table-row-group":y[1]==="/"?--J:++J;break;case"table-row":case"":if(y[1]==="/"){U+=me,me=1;break}if(m=We(y[0],!1),m.?U=m.-1:U==-1&&(U=0),me=+m["number-rows-repeated"]||1,me<10)for(xe=0;xe<me;++xe)J>0&&(ye[U+xe]={level:J});B=-1;break;case"covered-table-cell":y[1]!=="/"&&++B,e.sheetStubs&&(e.dense?(A[U]||(A[U]=[]),A[U][B]={t:"z"}):A[Qe({r:U,c:B})]={t:"z"}),R="",F=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++B,S=We(y[0],!1),G=parseInt(S["number-columns-repeated"]||"1",10),T={t:"z",v:null},S.formula&&e.cellFormula!=!1&&(T.f=ZC(Et(S.formula))),(S.||S["value-type"])=="string"&&(T.t="s",T.v=Et(S["string-value"]||""),e.dense?(A[U]||(A[U]=[]),A[U][B]=T):A[Qe({r:U,c:B})]=T),B+=G-1;else if(y[1]!=="/"){++B,R="",C=0,F=[],G=1;var ke=me?U+me-1:U;if(B>k.e.c&&(k.e.c=B),B<k.s.c&&(k.s.c=B),U<k.s.r&&(k.s.r=U),ke>k.e.r&&(k.e.r=ke),S=We(y[0],!1),Y=[],N={},T={t:S.||S["value-type"],v:null},e.cellFormula)if(S.formula&&(S.formula=Et(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(ee=parseInt(S["number-matrix-rows-spanned"],10)||0,ge=parseInt(S["number-matrix-columns-spanned"],10)||0,Q={s:{r:U,c:B},e:{r:U+ee-1,c:B+ge-1}},T.F=_t(Q),te.push([Q,T.F])),S.formula)T.f=ZC(S.formula);else for(xe=0;xe<te.length;++xe)U>=te[xe][0].s.r&&U<=te[xe][0].e.r&&B>=te[xe][0].s.c&&B<=te[xe][0].e.c&&(T.F=te[xe][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(ee=parseInt(S["number-rows-spanned"],10)||0,ge=parseInt(S["number-columns-spanned"],10)||0,Q={s:{r:U,c:B},e:{r:U+ee-1,c:B+ge-1}},ie.push(Q)),S["number-columns-repeated"]&&(G=parseInt(S["number-columns-repeated"],10)),T.t){case"boolean":T.t="b",T.v=tr(S["boolean-value"]);break;case"float":T.t="n",T.v=parseFloat(S.value);break;case"percentage":T.t="n",T.v=parseFloat(S.value);break;case"currency":T.t="n",T.v=parseFloat(S.value);break;case"date":T.t="d",T.v=Wr(S["date-value"]),e.cellDates||(T.t="n",T.v=ja(T.v)),T.z="m/d/yy";break;case"time":T.t="n",T.v=eL(S["time-value"])/86400,e.cellDates&&(T.t="d",T.v=Cx(T.v)),T.z="HH:MM:SS";break;case"number":T.t="n",T.v=parseFloat(S.);break;default:if(T.t==="string"||T.t==="text"||!T.t)T.t="s",S["string-value"]!=null&&(R=Et(S["string-value"]),F=[]);else throw new Error("Unsupported value type "+T.t)}}else{if(K=!1,T.t==="s"&&(T.v=R||"",F.length&&(T.R=F),K=C==0),ae.Target&&(T.l=ae),Y.length>0&&(T.c=Y,Y=[]),R&&e.cellText!==!1&&(T.w=R),K&&(T.t="z",delete T.v),(!K||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=U))for(var Se=0;Se<me;++Se){if(G=parseInt(S["number-columns-repeated"]||"1",10),e.dense)for(A[U+Se]||(A[U+Se]=[]),A[U+Se][B]=Se==0?T:sa(T);--G>0;)A[U+Se][B+G]=sa(T);else for(A[Qe({r:U+Se,c:B})]=T;--G>0;)A[Qe({r:U+Se,c:B+G})]=sa(T);k.e.c<=B&&(k.e.c=B)}G=parseInt(S["number-columns-repeated"]||"1",10),B+=G-1,G=0,T={},R="",F=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((l=i.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((l=i.pop())[0]!==y[3])throw"Bad state: "+l;N.t=R,F.length&&(N.R=F),N.a=q,Y.push(N)}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);q="",X=0,R="",C=0,F=[];break;case"creator":y[1]==="/"?q=a.slice(X,y.index):X=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((l=i.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);R="",C=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(j[c.name]=f,(l=i.pop())[0]!==y[3])throw"Bad state: "+l}else y[0].charAt(y[0].length-2)!=="/"&&(f="",c=We(y[0],!1),i.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=We(y[0],!1),f+=nR[y[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=We(y[0],!1),f+=nR[y[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":f+=a.slice(d,y.index);break}else d=y.index+y[0].length;break;case"named-range":o=We(y[0],!1),Oe=cE(o["cell-range-address"]);var be={Name:o.name,Ref:Oe[0]+"!"+Oe[1]};se&&(be.Sheet=_.length),we.Names.push(be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(y[1]==="/"&&(!S||!S["string-value"])){var ot=z7(a.slice(C,y.index));R=(R.length>0?R+`
`:"")+ot[0]}else We(y[0],!1),C=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{Oe=cE(We(y[0])["target-range-address"]),v[Oe[0]]["!autofilter"]={ref:Oe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(ae=We(y[0],!1),!ae.href)break;ae.Target=Et(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(Oe=cE(ae.Target.slice(1)),ae.Target="#"+Oe[0]+"!"+Oe[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(e.WTF)throw new Error(y)}}var W={Sheets:v,SheetNames:_,Workbook:we};return e.bookSheets&&delete W.Sheets,W}function iR(r,t){t=t||{},Zn(r,"META-INF/manifest.xml")&&a6(wr(r,"META-INF/manifest.xml"),t);var e=Mn(r,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var a=iD(Vt(e),t);return Zn(r,"meta.xml")&&(a.Props=vO(wr(r,"meta.xml"))),a}function sR(r,t){return iD(r,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ty(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function UA(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):Vt(Du(r))}function HA(r){var t=r.reduce(function(i,l){return i+l.length},0),e=new Uint8Array(t),a=0;return r.forEach(function(i){e.set(i,a),a+=i.length}),e}function lR(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function G7(r,t){for(var e=(r[t+15]&127)<<7|r[t+14]>>1,a=r[t+14]&1,i=t+13;i>=t;--i)a=a*256+r[i];return(r[t+15]&128?-a:a)*Math.pow(10,e-6176)}function Pd(r,t){var e=t?t[0]:0,a=r[e]&127;e:if(r[e++]>=128&&(a|=(r[e]&127)<<7,r[e++]<128||(a|=(r[e]&127)<<14,r[e++]<128)||(a|=(r[e]&127)<<21,r[e++]<128)||(a+=(r[e]&127)*Math.pow(2,28),++e,r[e++]<128)||(a+=(r[e]&127)*Math.pow(2,35),++e,r[e++]<128)||(a+=(r[e]&127)*Math.pow(2,42),++e,r[e++]<128)))break e;return t&&(t[0]=e),a}function Ur(r){var t=0,e=r[t]&127;e:if(r[t++]>=128){if(e|=(r[t]&127)<<7,r[t++]<128||(e|=(r[t]&127)<<14,r[t++]<128)||(e|=(r[t]&127)<<21,r[t++]<128))break e;e|=(r[t]&127)<<28}return e}function Ta(r){for(var t=[],e=[0];e[0]<r.length;){var a=e[0],i=Pd(r,e),l=i&7;i=Math.floor(i/8);var o=0,c;if(i==0)break;switch(l){case 0:{for(var f=e[0];r[e[0]++]>=128;);c=r.slice(f,e[0])}break;case 5:o=4,c=r.slice(e[0],e[0]+o),e[0]+=o;break;case 1:o=8,c=r.slice(e[0],e[0]+o),e[0]+=o;break;case 2:o=Pd(r,e),c=r.slice(e[0],e[0]+o),e[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(i," at offset ").concat(a))}var d={data:c,type:l};t[i]==null?t[i]=[d]:t[i].push(d)}return t}function Sy(r,t){return(r==null?void 0:r.map(function(e){return t(e.data)}))||[]}function V7(r){for(var t,e=[],a=[0];a[0]<r.length;){var i=Pd(r,a),l=Ta(r.slice(a[0],a[0]+i));a[0]+=i;var o={id:Ur(l[1][0].data),messages:[]};l[2].forEach(function(c){var f=Ta(c.data),d=Ur(f[3][0].data);o.messages.push({meta:f,data:r.slice(a[0],a[0]+d)}),a[0]+=d}),(t=l[3])!=null&&t[0]&&(o.merge=Ur(l[3][0].data)>>>0>0),e.push(o)}return e}function j7(r,t){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var e=[0],a=Pd(t,e),i=[];e[0]<t.length;){var l=t[e[0]]&3;if(l==0){var o=t[e[0]++]>>2;if(o<60)++o;else{var c=o-59;o=t[e[0]],c>1&&(o|=t[e[0]+1]<<8),c>2&&(o|=t[e[0]+2]<<16),c>3&&(o|=t[e[0]+3]<<24),o>>>=0,o++,e[0]+=c}i.push(t.slice(e[0],e[0]+o)),e[0]+=o;continue}else{var f=0,d=0;if(l==1?(d=(t[e[0]]>>2&7)+4,f=(t[e[0]++]&224)<<3,f|=t[e[0]++]):(d=(t[e[0]++]>>2)+1,l==2?(f=t[e[0]]|t[e[0]+1]<<8,e[0]+=2):(f=(t[e[0]]|t[e[0]+1]<<8|t[e[0]+2]<<16|t[e[0]+3]<<24)>>>0,e[0]+=4)),i=[HA(i)],f==0)throw new Error("Invalid offset 0");if(f>i[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(i.push(i[0].slice(-f)),d-=f;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-f,-f+d))}}var g=HA(i);if(g.length!=a)throw new Error("Unexpected length: ".concat(g.length," != ").concat(a));return g}function Y7(r){for(var t=[],e=0;e<r.length;){var a=r[e++],i=r[e]|r[e+1]<<8|r[e+2]<<16;e+=3,t.push(j7(a,r.slice(e,e+i))),e+=i}if(e!==r.length)throw new Error("data is not a valid framed stream!");return HA(t)}function X7(r,t,e,a){var i=Ty(r),l=i.getUint32(4,!0),o=(a>1?12:8)+lR(l&(a>1?3470:398))*4,c=-1,f=-1,d=NaN,g=new Date(2001,0,1);l&512&&(c=i.getUint32(o,!0),o+=4),o+=lR(l&(a>1?12288:4096))*4,l&16&&(f=i.getUint32(o,!0),o+=4),l&32&&(d=i.getFloat64(o,!0),o+=8),l&64&&(g.setTime(g.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var m;switch(r[2]){case 0:break;case 2:m={t:"n",v:d};break;case 3:m={t:"s",v:t[f]};break;case 5:m={t:"d",v:g};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(c>-1)m={t:"s",v:e[c]};else if(f>-1)m={t:"s",v:t[f]};else if(!isNaN(d))m={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return m}function q7(r,t,e){var a=Ty(r),i=a.getUint32(8,!0),l=12,o=-1,c=-1,f=NaN,d=NaN,g=new Date(2001,0,1);i&1&&(f=G7(r,l),l+=16),i&2&&(d=a.getFloat64(l,!0),l+=8),i&4&&(g.setTime(g.getTime()+a.getFloat64(l,!0)*1e3),l+=8),i&8&&(c=a.getUint32(l,!0),l+=4),i&16&&(o=a.getUint32(l,!0),l+=4);var m;switch(r[1]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[c]};break;case 5:m={t:"d",v:g};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:e[o]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)));break;case 10:m={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(i&31," : ").concat(r.slice(0,4)))}return m}function W7(r,t,e){switch(r[0]){case 0:case 1:case 2:case 3:return X7(r,t,e,r[0]);case 5:return q7(r,t,e);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function Mo(r){var t=Ta(r);return Pd(t[1][0].data)}function oR(r,t){var e=Ta(t.data),a=Ur(e[1][0].data),i=e[3],l=[];return(i||[]).forEach(function(o){var c=Ta(o.data),f=Ur(c[1][0].data)>>>0;switch(a){case 1:l[f]=UA(c[3][0].data);break;case 8:{var d=r[Mo(c[9][0].data)][0],g=Ta(d.data),m=r[Mo(g[1][0].data)][0],v=Ur(m.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var _=Ta(m.data);l[f]=_[3].map(function(A){return UA(A.data)}).join("")}break}}),l}function K7(r,t){var e,a,i,l,o,c,f,d,g,m,v,_,A,y,T=Ta(r),S=Ur(T[1][0].data)>>>0,R=Ur(T[2][0].data)>>>0,C=((a=(e=T[8])==null?void 0:e[0])==null?void 0:a.data)&&Ur(T[8][0].data)>0||!1,F,U;if((l=(i=T[7])==null?void 0:i[0])!=null&&l.data&&t!=0)F=(c=(o=T[7])==null?void 0:o[0])==null?void 0:c.data,U=(d=(f=T[6])==null?void 0:f[0])==null?void 0:d.data;else if((m=(g=T[4])==null?void 0:g[0])!=null&&m.data&&t!=1)F=(_=(v=T[4])==null?void 0:v[0])==null?void 0:_.data,U=(y=(A=T[3])==null?void 0:A[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var B=C?4:1,k=Ty(F),J=[],j=0;j<F.length/2;++j){var ie=k.getUint16(j*2,!0);ie<65535&&J.push([j,ie])}if(J.length!=R)throw"Expected ".concat(R," cells, found ").concat(J.length);var Q=[];for(j=0;j<J.length-1;++j)Q[J[j][0]]=U.subarray(J[j][1]*B,J[j+1][1]*B);return J.length>=1&&(Q[J[J.length-1][0]]=U.subarray(J[J.length-1][1]*B)),{R:S,cells:Q}}function $7(r,t){var e,a=Ta(t.data),i=(e=a==null?void 0:a[7])!=null&&e[0]?Ur(a[7][0].data)>>>0>0?1:0:-1,l=Sy(a[5],function(o){return K7(o,i)});return{nrows:Ur(a[4][0].data)>>>0,data:l.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(f,d){if(o[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));o[c.R][d]=f}),o},[])}}function Q7(r,t,e){var a,i=Ta(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(Ur(i[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(l.e.c=(Ur(i[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));e["!ref"]=_t(l);var o=Ta(i[4][0].data),c=oR(r,r[Mo(o[4][0].data)][0]),f=(a=o[17])!=null&&a[0]?oR(r,r[Mo(o[17][0].data)][0]):[],d=Ta(o[3][0].data),g=0;d[1].forEach(function(m){var v=Ta(m.data),_=r[Mo(v[2][0].data)][0],A=Ur(_.meta[1][0].data);if(A!=6002)throw new Error("6001 unexpected reference to ".concat(A));var y=$7(r,_);y.data.forEach(function(T,S){T.forEach(function(R,C){var F=Qe({r:g+S,c:C}),U=W7(R,c,f);U&&(e[F]=U)})}),g+=y.nrows})}function Z7(r,t){var e=Ta(t.data),a={"!ref":"A1"},i=r[Mo(e[2][0].data)],l=Ur(i[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return Q7(r,i[0],a),a}function J7(r,t){var e,a=Ta(t.data),i={name:(e=a[1])!=null&&e[0]?UA(a[1][0].data):"",sheets:[]},l=Sy(a[2],Mo);return l.forEach(function(o){r[o].forEach(function(c){var f=Ur(c.meta[1][0].data);f==6e3&&i.sheets.push(Z7(r,c))})}),i}function e9(r,t){var e=Cy(),a=Ta(t.data),i=Sy(a[1],Mo);if(i.forEach(function(l){r[l].forEach(function(o){var c=Ur(o.meta[1][0].data);if(c==2){var f=J7(r,o);f.sheets.forEach(function(d,g){Ry(e,d,g==0?f.name:f.name+"_"+g,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function fE(r){var t,e,a,i,l={},o=[];if(r.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=Y7(f.content)}catch(m){return console.log("?? "+f.content.length+" "+(m.message||m))}var g;try{g=V7(d)}catch(m){return console.log("## "+(m.message||m))}g.forEach(function(m){l[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var c=((i=(a=(e=(t=l==null?void 0:l[1])==null?void 0:t[0])==null?void 0:e.meta)==null?void 0:a[1])==null?void 0:i[0].data)&&Ur(l[1][0].meta[1][0].data)==1&&l[1][0];if(c||o.forEach(function(f){l[f].forEach(function(d){var g=Ur(d.meta[1][0].data)>>>0;if(g==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return e9(l,c)}function t9(r){return function(e){for(var a=0;a!=r.length;++a){var i=r[a];e[i[0]]===void 0&&(e[i[0]]=i[1]),i[2]==="n"&&(e[i[0]]=Number(e[i[0]]))}}}function by(r){t9([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function r9(r){return Df.WS.indexOf(r)>-1?"sheet":r==Df.CS?"chart":r==Df.DS?"dialog":r==Df.MS?"macro":r&&r.length?r:"sheet"}function a9(r,t){if(!r)return 0;try{r=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,r["!id"][a.id].Target,r9(r["!id"][a.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function n9(r,t,e,a,i,l,o,c,f,d,g,m){try{l[a]=Ed(Mn(r,e,!0),t);var v=wr(r,t),_;switch(c){case"sheet":_=u7(v,t,i,f,l[a],d,g,m);break;case"chart":if(_=f7(v,t,i,f,l[a],d,g,m),!_||!_["!drawel"])break;var A=dd(_["!drawel"].Target,t),y=IA(A),T=cP(Mn(r,A,!0),Ed(Mn(r,y,!0),A)),S=dd(T,A),R=IA(S);_=qU(Mn(r,S,!0),S,f,Ed(Mn(r,R,!0),S),d,_);break;case"macro":_=h7(v,t,i,f,l[a],d,g,m);break;case"dialog":_=d7(v,t,i,f,l[a],d,g,m);break;default:throw new Error("Unrecognized sheet type "+c)}o[a]=_;var C=[];l&&l[a]&&ms(l[a]).forEach(function(F){var U="";if(l[a][F].Type==Df.CMNT){U=dd(l[a][F].Target,t);var B=x7(wr(r,U,!0),U,f);if(!B||!B.length)return;qC(_,B,!1)}l[a][F].Type==Df.TCMNT&&(U=dd(l[a][F].Target,t),C=C.concat(fP(wr(r,U,!0),f)))}),C&&C.length&&qC(_,C,!0,f.people||[])}catch(F){if(f.WTF)throw F}}function $n(r){return r.charAt(0)=="/"?r.slice(1):r}function i9(r,t){if(V4(),t=t||{},by(t),Zn(r,"META-INF/manifest.xml")||Zn(r,"objectdata.xml"))return iR(r,t);if(Zn(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof fE<"u"){if(r.FileIndex)return fE(r);var e=vt.utils.cfb_new();return EC(r).forEach(function(ye){sL(e,ye,iL(r,ye))}),fE(e)}throw new Error("Unsupported NUMBERS file")}if(!Zn(r,"[Content_Types].xml"))throw Zn(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Zn(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=EC(r),i=t6(Mn(r,"[Content_Types].xml")),l=!1,o,c;if(i.workbooks.length===0&&(c="xl/workbook.xml",wr(r,c,!0)&&i.workbooks.push(c)),i.workbooks.length===0){if(c="xl/workbook.bin",!wr(r,c,!0))throw new Error("Could not find workbook");i.workbooks.push(c),l=!0}i.workbooks[0].slice(-3)=="bin"&&(l=!0);var f={},d={};if(!t.bookSheets&&!t.bookProps){if(Td=[],i.sst)try{Td=m7(wr(r,$n(i.sst)),i.sst,t)}catch(ye){if(t.WTF)throw ye}t.cellStyles&&i.themes.length&&(f=g7(Mn(r,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(d=p7(wr(r,$n(i.style)),i.style,f,t))}i.links.map(function(ye){try{var me=Ed(Mn(r,IA($n(ye))),ye);return _7(wr(r,$n(ye)),me,ye,t)}catch{}});var g=c7(wr(r,$n(i.workbooks[0])),i.workbooks[0],t),m={},v="";i.coreprops.length&&(v=wr(r,$n(i.coreprops[0]),!0),v&&(m=vO(v)),i.extprops.length!==0&&(v=wr(r,$n(i.extprops[0]),!0),v&&s6(v,m,t)));var _={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(v=Mn(r,$n(i.custprops[0]),!0),v&&(_=o6(v,t)));var A={};if((t.bookSheets||t.bookProps)&&(g.Sheets?o=g.Sheets.map(function(me){return me.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),t.bookProps&&(A.Props=m,A.Custprops=_),t.bookSheets&&typeof o<"u"&&(A.SheetNames=o),t.bookSheets?A.SheetNames:t.bookProps))return A;o={};var y={};t.bookDeps&&i.calcchain&&(y=v7(wr(r,$n(i.calcchain)),i.calcchain));var T=0,S={},R,C;{var F=g.Sheets;m.Worksheets=F.length,m.SheetNames=[];for(var U=0;U!=F.length;++U)m.SheetNames[U]=F[U].name}var B=l?"bin":"xml",k=i.workbooks[0].lastIndexOf("/"),J=(i.workbooks[0].slice(0,k+1)+"_rels/"+i.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Zn(r,J)||(J="xl/_rels/workbook."+B+".rels");var j=Ed(Mn(r,J,!0),J.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=E7(wr(r,$n(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=hP(wr(r,$n(i.people[0])),t)),j&&(j=a9(j,g.Sheets));var ie=wr(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(T=0;T!=m.Worksheets;++T){var Q="sheet";if(j&&j[T]?(R="xl/"+j[T][1].replace(/[\/]?xl\//,""),Zn(r,R)||(R=j[T][1]),Zn(r,R)||(R=J.replace(/_rels\/.*$/,"")+j[T][1]),Q=j[T][2]):(R="xl/worksheets/sheet"+(T+1-ie)+"."+B,R=R.replace(/sheet0\./,"sheet.")),C=R.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(T!=t.sheets)continue e;break;case"string":if(m.SheetNames[T].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var ee=!1,ge=0;ge!=t.sheets.length;++ge)typeof t.sheets[ge]=="number"&&t.sheets[ge]==T&&(ee=1),typeof t.sheets[ge]=="string"&&t.sheets[ge].toLowerCase()==m.SheetNames[T].toLowerCase()&&(ee=1);if(!ee)continue e}}n9(r,R,C,m.SheetNames[T],T,S,o,Q,t,g,f,d)}return A={Directory:i,Workbook:g,Props:m,Custprops:_,Deps:y,Sheets:o,SheetNames:m.SheetNames,Strings:Td,Styles:d,Themes:f,SSF:sa(Je)},t&&t.bookFiles&&(r.files?(A.keys=a,A.files=r.files):(A.keys=[],A.files={},r.FullPaths.forEach(function(ye,me){ye=ye.replace(/^Root Entry[\/]/,""),A.keys.push(ye),A.files[ye]=r.FileIndex[me]}))),t&&t.bookVBA&&(i.vba.length>0?A.vbaraw=wr(r,$n(i.vba[0]),!0):i.defaults&&i.defaults.bin===mP&&(A.vbaraw=wr(r,"xl/vbaProject.bin",!0))),A}function s9(r,t){var e=t||{},a="Workbook",i=vt.find(r,a);try{if(a="/!DataSpaces/Version",i=vt.find(r,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(Z8(i.content),a="/!DataSpaces/DataSpaceMap",i=vt.find(r,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=e5(i.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=vt.find(r,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=t5(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=vt.find(r,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);a5(i.content)}catch{}if(a="/EncryptionInfo",i=vt.find(r,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=n5(i.content);if(a="/EncryptedPackage",i=vt.find(r,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],i.content,e.password||"",e);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],i.content,e.password||"",e);throw new Error("File is password-protected")}function wy(r,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":e=Fn(r.slice(0,12));break;case"binary":e=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function l9(r,t){return vt.find(r,"EncryptedPackage")?s9(r,t):rD(r,t)}function o9(r,t){var e,a=r,i=t||{};return i.type||(i.type=xt&&Buffer.isBuffer(r)?"buffer":"base64"),e=K4(a,i),i9(e,i)}function sD(r,t){var e=0;e:for(;e<r.length;)switch(r.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return PA(r.slice(e),t);default:break e}return Id.to_workbook(r,t)}function c9(r,t){var e="",a=wy(r,t);switch(t.type){case"base64":e=Fn(r);break;case"binary":e=r;break;case"buffer":e=r.toString("binary");break;case"array":e=wu(r);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(e=Vt(e)),t.type="binary",sD(e,t)}function u9(r,t){var e=r;return t.type=="base64"&&(e=Fn(e)),e=Od.utils.decode(1200,e.slice(2),"str"),t.type="binary",sD(e,t)}function f9(r){return r.match(/[^\x00-\x7F]/)?pd(r):r}function hE(r,t,e,a){return a?(e.type="string",Id.to_workbook(r,e)):Id.to_workbook(t,e)}function zA(r,t){D4();var e=t||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return zA(new Uint8Array(r),(e=sa(e),e.type="array",e));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var a=r,i=[0,0,0,0],l=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),Uf={},e.dateNF&&(Uf.dateNF=e.dateNF),e.type||(e.type=xt&&Buffer.isBuffer(r)?"buffer":"base64"),e.type=="file"&&(e.type=xt?"buffer":"binary",a=ZF(r),typeof Uint8Array<"u"&&!xt&&(e.type="array")),e.type=="string"&&(l=!0,e.type="binary",e.codepage=65001,a=f9(r)),e.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return e=sa(e),e.type="array",zA(ny(a),e)}switch((i=wy(a,e))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return l9(vt.read(a,e),e);break;case 9:if(i[1]<=8)return rD(a,e);break;case 60:return PA(a,e);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return U8(a,e);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return P8.to_workbook(a,e);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?o9(a,e):hE(r,a,e,l);case 239:return i[3]===60?PA(a,e):hE(r,a,e,l);case 255:if(i[1]===254)return u9(a,e);if(i[1]===0&&i[2]===2&&i[3]===0)return yd.to_workbook(a,e);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return yd.to_workbook(a,e);break;case 3:case 131:case 139:case 140:return XC.to_workbook(a,e);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return m5.to_workbook(a,e);break;case 10:case 13:case 32:return c9(a,e);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return F8.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?XC.to_workbook(a,e):hE(r,a,e,l)}function h9(r,t,e,a,i,l,o,c){var f=la(e),d=c.defval,g=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),m=!0,v=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:e,enumerable:!1})}catch{v.__rowNum__=e}else v.__rowNum__=e;if(!o||r[e])for(var _=t.s.c;_<=t.e.c;++_){var A=o?r[e][_]:r[a[_]+f];if(A===void 0||A.t===void 0){if(d===void 0)continue;l[_]!=null&&(v[l[_]]=d);continue}var y=A.v;switch(A.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+A.t)}if(l[_]!=null){if(y==null)if(A.t=="e"&&y===null)v[l[_]]=null;else if(d!==void 0)v[l[_]]=d;else if(g&&y===null)v[l[_]]=null;else continue;else v[l[_]]=g&&(A.t!=="n"||A.t==="n"&&c.rawNumbers!==!1)?y:El(A,y,c);y!=null&&(m=!1)}}return{row:v,isempty:m}}function GA(r,t){if(r==null||r["!ref"]==null)return[];var e={t:"n",v:0},a=0,i=1,l=[],o=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},g=d.range!=null?d.range:r["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof g){case"string":f=fr(g);break;case"number":f=fr(r["!ref"]),f.s.r=g;break;default:f=g}a>0&&(i=0);var m=la(f.s.r),v=[],_=[],A=0,y=0,T=Array.isArray(r),S=f.s.r,R=0,C={};T&&!r[S]&&(r[S]=[]);var F=d.skipHidden&&r["!cols"]||[],U=d.skipHidden&&r["!rows"]||[];for(R=f.s.c;R<=f.e.c;++R)if(!(F[R]||{}).hidden)switch(v[R]=Pr(R),e=T?r[S][R]:r[v[R]+m],a){case 1:l[R]=R-f.s.c;break;case 2:l[R]=v[R];break;case 3:l[R]=d.header[R-f.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),c=o=El(e,null,d),y=C[o]||0,!y)C[o]=1;else{do c=o+"_"+y++;while(C[c]);C[o]=y,C[c]=1}l[R]=c}for(S=f.s.r+i;S<=f.e.r;++S)if(!(U[S]||{}).hidden){var B=h9(r,f,S,v,a,l,T,d);(B.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(_[A++]=B.row)}return _.length=A,_}var cR=/"/g;function d9(r,t,e,a,i,l,o,c){for(var f=!0,d=[],g="",m=la(e),v=t.s.c;v<=t.e.c;++v)if(a[v]){var _=c.dense?(r[e]||[])[v]:r[a[v]+m];if(_==null)g="";else if(_.v!=null){f=!1,g=""+(c.rawNumbers&&_.t=="n"?_.v:El(_,null,c));for(var A=0,y=0;A!==g.length;++A)if((y=g.charCodeAt(A))===i||y===l||y===34||c.forceQuotes){g='"'+g.replace(cR,'""')+'"';break}g=="ID"&&(g='"ID"')}else _.f!=null&&!_.F?(f=!1,g="="+_.f,g.indexOf(",")>=0&&(g='"'+g.replace(cR,'""')+'"')):g="";d.push(g)}return c.blankrows===!1&&f?null:d.join(o)}function lD(r,t){var e=[],a=t??{};if(r==null||r["!ref"]==null)return"";var i=fr(r["!ref"]),l=a.FS!==void 0?a.FS:",",o=l.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,f=c.charCodeAt(0),d=new RegExp((l=="|"?"\\|":l)+"+$"),g="",m=[];a.dense=Array.isArray(r);for(var v=a.skipHidden&&r["!cols"]||[],_=a.skipHidden&&r["!rows"]||[],A=i.s.c;A<=i.e.c;++A)(v[A]||{}).hidden||(m[A]=Pr(A));for(var y=0,T=i.s.r;T<=i.e.r;++T)(_[T]||{}).hidden||(g=d9(r,i,T,m,o,f,l,a),g!=null&&(a.strip&&(g=g.replace(d,"")),(g||a.blankrows!==!1)&&e.push((y++?c:"")+g)));return delete a.dense,e.join("")}function p9(r,t){t||(t={}),t.FS="	",t.RS=`
`;var e=lD(r,t);return e}function g9(r){var t="",e,a="";if(r==null||r["!ref"]==null)return[];var i=fr(r["!ref"]),l="",o=[],c,f=[],d=Array.isArray(r);for(c=i.s.c;c<=i.e.c;++c)o[c]=Pr(c);for(var g=i.s.r;g<=i.e.r;++g)for(l=la(g),c=i.s.c;c<=i.e.c;++c)if(t=o[c]+l,e=d?(r[g]||[])[c]:r[t],a="",e!==void 0){if(e.F!=null){if(t=e.F,!e.f)continue;a=e.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(e.f!=null)a=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)a=""+e.v;else if(e.t=="b")a=e.v?"TRUE":"FALSE";else if(e.w!==void 0)a="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?a="'"+e.v:a=""+e.v}}f[f.length]=t+"="+a}return f}function oD(r,t,e){var a=e||{},i=+!a.skipHeader,l=r||{},o=0,c=0;if(l&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var f=typeof a.origin=="string"?Ba(a.origin):a.origin;o=f.r,c=f.c}var d,g={s:{c:0,r:0},e:{c,r:o+t.length-1+i}};if(l["!ref"]){var m=fr(l["!ref"]);g.e.c=Math.max(g.e.c,m.e.c),g.e.r=Math.max(g.e.r,m.e.r),o==-1&&(o=m.e.r+1,g.e.r=o+t.length-1+i)}else o==-1&&(o=0,g.e.r=t.length-1+i);var v=a.header||[],_=0;t.forEach(function(y,T){ms(y).forEach(function(S){(_=v.indexOf(S))==-1&&(v[_=v.length]=S);var R=y[S],C="z",F="",U=Qe({c:c+_,r:o+T+i});d=Bd(l,U),R&&typeof R=="object"&&!(R instanceof Date)?l[U]=R:(typeof R=="number"?C="n":typeof R=="boolean"?C="b":typeof R=="string"?C="s":R instanceof Date?(C="d",a.cellDates||(C="n",R=ja(R)),F=a.dateNF||Je[14]):R===null&&a.nullError&&(C="e",R=0),d?(d.t=C,d.v=R,delete d.w,delete d.R,F&&(d.z=F)):l[U]=d={t:C,v:R},F&&(d.z=F))})}),g.e.c=Math.max(g.e.c,c+v.length-1);var A=la(o);if(i)for(_=0;_<v.length;++_)l[Pr(_+c)+A]={t:"s",v:v[_]};return l["!ref"]=_t(g),l}function m9(r,t){return oD(null,r,t)}function Bd(r,t,e){if(typeof t=="string"){if(Array.isArray(r)){var a=Ba(t);return r[a.r]||(r[a.r]=[]),r[a.r][a.c]||(r[a.r][a.c]={t:"z"})}return r[t]||(r[t]={t:"z"})}return typeof t!="number"?Bd(r,Qe(t)):Bd(r,Qe({r:t,c:e||0}))}function x9(r,t){if(typeof t=="number"){if(t>=0&&r.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=r.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Cy(){return{SheetNames:[],Sheets:{}}}function Ry(r,t,e,a){var i=1;if(!e)for(;i<=65535&&r.SheetNames.indexOf(e="Sheet"+i)!=-1;++i,e=void 0);if(!e||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&r.SheetNames.indexOf(e)>=0){var l=e.match(/(^.*?)(\d+)$/);i=l&&+l[2]||0;var o=l&&l[1]||e;for(++i;i<=65535&&r.SheetNames.indexOf(e=o+i)!=-1;++i);}if(t7(e),r.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return r.SheetNames.push(e),r.Sheets[e]=t,e}function v9(r,t,e){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var a=x9(r,t);switch(r.Workbook.Sheets[a]||(r.Workbook.Sheets[a]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}r.Workbook.Sheets[a].Hidden=e}function _9(r,t){return r.z=t,r}function cD(r,t,e){return t?(r.l={Target:t},e&&(r.l.Tooltip=e)):delete r.l,r}function E9(r,t,e){return cD(r,"#"+t,e)}function A9(r,t,e){r.c||(r.c=[]),r.c.push({t,a:e||"SheetJS"})}function y9(r,t,e,a){for(var i=typeof t!="string"?t:fr(t),l=typeof t=="string"?t:_t(t),o=i.s.r;o<=i.e.r;++o)for(var c=i.s.c;c<=i.e.c;++c){var f=Bd(r,o,c);f.t="n",f.F=l,delete f.v,o==i.s.r&&c==i.s.c&&(f.f=e,a&&(f.D=!0))}return r}var T9={encode_col:Pr,encode_row:la,encode_cell:Qe,encode_range:_t,decode_col:dy,decode_row:hy,split_cell:IL,decode_cell:Ba,decode_range:Wh,format_cell:El,sheet_add_aoa:dO,sheet_add_json:oD,sheet_add_dom:aD,aoa_to_sheet:Kh,json_to_sheet:m9,table_to_sheet:nD,table_to_book:U7,sheet_to_csv:lD,sheet_to_txt:p9,sheet_to_json:GA,sheet_to_html:B7,sheet_to_formulae:g9,sheet_to_row_object_array:GA,sheet_get_cell:Bd,book_new:Cy,book_append_sheet:Ry,book_set_sheet_visibility:v9,cell_set_number_format:_9,cell_set_hyperlink:cD,cell_set_internal_link:E9,cell_add_comment:A9,sheet_set_array_formula:y9,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const S9=async r=>new Promise((t,e)=>{const a=new FileReader;a.onload=i=>{var l;try{const o=new Uint8Array((l=i.target)==null?void 0:l.result),c=zA(o,{type:"array"});let f="";c.SheetNames.forEach(d=>{f+=`--- SHEET: ${d} ---
`;const g=c.Sheets[d];T9.sheet_to_json(g,{header:1}).forEach(v=>{Array.isArray(v)&&(f+=v.join("	")+`
`)}),f+=`
`}),t(f.trim())}catch(o){e(o)}},a.onerror=i=>e(i),a.readAsArrayBuffer(r)}),b9=({documents:r,folders:t,onAddFiles:e,onRemove:a,onSummaryRequested:i,isLoading:l,theme:o})=>{const c=Fr.useRef(null),f=Fr.useRef(null),[d,g]=Fr.useState(new Set(["general-dir","confidential-dir"])),m=_=>{const A=new Set(d);A.has(_)?A.delete(_):A.add(_),g(A)},v=_=>Ee.jsxs("div",{className:`group relative border rounded-lg p-2 transition-all ml-4 mb-1 ${o==="dark"?"bg-slate-900 border-slate-800 hover:border-sc-orange shadow-sm":"bg-white border-slate-100 hover:border-blue-200 hover:shadow-sm"}`,children:[Ee.jsxs("div",{className:"flex items-start justify-between gap-1",children:[Ee.jsx("div",{className:"flex-1 min-w-0",title:_.name,children:Ee.jsx("p",{className:`text-[12px] font-medium truncate ${o==="dark"?"text-slate-300":"text-slate-700"}`,children:_.name})}),Ee.jsx("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity",children:Ee.jsx("button",{onClick:()=>a(_.id),className:"p-1 text-slate-300 hover:text-red-500",children:Ee.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:Ee.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]}),Ee.jsx("div",{className:"flex items-center justify-between mt-1",children:Ee.jsx("button",{onClick:()=>i(_),className:`text-[9px] font-bold hover:underline ${o==="dark"?"text-sc-orange":"text-sc-navy"}`,children:"Analyze Source"})})]},_.id);return Ee.jsxs("div",{className:`flex flex-col h-full ${o==="dark"?"bg-slate-950":"bg-slate-50/50"}`,children:[Ee.jsxs("div",{className:`p-4 border-b space-y-3 ${o==="dark"?"border-slate-800 bg-slate-900":"border-slate-200 bg-white"}`,children:[Ee.jsxs("button",{onClick:()=>{var _;return(_=c.current)==null?void 0:_.click()},disabled:l,className:`w-full flex items-center justify-center gap-2 font-bold py-3 rounded-xl transition-all shadow-md disabled:opacity-50 ${o==="dark"?"bg-slate-800 border border-slate-700 text-white hover:bg-slate-700":"bg-sc-navy hover:bg-blue-800 text-white"}`,children:[Ee.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Ee.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add General Files"]}),Ee.jsx("input",{type:"file",ref:c,onChange:_=>_.target.files&&e(_.target.files,"general-dir"),className:"hidden",accept:".txt,.md,.pdf,.xlsx,.xls",multiple:!0}),Ee.jsxs("button",{onClick:()=>{var _;return(_=f.current)==null?void 0:_.click()},disabled:l,className:`w-full flex items-center justify-center gap-2 font-bold py-3 rounded-xl transition-all shadow-md disabled:opacity-50 ${o==="dark"?"bg-sc-orange text-white hover:bg-white hover:text-sc-orange":"bg-sc-orange text-white hover:bg-amber-600"}`,children:[Ee.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Ee.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Add Confidential Files"]}),Ee.jsx("input",{type:"file",ref:f,onChange:_=>_.target.files&&e(_.target.files,"confidential-dir"),className:"hidden",accept:".txt,.md,.pdf,.xlsx,.xls",multiple:!0})]}),Ee.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3",children:[t.map(_=>Ee.jsxs("div",{className:"mb-4",children:[Ee.jsx("div",{className:"flex items-center justify-between group px-2 py-2 cursor-pointer rounded-xl hover:bg-slate-200/10",children:Ee.jsxs("div",{className:"flex items-center gap-2 flex-1",onClick:()=>m(_.id),children:[Ee.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 transition-transform ${d.has(_.id)?"rotate-90":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:Ee.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),Ee.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 ${_.id==="confidential-dir"?"text-sc-orange":"text-sc-navy"}`,viewBox:"0 0 20 20",fill:"currentColor",children:Ee.jsx("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})}),Ee.jsx("span",{className:`text-sm font-extrabold tracking-tight truncate ${o==="dark"?"text-slate-300":"text-slate-600"}`,children:_.name}),Ee.jsxs("span",{className:"text-[10px] font-bold text-slate-500",children:["[",r.filter(A=>A.folderId===_.id).length,"]"]})]})}),d.has(_.id)&&Ee.jsx("div",{className:"mt-1",children:r.filter(A=>A.folderId===_.id).map(v)})]},_.id)),r.some(_=>!_.folderId||_.folderId!=="confidential-dir"&&_.folderId!=="general-dir")&&Ee.jsxs("div",{className:"mt-4",children:[Ee.jsxs("div",{className:"flex items-center gap-2 px-2 py-2 cursor-pointer",onClick:()=>m("legacy"),children:[Ee.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 transition-transform ${d.has("legacy")?"rotate-90":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:Ee.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),Ee.jsx("span",{className:`text-[10px] font-bold uppercase tracking-widest ${o==="dark"?"text-slate-600":"text-slate-400"}`,children:"Imported / Legacy"})]}),d.has("legacy")&&Ee.jsx("div",{className:"mt-1",children:r.filter(_=>!_.folderId||_.folderId!=="confidential-dir"&&_.folderId!=="general-dir").map(v)})]})]}),Ee.jsx("div",{className:`p-6 border-t ${o==="dark"?"border-slate-800 bg-slate-900":"border-slate-200 bg-white"}`,children:Ee.jsxs("div",{className:"flex flex-col items-center text-center gap-2",children:[Ee.jsx("p",{className:`text-[10px] font-bold uppercase tracking-tighter ${o==="dark"?"text-slate-500":"text-slate-400"}`,children:"Sources Root Directory"}),Ee.jsx("p",{className:`text-[9px] font-medium italic ${o==="dark"?"text-slate-600":"text-slate-400"}`,children:"/sources/workspace.json"})]})})]})},w9=({messages:r,onSendMessage:t,isLoading:e,documentCount:a,onDownloadSource:i,theme:l})=>{const[o,c]=Fr.useState(""),f=Fr.useRef(null);Fr.useEffect(()=>{f.current&&(f.current.scrollTop=f.current.scrollHeight)},[r,e]);const d=m=>{m.preventDefault(),o.trim()&&!e&&(t(o),c(""))},g=m=>/[\u0600-\u06FF]/.test(m);return Ee.jsxs("div",{className:`flex flex-col h-full transition-colors duration-300 ${l==="dark"?"bg-slate-900":"bg-white"}`,children:[Ee.jsxs("div",{ref:f,className:"flex-1 overflow-y-auto px-6 md:px-12 py-10 space-y-10 custom-scrollbar",children:[r.map(m=>Ee.jsxs("div",{className:`flex flex-col animate-in fade-in slide-in-from-bottom-2 duration-300 ${m.role==="user"?"items-end":"items-start"}`,children:[Ee.jsxs("div",{className:`flex gap-3 max-w-[95%] md:max-w-[85%] ${m.role==="user"?"flex-row-reverse":"flex-row"}`,children:[m.role==="model"&&Ee.jsx("div",{className:`hidden sm:flex w-10 h-10 rounded-full flex-shrink-0 items-center justify-center text-white shadow-md transition-colors ${l==="dark"?"bg-sc-orange":"bg-sc-navy"}`,children:Ee.jsx("img",{src:"/images/logo.png",alt:"SC",className:"w-6 h-6 rounded-full"})}),Ee.jsxs("div",{className:`group relative rounded-2xl p-5 md:p-6 transition-all ${m.role==="user"?"chat-bubble-user text-white rounded-tr-none":`${l==="dark"?"bg-slate-800 border-slate-700 text-slate-100":"bg-white border-slate-100 text-slate-800"} border rounded-tl-none shadow-sm`}`,style:{direction:g(m.text)?"rtl":"ltr"},children:[Ee.jsx("div",{className:`prose prose-sm md:prose-base max-w-none whitespace-pre-wrap leading-relaxed font-medium ${l==="dark"?"text-slate-100":"text-slate-800"}`,children:m.text}),m.sources&&m.sources.length>0&&Ee.jsxs("div",{className:`mt-6 pt-4 border-t ${l==="dark"?"border-slate-700":"border-slate-100"}`,children:[Ee.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2",children:"Knowledge Base Reference"}),Ee.jsx("div",{className:"flex flex-wrap gap-2",children:m.sources.map(v=>Ee.jsxs("button",{onClick:()=>i(v),className:`flex items-center gap-2 text-[11px] font-bold px-3 py-1.5 rounded-lg transition-all border ${l==="dark"?"bg-slate-700 text-sc-orange border-slate-600 hover:bg-sc-orange hover:text-white":"bg-slate-50 text-sc-navy border-slate-200 hover:bg-sc-orange hover:text-white hover:border-sc-orange"}`,children:[Ee.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Ee.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),v]},v))})]})]})]}),Ee.jsxs("span",{className:"text-[10px] text-slate-400 mt-2 px-1 font-semibold uppercase tracking-tighter",children:[m.role==="model"?"Smart Bot":"User","  ",m.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]},m.id)),e&&Ee.jsxs("div",{className:"flex items-center gap-4",children:[Ee.jsxs("div",{className:"flex space-x-1",children:[Ee.jsx("div",{className:`w-2 h-2 rounded-full animate-bounce [animation-delay:-0.3s] ${l==="dark"?"bg-sc-orange":"bg-sc-navy"}`}),Ee.jsx("div",{className:`w-2 h-2 rounded-full animate-bounce [animation-delay:-0.15s] ${l==="dark"?"bg-sc-orange":"bg-sc-navy"}`}),Ee.jsx("div",{className:`w-2 h-2 rounded-full animate-bounce ${l==="dark"?"bg-sc-orange":"bg-sc-navy"}`})]}),Ee.jsx("span",{className:`text-xs font-bold uppercase tracking-widest ${l==="dark"?"text-sc-orange":"text-sc-navy"}`,children:"Smart Bot is thinking..."})]})]}),Ee.jsx("div",{className:`p-6 md:p-10 border-t transition-all ${l==="dark"?"bg-slate-900 border-slate-800":"bg-white border-slate-50"}`,children:Ee.jsxs("form",{onSubmit:d,className:"max-w-4xl mx-auto relative",children:[Ee.jsx("input",{type:"text",value:o,onChange:m=>c(m.target.value),disabled:e,placeholder:"Ask Smart College Bot anything...",className:`w-full border-2 rounded-[2rem] py-5 pl-8 pr-16 focus:outline-none focus:ring-4 focus:ring-blue-500/10 transition-all text-lg shadow-sm ${l==="dark"?"bg-slate-800 border-slate-700 text-white focus:border-sc-orange":"bg-slate-50 border-slate-100 text-slate-900 focus:border-sc-navy"}`,style:{direction:g(o)?"rtl":"ltr"}}),Ee.jsx("button",{type:"submit",disabled:e||!o.trim(),className:`absolute right-3 top-1/2 -translate-y-1/2 w-12 h-12 flex items-center justify-center text-white rounded-full transition-all shadow-lg active:scale-95 ${l==="dark"?"bg-sc-orange hover:bg-white hover:text-sc-orange":"bg-sc-navy hover:bg-sc-orange"} disabled:bg-slate-200 disabled:text-slate-400`,children:Ee.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor",children:Ee.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z",clipRule:"evenodd"})})})]})})]})},C9=()=>{const[r,t]=Fr.useState([]),[e,a]=Fr.useState([]),[i,l]=Fr.useState([]),[o,c]=Fr.useState(!1),[f,d]=Fr.useState(!1),[g,m]=Fr.useState(!1),[v,_]=Fr.useState({username:"",password:""}),[A,y]=Fr.useState(null),[T,S]=Fr.useState("light"),R=Fr.useRef(null),C="confidential-dir",F="general-dir";Fr.useEffect(()=>{const Q=localStorage.getItem("sc_theme")||"light";S(Q),document.documentElement.classList.toggle("dark",Q==="dark"),(async()=>{try{let ge=await H1.getAllDocuments();if(a([{id:F,name:"General",createdAt:new Date},{id:C,name:"Confidential",createdAt:new Date}]),ge.length===0)try{const te=await(await fetch("/workspace.json")).json();for(const we of te.default_documents){const Oe=await(await fetch(`/${we.path}`)).text(),Y={id:Math.random().toString(36).substring(7),name:we.name,content:Oe,type:"text/plain",size:Oe.length,uploadedAt:new Date,folderId:we.folderId};await H1.saveDocument(Y),ge.push(Y)}}catch(G){console.warn("Could not load default documents from /sources/ folder.",G)}t(ge);const me=localStorage.getItem("smart_chat_history");if(me){const G=JSON.parse(me);l(G.map(te=>({...te,timestamp:new Date(te.timestamp)})))}else l([{id:"welcome",role:"model",text:"Welcome to Smart College Bot! How can I assist you today? I am here to help answer your questions in English and Arabic based on our project records in the /sources/ folder.",timestamp:new Date}])}catch(ge){console.error("Project boot sequence failed:",ge)}})()},[]),Fr.useEffect(()=>{i.length>0&&localStorage.setItem("smart_chat_history",JSON.stringify(i))},[i]);const U=()=>{const Q=T==="light"?"dark":"light";S(Q),localStorage.setItem("sc_theme",Q),document.documentElement.classList.toggle("dark",Q==="dark")},B=async(Q,ee)=>{var ye;c(!0);const ge=[];try{for(const me of Array.from(Q)){let G="";try{const te=(ye=me.name.split(".").pop())==null?void 0:ye.toLowerCase();te==="pdf"?G=await AF(me):te==="xlsx"||te==="xls"?G=await S9(me):G=await me.text();const we={id:Math.random().toString(36).substring(7),name:me.name,content:G,type:me.type,size:me.size,uploadedAt:new Date,folderId:ee};await H1.saveDocument(we),ge.push(we)}catch(te){console.error("Error writing file to /sources/:",te)}}t(me=>[...me,...ge])}finally{c(!1)}},k=async(Q,ee=!1)=>{if(!Q.trim()||o)return;const ge=Q.toLowerCase().trim();if(ge==="admin"||ge==="login"||ge==="verification")if(f){const ye={id:Date.now().toString(),role:"user",text:Q,timestamp:new Date};l(me=>[...me,ye,{id:Date.now().toString()+"-sys",role:"model",text:"You are already authenticated as an administrator.",timestamp:new Date}]);return}else{m(!0),y(null);const ye={id:Date.now().toString(),role:"user",text:Q,timestamp:new Date};l(me=>[...me,ye,{id:Date.now().toString()+"-sys",role:"model",text:"Opening administrator verification portal...",timestamp:new Date}]);return}if(!ee){const ye={id:Date.now().toString(),role:"user",text:Q,timestamp:new Date};l(me=>[...me,ye])}c(!0),R.current=Q;try{const ye=await mM.askAboutDocuments(Q,r,e,i,f);l(me=>[...me,{id:Date.now().toString(),role:"model",text:ye.text,timestamp:new Date,sources:ye.sources}]),ye.needsAdmin&&!f&&setTimeout(()=>{m(!0),y(null)},500)}catch{l(me=>[...me,{id:Date.now().toString(),role:"model",text:"Error accessing /sources/ context. Please try again.",timestamp:new Date}])}finally{c(!1)}},J=async Q=>{if(Q.preventDefault(),y(null),v.username==="admin"&&v.password==="Admin2025!")if(d(!0),m(!1),_({username:"",password:""}),R.current&&R.current.toLowerCase()!=="admin"&&R.current.toLowerCase()!=="login"){const ee=R.current;l(ge=>[...ge,{id:Date.now().toString(),role:"model",text:"Verification successful. Unlocking /sources/confidential/ records...",timestamp:new Date}]),setTimeout(()=>k(ee,!0),800)}else l(ee=>[...ee,{id:Date.now().toString(),role:"model",text:"Welcome, Administrator. You now have full access to the project sources including confidential records.",timestamp:new Date}]);else y("Invalid credentials. Please verify your administrator details.")},j=()=>{l([{id:Date.now().toString(),role:"model",text:"Environment refreshed. How can I help you today?",timestamp:new Date}]),localStorage.removeItem("smart_chat_history"),R.current=null},ie=Q=>{const ee=r.find(we=>we.name===Q);if(!ee)return;if(ee.folderId===C&&!f){alert("Access Denied: This record is restricted to authorized administrators."),m(!0);return}const ge=new Blob([ee.content],{type:"text/plain;charset=utf-8"}),ye=URL.createObjectURL(ge),me=document.createElement("a");me.href=ye;const G=ee.name.toLowerCase(),te=G.endsWith(".pdf")||G.endsWith(".xlsx")||G.endsWith(".xls")?".txt":"";me.download=`${ee.name}${te}`,document.body.appendChild(me),me.click(),document.body.removeChild(me),URL.revokeObjectURL(ye)};return Ee.jsxs("div",{className:`flex h-screen w-full transition-colors duration-300 overflow-hidden font-sans ${T==="dark"?"bg-slate-900 text-white":"bg-white text-slate-900"}`,children:[Ee.jsxs("div",{className:`${f?"w-80":"w-0"} transition-all duration-500 ease-in-out border-r ${T==="dark"?"border-slate-800 bg-slate-950":"border-slate-100 bg-slate-50"} overflow-hidden flex flex-col`,children:[Ee.jsxs("div",{className:`p-6 border-b flex justify-between items-center ${T==="dark"?"border-slate-800":"border-slate-200"}`,children:[Ee.jsx("h2",{className:`font-bold ${T==="dark"?"text-sc-orange":"text-sc-navy"}`,children:"Source Manager"}),Ee.jsx("button",{onClick:()=>d(!1),className:"text-slate-400 hover:text-red-500 transition-colors",children:Ee.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:Ee.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),Ee.jsx("div",{className:"flex-1 overflow-y-auto",children:Ee.jsx(b9,{documents:r,folders:e,onAddFiles:B,onRemove:async Q=>{confirm("Remove this source from the project?")&&(await H1.deleteDocument(Q),t(ee=>ee.filter(ge=>ge.id!==Q)))},onSummaryRequested:Q=>k(`Analyze the file: "${Q.name}"`),isLoading:o,theme:T})})]}),Ee.jsxs("main",{className:"flex-1 flex flex-col min-w-0 bg-transparent relative",children:[Ee.jsxs("header",{className:`h-20 flex items-center justify-between px-8 border-b transition-all z-10 ${T==="dark"?"bg-slate-900/80 border-slate-800":"bg-white/80 border-slate-100"} backdrop-blur-md`,children:[Ee.jsxs("div",{className:"flex items-center gap-4",children:[Ee.jsx("img",{src:"/images/logo.png",alt:"Smart College Logo",className:`h-12 md:h-14 object-contain ${T==="dark"?"brightness-125 contrast-125":""}`}),Ee.jsx("div",{className:`h-8 w-px hidden md:block ${T==="dark"?"bg-slate-700":"bg-slate-200"}`}),Ee.jsx("h1",{className:`text-xl font-extrabold tracking-tight hidden md:block ${T==="dark"?"text-sc-orange":"text-sc-navy"}`,children:"Smart College Bot"})]}),Ee.jsxs("div",{className:"flex items-center gap-3",children:[Ee.jsx("button",{onClick:U,className:`p-2.5 rounded-xl transition-all ${T==="dark"?"bg-slate-800 text-sc-orange":"bg-slate-100 text-slate-500"}`,title:"Toggle Theme",children:T==="light"?Ee.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Ee.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9 9 0 0012 21a9 9 0 008.354-5.646z"})}):Ee.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Ee.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M6.343 6.343l-.707-.707M12 8a4 4 0 100 8 4 4 0 000-8z"})})}),Ee.jsx("button",{onClick:j,className:`p-2.5 rounded-xl transition-colors ${T==="dark"?"hover:bg-slate-800 text-slate-400":"hover:bg-red-50 text-slate-400 hover:text-red-500"}`,children:Ee.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Ee.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),Ee.jsx("div",{className:"flex-1 overflow-hidden relative max-w-5xl mx-auto w-full",children:Ee.jsx(w9,{messages:i,onSendMessage:k,onClearChat:j,onDownloadSource:ie,isLoading:o,documentCount:r.length,theme:T})}),Ee.jsxs("div",{className:`h-12 border-t flex flex-col md:flex-row items-center justify-center gap-2 md:gap-6 px-4 py-2 transition-all ${T==="dark"?"bg-slate-950 border-slate-800":"bg-slate-50 border-slate-100"}`,children:[Ee.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest text-center",children:"Connected to: workspace.json manifest"}),Ee.jsx("a",{href:"https://www.smart-college.org",target:"_blank",rel:"noopener noreferrer",className:`text-[10px] font-bold uppercase tracking-widest hover:underline ${T==="dark"?"text-sc-orange":"text-sc-navy"}`,children:"www.smart-college.org"}),Ee.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest",children:"+961 3 721 999"})]})]}),g&&Ee.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",children:Ee.jsxs("div",{className:`w-full max-w-md p-8 rounded-3xl shadow-2xl animate-in zoom-in duration-300 ${T==="dark"?"bg-slate-900 text-white":"bg-white text-slate-900"}`,children:[Ee.jsxs("div",{className:"flex justify-between items-start mb-2",children:[Ee.jsx("h2",{className:`text-2xl font-bold ${T==="dark"?"text-sc-orange":"text-sc-navy"}`,children:"Verification Required"}),Ee.jsx("button",{onClick:()=>m(!1),className:"text-slate-400 hover:text-slate-600",children:Ee.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Ee.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Ee.jsx("p",{className:"text-sm text-slate-400 mb-6 font-medium",children:"Accessing files in /sources/confidential/ requires an administrator token."}),A&&Ee.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 text-red-600 rounded-xl text-sm font-bold flex items-start gap-2",children:[Ee.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mt-0.5",viewBox:"0 0 20 20",fill:"currentColor",children:Ee.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),Ee.jsx("span",{children:A})]}),Ee.jsxs("form",{onSubmit:J,className:"space-y-4",children:[Ee.jsxs("div",{children:[Ee.jsx("label",{className:"block text-xs font-bold mb-2 text-slate-400 uppercase tracking-widest",children:"Administrator User"}),Ee.jsx("input",{type:"text",autoFocus:!0,value:v.username,onChange:Q=>_({...v,username:Q.target.value}),className:`w-full p-4 rounded-xl border-2 outline-none focus:border-sc-orange transition-all ${T==="dark"?"bg-slate-800 border-slate-700":"bg-slate-50 border-slate-100"}`,placeholder:"admin"})]}),Ee.jsxs("div",{children:[Ee.jsx("label",{className:"block text-xs font-bold mb-2 text-slate-400 uppercase tracking-widest",children:"Secret Key"}),Ee.jsx("input",{type:"password",value:v.password,onChange:Q=>_({...v,password:Q.target.value}),className:`w-full p-4 rounded-xl border-2 outline-none focus:border-sc-orange transition-all ${T==="dark"?"bg-slate-800 border-slate-700":"bg-slate-50 border-slate-100"}`,placeholder:""})]}),Ee.jsxs("div",{className:"flex gap-3 pt-4",children:[Ee.jsx("button",{type:"button",onClick:()=>m(!1),className:`flex-1 py-4 font-bold rounded-xl hover:bg-slate-200 transition-all ${T==="dark"?"bg-slate-800 hover:bg-slate-700":"bg-slate-100"}`,children:"Cancel"}),Ee.jsx("button",{type:"submit",className:"flex-1 py-4 bg-sc-navy hover:bg-sc-orange text-white font-bold rounded-xl transition-all shadow-lg",children:"Confirm Verify"})]})]})]})})]})},uD=document.getElementById("root");if(!uD)throw new Error("Could not find root element to mount to");const R9=DN.createRoot(uD);R9.render(Ee.jsx(TN.StrictMode,{children:Ee.jsx(C9,{})}));
